# Maintainer: Marti Raudsepp <marti@juffo.org>
# Contributor: Lucas De Marchi <lucas.de.marchi@gmail.com>

pkgname=perf-util
pkgver=3.0.1
_dist_pkgver=v${pkgver/rc/-rc}
pkgrel=1
pkgdesc="Performance monitoring tools using the Linux performance events infrastructure"
arch=(i686 x86_64)
license=('GPL')
url="http://www.kernel.org/"
depends=('elfutils' 'zlib' 'perl' 'python2')
# NB! This is detected build-time only
optdepends=(
  'libnewt: enable interactive console UI'
)
# necessary for building man pages -- 'perf help' relies on these
makedepends=('asciidoc' 'xmlto' 'libdwarf')
source=(http://www.politreco.com/files/$pkgname-$_dist_pkgver.tar.bz2)

build() {
  cd $srcdir/$pkgname-$_dist_pkgver/tools/perf

  make PYTHON=python2 PYTHON_CONFIG=python2-config prefix=/usr \
      perfexecdir=lib/perf-core all man

  make PYTHON=python2 PYTHON_CONFIG=python2-config prefix=/usr \
      perfexecdir=lib/perf-core DESTDIR=$pkgdir/ install install-man

  install -dm 755 $pkgdir/usr/share/doc/$pkgname
  cp *.txt Documentation/*.txt $pkgdir/usr/share/doc/$pkgname
}
md5sums=('6ba7aa2061fef8135debd4fc7021900e')
