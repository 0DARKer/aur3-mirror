# Maintainer:  Athurg <athurg@gooth.cn>
# Contributor: Athurg <athurg@gooth.cn>

pkgname=duplicati
pkgver=1.2
pkgrel=1
pkgdesc="Duplicati is a free (LGPL) backup system, and a 100% managed C# implementation of Duplicity. Duplicati enables you to setup and monitor backups on Windows or Linux."
arch=('i686' 'x86_64')
url="http://code.google.com/p/duplicati/"
license=('LPL')
depends=('mono')
optdepends=(
)
source=("http://duplicati.googlecode.com/files/Duplicati%20$pkgver.zip"
	"http://duplicati.googlecode.com/svn/trunk/Duplicati/GUI/Resources/Duplicati.png"
    )

#build() {
#	cd "$srcdir/Duplicati"
#	install -Dm755 bin/$pkgname "$pkgdir/usr/bin/$pkgname"
#	#cp -r share "$pkgdir/usr/"
#}

sha1sums=('8491b4c3316f2a6aac0ddb69ff44a14d244a19e6'
	'e4e8ef8e797b0673e7256f63203491056923ed83'
    )

package() {
  #cd "$srcdir/$pkgname-$pkgver"
  mkdir -p "$pkgdir/opt"
  cp -r "$srcdir/Duplicati" "$pkgdir/opt/"
  mkdir -p "$pkgdir/usr/bin"
cat >> "$pkgdir/usr/bin/duplicati" << EOF
#!/bin/sh
cd /opt/Duplicati/
/opt/Duplicati/StartDuplicati.sh
EOF
  chmod 777 "$pkgdir/usr/bin/duplicati"
  cp "$srcdir/Duplicati.png" "$pkgdir/opt/Duplicati/"
  mkdir -p "$pkgdir/usr/share/applications"
cat >> "$pkgdir/usr/share/applications/duplicati.desktop" << EOF
#!/usr/bin/env xdg-open
[Desktop Entry]
Version=1.0
Name=Duplicati
Exec=/usr/bin/duplicati
Terminal=false
Icon=/opt/Duplicati/Duplicati.png
Type=Application
Categories=System;Utility;Archiving
EOF
}
