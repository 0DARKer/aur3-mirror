# Maintainer: Limao Luo <luolimao+AUR@gmail.com>
#
# (added from qt4pas package)
# Contributor: BlackIkeEagle <ike.devolder@gmail.com>
# Contributor: Fabien Wang <fabien.wang@gmail.com>

_pkgname=qt4pas
pkgname=lib32-$_pkgname
pkgver=2.5
pkgrel=3
pkgdesc="Free Pascal Qt4 binding library"
arch=(x86_64)
url=http://users.telenet.be/Jan.Van.hijfte/qtforfpc/fpcqt4.html
license=(LGPL3)
depends=(lib32-qt)
makedepends=(gcc-multilib)
_srcname=$_pkgname-V${pkgver}_Qt4.5.3
source=(${url%/*}/V$pkgver/$_srcname.tar.gz)
sha256sums=('825423db80da4df5c21816c0392b3394cddfe2f3293dfd08ace84941726affea')
sha512sums=('ceadfa35fde3649e370b9f61693692a35e4e512486dc553037d79b587cfdd343314cdf3646a2e90c3c9fa5a6f8818b2716e7cb81a39cb6f5ae27a527bc3dd962')

build() {
    cd "$srcdir"/$_srcname/
    export CC="gcc -m32"
    export CXX="g++ -m32"
    export QMAKESPEC="linux-g++-32"

    sed -i "s:target\.path = :&$pkgdir:g" Qt4Pas.pro

    qmake -query
    qmake
    make
}

package() {
    cd "$srcdir"/$_srcname/
    make install

    cd "$pkgdir"/usr/lib/
    for intflink in libqt4intf.so{,.5,.5.2{,.1,.5}}; do
        ln -s libQt4Pas.so.5.2.5 $intflink
    done
}
