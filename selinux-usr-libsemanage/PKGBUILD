# Maintainer: Nicky726 (Nicky726 <at> gmail <dot> com)                 
# Contributor: Sergej Pupykin (pupykin <dot> s+arch <at> gmail <dot> com)

pkgname=selinux-usr-libsemanage
_origname=libsemanage
_release=20120924
pkgver=2.1.9
pkgrel=1
pkgdesc="SELinux userspace (libsemanage including python bindings)"
arch=('i686' 'x86_64')
url="http://userspace.selinuxproject.org"
license=('GPL')
groups=('selinux' 'selinux-userspace')
depends=('ustr' 'selinux-usr-libselinux>=2.1.0' 'python2')
conflicts=('selinux-usr-libsemanage-python')
options=(!emptydirs)
source=(http://userspace.selinuxproject.org/releases/${_release}/${_origname}-${pkgver}.tar.gz)
sha256sums=('6f01d17f9751412f7b76e6e7daafeb2faf301b9bfeea83506160c81becf035cc')

build() {
  cd "${srcdir}/${_origname}-${pkgver}"

  # Set python version
  sed -i -e "s/ python/ python2/" "src/Makefile"

  make 

  # Build python wrapper, which is needed for semanage tool
  make pywrap
}

package(){
  cd "${srcdir}/${_origname}-${pkgver}"

  make DESTDIR="${pkgdir}" LIBDIR="${pkgdir}/usr/lib" SHLIBDIR="${pkgdir}/usr/lib" install
  make DESTDIR="${pkgdir}" LIBDIR="${pkgdir}/usr/lib" SHLIBDIR="${pkgdir}/usr/lib" install-pywrap
}
