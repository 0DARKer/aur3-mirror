# Maintainer: Jean Levasseur <levasseur.jean@gmail.com>
# Contributor: Allan McRae <allan@archlinux.org>
# Contributor: Alessio 'alexwizard' Sergi <sergi.alessio {at} gmail.com>

pkgname=libflickrnet
pkgver=2.2.0
pkgrel=1
pkgdesc="Flickr.Net API Library"
arch=('i686' 'x86_64')
url="http://www.codeplex.com/FlickrNet"
groups=('lib')
license=('LGPL')
depends=('mono')
makedepends=('pkgconfig')
replaces=('flickrnet')
source=("https://launchpad.net/ubuntu/+archive/primary/+files/${pkgname}_${pkgver}.orig.tar.gz"
        'AssemblyInfo.patch'
        'flickrnet.pc')
md5sums=('159d63e1a7b20090f1bcf40d510f0760'
         'aedb9bf63b1cf945f66984e44cec14c7'
         '131dd6e01f99c0533e9367b5cfda3a13')

build() {
  export MONO_SHARED_DIR="$srcdir/.wabi"
  mkdir -p "${MONO_SHARED_DIR}"
  
  cd $srcdir/${pkgname}-48055~${pkgver}/FlickrNet
  patch -Np0 -i $srcdir/AssemblyInfo.patch

  gmcs -target:library -out:FlickrNet.dll -r:System.Web.dll -r:System.Drawing.dll *.cs || return 1
  install -Dm644 FlickrNet.dll $pkgdir/usr/lib/mono/flickrnet-$pkgver/FlickrNet.dll

  install -Dm644 $srcdir/flickrnet.pc $pkgdir/usr/lib/pkgconfig/flickrnet.pc
  sed -i "s/@VERSION@/$pkgver/" $pkgdir/usr/lib/pkgconfig/flickrnet.pc
}
