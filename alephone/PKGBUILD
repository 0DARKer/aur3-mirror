# Maintainer: Marcin Skory <armitage at q84fh dot net>
# Contributor: Arkham <arkham at archlinux dot us>
# Contributor: Christoph Zeiler <archNOSPAM_at_moonblade.dot.org>
# Contributor: Jacek Poplawski <jacekpoplawski__gmail>

pkgname=alephone
pkgver=20120128
pkgrel=1
pkgdesc='A free, enhanced port of the classic FPS "Marathon 2" by Bungie Software'
arch=('i686' 'x86_64')
url="http://marathon.sourceforge.net/"
license=('GPL')
depends=('sdl_ttf' 'libmad' 'libsndfile' 'libvorbis' 'mesa' 'sdl_image' \
'sdl_net' 'smpeg' 'speex' 'zziplib')
optdepends=('alephone-emr: community-made scenario' \
            'alephone-eternalx: community-made scenario' \
            'alephone-evil: community-made scenario' \
            'alephone-marathon: M1A1 data converted for AlephOne' \
            'alephone-marathon2: original data for Marathon 2: Durandal' \
            'alephone-infinity: original data for Marathon Infinity' \
            'alephone-red: community-made scenario' \
            'alephone-rubiconx: community-made scenario' \
            'alephone-tempus_irae: community-made scenario')
makedepends=('boost' 'lua>=5.1')
source=(http://downloads.sourceforge.net/marathon/AlephOne-$pkgver.tar.bz2 \
        khne522-llazyenum.patch)
md5sums=('8693a36d29a5a1150b78554714bd9884'
         '895e67560c72e03d655a3ddbda7c2f94')
sha1sums=('05dc09cd6326f8a47729309cfb6d4a30e1c79e03'
          'debbc9eb7e03917d46b16e12d8fa14838151a11d')
sha256sums=('45a65f34074b93358bbba2e2f1232324f850f7f7d1a20512363d411e5c46298a'
            '0da56379ac5323ed92cbdc7e0e467822994268d45029bbce6adeb7e8e0faaa59')
sha512sums=('d996af81c4e56711ea965e8bf557df22118d1cb01728456b351d43217af5d64e5518a34c985896dcccd320548536f3ee7d7d39c3fccfe52ce8ab638ae0ef6547'
            'c84d64bbf38634e288188c38dc23e51c0c63b9e12e3a02d7cc0e684d40e0f8eba31a70bbe33731287932f1dc9e2490fc0601a58832ea68a27d1884f34091213e')
build() {
    cd $srcdir/AlephOne-$pkgver
    patch -p0 -i $startdir/khne522-llazyenum.patch Source_Files/Lua/lua_templates.h
    sed "s|PACKAGE='AlephOne'|PACKAGE='alephone'|g" -i configure

    ./configure --prefix=/usr
    make || return 1
    make DESTDIR="$pkgdir" install || return 1
}
