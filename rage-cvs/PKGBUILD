# Contributor: Feanor <fabio.falcinelli@gmail.com>
pkgname=rage-cvs
pkgver=20080808
pkgrel=1
pkgdesc="An Enlightened multimedia library browser"
arch=('i686')
license=('BSD')
url="http://www.enlightenment.org"
makedepends=('cvs')
conflicts=('rage')
provides=('rage')
depends=('eet' 'evas' 'ecore' 'edje' 'emotion' 'xine-lib')
source=(rage.desktop)
md5sums=('7e56125cc786187267a33cb3ef7a9465')

_cvsroot=":pserver:anonymous@anoncvs.enlightenment.org:/var/cvs/e"
_cvsmod="misc/rage"

build() {
  cd $startdir/src
  msg "Connecting to the CVS server...."
  cvs -z3 -d $_cvsroot co -D $pkgver -f $_cvsmod
  cd $_cvsmod
  
  msg "CVS checkout done or server timeout"
  msg "Starting make..."

  cp -R $startdir/src/${_cvsmod%%/*} $startdir/src/${_cvsmod%%/*}-build
  cd $startdir/src/${_cvsmod%%/*}-build
  cd ${_cvsmod#*/}

  ./autogen.sh --prefix=/usr/ --disable-static

  make || return 1
  make DESTDIR=$startdir/pkg install
  install -D -m644 $startdir/src/rage.desktop $startdir/pkg/usr/share/applications/rage.desktop
  install -D -m644 AUTHORS $startdir/pkg/usr/share/licenses/$pkgname/AUTHORS
  install -D -m644 COPYING $startdir/pkg/usr/share/licenses/$pkgname/COPYING
  rm -fr $startdir/src/${_cvsmod%%/*}-build
}

