#! /bin/bash
# Maintainer: Jorge Barroso <jorge.barroso.11 at gmail dot com>
# Contributor: Aurélien DESBRIÈRES <ice.cube@gmx.com>
# Contributor: Nick B <Shirakawasuna at gmail _dot_ com>
# Contributor: Iven Day <ivenvd@gmail.com>

pkgname=akamaru-svn
pkgver=3
pkgrel=5
pkgdesc="A simple, but fun, physics engine prototype"
arch=('i686' 'x86_64')
url="http://www.kiba-dock.org/"
license=('GPL')
depends=('glib2')
makedepends=('subversion' 'pkgconfig' 'intltool' 'sed')
conflicts=('akamaru')
provides=('akamaru')

_svntrunk=https://kibadock.svn.sourceforge.net/svnroot/kibadock/trunk/akamaru
_svnmod=akamaru

build() {
  cd $srcdir
  svn co $_svntrunk -r $pkgver $_svnmod
  cd $_svnmod 
  msg "Starting build..."
  cp -r ../$_svnmod ../$_svnmod-build
  cd ../$_svnmod-build
  mv configure.in configure.ac
  sed -i 's#AC_SUBST("$AKAMARU_REQUIRES")#AC_SUBST(AKAMARU_REQUIRES)#' configure.ac
  sed -i 's#AM_CONFIG_HEADER#AC_CONFIG_HEADER#' configure.ac
  ./autogen.sh --prefix=/usr
  ./configure --prefix=/usr
  make
}

package() {
  cd $srcdir/$_svnmod-build
  
  make DESTDIR=$pkgdir install
  
  install -D -m644 COPYING $pkgdir/usr/share/licenses/custom/akamaru-svn/LICENSE
}
