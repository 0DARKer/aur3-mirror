pkgname=linux4tegra
pkgver=R15alpha1
pkgrel=1
arch=(arm armv7h)
url="http://developer.nvidia.com/linux-tegra"
license=(custom)
options=(!strip)
pkgdesc="drivers and codecs for nvidia tegra platform"

platform=ventana # harmony / ventana / cardhu
xabi=11 #5..11

source=("http://developer.download.nvidia.com/assets/tools/files/l4t/r15_alpha/${platform}_Tegra-Linux-R15.alpha.1.0.tbz2"
        "http://developer.download.nvidia.com/assets/tools/files/l4t/r15_alpha/${platform}_Tegra-Linux-codecs-R15.alpha.1.0.tar.gz"
        "http://developer.download.nvidia.com/assets/tools/files/l4t/r15_alpha/Tegra-Linux-nvgstplayerR15.alpha.1.0.tbz2")

package() {
  tar xaf $srcdir/Linux_for_Tegra/nv_tegra/base.tgz -C $pkgdir
  tar xaf $srcdir//nvgstplayer.tbz2 -C $pkgdir
  tar xaf $srcdir/restricted_codecs.tbz2 -C $pkgdir
  cp $srcdir/Linux_for_Tegra/nv_tegra/x/tegra_drv.abi${xabi}.so $pkgdir/usr/lib/xorg/modules/drivers/tegra_drv.so
  rm -rf $pkgdir/{home,usr/sbin,lib/modules}
  install -D -m644 "${srcdir}/Tegra_Software_License_Agreement-Tegra-Linux-codecs.pdf" "${pkgdir}/usr/share/licenses/${pkgname}/codecs_agreement.pdf"
  install -D -m644 "${srcdir}/Linux_for_Tegra/nv_tegra/LICENSE" "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
  mkdir $pkgdir/etc/X11/xorg.conf.d
  mv $pkgdir/etc/X11/xorg.conf $pkgdir/etc/X11/xorg.conf.d/10-tegra.conf
}
md5sums=('3ae3c24ea14ad337355b6c2f478c7e04'
         'b6049dad06931b718ce2b7fda6505024'
         '2a31b5fc77ebc1887bea02ebf46504b3')
