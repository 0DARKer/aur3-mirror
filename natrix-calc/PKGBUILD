# Maintainer: Mijo Medvedec <mijo dot medvedec at gmail dot com>

pkgname=natrix-calc
pkgver=2.1
pkgrel=4
pkgdesc="Generic IP calculator with ability to calculate parameters of IPv4/IPv6 networks"
arch=('i686' 'x86_64')
url="http://sourceforge.net/projects/natrix/"
license=('GPL3')
depends=('qt4')
makedepends=('qt4' 'gendesk')
source=("http://sourceforge.net/projects/natrix/files/${pkgver}/${pkgname}_${pkgver}.zip")
md5sums=('0d00ac5639433c7540b9dcf6dd681cbe')
sha256sums=('4a200652c04da87a10fa2aa869541ae58454dd2f980f0c042eceefd958c8283b')

prepare() {
	gendesk -n --pkgname "$pkgname" --pkgdesc "$pkgdesc"
}

build() {
	cd "$srcdir/$pkgname"
	qmake-qt4 Natrix.pro
	make
}

package() {
	cd "$srcdir/$pkgname"
	install -Dm 755 "$pkgname" "$pkgdir/usr/bin/$pkgname"

	install -dm 755 "$pkgdir/usr/share/$pkgname/locale"
	install -Dm 644 *.qm "$pkgdir/usr/share/$pkgname/locale"

	install -Dm 644 "$pkgname.png" "$pkgdir/usr/share/pixmaps/$pkgname.png"
	install -Dm 644 "$srcdir/$pkgname.desktop" "$pkgdir/usr/share/applications/$pkgname.desktop"

	sed -i 's/Natrix-calc/Natrix/g' "$pkgdir/usr/share/applications/$pkgname.desktop"
	sed -i 's/Office;/Network;Internet;Utility;KDE;/g' "$pkgdir/usr/share/applications/$pkgname.desktop"
}
