# Maintainer: L.G. Sarmiento <pico@pietro.gfnun.unal.edu.co>
pkgname=fityk-git
pkgver=20120612
pkgrel=1
pkgdesc="A program for nonlinear fitting of analytical functions to data."
url="http://fityk.nieto.pl/"
arch=('i686' 'x86_64')
license=('GPL2')
depends=('lua' 'xylib' 'python' 'ruby' 'gtk2' 'libsm' 'libxxf86vm' 'desktop-file-utils')
makedepends=('boost' 'git' 'python-sphinx' 'svn' 'swig')
optdepends=('gnuplot: can be used with the CLI')
provides=("fityk=${pkgver}")
options=('!libtool')
source=("fityk.install")
md5sums=('0f2c2b78511036ea623a9568509bc987')

install="fityk.install"

build() {
  # daily snapshot because fityk requires wxgtk>=2.9 not yet available in arch
  svn checkout http://svn.wxwidgets.org/svn/wx/wxWidgets/trunk ${srcdir}/wxWidgets
  cd ${srcdir}/wxWidgets
  ./configure --prefix=${srcdir}/usr --disable-shared --with-libpng=sys --with-libxpm=sys --with-libjpeg=sys --with-libtiff=sys
  make
  make install

  # Proper fityk
  git clone --depth 1 http://github.com/wojdyr/fityk.git ${srcdir}/fityk
  cd ${srcdir}/fityk
  ./autogen.sh \
    --prefix=/usr \
    --with-wx-prefix=${srcdir}/usr
  make
}

package() {
  cd ${srcdir}/fityk
  make DESTDIR=${pkgdir} install
}
