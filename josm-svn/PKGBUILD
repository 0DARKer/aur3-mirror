# Contributor: Johann Kl√§hn <kljohann@gmail.com>
# .desktop-file from package josm-latest by Eichi <mail@der-eichi.de>

# This only uses makepkgs svn feature to get the latest version number
# Then, precompiled binaries are downloaded

pkgname=josm-svn
pkgver=1526
pkgrel=1
pkgdesc="An editor for OpenStreetMap written in Java. (latest .jar snapshot; no actual compilation is done)"
arch=('i686' 'x86_64')
url="http://josm.openstreetmap.de/"
license=('GPL')
provides=('josm')
depends=('java-runtime')
makedepends=('subversion' 'wget')
conflicts=('josm')
source=(josm.png::http://josm.openstreetmap.de/browser/trunk/images/logo.png?format=raw
        josm.sh
        josm.desktop)
md5sums=()

_svntrunk=http://josm.openstreetmap.de/svn/trunk
_svnmod=josm-svn

build() {
  cd $startdir/src

  wget -c -t 3 --waitretry=3 -O josm-latest.jar http://josm.openstreetmap.de/download/josm-snapshot-$pkgver.jar
  if [[ $? -ne 0 ]]; then
    echo "! The binary for rev. $pkgver was not yet uploaded. Please retry later." 1>&2-
    return 1
  fi
 
  install -D -m644 josm-latest.jar $pkgdir/usr/share/java/josm/josm.jar || return 1
  install -D -m755 josm.sh $pkgdir/usr/bin/josm || return 1
  install -D -m644 josm.desktop $startdir/pkg/usr/share/applications/josm.desktop || return 1
  install -D -m644 josm.png ${startdir}/pkg/usr/share/pixmaps/josm.png || return 1
}
