# Maintainer:  Martin C. Doege <mdoege at compuserve dot com>

pkgname=gophervr
pkgver=0.4.1
pkgrel=4
pkgdesc="A Virtual Reality interface to Gopherspace"
arch=('i686' 'x86_64')
url="gopher://gopher.floodgap.com/1/gophervr"
license=('GPL')
depends=('openmotif')
makedepends=('curl' 'unzip')
source=("Makefile.patch"
        "helpdiag.h.patch"
        "vogl.h.patch"
        "gophervr.desktop"
        "gophervr_icon.png")
md5sums=('acbb60dc127d4294d0ae404be6fd865b'
         '1143af9faa2a53355f480382b6a2b0e0'
         'bf0bd46b2015cf678e3264ce8cd077d0'
         '357365c3e59262d92e1d0382cd842e53'
         '05f51b00d10f6dac04ca5d03b62e88e1')

build() {
  cd $srcdir
  curl -O "gopher://gopher.floodgap.com/5/gophervr/all-versions/gophervr-"$pkgver"-src.zip"
  unzip "gophervr-"$pkgver"-src.zip"
  cd gophervr
  patch gophervr/Makefile $srcdir/Makefile.patch
  patch gophervr/helpdiag.h $srcdir/helpdiag.h.patch
  patch libvogl/src/vogl.h $srcdir/vogl.h.patch
  make linux
}

package() {
  cd "$srcdir/gophervr/gophervr"
  mkdir -p $pkgdir/usr/bin
  cp gophervr $pkgdir/usr/bin
  mkdir -p $pkgdir/usr/local/lib/hershey
  cp futura.hfont $pkgdir/usr/local/lib/hershey
  mkdir -p $pkgdir/usr/share/doc/gophervr
  cp gophervr.help $pkgdir/usr/share/doc/gophervr
  cd $srcdir
  mkdir -p $pkgdir/usr/share/icons
  cp gophervr_icon.png $pkgdir/usr/share/icons
  mkdir -p $pkgdir/usr/share/applications
  cp gophervr.desktop $pkgdir/usr/share/applications
}
