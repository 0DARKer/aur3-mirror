# Contributor: Andreas W. Hauser <andy-aur@splashground.de>
pkgname=cpdup
pkgver=1.09
pkgrel=1
pkgdesc="DragonFly BSD tool to mirror filesystems retaining permissions, flags, ownership, and utimes"
url="http://apollo.backplane.com/FreeBSDPorts/"
license=('BSD')
arch=(i686 x86_64)
source=(http://apollo.backplane.com/FreeBSDPorts/cpdup-$pkgver.tar.gz)

build() {
  cd $startdir/src/$pkgname
  rm -f md5.c
  # The Makefile is a BSD Makefile, so don't use it.
  export CFLAGS="$CFLAGS -D__unused= -D_GNU_SOURCE -D__USE_FILE_OFFSET64 -DNOMD5 -DUSE_PTHREADS -pthread"
  for f in fsmid.o  hclink.o hcproto.o misc.o; do
    make -f /dev/null $f
  done
  export LDFLAGS="$LDFLAGS fsmid.o  hclink.o hcproto.o misc.o"
  make -f /dev/null cpdup
  mkdir -p  $startdir/pkg/usr/bin
  install cpdup -m 755  $startdir/pkg/usr/bin/cpdup
  mkdir -p  $startdir/pkg/usr/share/man/man1
  install -m 644 cpdup.1  $startdir/pkg/usr/share/man/man1
}
md5sums=('39854050225ad0fc8cdeea60e8b81e74')
