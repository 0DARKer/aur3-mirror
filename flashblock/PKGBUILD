# Maintainer: Dave Nguyen <diendien@gmail.com>

pkgname=flashblock
pkgver=1.5.13
pkgrel=1
pkgdesc="Firefox add-on which blocks ALL Flash content"

url="http://flashblock.mozdev.org/"
license=('MPL')

arch=('any')
depends=('firefox')
_firefoxVersion=$(firefox -v | sed 's/^.*\(3\.[5-9][0-9]*\).*$/\1/g')

source=(http://downloads.mozdev.org/flashblock/flashblock-1.5.13.xpi)
md5sums=('a0670d4e57a73da2e80582aac2343783')

build() {
  cd $srcdir

  local emid=$(sed -n '/.*<em:id>\(.*\)<\/em:id>.*/{s//\1/p;q}' install.rdf) || return 1
  local dstdir=$pkgdir/usr/lib/firefox-$_firefoxVersion/extensions/$emid

  install -d $dstdir || return 1
  cp -R * $dstdir || return 1

  rm -f $dstdir/*.xpi || return 1
  chmod -R -x+X $dstdir || return 1
}
