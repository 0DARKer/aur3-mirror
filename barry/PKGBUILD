# Contributor: Ray Blostein <rblostein [at] gmail.com>
pkgname=barry
pkgver=0.17.1
pkgrel=1
pkgdesc="Barry is a GPL C++ library for interfacing with the RIM BlackBerry Handheld."
url='http://www.netdirect.ca/software/packages/barry'
license=('GPL')
arch=('i686' 'x86_64')
depends=('libusb-compat' 'zlib' 'libglademm' 'libtar' 'libxml++')
makedepends=('make' 'gcc' 'patch' 'pkg-config' 'autoconf' 'automake' 'libtool' 'gettext')

optdepends=('fuse: for bfuse')
conflicts=('barry-git')
source=("http://downloads.sourceforge.net/${pkgname}/${pkgname}-${pkgver}.tar.bz2"
        'tarfile-ops-nt.cc.patch'
        'packet.h.patch'
        'j_jdwp.cc.patch')

md5sums=('645b2816c79584ac36f63ce69dbbfd24'
         '1f808132b402c4ea68a0d1fc3f19142c'
         '3a3171224aca4d7fd15bfc161145c9dd'
         '2f6b4ba25c4da3185d8a003a6515f81a')

build() {
# Apply patches
  cd $srcdir/$pkgname-$pkgver/src
  patch -p0 < $srcdir/tarfile-ops-nt.cc.patch
  patch -p0 < $srcdir/packet.h.patch
  patch -p0 < $srcdir/j_jdwp.cc.patch

# Build the package
  cd $srcdir/$pkgname-$pkgver
  ./configure --prefix=/usr --enable-gui
  make || return 1
  make DESTDIR=$pkgdir install

# Remove libtool files
  find "$pkgdir/" -name "*.la" -exec rm {} \;
}

