# Contributor: Ray Blostein <rblostein [at] gmail.com>
pkgname=barry
pkgver=0.16
pkgrel=4
pkgdesc="Barry is a GPL C++ library for interfacing with the RIM BlackBerry Handheld."
url='http://sourceforge.net/projects/barry'
license=('GPL')
arch=('i686' 'x86_64')
depends=('libusb' 'zlib' 'libglademm' 'libtar')
makedepends=('make' 'gcc' 'patch' 'pkg-config')
optdepends=('fuse: for bfuse')
conflicts=('barry-git')
source=("http://downloads.sourceforge.net/${pkgname}/${pkgname}-${pkgver}.tar.bz2"
        'tarfile-ops-nt.cc.patch'
        'j_message.h.patch')
md5sums=('1f22bbce27702e116902fc199e239878'
         '1f808132b402c4ea68a0d1fc3f19142c'
         '58bdede25b0fd1f7b9ce5b5665016851')

build() {
# Apply patches
  cd $srcdir/$pkgname-$pkgver/gui/src
  patch -p0 < $srcdir/tarfile-ops-nt.cc.patch
  cd $srcdir/$pkgname-$pkgver/src
  patch -p0 < $srcdir/j_message.h.patch

# Build the package
  cd $srcdir/$pkgname-$pkgver
  ./configure --prefix=/usr --enable-gui
  make || return 1
  make DESTDIR=$pkgdir install

# Remove libtool files
  find "$pkgdir/" -name "*.la" -exec rm {} \;
}

