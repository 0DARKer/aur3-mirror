# Contributor: Majki <majki@majki.hu>
pkgname=ultimatepp
pkgver=2791
pkgrel=2
arch=('i686' 'x86_64')
pkgdesc="Ultimate++ is a C++ cross-platform rapid application development IDE."
url="http://www.ultimatepp.org/"
license="BSD"
depends=('gcc' 'libxft' 'libnotify' 'libpng')
optdepends=('valgrind')
conflicts=('upp')
source=(http://downloads.sourceforge.net/project/upp/upp/$pkgver/upp-x11-src-$pkgver.tar.gz doinstall)
md5sums=('875d4399948fee67e2485618f46d1b0c' 'e229c42b8ce85a2fb2caf1400de0c712')

build() {
  cd $srcdir/upp-x11-src-$pkgver
  
  # patching this idiotic build system ;-)
  sed -i '/^CC\ =/s/\(.*\)/\1\ -O2\ -march=native/' uppsrc/Makefile
  sed -i '/^cp uppsrc/d' domake
  sed -i '/RELEASE_OPTIONS/s/-O1/-O2\ -march=native/' GCC.bm
  cp ../../doinstall doinstall

  make || return 1
  sh doinstall $pkgdir || return 1

  echo -e "\n  If you prefer command line, just type upp to start the IDE.\n  Have fun ;)\n"
}

