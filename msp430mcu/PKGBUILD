# Contributor: Rick W. Chen <stuffcorpse at archlinux dot us>

pkgname=msp430mcu
pkgver=20110613
pkgrel=2
pkgdesc="C headers and binutils linker scripts for microcontrollers in the MSP430 family"
arch=(any)
url="http://mspgcc4.sourceforge.net/"
license=('GPL')
makedepends=('python2')
options=(!strip)
source=("http://sourceforge.net/projects/mspgcc/files/${pkgname}/${pkgname}-${pkgver}.tar.bz2"
        "header_perms.patch")
sha1sums=('79904ac0c1852c6846cadbb21a0cb77a47adcdcd'
          '712a29f7de41ad38d6a05d6a43097ffeea473244')

_builddir="${srcdir}/build"

build() {
  cp -r "${srcdir}/msp430mcu-${pkgver}" ${_builddir} && cd ${_builddir}
  sed -i -e "s|python |python2 |" $(find ./scripts/ -name '*.sh')
  export MSP430MCU_ROOT=$(pwd)
  ./scripts/build.sh
}

package() {
  cd ${_builddir}
  patch -Np1 -i "${srcdir}/header_perms.patch"
  ./scripts/install.sh "${pkgdir}/usr"
}

# vim:set sts=2 ts=2 sw=2 et:
