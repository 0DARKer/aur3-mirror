From 05070d92c70f9d3f9f4531672d4e7da64837c569 Mon Sep 17 00:00:00 2001
From: Raimar <no@email.de>
Date: Thu, 12 Jun 2014 20:51:12 +0200
Subject: [PATCH] Added ESCAPE key to close the lxsession-logout menu

---
 lxsession-logout/lxsession-logout.c | 10 ++++++++++
 1 file changed, 10 insertions(+)

diff --git a/lxsession-logout/lxsession-logout.c b/lxsession-logout/lxsession-logout.c
index 9ace78d..84f15a4 100644
--- a/lxsession-logout/lxsession-logout.c
+++ b/lxsession-logout/lxsession-logout.c
@@ -19,6 +19,7 @@
 #include <config.h>
 #include <locale.h>
 #include <stdlib.h>
+#include <gdk/gdkkeysyms.h>
 #include <gtk/gtk.h>
 #include <gdk/gdk.h>
 #include <gdk/gdkx.h>
@@ -774,6 +775,15 @@ int main(int argc, char * argv[])
     GtkWidget * cancel_button = gtk_button_new_from_stock(GTK_STOCK_CANCEL);
     gtk_button_set_alignment(GTK_BUTTON(cancel_button), 0.0, 0.5);
     g_signal_connect(G_OBJECT(cancel_button), "clicked", G_CALLBACK(cancel_clicked), NULL);
+    GtkAccelGroup* accel_group = gtk_accel_group_new();
+    gtk_window_add_accel_group(GTK_WINDOW(window), accel_group);
+#if GTK_CHECK_VERSION(3,0,0)
+    gtk_widget_add_accelerator(cancel_button, "activate", accel_group,
+        GDK_KEY_Escape, (GdkModifierType)0, GTK_ACCEL_VISIBLE);
+#else
+    gtk_widget_add_accelerator(cancel_button, "activate", accel_group,
+        GDK_Escape, (GdkModifierType)NULL, GTK_ACCEL_VISIBLE);
+#endif
     gtk_box_pack_start(GTK_BOX(controls), cancel_button, FALSE, FALSE, 4);
 
     /* Create the error text. */
-- 
2.0.0

