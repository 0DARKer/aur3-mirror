# Maintainer: JWC <bulk |aaaatttremovethis|jwcxz0putaperiodhere0com>
# Main Contributor: Martti KÃ¼hne <mysatyre[at]gmail[dot]com>
# Contributor: Ian Taylor <ibtaylor[at]gmail[dot]com>
pkgname=tmux-cvs-windowstatus
pkgver=20100805
pkgrel=1
pkgdesc="A terminal multiplexer, CVS version, with extended window status patch"
url="http://sourceforge.net/projects/tmux/"
arch=('i686' 'x86_64')
license=('BSD')
makedepends=('coreutils' 'make' 'cvs')
depends=('ncurses')
conflicts=(tmux)
provides=(tmux)
source=(LICENSE window-status.patch)
md5sums=('71601bc37fa44e4395580b321963018e'
         'e41e86ea522b2304989f73dfd556f5b0')

_cvsroot=":pserver:anonymous@tmux.cvs.sourceforge.net:/cvsroot/tmux"
_cvsmod="tmux"

build() {
  cd $srcdir

  msg "Connection to $_cvsmod.sourceforge.net CVS server..."
  cvs -d$_cvsroot checkout $_cvsmod || return 1

  msg "CVS checkout done"
  msg "Starting make..."

  cd "$srcdir/${pkgname%-*-*}"

  patch -p0 < ../window-status.patch

  mkdir -p "$pkgdir/usr/bin"
  mkdir -p "$pkgdir/usr/share/man/man1"
  mkdir -p "$pkgdir/usr/share/vim/syntax"
  mkdir -p "$pkgdir/usr/share/doc/tmux"
  mkdir -p "$pkgdir/usr/share/licenses/tmux"

  ./configure
  make || return 1

  install -Dm755 tmux "$pkgdir/usr/bin/tmux" && \
  install -Dm644 tmux.1 "$pkgdir/usr/share/man/man1/tmux.1" && \
  install -Dm644 examples/tmux.vim "$pkgdir/usr/share/vim/vimfiles/syntax/tmux.vim" && \
  install -Dm644 ../LICENSE "$pkgdir/usr/share/licenses/tmux/LICENSE" && \
  install -dm755 "$pkgdir/usr/share/tmux/" && \
  install -m644 examples/*.conf "$pkgdir/usr/share/tmux/"
}
