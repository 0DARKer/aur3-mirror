# Maintainer: Andr√© Schlichting <andre@delorus.de>
pkgname=python2-fitparse-git
pkgver=20121207
pkgrel=1
pkgdesc="Garmin FIT file parser implementation"
arch=('i686' 'x86_64')
url="https://github.com/dtcooper/python-fitparse"
license=('Python' "custom:python2-fitparse")
depends=('python2')
makedepends=('git')

_gitroot=git://github.com/dtcooper/python-fitparse.git
_gitname=python-fitparse

build() {
  cd "$srcdir"
  msg "Connecting to GIT server...."

  if [[ -d "$_gitname" ]]; then
    cd "$_gitname" && git pull origin
    msg "The local files are updated."
  else
    git clone "$_gitroot" "$_gitname" --depth=1
  fi

  msg "GIT checkout done or server timeout"

  rm -rf "$srcdir/$_gitname-build"
  mkdir -p "$srcdir/$_gitname-build"
  cd "$srcdir/$_gitname" && ls -A | grep -v .git | xargs -d '\n' cp -r -t ../$_gitname-build
  cd "$srcdir/$_gitname-build"

  install -dm755 ${pkgdir}/usr/lib/python2.7/site-packages/fitparse
  cp fitparse/* ${pkgdir}/usr/lib/python2.7/site-packages/fitparse

  install -Dm644 LICENSE ${pkgdir}/usr/share/licenses/python2-fitparse/LICENSE
}
