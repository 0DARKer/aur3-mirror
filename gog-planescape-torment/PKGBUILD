# Maintainer : Andr√© Fettouhi <a.fettouhi@gmail.com>
# Contributor : Noctivivans  <noctivivans@gmail.com>

pkgname=gog-planescape-torment
pkgver=1.0.0.6
pkgrel=2
pkgdesc="Sigil... A place with gates that lead anywhere in existence, provided you have the proper key."
arch=("i686" "x86_64")
url="http://www.gog.com/game/planescape_torment"
license=("custom")
lang_dir="(Polish)" #FIXME - replace "polish" with preferred language
lang_pkg="polish" #FIXME - replace "polish" with preferred language
groups=("games")
source=("gog_planescape_torment_${lang_pkg}_${pkgver}.tar.gz" "gog-planescape-torment")
sha256sums=('c43418cd934d5a1bc2fb9a25420b02a1ca51d28dfbf77ced296a565a86cc4722' #FIXME - replace sha256sum with correct one for ${lang_pkg}
            '21d8d21cab91ab140380273d430ecf98cf95abb3a1fe7f6ca03657e97d6da9c1')
depends=(freetype2 wine)
#options=('!strip')
PKGEXT=.pkg.tar

package() {
mkdir -p "${pkgdir}"/opt/gog/planescape-torment-${lang_pkg}
mv "${srcdir}"/Planescape\ Torment\ ${lang_dir}/prefix/drive_c/GOG\ Games/Planescape\ Torment\ ${lang_dir}/* "${pkgdir}"/opt/gog/planescape-torment-${lang_pkg}
sed -i s/'HD0:=.\+'/'HD0:=C:\\planescape-torment-polish\\'/ "${pkgdir}"/opt/gog/planescape-torment-${lang_pkg}/Torment.ini #FIXME - replace "polish" with ${lang_pkg}
sed -i s/'CD1:=.\+'/'CD1:=C:\\planescape-torment-polish\\data\\'/ "${pkgdir}"/opt/gog/planescape-torment-${lang_pkg}/Torment.ini #FIXME - replace "polish" with ${lang_pkg}
sed -i s/'CD2:=.\+'/'CD2:=C:\\planescape-torment-polish\\data\\'/ "${pkgdir}"/opt/gog/planescape-torment-${lang_pkg}/Torment.ini #FIXME - replace "polish" with ${lang_pkg}
sed -i s/'CD3:=.\+'/'CD3:=C:\\planescape-torment-polish\\data\\'/ "${pkgdir}"/opt/gog/planescape-torment-${lang_pkg}/Torment.ini #FIXME - replace "polish" with ${lang_pkg}
sed -i s/'CD4:=.\+'/'CD4:=C:\\planescape-torment-polish\\data\\'/ "${pkgdir}"/opt/gog/planescape-torment-${lang_pkg}/Torment.ini #FIXME - replace "polish" with ${lang_pkg}
sed -i s/'CD5:=.\+'/'CD5:=C:\\planescape-torment-polish\\data\\'/ "${pkgdir}"/opt/gog/planescape-torment-${lang_pkg}/Torment.ini #FIXME - replace "polish" with ${lang_pkg}
mkdir -p "${pkgdir}"/usr/bin/
cp -a "${srcdir}/gog-planescape-torment" "${srcdir}/gog-planescape-torment-${lang_pkg}"
sed -i s/"ID=planescape-torment"/"ID=planescape-torment-${lang_pkg}"/g "${srcdir}/gog-planescape-torment-${lang_pkg}"
install -Dm644 "${srcdir}"/Planescape\ Torment\ ${lang_dir}/support/gog-planescape-torment-${lang_pkg}-primary.desktop "${pkgdir}"/usr/share/applications/gog-planescape-torment-${lang_pkg}.desktop
install -Dm644 "${srcdir}"/Planescape\ Torment\ ${lang_dir}/support/gog-planescape-torment-${lang_pkg}.png "${pkgdir}"/usr/share/pixmaps/gog-planescape-torment-${lang_pkg}.png
install -Dm644 "${srcdir}"/Planescape\ Torment\ ${lang_dir}/docs/End\ User\ License\ Agreement.txt "${pkgdir}"/usr/share/licenses/$pkgname-${lang_pkg}/LICENSE
install -Dm755 "${srcdir}/gog-planescape-torment-${lang_pkg}" "${pkgdir}/usr/bin/gog-planescape-torment-${lang_pkg}"
}
