# Maintainer: saxonbeta <saxonbeta at gmail __com
pkgname=elmerfem-git
_pkgname=elmerfem
pkgver=20150211
pkgrel=1
pkgdesc="Elmer multi-physics simulator."
arch=('i686' 'x86_64')
url="http://www.csc.fi/english/pages/elmer"
license=('GPL')
depends=('qwt' 'opencascade' 'vtk5' 'suitesparse' 'arpack')
makedepends=('git' 'gcc-fortran' 'cmake')
provides=(elmerfem)
conflicts=('elmer_fem' 'elmer_eio' 'elmer_hutiter' 'elmer_matc' 'elmergrid' 'elmer_mathlibs' 'elmer_meshgen2d' 'elmer_umfpack' 'elmerfem-svn')
options=(!emptydirs !makeflags)

source=('git+https://github.com/ElmerCSC/elmerfem.git')
sha256sums=(SKIP)

prepare() {
cd "$srcdir/$_pkgname/ElmerGUI"

cp Application/forms/* Application/src/


}


build() {
  
  
  cd "$srcdir/$_pkgname"
  cmake -DWITH_ELMERGUI:BOOL=TRUE -DWITH_MPI:BOOL=TRUE -DCMAKE_INSTALL_PREFIX=$pkgdir/usr \
  -DWITH_VTK:BOOL=TRUE -DWITH_OpenMP:BOOL=TRUE -DWITH_QWT:BOOL=TRUE \
  -DELMER_SOLVER_HOME=$pkgdir/usr/share/elmersolver -DELMER_INSTALL_LIB_DIR=$pkgdir/usr/lib
  make all
  

 

}

package() {
 cd "$srcdir/$_pkgname"
 make install
 
 #rm -- $pkgdir/usr/lib/elmersolver/*.a
 rm -- $pkgdir/usr/lib/{libparpack.so,libarpack.so}
 mv $pkgdir/usr/share/elmersolver/lib/*.so $pkgdir/usr/lib
 
 
 
 
 
}
