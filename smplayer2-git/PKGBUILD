# Maintainer: loonyphoenix (loonyphoenix at gmail)
# Contributor: Flamelab <panosfilip@gmail.com>
# Fixes and patches: WAntilles <wantilles@adslgr.com>

# This is a modified and (heavily) simplified version of smplayer-svn package. It builds an
# SMPlayer fork named SMPlayer2 by lachs0r, which fixes several issues with mplayer2 
# integration.

pkgname=smplayer2-git
pkgver=20111018
pkgrel=1
_realver=0.6.9
pkgdesc="A complete front-end for MPlayer and mplayer2"
url="https://github.com/lachs0r/SMPlayer2"
arch=('i686' 'x86_64')
license=('GPL')
depends=('qt>=4.7.2' 'mplayer')
makedepends=('git')
conflicts=('smplayer')
provides=("smplayer=$_realver")
source=()

_gitroot="git://github.com/lachs0r/SMPlayer2.git"
_gitname="smplayer2"

build()

{
  cd "${srcdir}"

  if [[ -d "${_gitname}" ]]; then
    cd "${_gitname}"
    git pull
  else
    git clone "${_gitroot}" "${_gitname}" && cd "${_gitname}"
  fi

  cd "${srcdir}"

  if [ -d ${_gitname}-build ]; then
        rm -r ${_gitname}-build
  fi
  cp -r ${_gitname} ${_gitname}-build
  cd ${_gitname}-build

  make PREFIX=/usr
}

package() { 
  cd ${srcdir}/${_gitname}-build
  make PREFIX=${pkgdir}/usr install

  install -dm755 ${pkgdir}/usr/share/pixmaps
  ln -s /usr/share/icons/hicolor/64x64/apps/smplayer.png \
        ${pkgdir}/usr/share/pixmaps/
}
