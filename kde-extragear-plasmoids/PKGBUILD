# Contributor: Bartek Iwaniec <hash87 [at] gmail [dot] com>

pkgname=kde-extragear-plasmoids
arch=(i686 x86_64)
pkgver=4.7.3
pkgrel=1
pkgdesc="Additional Plasmoids from kde-look.org"
url="http://www.kde-look.org/"
license="GPL"
depends=('kdebase-workspace>=4.7.0' 'qjson')
makedepends=('cmake' 'gcc' 'automoc4' 'gettext' 'boost')
source=(
	http://kde-look.org/CONTENT/content-files/134442-plasma-widget-quickaccess-0.8.2-2.zip
	http://litc.gildiarpg.pl/downloads/wifi-signal.tar.gz
	http://kde-look.org/CONTENT/content-files/91009-iHateTheCashew-4.4.tbz
	http://www.kde-look.org/CONTENT/content-files/92825-adjustableclock-2.6.1.tar.bz2
	http://kde-look.org/CONTENT/content-files/109367-yasp-scripted-1.0.8a.tar.bz2
	http://www.kde-look.org/CONTENT/content-files/99737-fancytasks-1.0.95.tar.bz2
	http://sourceforge.net/projects/yawp/files/yawp/0.3.6/yawp-0.3.6.tar.bz2
	http://ivplasma.googlecode.com/files/toggle-compositing-0.2.3.tar.gz
	http://kde-look.org/CONTENT/content-files/97511-translatoid-1.30.tar.gz
	http://www.kde-look.org/CONTENT/content-files/92309-0.2-beta1.tar.bz2
	http://kde-look.org/CONTENT/content-files/98925-cwp-1.5.4.tar.bz2
	https://bitbucket.org/flupp/smooth-tasks-fork/get/5837a7a0593b.tar.bz2
	http://cdlszm.org/downloads/plasma-applet-daisy-0.0.4.25.tar.gz
	http://www.kde-look.org/CONTENT/content-files/91495-runcommand-2.2.tar.bz2
	http://socket-sentry.googlecode.com/files/socketsentry-0.9.3.tar.gz
	#http://kde-look.org/CONTENT/content-files/104631-v2.1.1.tar.gz
	http://kde-look.org/CONTENT/content-files/107779-plasmoid-eventlist-0.3.95.tar.gz
	http://kde-look.org/CONTENT/content-files/127019-playwolf-elements-0.2.2.tar.bz2
	http://kde-look.org/CONTENT/content-files/127462-fastuserswitch-0.3.1.tar.bz2
	http://kde-look.org/CONTENT/content-files/144808-plasma-icontasks-0.9.0.tar.bz2
)
md5sums=('4879aa3af6d7db8e06dd8ed0ad994a51'
         '5c147b8c4c98043559716ae070bc06f2'
         '521952f888a4fe8a72969a586743c4b6'
         'a688bcfc5bf3a901fa140afea60ed713'
         'b271abb634b6310ce7853a479ee682b0'
         '4861bc8626a6e1ab3cc0d5b0df4ce562'
         'd64c6d528e3ba7b7afba63e6670211c8'
         'c811dd4d9842d1628b748e01855357b5'
         '7f5e2c4d11756da3b0fa9c80076426df'
         'df2624396c2838457b866483dfbf9265'
         '46b9cbfd51093d153806b17883e10f9b'
         '45441bba77c78d7282b0f857513663d4'
         '269fd526453a16066cb704352505f7e9'
         '1af09c59f3cba642db36871fb9cd340a'
         'b737c58ccf79d63bf15c87d99728518a'
         '390e8a73ddb19a5608407f8c97f828f3'
         'd2c8c95ba7774dc1ac90c0c62540b064'
         'd24d587265ec841567f00d8fe5240629'
         '91366828fe49aec4bf293b80021d8ee7')

build() {
#Build plasmoids
cd $srcdir
for _plasmoid_dir in *
do
   if [ -d $_plasmoid_dir ]; then
       if [ -f $_plasmoid_dir/CMakeLists.txt ]; then
	 cd $_plasmoid_dir
	 if [ $_plasmoid_dir != $srcdir ]; then
	    make_plasmoid
	    cd $srcdir
	 fi
       fi
   fi
done

#Remove conflicting files
rm ${pkgdir}/usr/share/apps/cmake/modules/FindQJSON.cmake
}



make_plasmoid() {
	if [ ! -d build  ]; then
		mkdir build
	fi
	cd build
	cmake -DCMAKE_INSTALL_PREFIX=`kde4-config --prefix` -DCMAKE_BUILD_TYPE=Release ..
	make clean
	make
        make DESTDIR=$pkgdir install
}

