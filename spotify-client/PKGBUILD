# Maintainer: CReimer <c.reimer1993@gmail.com>

pkgname=spotify-client
pkgver=0.8.4.103
_revision=.g9cb177b.260-1
pkgrel=1
pkgdesc="Spotify desktop client"
arch=('x86_64' 'i686')
url="http://www.spotify.com"
license=('custom')
depends=('nss' 'gtk2' 'libxss' 'openssl098' 'qtwebkit' 'gconf' 'libpng12')
conflicts=('spotify-beta' 'spotify')
install='spotify-client.install'
if [ "${CARCH}" = "x86_64" ]; then
  md5sums=('d85ef9a3e612510b8565834df66eb47e')
  _carch=amd64
elif [ "${CARCH}" = "i686" ]; then
  md5sums=('0d87b47e356b308b56399ceabe8bd6c8')
  _carch=i386
fi
source=("http://repository.spotify.com/pool/non-free/s/spotify/${pkgname}_${pkgver}${_revision}_${_carch}.deb")

package() {
  cd $srcdir

  tar -xf data.tar.gz -C "${pkgdir}"

  mkdir -p $pkgdir/usr/lib
  ln -s /usr/lib/libnss3.so "${pkgdir}/usr/lib/libnss3.so.1d"
  ln -s /usr/lib/libnssutil3.so "${pkgdir}/usr/lib/libnssutil3.so.1d"
  ln -s /usr/lib/libsmime3.so "${pkgdir}/usr/lib/libsmime3.so.1d"
  ln -s /usr/lib/libplc4.so "${pkgdir}/usr/lib/libplc4.so.0d"
  ln -s /usr/lib/libnspr4.so "${pkgdir}/usr/lib/libnspr4.so.0d"

  mkdir -p $pkgdir/usr/share/licenses/$pkgname
  mv $pkgdir/usr/share/doc/$pkgname/copyright \
    "${pkgdir}/usr/share/licenses/${pkgname}"
}

