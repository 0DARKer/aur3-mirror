# Contributor: Alexis Robert <alexis.robert@gmail.com>
# Contributor: Paul Archan <paul.archan@gmail.com>

pkgname=repo-git
pkgver=v1.12.2.52.g610d3c4
pkgrel=1
pkgdesc="Tool built on top of git to help manage many git repositories. Part of the Android project."
arch=('any')
url="https://code.google.com/p/git-repo/"
license=('APACHE')
depends=('git' 'python2')
conflicts=('repo')
provides=('repo')

#source=(python2-patch.diff)

source=("git+https://gerrit.googlesource.com/git-repo" "python2.patch")
sha256sums=('SKIP' '389cf97d9de0993838615691a6c9036ce91d0c659378de6d3b8310cdb15d764c')
_gitname="git-repo"

pkgver() {
	cd "$srcdir/$_gitname"
	echo $(git describe --always | sed 's/-/./g')
}

build() {
	cd "$_gitname"
	git apply "$srcdir/python2.patch"
}

package() {
	cd "$_gitname"
	install -D -m 755 repo "$pkgdir/usr/bin/repo"
	install -D -m 644 docs/manifest-format.txt "$pkgdir/usr/share/doc/repo/manifest-format.txt"
}
