#Maintainer: Loren Copeland <thisisquitealongname@gmail.com> 

pkgname=jack2-git
_realname=${pkgname%-git}
pkgver=20120304
pkgrel=2
pkgdesc="Git version of the popular multiprocessor-aware low-latency audio server."
arch=('i686' 'x86_64')
url="http://www.grame.fr/~letz/jackdmp.html"
license=('GPL2')
depends=('python2' 'libsamplerate') 
makedepends=('git')
optdepends=('celt-0.7' 'dbus-core' 'libffado' 'libfreebob' 'python2')
provides=('jack2' 'jack' 'jack-audio-connection-kit')
conflicts=('jack2-svn' 'jack2' 'jackmp' 'tschack' 'tschack-git' 'jack' 'jackd' 'jack-audio-connection-kit')

_gitroot=https://github.com/jackaudio/jack2

build() {
  cd "${srcdir}"

  msg "Connecting to GIT server...."

  if [ -d ${srcdir}/$pkgname ] ; then
    cd $pkgname && git pull origin master
    msg "Local repository updated."
  else
    git clone $_gitroot $pkgname
  fi

  msg "Starting make..."

  rm -rf "${srcdir}/${pkgname}-build"
  cp -r "${srcdir}/${pkgname}" "${srcdir}/${pkgname}-build"
  cd "${srcdir}/${pkgname}-build"

  python2 ./waf configure \
    --prefix=/usr \
    --alsa

  python2 ./waf build
}

package() {
  cd "${srcdir}/${pkgname}-build"

  python2 ./waf --destdir="${pkgdir}" install
}
