# Contributor : Anish Bhatt <anish[removethis][at]gatech[dot]edu>

pkgname=flashplugin-prerelease32
_licensefile='PlatformClients_PC_WWEULA_Combined_20100108_1657.pdf'
pkgver=11.0.1.3
pkgrel=1

pkgdesc='Adobe Flash Player Incubator'
url='http://labs.adobe.com/technologies/flashplatformruntimes/incubator/'
arch=('i686')

source=('http://download.macromedia.com/pub/labs/flashplatformruntimes/incubator/flashplayer_inc_debug_lin_051211.tar.gz'
        "http://www.adobe.com/products/eulas/pdfs/${_licensefile}"
	mms.cfg)
md5sums=('787d67bd22d102df8905a0e212b16060'
         '94ca2aecb409abfe36494d1a7ec7591d'
         'df30781e4c9b789e2d7f6cdbd9f47d6b')

depends=('mozilla-common' 'libxt' 'gtk2' 'nss' 'curl')
optdepends=('libvdpau: GPU acceleration on Nvidia card')
conflicts=('flashplugin')
provides=('flashplayer' 'flashplugin')
license=('custom')
options=(!strip)
backup=(etc/adobe/mms.cfg)

build() {
  pushd ${srcdir}/usr/share/kde4/services
    sed 's/adobe-flash-properties/flash-player-properties/g' kcm_adobe_flash_player.desktop > kcm_adobe_flash_player.desktop.sed
    cat kcm_adobe_flash_player.desktop.sed > kcm_adobe_flash_player.desktop
  popd
}

package() {
  install -D -m755 ${srcdir}/usr/lib/kde4/kcm_adobe_flash_player.so ${pkgdir}/usr/lib/kde4/kcm_adobe_flash_player.so
  install -D -m644 ${srcdir}/usr/share/icons/hicolor/16x16/apps/flash-player-properties.png ${pkgdir}/usr/share/icons/hicolor/16x16/apps/flash-player-properties.png
  install -D -m644 ${srcdir}/usr/share/icons/hicolor/32x32/apps/flash-player-properties.png ${pkgdir}/usr/share/icons/hicolor/32x32/apps/flash-player-properties.png
  install -D -m644 ${srcdir}/usr/share/icons/hicolor/24x24/apps/flash-player-properties.png ${pkgdir}/usr/share/icons/hicolor/24x24/apps/flash-player-properties.png
  install -D -m644 ${srcdir}/usr/share/icons/hicolor/48x48/apps/flash-player-properties.png ${pkgdir}/usr/share/icons/hicolor/48x48/apps/flash-player-properties.png
  install -D -m644 ${srcdir}/usr/share/icons/hicolor/22x22/apps/flash-player-properties.png ${pkgdir}/usr/share/icons/hicolor/22x22/apps/flash-player-properties.png
  install -D -m644 ${srcdir}/usr/share/applications/flash-player-properties.desktop ${pkgdir}/usr/share/applications/flash-player-properties.desktop
  install -D -m644 ${srcdir}/usr/share/kde4/services/kcm_adobe_flash_player.desktop ${pkgdir}/usr/share/kde4/services/kcm_adobe_flash_player.desktop
  install -D -m644 ${srcdir}/usr/bin/flash-player-properties ${pkgdir}/usr/bin/flash-player-properties
  install -D -m755 libflashplayer.so ${pkgdir}/usr/lib/mozilla/plugins/libflashplayer.so
  install -D -m644 ${_licensefile} ${pkgdir}/usr/share/licenses/${pkgname}/${_licensefile}
  install -D -m644 mms.cfg ${pkgdir}/etc/adobe/mms.cfg
}

