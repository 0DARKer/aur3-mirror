# Contributor: Gerhard Brauer <gerbra@archlinux.de>
# Contributor: Richard Murri <admin@richardmurri.com>
pkgname=x2goserver
pkgver=3.0.1_5
_dashes=${pkgver//_/-}
pkgrel=1
pkgdesc="x2go server"
arch=(i686 x86_64)
license=('GPL')
url="http://x2go.berlios.de"
depends=(x2goagent postgresql sshfs)
install=x2goserver.install
source=(http://x2go.obviously-nice.de/deb/pool-lenny/${pkgname}/${pkgname}_${_dashes}.tar.gz
        x2gostartagent.patch
        x2goserver.rc)
conflicts=x2goserver-one
groups=('x2go' 'alts')

build() {
  cd ${startdir}/src/$pkgname-${_dashes%-*}
  patch -Np0 <../x2gostartagent.patch

  install -Dm644 sql ${pkgdir}/etc/x2go/sql
  install -Dm755 x2gocleansessions ${pkgdir}/usr/sbin/x2gocleansessions
  install -Dm755 x2gocmdexitmessage ${pkgdir}/usr/bin/x2gocmdexitmessage
  install -Dm755 x2gocreatebase.sh ${pkgdir}/usr/lib/x2go/x2gocreatebase.sh
  install -Dm755 x2gogetservers ${pkgdir}/usr/bin/x2gogetservers
  install -Dm755 x2golistsessions ${pkgdir}/usr/bin/x2golistsessions
  install -Dm755 x2golistsessions_root ${pkgdir}/usr/bin/x2golistsessions_root
  install -Dm755 x2golistsessions_sql ${pkgdir}/usr/bin/x2golistsessions_sql
  install -Dm755 x2gomountdirs ${pkgdir}/usr/bin/x2gomountdirs
  install -Dm755 x2gopgwrapper ${pkgdir}/usr/bin/x2gopgwrapper
  install -Dm755 x2gopgwrapper_local ${pkgdir}/usr/bin/x2gopgwrapper_local
  install -Dm755 x2gopgwrapper_net ${pkgdir}/usr/bin/x2gopgwrapper_net
  install -Dm755 x2goresume-session ${pkgdir}/usr/bin/x2goresume-session
  install -Dm755 x2goruncommand ${pkgdir}/usr/bin/x2goruncommand
  install -Dm755 x2goshowblocks ${pkgdir}/usr/bin/x2goshowblocks
  install -Dm755 x2gostartagent ${pkgdir}/usr/bin/x2gostartagent
  install -Dm755 x2gosuspend-agent ${pkgdir}/usr/bin/x2gosuspend-agent
  install -Dm755 x2gosuspend-session ${pkgdir}/usr/bin/x2gosuspend-session
  install -Dm755 x2goterminate ${pkgdir}/usr/bin/x2goterminate
  install -Dm755 x2goterminate-session ${pkgdir}/usr/bin/x2goterminate-session
  install -Dm755 x2goumount ${pkgdir}/usr/bin/x2goumount
  install -Dm755 x2goumount_session ${pkgdir}/usr/bin/x2goumount_session
  install -Dm755 ../x2goserver.rc ${pkgdir}/etc/rc.d/x2goserver
}
md5sums=('08f6f00b7043e998113443a57fbd091b'
         '3f4304e2e85941480a7b8eb5496b61bd'
         '4b7ffae496f4727c58237303af9edff1')
