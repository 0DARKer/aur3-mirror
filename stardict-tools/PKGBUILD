# Maintainer: Jaroslav Lichtblau <dragonlord@aur.archlinux.org>

pkgname=stardict-tools
pkgver=3.0.1
pkgrel=5
pkgdesc="Set of tools for managing Stardict dictionaries"
url="http://stardict.sourceforge.net/"
license=('GPL')
arch=('i686' 'x86_64')
depends=('gtk2' 'mysql' 'perl' 'python')
makedepends=('patch')
source=(http://downloads.sourceforge.net/stardict/$pkgname-$pkgver.tar.bz2 \
       $pkgname-fix.diff)
md5sums=('1d78c5da68080368b854278cdf56b8da'
         '3f64cb435fd38c8187e66e396db9b32a')

build() {
  cd ${srcdir}/$pkgname-$pkgver

  patch -Np1 -i ${srcdir}/$pkgname-fix.diff || return 1

  ./configure --prefix=/usr
  make || return 1
  make DESTDIR=${pkgdir} install

  tools="pydict2dic olddic2newdic oxford2dic directory2dic dictd2dic wquick2dic ec50 directory2treedic treedict2dir jdictionary mova xmlinout soothill kanjidic2 powerword kdic 21tech 21shiji buddhist tabfile dsl2dict cedict edict duden stardict_dict_update degb2utf frgb2utf jpgb2utf gmx2utf rucn kingsoft wikipedia babylon stardict2txt stardict_verify"
  extra_exec="hanzim2dict.py jm2stardict.py uyghur2dict.py ncce2stardict.pl parse-oxford.perl dictgen.php"
  extra_noexec="example.ifo example_treedict.tar.bz2"

  instdir=${pkgdir}/usr/share/$pkgname

  cd src

  for i in $tools $extra_exec; do
  install -D -m755 $i $instdir/$i || return 1
  done

  for i in $extra_noexec; do
  install -D -m644 $i $instdir/$i || return 1
  done
}
