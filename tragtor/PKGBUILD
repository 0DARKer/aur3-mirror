# Contributor: Adrian Holfter <aholfter at googlemail dot com>

pkgname=tragtor
pkgver=0.8.27
pkgrel=1
pkgdesc="A graphical user interface for ffmpeg" 
arch=('i686' 'x86_64')
url="http://mein-neues-blog.de/tragtor-gui-for-FFmpeg/" 
license=('GPL')
depends=('python2' 'pygtk>=2.6' 'ffmpeg' 'id3v2') 

#source=(http://mein-neues-blog.de/files/traGtor/${pkgname}-${pkgver}_all.tar.gz)
source=(http://repository.mein-neues-blog.de:9000/archive/${pkgname}-${pkgver}_all.tar.gz)

md5sums=('df8e7dc3c886f0b260e3bc9ff829dd46')


build() { 
	echo Patch traGtor to python2...
	# Patch: Force traGtor to use python2 instead of the new python3 because of compatibility issues
	sed s/python\ /python2\ / usr/bin/tragtor > usr/bin/tragtor.fix || return 1
	cp usr/bin/tragtor.fix usr/bin/tragtor || return 1
	rm usr/bin/tragtor.fix || return 1

	echo Enabling Desktop icon for non-GNOME-DEs..
	sed s/OnlyShowIn=GNOME\;// usr/share/applications/tragtor.desktop > usr/share/applications/tragtor.desktop.fix || return 1
	cp usr/share/applications/tragtor.desktop.fix usr/share/applications/tragtor.desktop || return 1
	rm usr/share/applications/tragtor.desktop.fix || return 1
	
	echo Copying files...
	cp -R $srcdir/usr $pkgdir/usr || return 1
}
