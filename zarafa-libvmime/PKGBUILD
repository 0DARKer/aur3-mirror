# Contributor: yannsen <ynnsen@gmail.com>
pkgname=zarafa-libvmime
pkgver=0.7.1
pkgrel=5
pkgdesc="A powerful C++ class library for working with MIME messages and services like IMAP, POP, or SMTP"
arch=('i686' 'x86_64')
url="http://www.vmime.org/"
license=('GPL')
depends=('gcc-libs')
makedepends=()
provides=('libvmime')
conflicts=('libvmime')
source=(http://developer.zarafa.com/download/libvmime-$pkgver.tar.bz2 \
        http://developer.zarafa.com/download/zarafa-vmime-patches.tar.gz \
	posixChildProcess.hpp.patch)

md5sums=('81f06a771d2de01d5982635838eb5f6a'
         'a92aff3294829f9c270ea05929e619d1'
         'abbabbe8cfca0d35da2f582bb729f506')

build() {
  cd $srcdir/libvmime-$pkgver
  patch -Np2 < ../posixChildProcess.hpp.patch || return 1
  for patch in $srcdir/*.diff
  do
    patch -Np1 < ${patch}
  done
  ./configure --prefix=/usr \
    --enable-sasl \
    --enable-tls \
    --enable-platform-posix \
    --enable-messaging \
    --enable-messaging-proto-pop3 \
    --enable-messaging-proto-smtp \
    --enable-messaging-proto-imap \
    --enable-messaging-proto-maildir \
    --enable-messaging-proto-sendmail || return 1
  make || return 1
  make DESTDIR=$pkgdir install
}
