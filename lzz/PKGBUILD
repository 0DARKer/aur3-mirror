# Maintainer: Caleb Reach <jtxx000@gmail.com>
pkgname=lzz
pkgver=2.8.2
pkgrel=1
pkgdesc="generate header and implementation files from an lzz file"
arch=('i686' 'x86_64')
url="http://www.lazycplusplus.com/"
source=('http://www.lazycplusplus.com/lzz_2_8_2_src.zip' 'http://www.lazycplusplus.com/lzz_2_8_2_src_gen.zip')
license=('GPL')
md5sums=('44a82428901a155687f1300c6110b5a2'
         'ed3ab8b6d9da35df1c7ac2cd9fa5387e')

addinclude() {
  sed -i "1i#include <$1>" "${@:2}"
}

build() {
  cd "$srcdir/$pkgname"*_src/
  . setup_gcc_opt.env
  mkdir gcc.opt
  mv ../gencode gcc.opt

  cd gcc.opt/gencode

  addinclude string.h conf_Config.cpp gram_CharReader.cpp gram_EvalHashIfExpr.cpp util_GetTempDir.cpp util_GetTempFile.cpp
  addinclude stdlib.h gram_EvalHashIfExpr.cpp gram_Prep.cpp util_GetTempFile.cpp
  addinclude stdio.h smtc_File.cpp

  cd ../..

  make || return 1

  install -D gcc.opt/lzz "$pkgdir"/usr/bin/lzz
}
