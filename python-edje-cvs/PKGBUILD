# Contributor: Igor Scabini <furester@gmail.com>

pkgname=python-edje-cvs
pkgver=20080217
pkgrel=1
pkgdesc="E17 Library for python"
arch=(i686 x86_64)
groups=('efl-cvs')
url="http://www.enlightenment.org/"
license=("BSD")
depends=('python>=2.4' 'cython>=0.9.6.8' 'setuptools' 'evas' 'ecore' 'edje' 'e_dbus' 'emotion' 'dbus-python' 'python-evas')
makedepends=('cvs')
conflicts=('python-edje')
provides=('python-edje')
source=()
md5sums=()

_cvsroot=":pserver:anonymous@anoncvs.enlightenment.org:/var/cvs/e"
_cvsmod="e17/proto/python-efl/python-edje"

build() {
  cd $startdir/src
  msg "Connecting to the CVS server...."
  cvs -z3 -d $_cvsroot co -D $pkgver -f $_cvsmod
  cd $_cvsmod
 
  msg "CVS checkout done or server timeout"
  msg "Starting make..."

  cp -R $startdir/src/${_cvsmod%%/*} $startdir/src/${_cvsmod%%/*}-build
  cd $startdir/src/${_cvsmod%%/*}-build
  cd ${_cvsmod#*/}

  mkdir -p $startdir/pkg/usr/lib/python2.5/site-packages/
  python setup.py build_ext --include-dirs /usr/lib/python2.5/site-packages/
  PYTHONPATH=$startdir/pkg/usr/lib/python2.5/site-packages/ \
	python setup.py install --prefix $startdir/pkg/usr

  python setup.py install_headers --install-dir $startdir/pkg/usr/lib/python2.5/site-packages/

  rm $startdir/pkg/usr/lib/python2.5/site-packages/easy-install.pth
  rm $startdir/pkg/usr/lib/python2.5/site-packages/site.*

  rm -fr $startdir/src/${_cvsmod%%/*}-build
}
