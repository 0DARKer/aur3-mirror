# Maintainer: lh <jarryson AT gmail com>

pkgname=fcitx-hg
pkgver=530
pkgrel=1
pkgdesc="Free Chinese Input Toy of X - Input Method Server for X window system (XIM)"
arch=("i686" "x86_64")
license=('GPL')
url="http://code.google.com/p/fcitx"
depends=('pango')
makedepends=('mercurial' 'python2' 'intltool')
conflicts=('fcitx' 'fcitx-utf8-svn' 'fcitx-svn')
replaces=('fcitx')
provides=("fcitx=4.0")
source=('http://fcitx.googlecode.com/files/pinyin.tar.gz'
        'http://fcitx.googlecode.com/files/pinyin.tar.gz.md5'
        'http://fcitx.googlecode.com/files/table.tar.gz'
        'http://fcitx.googlecode.com/files/table.tar.gz.md5')
md5sums=('e9d08c2c069288ae39d453f5aba41e14'
         '0c0d5b8e8056178474b656aeab559715'
         'acb0b112423474ab2c1a22cee590d636'
         '5e5721df10f48f919e3368b3440e3792')
noextract=('pinyin.tar.gz' 'table.tar.gz')

_hgrepo="fcitx"
_hgroot="http://fcitx.googlecode.com/hg"

build() {
  cd $srcdir/

  msg "Creating make environment..."
  
  rm -rf $srcdir/$_hgrepo-build
  cp -r $srcdir/$_hgrepo $srcdir/$_hgrepo-build

  msg "Starting make..."
  cd $srcdir/$_hgrepo-build

  cp $srcdir/pinyin.tar.gz{,.md5} data/
  cp $srcdir/table.tar.gz{,.md5} data/table/

  ./autogen.sh
  ./configure --prefix=/usr --disable-debug --enable-pango --enable-tray
  make
}
package(){
  cd $srcdir/$_hgrepo-build
  make DESTDIR=$pkgdir install
}

