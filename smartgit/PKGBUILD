#Maintainer: Alexey Stukalov <astukalov@gmail.com>
#forked from smartgit AUR package, maintainer Rene Peinthor
pkgname=smartgit
pkgver=2.1
_pkgver=2_1
pkgrel=1
pkgdesc="A Git GUI client written in Java"
arch=("any")
url="http://www.syntevo.com/smartgit/index.html"
license=('custom')
depends=("java-runtime" "desktop-file-utils" "sh")
makedepends=("python>=3")
provides=(smartgit=$pkgver)
source=(smartgit.desktop downloader.py)
install="smartgit.install"
md5sums=('1d4bb1a70a3c6a6d04fe938beb28808b'
         'abf1fe0a54b0d0370cc99350063f83ce')
smartgitmd5sum='32ce8732e0d59991c469a4049c1bef81'


extracted="$pkgname-$_pkgver"

build() {
	cd "$srcdir"
	python3 downloader.py smartgit smartgit-generic-${_pkgver}.tar.gz

	echo "${smartgitmd5sum} *smartgit-generic-${_pkgver}.tar.gz" | md5sum -c || (error "md5sum doesn't match" && return 1)

	tar xzf smartgit-generic-${_pkgver}.tar.gz
}

package() {
	cd "$srcdir"

	install -D -m644 "${extracted}"/license.html "${pkgdir}/usr/share/licenses/${pkgname}/license.html"
	mkdir -p "${pkgdir}"/opt
	mv "${extracted}" ${pkgdir}/opt/$pkgname || return 1

	install -D -m644 smartgit.desktop "${pkgdir}"/usr/share/applications/smartgit.desktop
}
