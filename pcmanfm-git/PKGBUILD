# Maintainer: TDY <tdy@gmx.com>

pkgname=pcmanfm-git
pkgver=20130417_1.1.0_12_g0558b6a
pkgrel=1
pkgdesc="An extremely fast, lightweight, yet feature-rich file manager with tabbed browsing"
arch=('i686' 'x86_64')
url="http://pcmanfm.sourceforge.net/"
license=('GPL')
depends=('libfm-git')
makedepends=('git' 'intltool' 'pkg-config')
optdepends=('gvfs: mounting of local and remote drives'
            'gnome-menus: applications menu and "Open with..." dialog')
provides=('pcmanfm')
conflicts=('pcmanfm')
install=pcmanfm.install
source=(git://pcmanfm.git.sourceforge.net/gitroot/pcmanfm/pcmanfm
        automake-version.patch
        obsolete-macro.patch)
md5sums=('SKIP'
         '484c8f3600ac91c9200897db6a392573'
         '878b557f247da501bf6c94f40f0dae25')

_gitname=pcmanfm

pkgver() {
    cd "$srcdir/$_gitname"

    echo "$(LANG=C date '+%Y%m%d')_$(git describe --always | sed 's/-/_/g')"
}

build() {
  cd "${srcdir}/${_gitname}"

  msg "Applying patches..."
  git apply ../automake-version.patch
  git apply ../obsolete-macro.patch
    
  msg "Starting make..."
  ./autogen.sh
  ./configure --prefix=/usr --sysconfdir=/etc
  make LDFLAGS="-lm ${LDFLAGS}"
}

package() {
  cd "${srcdir}/${_gitname}"
  make DESTDIR="${pkgdir}" install
}
