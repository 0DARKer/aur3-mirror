# Contributor: Rene Wiermer <rwiermer@googlemail.com>
# Contributor: Eric Forgeot < http://anamnese.online.fr >

pkgname=qtads
arch=('i686' 'x86_64')
pkgver=2.1.1
pkgrel=1
pkgdesc="A Qt-based interpreter for TADS text adventures. Support TADS 2 and 3, both for text-only and multimedia adventures."
url="http://qtads.sourceforge.net/"
license=('GPL')
depends=('qt' 'sdl_sound')
source=(http://downloads.sourceforge.net/sourceforge/qtads/$pkgname-$pkgver.tar.bz2)
md5sums=('352473247ed0768429930cfc3648abbf')

build() {
cd $srcdir/$pkgname-$pkgver

qmake CXXFLAGS="-fno-strict-aliasing" BIN_INSTALL=/usr/bin DOC_INSTALL=/usr/share/doc DATA_INSTALL=/usr/share || return 1

make || return 1
#make INSTALL_ROOT=$startdir/pkg/ install
}


package() {

mkdir -p $pkgdir/usr/share/qtads/doc
mkdir -p $pkgdir/usr/bin/


cp $srcdir/$pkgname-$pkgver/AUTHORS $pkgdir/usr/share/qtads/doc
cp $srcdir/$pkgname-$pkgver/BUGS $pkgdir/usr/share/qtads/doc
cp $srcdir/$pkgname-$pkgver/COPYING $pkgdir/usr/share/qtads/doc
#cp $srcdir/$pkgname-$pkgver/CREDITS $pkgdir/usr/share/qtads/doc
cp $srcdir/$pkgname-$pkgver/HTML_TADS_LICENSE $pkgdir/usr/share/qtads/doc
cp $srcdir/$pkgname-$pkgver/INSTALL $pkgdir/usr/share/qtads/doc
cp $srcdir/$pkgname-$pkgver/NEWS $pkgdir/usr/share/qtads/doc
#cp $srcdir/$pkgname-$pkgver/QTADS_LICENSE_NOTE $pkgdir/usr/share/qtads/doc
cp $srcdir/$pkgname-$pkgver/README $pkgdir/usr/share/qtads/doc
#cp $srcdir/$pkgname-$pkgver/SOURCE_README $pkgdir/usr/share/qtads/doc


cp $srcdir/$pkgname-$pkgver/qtads $pkgdir/usr/bin/

	#desktop icons
	mkdir -p $pkgdir/usr/share/pixmaps
	mkdir -p $pkgdir/usr/share/applications
	cp $srcdir/$pkgname-$pkgver/$pkgname-logo.png $pkgdir/usr/share/pixmaps/$pkgname.png
	
	install -D -m644 $srcdir/../$pkgname.desktop $pkgdir/usr/share/applications/$pkgname.desktop
}
