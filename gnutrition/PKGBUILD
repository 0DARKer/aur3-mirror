# Maintainer: Brandon Invergo <brandon@brandoninvergo.com>
pkgname=gnutrition
pkgver=0.31.1
pkgrel=1
pkgdesc="Free nutrition analysis software"
arch=('any')
url="https://www.gnu.org/software/gnutrition/"
license=('GPL3')
groups=()
depends=('python2' 'pygtk' 'mysql-python' 'sgmltools-lite' 'mysql')
makedepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=$pkgname.install
source=(http://ftp.gnu.org/gnu/$pkgname/$pkgname-$pkgver.tar.gz)
noextract=()
md5sums=('d698911d7873e3526c996836a57a94bc') 

build() {
  cd "$srcdir/$pkgname-$pkgver"

  sed -i '45,46s_${prefix}/gnome/apps/Applications/_${datarootdir}/applications/_' Makefile.in 
  # db2html seems to be deprecated; I can't find it in any Arch package
  # but sgmltools handles the same functionality
  sed -i '40s/db2html/sgmltools/' doc/Makefile.in 
  sed -i '1s/python/python2/' run-gnutrition.py.in 

  ./configure prefix=/usr PYTHON=/usr/bin/python2
  make prefix=/usr PYTHON=/usr/bin/python2
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make prefix="$pkgdir/usr" PYTHON=/usr/bin/python2 install
}

# vim:set ts=2 sw=2 et:
