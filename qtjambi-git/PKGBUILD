
pkgname=qtjambi-git
pkgver=20110929
pkgrel=1

arch=( 'i686' 'x86_64')

pkgdesc="Java bindings for the Qt C++ toolkit."
url='http://qt-jambi.org/'
license=('GPL')

source=('buildpath.patch')
md5sums=('70bb602291edcb8a22087e2631e8cee0')

depends=( 'qt>=4.7.4' 'java-environment>=6' )
makedepends=('phonon' 'wget' 'apache-ant')
conflicts=('qtjambi')
provides=('qtjambi')

build() {

	cd "${srcdir}"
	
	#download latest source tarball
	if [ -f "master" ];then
	rm master
	fi
	wget http://qt.gitorious.org/qt-jambi/qtjambi-community/archive-tarball/master
	tar -xf master
	cd qt-jambi-qtjambi-community

	#patch buildpath.properties
	patch -p0 -i $srcdir/buildpath.patch
	
	#build
	ant all

	# Install qtjambi
	mkdir -p $pkgdir/usr/share/java/
	install -Dm644 qtjambi-*.jar $pkgdir/usr/share/java/
	# Install qtjambi-jni
	mkdir -p $pkgdir/usr/lib/jni/
	install -Dm644 build/platform-output/lib/libcom_trolltech_qt_* build/platform-output/lib/libqtjambi.so $pkgdir/usr/lib/jni/
	# Install qtjambi-designer
	mkdir -p $pkgdir/usr/lib/qt/plugins/designer/
	install -Dm644 build/platform-output/plugins/designer/*.so $pkgdir/usr/lib/qt/plugins/designer/

}
