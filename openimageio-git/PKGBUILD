# Contributor: N30N <archlinux@alunamation.com>

pkgname="openimageio-git"
pkgver=20110521
pkgrel=1
pkgdesc="A library for reading and writing images, and a bunch of related classes, utilities, and applications."
url="http://www.openimageio.org"
license=("BSD")
arch=("i686" "x86_64")
provides=("openimageio")
depends=("boost-libs" "glew" "openexr" "jasper" "libjpeg" "libpng" "libtiff")
optdepends=("qt: iv image viewer" "pytho2n: for said bindings")
makedepends=("git" "cmake" "boost" "intel-tbb" "qt" "python2") #"gtest"
source=()
md5sums=()

_gitroot="git://github.com/OpenImageIO/oiio.git"
_gitname="oiio"

build() {
	msg "Connecting to the GIT server..."
	if [ -d "${_gitname}" ]; then
		(cd "${_gitname}" && git pull origin)
		rm -rf build
	else
		git clone "$_gitroot"
	fi

	cp -rf "${_gitname}" build
	cd build
	make \
		USE_PYTHON=1 \
		dist_dir="dist"
}

package() {
	cd "build/dist"
	install -d "${pkgdir}/usr/bin" \
		"${pkgdir}/usr/lib" \
		"${pkgdir}/usr/lib/python2.7/site-packages"
	install -m755 bin/* "${pkgdir}/usr/bin"
	install -m755 lib/libOpenImageIO.so "${pkgdir}/usr/lib"
	install -m755 python/OpenImageIO.so \
		"${pkgdir}/usr/lib/python2.7/site-packages"
	install -Dm644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
	find include ! -type d -exec \
		install -Dm644 "{}" "${pkgdir}/usr/{}" \;
	cd doc
	find * ! -type d -exec \
		install -Dm644 "{}" "${pkgdir}/usr/share/doc/${pkgname}/{}" \;
}

# vim: set noet ff=unix:
