# Package build for the linux oDesk Team client
# Maintainer: der_FeniX <derfenix dot gmail.com>
# Contributor: Stephen Weinberg <[firstname]@q5comm.com>

CARCH=`uname -m`

pkgname=odeskteam
pkgver=3.2.59
pkgrel=5
pkgdesc="The oDesk Team client for odesk.com"
arch=('i586' 'i686' 'x86_64')
provides=('godesk')
replaces=('godesk')
conflicts=('godesk')
url="http://www.odesk.com/downloads"
license=('custom:ODESK TEAM LICENSE AGREEMENT')
depends=('libxss' 'gstreamer0.10-base' 'libnotify' 'qt4')

if test "$CARCH" = i686; then
	source=("https://www.odesk.com/downloads/linux/odeskteam_${pkgver}_ubuntu_12.04_i386.deb" "odeskteam.desktop")
	md5sums=('654b2c2c2ebdf5c06df4a8d47a2006f8' 'd5d155a48fb90db78096e1f74a618e78')
fi

if test "$CARCH" = x86_64; then
	source=("https://www.odesk.com/downloads/linux/odeskteam_${pkgver}_ubuntu_12.04_amd64.deb" "odeskteam.desktop")
	md5sums=('ab2f2fe1ff67818acd3aec0ef925c438' 'd5d155a48fb90db78096e1f74a618e78')
fi

prepare() {
	cd "$srcdir"
	tar -zxf "$srcdir/data.tar.gz"
}

package() {
	cd $srcdir
	mkdir $pkgdir/usr
	cp -R $srcdir/usr/* $pkgdir/usr/
	# Move licence to licences dir
	mkdir -p $pkgdir/usr/share/licenses/$pkgname
	zcat "$srcdir/usr/share/doc/odeskteam/COPYING.gz" > "$pkgdir/usr/share/licenses/$pkgname/COPYING"

	# Install .desktop file
	install -D -m 644 "../odeskteam.desktop" "$pkgdir/usr/share/applications/odeskteam.desktop"
}
