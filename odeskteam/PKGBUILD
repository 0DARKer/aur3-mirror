# Package build for the linux oDesk Team client
# Maintainer: der_FeniX <derfenix dot gmail.com>
# Contributor: Stephen Weinberg <[firstname]@q5comm.com>

CARCH=`uname -m`

pkgname=odeskteam
pkgver=3.2.59
pkgrel=3
pkgdesc="The oDesk Team client for odesk.com"
arch=('i586' 'i686' 'x86_64')
provides=('godesk')
replaces=('godesk')
conflicts=('godesk')
url="http://www.odesk.com/downloads"
license=('custom:ODESK TEAM LICENSE AGREEMENT')
makedepends=('rpmextract')
depends=('qt4')

if [[ $CARCH == 'x86_64' ]]
then
	source=("https://www.odesk.com/downloads/linux/odeskteam-3.2.59-opensuse_12.1.x86_64.rpm"
	"odeskteam.desktop")
	md5sums=('230c5fa714c9b16bfac794b1468fdfec'
        	 'd5d155a48fb90db78096e1f74a618e78')
else
	source=("https://www.odesk.com/downloads/linux/odeskteam-3.2.59-opensuse_12.1.i586.rpm"
	"odeskteam.desktop")
	md5sums=('a616c0ba2ab8ff149b89d5e70860eadc'
	         'd5d155a48fb90db78096e1f74a618e78')
fi

build() {
	if [[ $CARCH == 'x86_64' ]]
then
	rpmextract.sh odeskteam-3.2.59-opensuse_12.1.x86_64.rpm
else
	rpmextract.sh odeskteam-3.2.59-opensuse_12.1.i586.rpm
fi
}

package() {
	cd $srcdir
	mkdir $pkgdir/usr
	cp -R $srcdir/usr/* $pkgdir/usr/
	# Move licence to licences dir
	#mkdir -p $pkgdir/usr/share/licenses/$pkgname
	#mv "$srcdir/usr/share/odeskteam/COPYING" "$pkgdir/usr/share/licenses/$pkgname/COPYING"

	# Install .desktop file
	install -D -m 644 "$srcdir/odeskteam.desktop" "$pkgdir/usr/share/applications/odeskteam.desktop"
}
