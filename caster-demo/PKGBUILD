# Contributor: jose <jose1711 [at] gmail (dot) com>

pkgname=caster-demo
pkgver=1.1
pkgrel=3
pkgdesc="an intense 3rd person action shooter with massive terrain deformation and explosive attacks (demo version)"
arch=('i686')
url="http://elecorn.com/caster3d/"
license="custom:free_demo"
install="caster-demo.install"
source=('http://www.elecorn.com/caster3d/data/caster_linux_demo_1.1.bin' 'caster-demo.desktop')
noextract=('caster_linux_demo_1.1.bin')
md5sums=('36c331695ab71fc2c0d5c20ffe5d2aae'
         '844c2728d0a31959876bbde3dbb4d151')
makedepends=('wget' 'unzip')
depends=('libx11' 'libpng12')

build() {
  mkdir -p $pkgdir/usr/{share/caster-demo,bin}
  cd $srcdir/
  /bin/dd if=caster_linux_demo_1.1.bin of=caster-demo.zip bs=49169 skip=4
  /usr/bin/unzip caster-demo.zip data/caster_linux_demo/*
  cd data/caster_linux_demo
  /bin/tar cf - * | ( cd ../../../pkg/usr/share/caster-demo/; tar xfp - )
(echo "#!/bin/bash
cd /usr/share/caster-demo
./caster-demo.bin \"\$@\"") > $pkgdir/usr/bin/caster-demo
  chmod 755 $pkgdir/usr/bin/caster-demo
  install -D -m644 caster_icon.png $pkgdir/usr/share/pixmaps/caster_icon.png && \
  install -D -m644 $srcdir/caster-demo.desktop $pkgdir/usr/share/applications/caster-demo.desktop || return 1
}
