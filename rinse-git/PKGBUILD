_pkgname=rinse
pkgver=
pkgname=$_pkgname-git
pkgrel=1
pkgdesc="Rinse is a simple tool which is designed to carry out the installation of a new RPM-based distribution."
arch=('i686' 'x86_64')
url="git://anonscm.debian.org/git/collab-maint/rinse.git"
groups=()
depends=()
makedepends=('git' 'dpkg' 'perl')
optdepends=()
licence='GPL, PerlArtistic'
provides=('rinse')
conflicts=('rinse')
source=(git://anonscm.debian.org/git/collab-maint/rinse.git)
noextract=()
md5sums=('SKIP')

_gitroot=git://anonscm.debian.org/git/collab-maint/rinse.git
_gitname=${_pkgname%-git}

pkgver() {
    cd $_pkgname
    git describe --long --tags | sed -r 's/([^-]*-g)/r\1/;s/-/./g'
}

build() {
    cd "$srcdir"
    msg "Connecting to GIT server...."
    if [ -z -d $_gitname ] ; then
        git clone --depth=1 $_gitroot $_gitname
    fi

    cd $_gitname && git fetch --tags
    msg "The local files are updated."
    git checkout $(git describe --tags $(git rev-list --tags --max-count=1))
    msg "GIT checkout done or server timeout"
}

package() {
    cd "$srcdir/$_gitname"
    make DESTDIR="$pkgdir/" install
}
