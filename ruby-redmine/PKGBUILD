# Maintainer: Blaž Tomažič <blaz.tomazic@gmail.com>
pkgname=ruby-redmine
pkgver=1.1.3
pkgrel=2
_realname="redmine"
pkgdesc="Redmine is a flexible project management web application written using Ruby on Rails framework."
arch=('i686' 'x86_64')
url="http://www.redmine.org/"
license=('GPL2')
depends=('ruby1.8' 'ruby1.8-rack-v1.0.1' 'rubygems1.8' 'ruby1.8-rake>=0.8.3' 'procps' 'ruby1.8-i18n-v0.4.2')
makedepends=('glibc')
optdepends=('ruby1.8-rmagick' 'mysql-ruby1.8' 'subversion>=1.3.0' 'git' 'darcs' 'bzr' 'mercurial')
options=()
install=ruby-redmine.install
_rubyforge=74722
source=("http://rubyforge.org/frs/download.php/$_rubyforge/$_realname-$pkgver.tar.gz"
        "redmine.rc"
        "redmine.service")
md5sums=('f2b6bf4c990a86547c269aa5641b89c7'
         '24e8c41b7c8a3017d70a5dc6cd3d9180'
         'fee6a89c33a0c912e856aa6a92e140c7')

build() {
  return 0
}

package() {
  cd "$srcdir/$_realname-$pkgver"
  
  #install in /var/lib
  _instdir="$pkgdir/var/lib/$_realname"
  mkdir -p ${_instdir}
  cp -ra . ${_instdir}
  
  #create some needed dir
  mkdir -p "${_instdir}/public/plugin_assets"
  
  #create /etc/rc.d/redmine
  mkdir -p "$pkgdir/etc/rc.d/"
  install -m 755 "$srcdir/redmine.rc" "$pkgdir/etc/rc.d/redmine"
  
  #create systemd service
  mkdir -p "$pkgdir/lib/systemd/system/"
  install -m 644 "$srcdir/redmine.service" "$pkgdir/lib/systemd/system/"
  
  #create redmine user home
  mkdir -p "${_instdir}/redmine/"
}

# vim:set ts=2 sw=2 et:
