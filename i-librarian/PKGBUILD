#Maintainer:Kwrazi<kwrazi@gmail.com>

# Bug: can't use comma in pkgname
pkgname="i-librarian"
pkgver=2.10
pkgrel=3 # i-librarian developers patched code without updating version number
pkgdesc="Academic software for managing research papers (web client)"
arch=('any')
url="http://www.bioinformatics.org/librarian/index.php"
license=('GPL3')
depends=('php-apache' 
         'php-sqlite' 
         'php-gd' 'poppler' 
         'bibutils' 
         'ghostscript' 
         'pdftk')
backup=("etc/webapps/${pkgname}/.htaccess")
install=${pkgname}.install
source=("http://bioinformatics.org/librarian/I,-Librarian-$pkgver-Linux.tar.gz"
        "apache.example.conf")
md5sums=('740c3f11989a53a2e8930826654e69d3'
         '72233aac7f7dc66a0a25bcb0c44d0498')

package() {
	_instdir=/usr/share/webapps/${pkgname}
	_etcdir=/etc/webapps/${pkgname}
	
	mkdir -p ${pkgdir}/${_instdir} ${pkgdir}/${_etcdir}
	
	cd ${pkgdir}/${_instdir}
	cp -ra ${srcdir}/* .
	mv library/.htaccess ${pkgdir}/${_etcdir}
	ln -s /etc/webapps/${pkgname}/.htaccess library/.htaccess
	
    install -Dm644 ${srcdir}/apache.example.conf ${pkgdir}/${_etcdir}/apache.example.conf

	rm ${pkgdir}/${_instdir}/*-Linux.tar.gz
    rm ${pkgdir}/${_instdir}/apache.example.conf
}
