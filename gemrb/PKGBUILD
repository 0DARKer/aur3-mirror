# Maintainer: Lukas Jirkovsky <l.jirkovsky@gmail.com>
pkgname=gemrb
pkgver=0.6.4
pkgrel=2
pkgdesc="OSS implementation of Bioware's Infinity Engine which supports eg. Baldur's Gate"
arch=('i686' 'x86_64')
url="http://gemrb.sourceforge.net/"
license=('GPL')
depends=('python2' 'openal' 'libpng' 'sdl_mixer')
makedepends=('cmake')
install=gemrb.install
options=(!libtool)
source=(http://downloads.sourceforge.net/sourceforge/gemrb/$pkgname-$pkgver.tar.gz \
        gcc4.6-fix.diff)
md5sums=('ab713b8174e5880db5f934ebb1f6aeee'
         '265b0905e43876e37171a218b1d3d617')

build() {
  cd "$srcdir"

  # fix build with gcc 4.6
  cd $pkgname-$pkgver
  patch -Np1 < ../gcc4.6-fix.diff
  cd "$srcdir"

  mkdir build || true
  cd build
  cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr ../$pkgname-$pkgver
  make
}

package() {
  cd "$srcdir"/build
  make DESTDIR="$pkgdir" install
}
