#Maintainer: float <flo.at at gmx dot de>

pkgname=s25rttr
pkgver=0.8
build=8596
pkgrel=2
pkgdesc="Return to the Roots. A free clone of The Settlers II from 1996"
arch=('i686' 'x86_64')
url="http://www.siedler25.org/"
license=('GPL3')
depends=(sdl sdl_mixer miniupnpc)
source=($pkgname.sh $pkgname.desktop $pkgname.xpm)
md5sums=('cbea91c8b7d43446f9334c8a06094bec'
         '8c486f63efb1c9bec6d50306270f1b4c'
         'a7bf0908aac3dbfaed837c19695ca362')
         
if [[ $CARCH == 'i686' ]]; then
  source+=("http://www.siedler25.org/uploads/stable/$pkgver/${pkgname}_${pkgver}-${build}_linux.i386.tar.bz2")
  md5sums+=('8e46196f8d765116b8b670b4ec7da777')
elif [[ $CARCH == 'x86_64' ]]; then
  source+=("http://www.siedler25.org/uploads/stable/$pkgver/${pkgname}_${pkgver}-${build}_linux.x86_64.tar.bz2")
  md5sums+=('ff61ad00aa3c3070c672aae213d8c02e')
fi

build() {
  install -d -m755 "$pkgdir"/usr/share/
  cp -ra "$srcdir"/"$pkgname"_"$pkgver"/share/* "$pkgdir"/usr/share/
  find "$pkgdir"/usr/ -type d -exec chmod 755 "{}" \;
  find "$pkgdir"/usr/ -type f -exec chmod 644 "{}" \;
  
  install -Dm755 "$srcdir"/"$pkgname".xpm "$pkgdir"/usr/share/pixmaps/"$pkgname".xpm
  install -Dm755 "$srcdir"/"$pkgname".desktop "$pkgdir"/usr/share/applications/"$pkgname".desktop
  install -Dm755 "$srcdir"/"$pkgname".sh "$pkgdir"/usr/bin/"$pkgname"
  install -Dm755 "$srcdir"/"$pkgname"_"$pkgver"/bin/s25client "$pkgdir"/usr/bin/s25client

  return 0
}
