# Maintainer: Sergei Lebedev <superbobry@gmail.com>
# Contributor : Nicolas Pouillard <nicolas(dot)pouillard(at)gmail(dot)com>
# Contributor: Sylvester Johansson <scj(at)archlinux(dot)us>
pkgname=ocaml-type-conv
pkgver=3.0.4
pkgrel=1
pkgdesc="mini library with common code-generation helpers for OCaml"
arch=('i686' 'x86_64')
url="https://forge.ocamlcore.org/projects/type-conv"
license=('LGPL')
depends=('ocaml')
makedepends=('ocaml-findlib')
source=(https://forge.ocamlcore.org/frs/download.php/697/${pkgname/ocaml-/}-$pkgver.tar.gz)
md5sums=('3dbc1b4d339911fcc07880fefc91617e')
options=(!strip !makeflags)

build() {
  cd "$srcdir/${pkgname/ocaml-/}-$pkgver"

  ocaml setup.ml -configure --prefix /usr --destdir ${pkgdir} || return 1
  ocaml setup.ml -build || return 1
}

package(){
  cd "$srcdir/${pkgname/ocaml-/}-$pkgver"

  OCAMLFIND_DESTDIR=${pkgdir}$(ocamlfind printconf destdir)
  mkdir -p $OCAMLFIND_DESTDIR
  OCAMLFIND_DESTDIR=$OCAMLFIND_DESTDIR ocaml setup.ml -install
}
