# This is an example PKGBUILD file. Use this as a start to creating your own,
# and remove these comments. For more information, see 'man PKGBUILD'.
# NOTE: Please fill out the license field for your package! If it is unknown,
# then please put 'unknown'.

# Maintainer: Mike Dacre <mike.dacre@gmail.com
pkgname=picard-tools
pkgver=1.117
pkgrel=1
pkgdesc="A Java-based command-line utilities that manipulate SAM files, and a Java API (HTSJDK) for creating new programs that read and write SAM files"
arch=('x86_64')
depends=('jre7-openjdk-headless')
url="http://picard.sourceforge.net/"
license=('GPL')
source=('http://sourceforge.net/projects/picard/files/picard-tools/1.117/picard-tools-1.117.zip')
md5sums=('ce0c5146bcac59a847c54559dc0d1248')

package() {
  mkdir -p "$pkgdir/usr/bin"
  mkdir -p "$pkgdir/usr/share/java"
  mkdir -p "$pkgdir/usr/lib"
  cp -r "$srcdir/$pkgname-$pkgver" "$pkgdir/usr/share/java/picard-tools"
  mv "$pkgdir/usr/share/java/picard-tools/libIntelDeflater.so" "$pkgdir/usr/lib/"
  cd "$pkgdir/usr/share/java/picard-tools/"
  ln -s "../../../lib/libIntelDeflater.so" .
  cd "$pkgdir/usr/bin"
  for i in $srcdir/$pkgname-$pkgver/*.jar; do
    i=`echo $i | sed 's/.*\///g'`;
    j=`echo $i | sed 's/.jar//g'`;
    j=${j,,};
    echo "#! /bin/sh
\"\$JAVA_HOME/bin/java\" -Xmx1000m -jar '/usr/share/java/picard-tools/$i' \"\$@\"
" > $j;
  done
  rm "$pkgdir/usr/bin/picard-1.117"
  rm "$pkgdir/usr/bin/htsjdk-1.117"
  chmod +x $pkgdir/usr/bin/*
}
