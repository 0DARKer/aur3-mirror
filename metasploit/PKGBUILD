# Maintainer: Sabart Otto - Seberm <seberm[at]gmail[dot]com>

pkgname=metasploit
pkgver=4.1.0
pkgrel=1
pkgdesc="An advanced open-source platform for developing, testing, and using exploit code"
depends=('ruby' 'libpcap')
optdepends=('java-runtime' 'dradis') #sqlite
provides=('metasploit')
conflicts=('metasploit-svn')
options=('!strip')
makedepends=('subversion')
source=(http://updates.metasploit.com/data/releases/framework-${pkgver}.tar.bz2 metasploit.sh)
url="http://www.metasploit.com/"
license=('BSD')
arch=('i686' 'x86_64')
    
md5sums=('13a2f96ca8bcdab260f6f6114c085555'
         '912c21a795ac6116a8c13bee876ddf99')


build() {
	cd $srcdir/msf

	echo "Installing the license file..."
	mkdir -p $pkgdir/opt $pkgdir/etc/profile.d $pkgdir/usr/share/licenses/$pkgname
	install -m444 "README" "$pkgdir/usr/share/licenses/${pkgname}/LICENSE"

	mv $srcdir/msf $pkgdir/opt/$pkgname
	cp $startdir/metasploit.sh $pkgdir/etc/profile.d

	chmod 755 $pkgdir/etc/profile.d/metasploit.sh


	# Removes all .svn directories
	echo "Removing all .svn directories..."
	find $pkgdir/opt/$pkgname -name ".svn" -type d -exec rm -fr {} +
} 
