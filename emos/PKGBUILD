# Contributor: Graziano Giuliani <graziano.giuliani@poste.it>
pkgname=emos
pkgver=000382
pkgrel=1
pkgdesc="ECMWF Interpolation Library"
arch=(i686 x86_64)
url="http://www.ecmwf.int/products/data/software/interpolation.html"
license=('GPL3')
groups=(science)
makedepends=(rsync)
source=(http://www.ecmwf.int/products/data/software/download/software_files/${pkgname}_$pkgver.tar.gz answers.txt)
md5sums=('cfca587da4dda8b615dfdc3d0fdac080'
         'b61aea139c0f95e132aa234c02503fb1')

build() {
  cd "$startdir/src/${pkgname}_$pkgver"
  cat $startdir/src/answers.txt | ./build_library

  ls bufrtables/*000* > .list/bufrtables
  mkdir -p $startdir/pkg/usr/lib
  mkdir -p $startdir/pkg/usr/share/emos

  INSTALL_DIR=$startdir/pkg/usr/lib
  install -m 644 libemos$R64.a $startdir/pkg/usr/lib/libemos.a
  for d in gribtables bufrtables crextables land_sea_mask gribtemplates ; do
    mkdir -p $startdir/pkg/usr/share/emos/$d
    find $d -type d -exec mkdir -p $startdir/pkg/usr/share/emos/{} \;
    for i in `cat .list/$d` ; do
      rsync -a $i $startdir/pkg/usr/share/emos/$i
    done
  done
}

# vim:set ts=2 sw=2 et:
