# Contributor: Andre Klitzing <andre () incubo () de>
pkgname=mingw32-pcre
pkgver=8.30
pkgrel=5
pkgdesc="A library that implements Perl 5-style regular expressions (mingw32)"
arch=('any')
depends=(mingw32-zlib mingw32-bzlib-static)
url="http://pcre.sourceforge.net"
license=('custom')
options=(!strip !buildflags !libtool)
makedepends=('mingw32-gcc' 'mingw32-binutils' 'mingw32-w32api')
source=(ftp://ftp.csx.cam.ac.uk/pub/software/programming/pcre/pcre-$pkgver.tar.bz2)
md5sums=('98e8928cccc945d04279581e778fbdff')

build() {
  cd "$srcdir/pcre-$pkgver"

  ./configure --prefix=/usr/i486-mingw32 --build=$CHOST --host=i486-mingw32 \
  --enable-unicode-properties --enable-jit --enable-utf --enable-pcre16 \
  --enable-pcregrep-libz --enable-pcregrep-libbz2 || return 1
  make || return 1
  make DESTDIR="$pkgdir" install
  i486-mingw32-strip $pkgdir/usr/i486-mingw32/bin/*.exe
  i486-mingw32-strip -x $pkgdir/usr/i486-mingw32/bin/*.dll
  i486-mingw32-strip -g $pkgdir/usr/i486-mingw32/lib/*.a
  rm -rf $pkgdir/usr/i486-mingw32/share
}
