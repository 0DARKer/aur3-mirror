# Contributor: Lokaltog <kimmern@lokaltog.net>

packager="slaveriq <arch@plassmann.biz>"
pkgname=wimp-no
pkgver=1.5.9
license='custom'
pkgrel=1
arch=('i686' 'x86_64')
pkgdesc="Adobe Air based streaming client for the Telenor Wimp service. Norwegian version, english language available."
url=('http://getwimp.com')
source=("http://getwimp.com/resources/swf/web3/wimp_aspiro_com/getwimp/Wimp-${pkgver}.air"
        'WiMP.desktop')
md5sums=('67d43159ca9ef7cd276c722fd5397cc6'
         '17d42e980e7f37e6bbf9eb39e304e1ef')
depends=('adobe-air-sdk'
         'unzip')

# Add lib32 dependencies for x86_64
if [ "${CARCH}" = 'x86_64' ]; then
	depends=($depends
	         'lib32-gtk2'
	         'lib32-nss'
	         'lib32-alsa-lib')
fi

build() {
	cd $srcdir

	mkdir $pkgdir/opt/
	mkdir $pkgdir/opt/airapps
	mkdir $pkgdir/usr/
	mkdir $pkgdir/usr/bin

	mv $srcdir/Wimp-$pkgver.air  $pkgdir/opt/airapps/wimp.air

	mkdir $pkgdir/opt/airapps/wimp

	cd $pkgdir/opt/airapps/wimp

	unzip ../wimp.air

	echo "#!/bin/sh" >> $pkgdir/usr/bin/wimp
	echo "/opt/adobe-air-sdk/bin/adl -nodebug /opt/airapps/wimp/META-INF/AIR/application.xml /opt/airapps/wimp/" >> $pkgdir/usr/bin/wimp

	chmod +x $pkgdir/usr/bin/wimp
}
