# Maintainer: Tianjiao Yin <ytj000+aur@gmail.com>

_plugin_name=new-tong-wen-tang
_plugin_version=0.4.0.9.1
_plugin_id=6113
pkgdesc="Plugin for firefox. A tool to switch display Chinese content between traditional and simplified glyphs."
license=('unknown')
emid={22870005-adef-4c9d-ae36-d0e1f2f27e5a}

pkgname=firefox-extension-$_plugin_name
pkgver=$_plugin_version
pkgrel=5
arch=('any')
url="https://addons.mozilla.org/firefox/addon/$_plugin_id"
depends=("firefox")

build() {
  _ffver=`pacman -Q firefox | cut -f2 -d\ | cut -f1-2 -d.`
  depends=("firefox>=${_ffver}" "firefox<=${_ffver/0/99}")

  cd $srcdir
  rm * -rf
  wget https://addons.mozilla.org/firefox/downloads/latest/$_plugin_id/addon-$_plugin_id-latest.xpi
  bsdtar -xf addon-$_plugin_id-latest.xpi
  local dstdir=$pkgdir/usr/lib/firefox-$_ffver/extensions/${emid}
  install -d $dstdir
  sed -i "s#em:maxVersion=\"5#em:maxVersion=\"7.99#g" install.rdf
  rm addon-$_plugin_id-latest.xpi
  cp -R * $dstdir
}
