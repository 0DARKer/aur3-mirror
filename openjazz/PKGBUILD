# Contributor: Rijst <ricerind@googlemail.com>
pkgname=openjazz
pkgver=120207
pkgrel=1
pkgdesc="A free, open-source version of the classic Jazz Jackrabbit(TM) games."
arch=(i686)
url="http://alister.eu/jazz/oj/"
license=('GPL')
depends=('sdl' 'convmv')
makedepends=('git')
install=openjazz.install
source=(openjazz openjazz_fixdata)
md5sums=('524d79084ec3b4ae34ee37eb85fe337f' '3fca730904ff09446c25ec11ac9f538d')

build() {
  cd $startdir/src/
  git clone git://repo.or.cz/OpenJazz.git
  cd OpenJazz/src

  patch -p0 events.c $startdir/src/OpenJazz/patches/special_enemies/openjazz-120207-events.c-special_enemies.patch
  patch -p0 level.c $startdir/src/OpenJazz/patches/special_enemies/openjazz-120207-level.c-special_enemies.patch
  patch -p0 level.h $startdir/src/OpenJazz/patches/special_enemies/openjazz-120207-level.h-special_enemies.patch

  make
  mkdir -p $startdir/pkg/usr/{bin,share/openjazz/data}
  install -m755 OpenJazz $startdir/pkg/usr/share/openjazz/
  install -m755 $startdir/src/openjazz $startdir/pkg/usr/bin/
  install -m755 $startdir/src/openjazz_fixdata $startdir/pkg/usr/bin
  install $startdir/src/OpenJazz/binary/openjazz.000 $startdir/pkg/usr/share/openjazz
}

