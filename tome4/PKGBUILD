pkgname=tome4
pkgver='1.0.0beta41'
pkgrel=1
pkgdesc="An open-source, single-player, role-playing roguelike game set in the world of Eyal."
arch=('i686' 'x86_64')
url="http://tome.te4.org/"
license=('GPL3')
depends=('mesa' 'sdl-hg' 'sdl_image-hg' 'sdl_ttf-hg' 'openal')
makedepends=('premake4')
options=(!makeflags)
source=("http://te4.org/dl/t-engine/t-engine4-src-${pkgver}.tar.bz2"
        'tome4'
		'patch-1.patch'
		'patch-2.patch'
		'patch-3.patch'
		'x86_64.patch')

build() {
    cd "${srcdir}/t-engine4-src-$pkgver"

    patch -p1 < "${srcdir}/patch-1.patch"
    patch -p1 < "${srcdir}/patch-2.patch"
    patch -p1 < "${srcdir}/patch-3.patch"
    patch -p1 < "${srcdir}/x86_64.patch"

    premake4 gmake
    make
}
package() {
    cd "${srcdir}/t-engine4-src-$pkgver"

    install -d "${pkgdir}/opt/tome4/"

    cp -r bootstrap/ game/ CONTRIBUTING COPYING CREDITS bin/Debug/t-engine \
        "${pkgdir}/opt/tome4/"

    install -Dm755 "${srcdir}/${pkgname}" "${pkgdir}/usr/bin/${pkgname}"
}
md5sums=('3687a03c176e3096f9ff7f5b8c76e7f8'
         '3a13c430be9b157ed30fe377598b5e35'
         '2a4008a4d93965ff49b819a59fe9c31d'
         '8ff2ee008a87b8b04239224b313eba09'
         'b392b9bf2d65d2d09ab5c92168ee4557'
         '13ddfca981ad23dd9bc0ee2ba8d958ba')
