# Maintainer: Mikael Eriksson <mikael_miffe_eriksson@yahoo.se>

pkgname=mingw32-sdl_image
pkgver=1.2.10
pkgrel=4
pkgdesc="A simple library to load images of various formats as SDL surfaces (mingw32)"
arch=('any')
url="http://www.libsdl.org/projects/SDL_image/"
license=('LGPL')
depends=('mingw32-sdl' 'mingw32-libpng' 'mingw32-runtime')
makedepends=('mingw32-gcc')
source=(http://www.libsdl.org/projects/SDL_image/release/SDL_image-$pkgver.tar.gz
        libpng1.5-fix.diff)
options=(!strip)
md5sums=('6c06584b31559e2b59f2b982d0d1f628'
         '4f875f09f2a15dbbbb17e6b97df10bd5')

build() {
  cd "$startdir/src/SDL_image-$pkgver"

  patch -p1 -i "$srcdir/libpng1.5-fix.diff"

  unset LDFLAGS # mingw-ld chokes on the makepkg default: --hash-style

  PKG_CONFIG_PATH=/usr/i486-mingw32/lib/pkgconfig \
  ./configure --host=i486-mingw32 \
  --prefix=/usr/i486-mingw32 \
  --enable-static \
  --enable-shared \
  --disable-png-shared

  make
  make DESTDIR="$startdir/pkg" install
}

# vim:set ts=2 sw=2 et:
