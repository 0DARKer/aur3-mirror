# Maintainer: arjan <arjan@archlinux.org>
# Contributor: Max Pray a.k.a. Synthead <synthead@gmail.com>

pkgname=xscorch
pkgver=0.2.0
pkgrel=3
pkgdesc="A clone of the classic DOS game Scorched Earth"
depends=('gtk' 'libmikmod')
arch=('i686' 'x86_64')
license=('GPL2')
url="http://www.xscorch.org/"
source=(http://www.xscorch.org/releases/$pkgname-$pkgver.tar.gz
        http://www.xscorch.org/releases/$pkgname-$pkgver-stack-smash.patch.gz
        xscorch.desktop)
  [ "$CARCH" = "x86_64" ] &&
  source=(http://www.xscorch.org/releases/$pkgname-$pkgver.tar.gz
          http://www.xscorch.org/releases/$pkgname-$pkgver-stack-smash.patch.gz
          http://www.xscorch.org/releases/$pkgname-$pkgver-64bit.patch.gz
          xscorch.desktop)
md5sums=('42862dbde1d0ebf87be30f7e04462a66'
         '43cf6229e0f034c235805ec8a54e6718'
         '00c6b5e67683ac8562488547659a72f3')
  [ "$CARCH" = "x86_64" ] &&
  md5sums=('42862dbde1d0ebf87be30f7e04462a66'
           '43cf6229e0f034c235805ec8a54e6718'
           '00c6b5e67683ac8562488547659a72f3'
           '31b8021889053c13058b13c79af87d48')

build() {
  cd $srcdir/$pkgname-$pkgver
  [ "$CARCH" = "x86_64" ] &&
    patch -p0 < $srcdir/$pkgname-$pkgver-64bit.patch
  patch -p0 < $srcdir/$pkgname-$pkgver-stack-smash.patch
  ./configure --prefix=/usr
  make || return 1
  make DESTDIR=$pkgdir install
  install -Dm 644 $srcdir/xscorch.desktop $pkgdir/usr/share/applications/xscorch.desktop
  mkdir -p $pkgdir/usr/share/pixmaps
  ln -s /usr/share/xscorch/images/xscorch-icon.xpm $pkgdir/usr/share/pixmaps/xscorch-icon.xpm
}
