_pkgname=libunicows
_target=i486-mingw32
pkgname=mingw32-libunicows
pkgver=1.1.2
pkgrel=1
pkgdesc="Microsoft Layer for Unicode (mingw32)"
arch=(any)
url="http://libunicows.sourceforge.net/"
license=('MIT')
makedepends=('mingw32-gcc' 'nasm')
options=(!strip !buildflags)
source=(http://downloads.sourceforge.net/${_pkgname}/${_pkgname}-${pkgver}-src.tar.gz)
md5sums=('8f12d5b507cd350fd835b492da30c8f5')

build() {
  cd "$srcdir/$_pkgname-$pkgver/src"
  
  sed -i 's|i586|i486|g' makefile.crossmingw32
  make -f makefile.crossmingw32 || return 1
}

package() {
  cd "$srcdir/$_pkgname-$pkgver"
  mkdir -p "${pkgdir}/usr/${_target}/lib"
  install -m644 -t "${pkgdir}/usr/${_target}/lib" lib/mingw32/{liblibunicows.a,libunicows.a}
}
