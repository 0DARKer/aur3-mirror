# Maintainer: Michael Schubert <mschu.dev at gmail>

pkgname=python2-gcat-git
pkgver=20130618
pkgrel=1
pkgdesc="Interacting with Google Drive spreadsheets from python or the command-line"
arch=('any')
url="https://github.com/embr/gcat"
license=('custom')
depends=('python2-yaml' 'python2-google-api-python-client' 'python2-pandas')
makedepends=('git')

_gitroot='git://github.com/embr/gcat.git'
_gitname='gcat'

build()
{
  if [ -d "${srcdir}/${_gitname}" ]; then
    msg "Updating local repository..."
    cd "${srcdir}/${_gitname}"
    git pull origin master
    msg "The local files are updated."
  else
    git clone ${_gitroot} ${_gitname}
  fi
  msg "git checkout done or server timeout"

  cd "$srcdir/$_gitname"
 
  # this is included in python2-google-api-python-client
  sed -i "/oauth2client/d" setup.py
}

package() {
  cd "$srcdir/$_gitname"
  python2 setup.py install --root="$pkgdir" --optimize=1

  pydir=`python2 -c "from distutils.sysconfig import get_python_lib; \
     print get_python_lib()"`
  install -Dm755 gcat/__init__.py "$pkgdir/$pydir/gcat/__init__.py"
  install -Dm644 LICENSE.txt "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
} 

