# Maintainer: SanskritFritz (gmail)

pkgname=erebus-git
pkgver=20130328
pkgrel=1
pkgdesc="2D real-time role-playing game."
arch=('i686' 'x86_64')
url="http://erebusrpg.sourceforge.net/"
license=("GPLv3")
depends=('phonon')
#optdepends=('')
makedepends=('qt4' 'git')
provides=('erebus')
conflicts=('erebus')
# Source is still needed, see erebus_source.txt
source=('http://launchpad.net/erebus/trunk/0.6/+download/erebussrc.zip')

_gitroot="git://git.code.sf.net/p/erebusrpg/code"
_gitname="erebusrpg-code"

build() {
        cd "$srcdir"

        if [ -d "$srcdir/$_gitname" ] ; then
                cd $_gitname && git pull origin
        else
                git clone $_gitroot $_gitname
        fi
        cd "$srcdir/$_gitname"
	rm -fr sound; mv -f "$srcdir/erebussrc/sound" .
	rm -fr music; mv -f "$srcdir/erebussrc/music" .
	
	qmake-qt4 erebus.pro
	make

}

package() {
	cd "$srcdir/$_gitname"
	make INSTALL_ROOT="$pkgdir" install
	mkdir --parents $pkgdir/usr/bin
	ln -s /opt/erebus/erebus $pkgdir/usr/bin/erebus
}

md5sums=('9c7981e615c2c09c261f47246506166c')

