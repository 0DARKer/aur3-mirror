pkgname=ut2004-goty
pkgver=3369
pkgrel=2
pkgdesc="Futuristic first person shooter by Epic Games, Game of the Year Edition (requires GOTY DVD)."
arch=('i686' 'x86_64')
url="http://www.unrealtournament2004.com"
license=('custom')
depends=('sdl' 'openal' 'unshield' 'libstdc++5')
install=ut2004.install
provides=('ut2004')
source=('http://planet64bit.de/fileZ/ut2004-lnxpatch3369.tar.bz2'
        'ut2004.desktop'
        'data-install.sh'
        'ut2004.sh'
        'ut2004.png')
md5sums=('be47e16b628a75097a8c82b8513b56d1'
         '7a89ea0708e19404459d5a3bb8172f09'
         '0002f3d86e88757db9c83c62bf5f9f12'
         '85623fe9fecd0678e4f12902c22d7272'
         'ae0c25b321f327a465ad3580a53d7b61')
build() {

    install -d $pkgdir/usr/share/{applications,pixmaps}
    install -d $pkgdir/opt/ut2004/{System,Scripts}

    cp -a $srcdir/UT2004-Patch/{Animations,Help,Speech,System,Textures,Web} $pkgdir/opt/ut2004/
    install -Dm555 $srcdir/ut2004.sh $pkgdir/opt/ut2004/Scripts/ut2004
    install -Dm555 $srcdir/data-install.sh $pkgdir/opt/ut2004/Scripts/data-install
    install -Dm644 $srcdir/ut2004.desktop $pkgdir/usr/share/applications/ut2004.desktop

    if [ "$CARCH" == "x86_64" ]
    then
        sed -i 's/ut2004-bin/&-linux-amd64/g' $pkgdir/opt/ut2004/Scripts/ut2004
        chmod 555 $pkgdir/opt/ut2004/Scripts/ut2004
    else
        rm $pkgdir/opt/ut2004/System/ucc-bin-linux-amd64
        rm $pkgdir/opt/ut2004/System/ut2004-bin-linux-amd64
    fi

    install -Dm644 $srcdir/ut2004.png $pkgdir/usr/share/pixmaps/ut2004.png
    ln -s /usr/lib/libSDL-1.2.so.0 $pkgdir/opt/ut2004/System/ || return 1
    ln -s /usr/lib/libopenal.so $pkgdir/opt/ut2004/System/openal.so || return 1
}
