#Maintainer: Paolo Stivanin <www.polslinux.it>

pkgname=libdrm-newest
_pkgname=libdrm
pkgver=2.4.22
pkgrel=1
pkgdesc="Userspace interface to kernel DRM services"
arch=(i686 x86_64)
url="http://dri.freedesktop.org/"
depends=('glibc')
conflicts=('libdrm')
replaces=('libdrm' 'libdrm-newest')
provides=('libdrm=2.4.22')
options=('!libtool')
license=('gpl')
source=("http://dri.freedesktop.org/${_pkgname}/${_pkgname}-$pkgver.tar.gz"
        no-pthread-stubs.patch)
md5sums=('baf6e005001c8cf739b499bcf2ca9dfb'
	 'bd2d3e704b812e90abfd31ffdb47f43c')

build() {
  cd "${srcdir}/${_pkgname}-${pkgver}"
  patch --ignore-whitespace -Np1 -i "${srcdir}/no-pthread-stubs.patch" || return 1
  libtoolize --force || return 1
  aclocal || return 1
  autoconf || return 1
  automake || return 1
  ./configure --prefix=/usr \
      --enable-intel --enable-radeon \
      --enable-vmwgfx-experimental-api --enable-nouveau-experimental-api \
      --enable-udev || return 1
  make || return 1
  make DESTDIR="${pkgdir}" install || return 1
}

