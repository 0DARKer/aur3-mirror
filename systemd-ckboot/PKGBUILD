# Maintainer: Mauro Santos <registo.mailling@gmail.com>
pkgname=systemd-ckboot
pkgver=1.0
pkgrel=1
pkgdesc="Checks boot files and MBR for changes"
arch=('any')
url="http://www.freedesktop.org/wiki/Software/systemd"
license=('GPL')
depends=('zenity' 'systemd')
backup=('etc/ckboot.conf')
install='ckboot.install'
source=('ckboot'
        'ckboot-check'
        'ckboot.conf'
        'ckboot.desktop'
        'ckboot-init'
        'ckboot.install'
        'ckboot.service'
        'ckboot.sh')
md5sums=('0355d79c84e5d98be90ae1b0dba8c0c7'
         'fed5509e1354f0b1e9aa711bbad87242'
         '69fa68fafb2a186a4d06fad5440eafdc'
         '63e570b59d3f68240bfe3303ffc55db6'
         '85f90897bf3c2d072363a9efc0cbfa82'
         '1ddc9db972afcc701883be303a6650cc'
         'd69a541cd83e3f99f33ba373365d66e7'
         '48f5e6791852d5877b5577ccb9761c66')

package() {
    # Install files
    install -Dm755 "${srcdir}/ckboot" "${pkgdir}/usr/bin/ckboot"
    install -Dm755 "${srcdir}/ckboot-check" "${pkgdir}/usr/bin/ckboot-check"
    install -Dm755 "${srcdir}/ckboot-init" "${pkgdir}/usr/bin/ckboot-init"
    install -Dm755 "${srcdir}/ckboot.sh" "${pkgdir}/etc/profile.d/ckboot.sh"
    install -Dm644 "${srcdir}/ckboot.service" "${pkgdir}/usr/lib/systemd/system/ckboot.service"
    install -Dm644 "${srcdir}/ckboot.conf" "${pkgdir}/etc/ckboot.conf"
    install -Dm644 "${srcdir}/ckboot.desktop" "${pkgdir}/etc/xdg/autostart/ckboot.desktop"
    
    # Enable unit
    mkdir "${pkgdir}/usr/lib/systemd/system/basic.target.wants"
    ln -s ../ckboot.service "${pkgdir}/usr/lib/systemd/system/basic.target.wants/ckboot.service"
}
