# Maintainer: Dieter Hsu <dieterplex@gmail.com>
pkgname=eclipse-m2e-wtp
pkgver=0.15.1
_pkgver="$pkgver.20120208-1300"
pkgrel=2
pkgdesc="Maven Integration for Eclipse WTP"
arch=('i686' 'x86_64')
url="https://community.jboss.org/en/tools/blog/2012/02/03/m2eclipse-wtp-0150-new-noteworthy"
license=('EPL')
depends=('eclipse>=3.6' 'eclipse-m2e>=1.0' 'eclipse-m2e-extras>=0.15')
_url="http://download.jboss.org/jbosstools/updates/requirements/m2eclipse/m2eclipse-wtp-${pkgver}"

source=(
    "${_url}/artifacts.jar"
    "${_url}/content.jar"
    "${_url}/features/org.maven.ide.eclipse.wtp.feature_${_pkgver}.jar"
    "${_url}/plugins/org.maven.ide.eclipse.wtp.overlay.ui_${_pkgver}.jar"
    "${_url}/plugins/org.maven.ide.eclipse.wtp.overlay_${_pkgver}.jar"
    "${_url}/plugins/org.maven.ide.eclipse.wtp_${_pkgver}.jar")
noextract=(
    "artifacts.jar"
    "content.jar"
    "org.maven.ide.eclipse.wtp.feature_${_pkgver}.jar"
    "org.maven.ide.eclipse.wtp.overlay.ui_${_pkgver}.jar"
    "org.maven.ide.eclipse.wtp.overlay_${_pkgver}.jar"
    "org.maven.ide.eclipse.wtp_${_pkgver}.jar")

build() {
  _dest=${pkgdir}/usr/share/eclipse/dropins/m2e-wtp/eclipse
  install -dm755 ${_dest}/plugins || return 1
  install -Dm644 artifacts.jar ${_dest} || return 1
  install -Dm644 content.jar ${_dest} || return 1

  for url in ${source[@]:2:5}
  do 
    _file="${url##*/}"
    _type="${url%/*}"
    _type="${_type##*/}"

    #install -Dm644 ${_file} ${_dest}/${_type}/${_file} || return 1
    if [ ${_type} == 'features' ]; then
        install -dm755 ${_dest}/features/${_file/.jar} 
        cd ${_dest}/features/${_file/.jar}
        jar xf ${srcdir}/${_file} || return 1
    else
        install -Dm644 ${srcdir}/${_file} ${_dest}/plugins || return 1
    fi
  done     
}
# vim:set ts=4 sw=4 et:
md5sums=('ffa9c811f23af1a0f84cfd87a2efe9b9'
         '02f3edbbb1e8a95b1d1f4fdbbd3e425a'
         '36ac078c6ae320493ffd2cb7b9ad3acf'
         'adea09766604ce317053e61563e1b2aa'
         '41f8343a33315e7b1a8db9954cbfa7c5'
         '74f7fada2a2c421271a3737357aa94b2')
