# Maintainer: David Morgan <dmorgan81[at]gmail[dot]com>
# Contributor: Dieter Hsu <dieterplex[at]gmail[dot]com>
# Contributor: Andrew Oppenlander <andrew.oppenlander[at]gmail[dot]com>
pkgname=eclipse-m2e-wtp
pkgver=0.17.0
_builddate=20130212
_pkgver="${pkgver}.${_builddate}"
pkgrel=1
pkgdesc="Maven Integration for Eclipse Web Tools Platform"
arch=('i686' 'x86_64')
url="http://www.eclipse.org/m2e-wtp/"
license=('EPL')
depends=('eclipse>=3.7' 'eclipse-m2e>=1.1')
_url="http://download.eclipse.org/m2e-wtp/releases/juno/0.17.x/${_pkgver}-1821/m2e-wtp"

source=(
    "${_url}/features/org.sonatype.m2e.mavenarchiver.feature_0.15.0.201207090125-signed-201209140800.jar"
    "${_url}/features/org.eclipse.m2e.wtp.feature_${_pkgver}-1821.jar"
    "${_url}/features/org.eclipse.m2e.wtp.jaxrs.feature_${_pkgver}-1821.jar"
    "${_url}/features/org.eclipse.m2e.wtp.jsf.feature_${_pkgver}-1821.jar"
    "${_url}/plugins/org.sonatype.m2e.mavenarchiver_0.15.0.201207090125-signed-201209140800.jar"
    "${_url}/plugins/org.eclipse.m2e.wtp.overlay.ui_${_pkgver}-1821.jar"
    "${_url}/plugins/org.eclipse.m2e.wtp.overlay_${_pkgver}-1821.jar"
    "${_url}/plugins/org.eclipse.m2e.wtp_${_pkgver}-1821.jar"
    "${_url}/plugins/org.eclipse.m2e.wtp.jaxrs_${_pkgver}-1821.jar"
    "${_url}/plugins/org.eclipse.m2e.wtp.jsf_${_pkgver}-1821.jar")
noextract=(${source[@]##*/})

build() {
  _dest=${pkgdir}/usr/share/eclipse/dropins/m2e-wtp/eclipse
  install -dm755 ${_dest}/plugins || return 1

  for url in ${source[@]}
  do 
    _file="${url##*/}"
    _type="${url%/*}"
    _type="${_type##*/}"

    #install -Dm644 ${_file} ${_dest}/${_type}/${_file} || return 1
    if [ ${_type} == 'features' ]; then
        install -dm755 ${_dest}/features/${_file/.jar} 
        cd ${_dest}/features/${_file/.jar}
        jar xf ${srcdir}/${_file} || return 1
    else
        install -Dm644 ${srcdir}/${_file} ${_dest}/plugins || return 1
    fi
  done     
}
# vim:set ts=4 sw=4 et:

md5sums=('5513ffaed3cfa1b9864004132ee3908f'
         '19eae6f06a1575e21a71f2494b1a6ef5'
         'baafce1802190d08384f3aa90af661bd'
         '96a09f481a1ddb153a9b8440ae1d3e2f'
         '0c199bd5ad8ba74dff232aaa7670dc53'
         '4b77632409437e61bca4ad6f60b4012d'
         'fec12323be054056201b87cb1fa0cec9'
         'd3fa3a2f4e2b13c7785c13629f7e1839'
         '6f47e6c3d9d877d256d56133ac864484'
         '42934ed1157639547817a485ea2c0f3b')
