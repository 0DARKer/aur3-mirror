# $Id: PKGBUILD 113959 2011-03-10 22:37:48Z jgc $
# Maintainer: onexused <aursignup dot kyoo at xoxy dot net>
# Modified to fit your television.

pkgname=xscreensaver-retired
pkgver=5.12
pkgrel=1
pkgdesc="'Retired' xscreensaver hacks that are still included in the source."
arch=('i686' 'x86_64')
url="http://www.jwz.org/xscreensaver/"
license=('BSD')
depends=('xscreensaver')
makedepends=('bc')
install=xscreensaver-retired.install
source=(http://www.jwz.org/xscreensaver/xscreensaver-${pkgver}.tar.gz \
        comeback.diff \
        LICENSE \
        xscreensaver-5.12-gltext-memleak.patch
        xscreensaver-retired.install)
md5sums=('0345c1acb9280729de05c5ca44b401e3'\
         'e68b1377438db2002a60c85f97ad03bf'\
         '5e7f3f2a63d20a484742f5b4cb5d572c'\
         '43ac1b2b3757a1abd07b9666a5174c20'\
         '74c2b783d3bf714294b44015b50fe6ad')

sha1sums=('7252540b1b1853459a56453714c0974de26fa4c5'\
          'b8bf3d922ce97dbd44ed2ae1c2355956b0b0302e'\
          '4209ea586b204fd1d81c382a0522c654f9fd9134'\
          '2108fd66fbbb45cb57b31762dd3a13a99d99b579'\
          '5f963465abad896905511d3a81e11ba4ab203e39')

build() {
  cd "${srcdir}/xscreensaver-${pkgver}"
  patch -Np0 -i "${srcdir}/xscreensaver-5.12-gltext-memleak.patch"
  patch -Np0 -i "${srcdir}/comeback.diff"
  ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var \
    --libexecdir=/usr/lib --with-x-app-defaults=/usr/share/X11/app-defaults \
    --with-pam --without-motif --with-gtk --with-gl \
    --without-gle --with-xpm --with-pixbuf --with-jpeg
  make
}

package() {
  cd "${srcdir}/xscreensaver-${pkgver}"
  make install_prefix="${pkgdir}" install
#  cd "${srcdir}/xscreensaver-${pkgver}/hacks"
#  install -d -m644 "${pkgdir}/usr/lib/xscreensaver/"
#  cp ant bubbles critical flag forest glx/glforestfire hyperball hypercube \
#  juggle laser lightning lisa lissie lmorph t3d vines whirlygig worm rotor \
#  sphere spiral \
#  "${pkgdir}/usr/lib/xscreensaver/"
#  cd config
#  install -d -m644 "${pkgdir}/usr/share/xscreensaver/config/"
#  cp ant.xml bubbles.xml critical.xml flag.xml forest.xml glforestfire.xml \
#  hyperball.xml hypercube.xml juggle.xml laser.xml lightning.xml lisa.xml \
#  lissie.xml lmorph.xml t3d.xml vines.xml whirlygig.xml worm.xml rotor.xml \
#  sphere.xml spiral.xml \
#  "${pkgdir}/usr/share/xscreensaver/config/"
  install -D -m644 ${srcdir}/LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
