#PKGBUILD Maintainer: Rafael Reggiani Manzo <rr.manzo#gmail.com>

pkgname=analizo
pkgver=1.18.0
pkgrel=1
pkgdesc="Analizo is a free, multi-language, extensible source code analysis and visualization toolkit."
groups=('analizo')
arch=('any')
url="http://analizo.org"
license=('GPLv3')
depends=('perl' 'perl-cpanplus-dist-arch' 'sloccount' 'doxyparse')
source=("${url}/download/${pkgname}_${pkgver}.tar.gz")
sha512sums=('581451498abaa5bc123b7067fa69cae935a6e3af4403c59cadbdea472df1b97d0739eccba3d1953a23145eb7a4b6d10100f8ec76de756d5e866a18d91c0c8616')

build(){
  cd "${srcdir}/${pkgname}"

  #Perl modules
  cpanp -i Class::Accessor
  cpanp -i Getopt::Euclid
  cpanp -i Graph
  cpanp -i List::Compare
  cpanp -i Statistics::Descriptive
  cpanp -i Statistics::OnLine
  cpanp -i MRO::Compat
  cpanp -i Test::Class
  cpanp -i Test::Exception
  cpanp -i YAML
  cpanp -i File::ShareDir::Install
  cpanp -i FindBin::libs
  cpanp -i App::Cmd::Setup
  cpanp -i Class::Inspector
  cpanp -i Graph::Writer::DSM
  cpanp -i File::HomeDir
  cpanp -i CHI
  cpanp -i File::Copy::Recursive

  #Analizo
  perl Makefile.PL
  make
}

check() {
  cd "${srcdir}/${pkgname}"

  make check || :
}

package(){
  cd "${srcdir}/${pkgname}"

  make DESTDIR="${pkgdir}/" install
}