#PKGBUILD Maintainer: Rafael Reggiani Manzo <rr.manzo#gmail.com>

pkgname=analizo
pkgver=1.17.0
pkgrel=1
pkgdesc="Analizo is a free, multi-language, extensible source code analysis and visualization toolkit."
groups=('analizo')
arch=('any')
url="http://analizo.org"
license=('GPLv3')
depends=('perl' 'perl-cpanplus-dist-arch' 'sloccount' 'doxyparse')
source=("${url}/download/${pkgname}_${pkgver}.tar.gz")
sha512sums=('c96a823c3b54e663f5fd1595862dde1ecdf14b6a4fa114e1a6d65acbded1e33633dc4e9e41c34d6bb92a216b31566c7396aa8d310447fb4b016f3dffb46df1ce')

build(){
  cd "${srcdir}/${pkgname}"

  #Perl modules
  #yes | setupdistarch

  cpanp -i Class::Accessor
  cpanp -i Getopt::Euclid
  cpanp -i Graph
  cpanp -i List::Compare
  cpanp -i Statistics::Descriptive
  cpanp -i Statistics::OnLine
  cpanp -i MRO::Compat
  cpanp -i Test::Class
  cpanp -i Test::Exception
  cpanp -i YAML

  #Analizo
  perl Makefile.PL
  make
}

check() {
  cd "${srcdir}/${pkgname}"

  make check || :
}

package(){
  cd "${srcdir}/${pkgname}"

  make DESTDIR="${pkgdir}/" install
}