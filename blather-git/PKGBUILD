# Maintainer: timttmy <marshall\\dot//cleave\\at//tiscali\\dot//co\\dot//uk>
# Current PKGBUILD was written by Padfoot https://aur.archlinux.org/packages/?O=0&C=0&SeB=m&K=padfoot
# Thank you Padfoot :)

pkgname='blather-git'
pkgver=20140121
pkgrel=1

pkgdesc="Python application for speech recognition using pocketsphinx and gstreamer. - latest git revision"

arch=('any')
url="https://gitorious.org/blather"
license=('GPL3')

depends=('pocketsphinx'
         'gstreamer0.10-python')
optdepends=('pyside: Qt interface'
            'pygtk: Gtk interface')
makedepends=('git')

provides=('blather')
install='blather.install'

source=(git://gitorious.org/blather/blather.git
        'blather-gtk.desktop'
        'blather-qt.desktop'
        'blather-autostart.desktop')
        
md5sums=('SKIP'
         'cc89d023ece47ad46b10668578989f19'
         '7137181700059662c6edc002fae371d5'
         'db3c6e93dc1bb6f3d80b7a2e05c26afd')

prepare() {
  rm -rf "$srcdir"/${pkgname%%-*}"/.git"
}

build() {
  python2 -m compileall "$srcdir"/${pkgname%%-*}
}

package() {
  cd "$srcdir"/${pkgname%%-*}

  mkdir -p "$pkgdir/usr/share/blather"  
  mkdir -p "$pkgdir/usr/share/applications"
  mkdir -p "$pkgdir/etc/xdg/autostart"
  
  install -m 755 "$srcdir/blather-gtk.desktop" "$pkgdir/usr/share/applications"
  install -m 755 "$srcdir/blather-qt.desktop" "$pkgdir/usr/share/applications"
  install -m 755 "$srcdir/blather-autostart.desktop" "$pkgdir/etc/xdg/autostart"
  
  cp -r "$srcdir"/${pkgname%%-*}/* "$pkgdir/usr/share/blather"
}
