# Maintainer: Jesse Jaara <gmail: jesse.jaara>
pkgname=rtmpdump-yle
pkgver=1.4.4
pkgrel=1
pkgdesc="Download video and audio from YLE Areena in .flv-format"
arch=("i686" "x86_64")
url="http://users.tkk.fi/~aajanki/rtmpdump-yle/index.html"
license=("GPL")
depends=("openssl" 'python2' 'json-c')
conflicts=('rtmpdump' 'rtmpdump-svn' 'rtmpdump-git')
provides=('rtmpdump=2.4' 'rtmpdump-svn' 'rtmpdump-git=20110930')
source=("http://users.tkk.fi/~aajanki/${pkgname}/${pkgname}-${pkgver}.tar.gz" \
	makefile.patch)

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  patch -p1 -i ../makefile.patch

  cd librtmp
  make			#Build librtmp
  cd ..
  
  make			#Build yle-dl
}
package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  
  mkdir -p "${pkgdir}/usr/lib"
  
  cd librtmp
  make DESTDIR="${pkgdir}" install install_so
  cd ..
  
  make DESTDIR="${pkgdir}" install 
  sed 's|python|python2|g' -i "${pkgdir}/usr/bin/yle-dl"

  ln -s rtmpdump-yle "${pkgdir}/usr/bin/rtmpdump"
}

md5sums=('692be025efab8e3344d9f21833d2aff1'
         '6dabca0078304c07d021c0a8842df50d')
