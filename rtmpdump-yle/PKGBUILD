# Maintainer: Jesse Jaara <gmail: jesse.jaara>
pkgname=rtmpdump-yle
pkgver=1.4.3
pkgrel=1
pkgdesc="Download video and audio from YLE Areena in .flv-format"
arch=("i686" "x86_64")
url="http://users.tkk.fi/~aajanki/rtmpdump-yle/index.html"
license=("GPL")
depends=("openssl" 'python2' 'json-c')
conflicts=('rtmpdump' 'rtmpdump-svn' 'rtmpdump-git')
provides=('rtmpdump=2.4' 'rtmpdump-svn' 'rtmpdump-git')
source=("http://users.tkk.fi/~aajanki/${pkgname}/${pkgname}-${pkgver}.tar.gz" \
	makefile.patch)

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  patch -p1 -i ../makefile.patch

  cd librtmp
  make			#Build librtmp
  cd ..
  
  make			#Build yle-dl
}
package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  
  mkdir -p "${pkgdir}/usr/lib"
  
  cd librtmp
  make DESTDIR="${pkgdir}" install install_so
  cd ..
  
  make DESTDIR="${pkgdir}" install 
  sed 's|python|python2|g' -i "${pkgdir}/usr/bin/yle-dl"

  ln -s rtmpdump-yle "${pkgdir}/usr/bin/rtmpdump"
}

md5sums=('cf82a72eac3d839b11bd93ce426e6648'
         '0f1be04d563977c4d3d3905a4e8172d5')
