# Maintainer: Techlive Zheng <techlivezheng at gmail dot com>
# Contributor: Ivan Morales  <imorales at sismanet dot com>

pkgname=xmail
pkgver=1.26
pkgrel=1
pkgdesc="An java based SMTP/POP3 server"
arch=('i686' 'x86_64')
url="http://www.xmailserver.org/"
license=('GPL')
depends=('openssl')
confilicts=('postfix')
source=(http://www.xmailserver.org/$pkgname-$pkgver.tar.gz xmail xmail.sh)

build() {
    cd $srcdir/$pkgname-$pkgver

    make -f Makefile.lnx || return 1
}

package() {
    cd $srcdir/$pkgname-$pkgver
    
    install -D -m 755 $srcdir/xmail       $pkgdir/etc/rc.d/xmail
    install -D -m 755 $srcdir/xmail.sh    $pkgdir/etc/profile.d/xmail.sh

    install -D -m 755 bin/XMail           $pkgdir/usr/sbin/XMail
    install -D -m 755 bin/XMCrypt         $pkgdir/usr/sbin/XMCrypt
    install -D -m 755 bin/MkUsers         $pkgdir/usr/sbin/MkUsers
    install -D -m 755 bin/CtrlClnt        $pkgdir/usr/sbin/CtrlClnt
#   install -D -m 755 bin/MkMachDep       $pkgdir/usr/sbin/MkMachDep
    
    install -D -m 4755 bin/sendmail       $pkgdir/usr/sbin/sendmail

    install -D -m 644 docs/Readme.txt     $pkgdir/usr/share/docs/xmail/Readme.txt
    install -D -m 644 docs/Readme.html    $pkgdir/usr/share/docs/xmail/Readme.html
    install -D -m 644 docs/ChangeLog.txt  $pkgdir/usr/share/docs/xmail/ChangeLog.txt
    install -D -m 644 docs/ChangeLog.html $pkgdir/usr/share/docs/xmail/ChangeLog.html

    cd MailRoot

    find . -type d -exec install -d {,${pkgdir}/opt/xmail/}{} \; || return 1
    find . -type f -exec install -D -m 644 {,${pkgdir}/opt/xmail/}{} \; || return 1
}

md5sums=('26d35c2fc104d79ebb6397c7dece5b15'
         '90a1da9d89d0ed101bfa0a1fd255d714'
         '1a668de800a761bb5feda3e247a140d9')
