# Maintainer: Chris Sivanich <csivanich at gmail dot com>

_gitname='synsei'
_gitroot='https://github.com/csivanich/'$_gitname'.git'

pkgname=synsei-git
pkgver=1412897395
pkgrel=1
pkgdesc='Easily manage synaptics configurations'
arch=(any)
url='https://github.com/csivanich/synsei'
license=('GPLV2')
groups=()
depends=('xf86-input-synaptics')
makedepends=('git')
provides=(synsei)
conflicts=()
replaces=()
backup=()
options=()
install=
changelog=
source=("$_gitroot")
noextract=()
sha256sums=('SKIP')

build() {
    cd "$srcdir"
    msg "Connecting to Github...."

    if [[ -d "$_gitname" ]]; then
        cd "$_gitname" && git pull origin
        msg "The local files are being updated."
    else
        git clone "$_gitroot" "$_gitname"
    fi

    msg "Git checkout done or server timeout"
    msg "Starting build..."

    rm -rf "$srcdir/$_gitname-build"
    git clone "$srcdir/$_gitname" "$srcdir/$_gitname-build"
    cd "$srcdir/$_gitname-build"
    git checkout master
    patch -p1 < "$srcdir/../remove_debug.patch"
}

package() {
    cd "$srcdir/$_gitname-build"

    share="${pkgdir}/usr/share/$_gitname"
    bin="${pkgdir}/usr/bin/"
    docs="${pkgdir}/usr/share/docs/$_gitname"

    mkdir -p "$share" "$bin" "$docs"

    install -Dm755 "$srcdir/../synsei" "$bin"
    install -Dm644 README.md "$docs"
    install -Dm644 functions "$share"
    install -Dm755 actions debug edit help list load save synsei view "$share"
}
