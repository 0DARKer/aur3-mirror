# Maintainer: Auguste Pop <auguste [at] gmail [dot] com>

pkgname=popeye
pkgver=4.59
pkgrel=1
pkgdesc="A chess problem solving and testing software"
arch=('i686' 'x86_64')
url="http://sourceforge.net/projects/popeye-chess/"
license=('custom')
source=("http://downloads.sourceforge.net/$pkgname-chess/$pkgname-$pkgver-sources.zip"
        "gengmarr.c")
md5sums=('881db669bd9f88d2f9485514d34c5ba9'
         'cfcb6fcc9f6f05d96ecae2aeb1b604a0')

build()
{
    cd "$srcdir/$pkgver"

    ln -s "$srcdir/gengmarr.c" .
    sed -i '/py6.h/d' pymain.c

    CFLAGS='-march=native -mtune=native' make -f makefile.unx
}

package()
{
    cd "$srcdir/$pkgver"

    install -m 755 -D py "$pkgdir/usr/bin/py"
    install -m 644 -D license.txt "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
    install -d "$pkgdir/usr/share/doc/$pkgname"
    install -m 644 py-*.txt "$pkgdir/usr/share/doc/$pkgname"
}
