# Contributor: Yejun Yang (yejunx AT gmail DOT com)

pkgname=disco
pkgver=0.1.3
pkgrel=1
pkgdesc="Disco is an open-source implementation of the Map-Reduce framework for distributed computing. As the original framework, Disco supports parallel computations over large data sets on unreliable cluster of computers."
arch=('any')
url="http://discoproject.org/"
license=('BSD')
depends=(erlang lighttpd python python-cjson)
makedepends=(setuptools)
optdepends=(openssh)
backup=(etc/disco/disco.conf etc/disco/lighttpd-master.conf etc/disco/lighttpd-node.conf)
install=disco.install
source=(http://discoproject.org/$pkgname-$pkgver.tar.gz
	disco-master
	disco-node)

md5sums=('3d2227308fe6c592b25ec008ef42efba'
         '98a2953fba3a0946b7e319b3be47d487'
         'b241a00d78b193a756d8c58907851287')

build() {
  cd $srcdir/$pkgname-$pkgver
  make || return 1
  make DESTDIR=$pkgdir install || return 1

  mkdir -p $pkgdir/srv/disco/data
  mkdir -p $pkgdir/var/run/disco
  mkdir -p $pkgdir/var/log/disco
  mkdir -p $pkgdir/etc/rc.d
  install -m 755 $srcdir/disco-master $pkgdir/etc/rc.d
  install -m 755 $srcdir/disco-node $pkgdir/etc/rc.d
}