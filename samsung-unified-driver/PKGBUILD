# Maintainer: Bernd Amend <berndamend gmail com>

pkgname=samsung-unified-driver
pkgver=1.00.29
pkgrel=2

pkgdesc="Unified Linux Driver for Samsung printers and scanners."
arch=(i686 x86_64 armel)
url="http://www.samsung.com"
license=('custom:samsung')
depends=('libxml2' 'libusb-compat' 'cups' 'sane')

options=(!strip)

if [ "$CARCH" = "i686" ]; then
	CARCHCUSTOM="i386"
	sha512sums=('2b4e5b02cfaa20c065d2cc28fe13350cd9966f5fc4972143015c448707fbdbd683f32d296b4f7afa03efcf2ebef9e64bb8e1555b15a17a082ede23ebdadfc91a' '2dfc7e51e40bad6de51215b81f19dab8dd5d27893a28a46f310d09a531f17711472e25641c35dfeb053d3e7ebcefcb93b821f34b0305389d36c4e866f8e60ab0' '78bee0c2c96172c1649cedb08df27971285fa69a4d88de770e917a1bfac536bcc08dae18242b78eec368f8405ca779df987e6f94f0cd96a9409c120e65efdfe6'
	)
elif [ "$CARCH" = "armel" ]; then
	CARCHCUSTOM="armel"
	sha512sums=('c2296b3a93635e721edd2d3214ffb5988447c120a50a1da3190ba036634df24ea99d3a3c159452dc7aeee791d253a5475439722062218a067f7a74d43964f646' '2dfc7e51e40bad6de51215b81f19dab8dd5d27893a28a46f310d09a531f17711472e25641c35dfeb053d3e7ebcefcb93b821f34b0305389d36c4e866f8e60ab0' '78bee0c2c96172c1649cedb08df27971285fa69a4d88de770e917a1bfac536bcc08dae18242b78eec368f8405ca779df987e6f94f0cd96a9409c120e65efdfe6'
	)
else
	CARCHCUSTOM="amd64"
	sha512sums=('2eb37c71b221695687e6a7855d2515d3fd4e323e61560f940dd185bd1d61f646eb29e50c13f129373a72d39cbea94a4710b812001b49b2818f38a4fbc3cb9d8d' '2dfc7e51e40bad6de51215b81f19dab8dd5d27893a28a46f310d09a531f17711472e25641c35dfeb053d3e7ebcefcb93b821f34b0305389d36c4e866f8e60ab0' '78bee0c2c96172c1649cedb08df27971285fa69a4d88de770e917a1bfac536bcc08dae18242b78eec368f8405ca779df987e6f94f0cd96a9409c120e65efdfe6'
	)
fi

suld_arch="suld-driver2-${pkgver}_${pkgver}-1_${CARCHCUSTOM}.deb"
suld_ppd="suld-ppd-4_${pkgver}-1_all.deb"
suld_common="suld-driver2-common-1_1-3_all.deb"

source=("http://www.bchemnet.com/suldr/pool/debian/extra/su/${suld_arch}"
	"http://www.bchemnet.com/suldr/pool/debian/extra/su/${suld_ppd}"
	"http://www.bchemnet.com/suldr/pool/debian/extra/su/${suld_common}"
	)
noextract=("${source[@]%%::*}")

package() {
	# common
	rm -rf common
	mkdir common
	cd common
	ar x "../${suld_common}"
	tar xf data.tar.xz
	install -d "${pkgdir}/usr/lib/udev/rules.d"
	install -m 444 -t "${pkgdir}/usr/lib/udev/rules.d/" etc/udev/rules.d/60_smfp_samsung.rules
	
	install -d "${pkgdir}/etc/sane.d/dll.d"
	install -m 444 -t "${pkgdir}/etc/sane.d/" etc/sane.d/xerox_mfp-smfp.conf
	install -m 444 -t "${pkgdir}/etc/sane.d/dll.d" etc/sane.d/dll.d/*
	
	install -d "${pkgdir}/usr/share/licenses/samsung-unified-driver"
	install -m 444 -t "${pkgdir}/usr/share/licenses/samsung-unified-driver" usr/share/doc/suld-driver2/eula-fr.txt usr/share/doc/suld-driver2/copyright.gz
	install -m 444 usr/share/doc/suld-driver2/eula.txt "${pkgdir}/usr/share/licenses/samsung-unified-driver/LICENSE"
	
	install -d "${pkgdir}/usr/share/locale/fr/LC_MESSAGES/"
	install -m 444 -t "${pkgdir}/usr/share/locale/fr/LC_MESSAGES/" usr/share/locale/fr/LC_MESSAGES/sane-smfp.mo
	
	install -d "${pkgdir}/usr/share/doc/samsung-unified-driver/"
	install -m 444 -t "${pkgdir}/usr/share/doc/samsung-unified-driver/" usr/share/doc/suld-driver2/changelog.gz
	cd ..

	# ppd
	rm -rf ppd
	mkdir ppd
	cd ppd
	ar x "../${suld_ppd}"
	tar xf data.tar.xz -C "${pkgdir}"
	cd ..
	
	# arch
	rm -rf arch
	mkdir arch
	cd arch
	ar x "../${suld_arch}"
	tar xf data.tar.xz -C "${pkgdir}"
	chmod 444 "${pkgdir}/etc/sane.d/smfp.conf"
	cd ..
}
