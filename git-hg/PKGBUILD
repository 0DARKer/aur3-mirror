# -*- shell-script -*-
# Arch Linux package build script
#
# Contributor: Vsevolod Balashov <vsevolod@balashov.name>
#
# $Id$

pkgname=git-hg
pkgver=20110318
pkgrel=1
pkgdesc="git-hg plugin"
arch=(any)
url="https://github.com/offbytwo/git-hg"
license=('MIT')
install=git-hg.install
depends=('mercurial' 'python-dulwich-git' 'git')
makedepends=()
provides=('git-fast-export')
source=('githghome.patch' 'git-hg.install')
md5sums=('6ea17d66b7377655398557238f89c33a'
         '25b7e78141a96b02e5c3b954c0aa95bc')

_gitroot="https://github.com/offbytwo/git-hg.git"
_gitname=$pkgname

build() {
  if [ -d $_gitname ]
  then
    rm -rf $_gitname
  fi
  git clone $_gitroot $_gitname
  cd $_gitname
  git submodule update --init
  git apply ../githghome.patch
  mkdir -p ${pkgdir}/usr/share/git/
  mkdir -p ${pkgdir}/usr/lib/git-core/
  cp -r ${srcdir}/${_gitname}/fast-export ${pkgdir}/usr/share/git/
  install -m 755 ${srcdir}/${_gitname}/bin/git-hg ${pkgdir}/usr/lib/git-core/


}
