
# Maintainer: Colard Benjamin <caemirr@gmail.com>
pkgname=ryzom-server-hg
pkgver=0.8
pkgrel=0.2
pkgdesc="Ryzom is a Free to Play MMORPG"
arch=('i686' 'x86_64')
license=('AGPL3' 'CC-BY-SA')
makedepends=('mercurial' 'mysql' 'libsquish' 'libwww' 'luabind' 'cpptest' 'lua' 'openal')
url="http://dev.ryzom.com"
provides=('ryzom')

_hgroot=http://ryzom.hg.sourceforge.net:8000/hgroot/ryzom/
_hgrepo=ryzom
_build="${srcdir}/${_hgrepo}/build/"
build()	{
	cd "${srcdir}/${_hgrepo}"
	hg update
	[ ! -d "${_build}" ] && mkdir "${_build}" 
	cd "${_build}"

	cmake	-DNL_ETC_PREFIX=/etc/nel \
		-DNL_DRIVER_PREFIX=/usr/lib/nel \
		-DRYZOM_ETC_PREFIX=/etc/ryzom \
		-DRYZOM_SHARE_PREFIX=/usr/share/games/ryzom \
		-DRYZOM_BIN_PREFIX=/usr/games \
		-DWITH_RYZOM_SERVER=ON	\
		-DWITH_RYZOM_CLIENT=OFF \
		-DWITH_NEL=ON \
		-DWITH_SOUND=OFF \
		-DWITH_NEL_TOOLS=ON \
		-DWITH_RYZOM_TOOLS=ON \
		-DWITH_STATIC=ON \
		-DWITH_STATIC_DRIVERS=ON \
		-Wno-dev \
		-lmd5 \
		../code
}

package() {
    cd "${_build}"
    make DESTDIR="${pkgdir}" install
}
