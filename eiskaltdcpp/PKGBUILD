# Contributor: dhamp <dhamp@ya.ru>

_name=eiskaltdcpp
_prerel=
_tarver=2.2.0
#pkgbase=$_name
pkgname=$_name
#('eiskaltdcpp' 'eiskaltdcpp-gtk' 'eiskaltdcpp-qt' 'eiskaltdcpp-common')
pkgver=$_tarver
pkgrel=3
license=('GPL3')
arch=('i686' 'x86_64')
depends=('qt' 'miniupnpc' 'libglade' 'libnotify' 'bzip2' 'pcre')
optdepends=('aspell: spellchecking'
            'qtscriptgenerator: need for qtscript'
            'php: needed for some optionаl scripts')
pkgdesc="DC and ADC client based on dcpp core"
url="http://code.google.com/p/eiskaltdc/"
makedepends=('gcc' 'pkgconfig' 'cmake' 'gettext')
conflicts=('eiskaltdcpp-git')
provides=('eiskaltdcpp')
options=(!emptydirs)
install=$_name.install
#_patchname=fix-for-build-beta2.diff
source=(http://eiskaltdc.googlecode.com/files/${pkgname}-${_tarver}${_prerel}.tar.bz2)
md5sums=('05c1055f59903eedc6409cda83e30d8c')
sha1sums=('3051a4e15aae4a188093c66f364b317174aaeb39')
build() {
  cd ${srcdir}
  #patch -Np1 -i ${srcdir}/${_patchname}
  rm -rf $srcdir/$_name-$_tarver$_prerel/build
  mkdir $srcdir/$_name-$_tarver$_prerel/build
  #cd $srcdir/$_name-$_tarver$_prerel
  #patch -Np1 -i ${srcdir}/${_patchname}
  cd $srcdir/$_name-$_tarver$_prerel/build
  #echo 'install(DIRECTORY ${dcpp_BINARY_DIR}/locale DESTINATION ${SHARE_DIR})' >> ../dcpp/CMakeLists.txt
  #echo 'if (WITH_EXAMPLES)' >> ../dcpp/CMakeLists.txt
  #echo 'install(DIRECTORY ${dcpp_SOURCE_DIR}/../examples DESTINATION ${_DATADIR})' >> ../dcpp/CMakeLists.txt
  #echo 'endif()' >> ../dcpp/CMakeLists.txt
  #echo 'if (WITH_EMOTICONS)' >> ../dcpp/CMakeLists.txt
  #echo 'install(DIRECTORY ${dcpp_SOURCE_DIR}/../emoticons DESTINATION ${_DATADIR})' >> ../dcpp/CMakeLists.txt
  #echo 'endif()' >> ../dcpp/CMakeLists.txt
  #echo 'install(DIRECTORY ${${PROJECT_NAME_GLOBAL}-gtk_BINARY_DIR}/locale DESTINATION ${SHARE_DIR})'>> ../eiskaltdcpp-gtk/CMakeLists.txt

  cmake .. -DCMAKE_INSTALL_PREFIX=/usr -DUSE_MINIUPNP=ON -DPERL_REGEX=ON -DUSE_JS=ON -DUSE_GTK=ON -DLOCAL_BOOST=ON
  make
  make DESTDIR=$pkgdir install
  #rm -rf $srcdir/$pkgname-$_tarver$_prerel/build
}

#package_eiskaltdcpp() {
    #depends=('qt' 'miniupnpc' 'libglade' 'libnotify')
    #optdepends=('aspell: spellchecking'
            #'qtscriptgenerator: need for qtscript'
            #'php: needed for some optionаl scripts')
    #pkgdesc="DC and ADC client based on dcpp core"
    #cd $srcdir/$_name-$_tarver$_prerel/build
    #make DESTDIR=$pkgdir install
#}

#package_eiskaltdcpp-gtk() {
    #depends=('miniupnpc' 'libglade' 'libnotify' 'eiskaltdcpp-common')
    #optdepends=('php: needed for some optionаl scripts')
    #pkgdesc="Gtk2-based DC and ADC client based on dcpp core"
    #cd $srcdir/$_name-$_tarver$_prerel/build
    #make -C eiskaltdcpp-gtk DESTDIR=$pkgdir install

#}
#package_eiskaltdcpp-qt() {
    #depends=('qt' 'miniupnpc' 'eiskaltdcpp-common')
    #optdepends=('aspell: spellchecking'
            #'qtscriptgenerator: need for qtscript'
            #'php: needed for some optionаl scripts')
    #pkgdesc="Qt4-based DC and ADC client based on dcpp core"
    #cd $srcdir/$_name-$_tarver$_prerel/build
    #make -C eiskaltdcpp-qt DESTDIR=$pkgdir install
#}

#package_eiskaltdcpp-common() {
    #depends=('bzip2' 'openssl')
    #pkgdesc="Own dcpp core and other common files"
    #cd $srcdir/$_name-$_tarver$_prerel/build
    #make -C dcpp DESTDIR=$pkgdir install
#}
