# Maintainer: Ivan Sichmann Freitas <ivansichfreitas at gmail dot com>
# Contributor: Laszlo Papp <djszapi2 at gmail dot com>
# Contributor: Gerardo Exequiel Pozzi <vmlinuz386@yahoo.com.ar>
# Contributor: Vladimir Cerny <blackvladimir@gmail.com>
# Contributor: 4javier <4javieregATgmailDOTcom>

pkgname=avr-gdb
_pkgname=gdb
pkgver=7.3.1
pkgrel=1
pkgdesc="The GNU Debugger for AVR"
arch=('i686' 'x86_64')
url="http://www.gnu.org/software/gdb/"
license=('GPL3')
depends=('python')
options=('!libtool')
source=(http://ftp.gnu.org/gnu/gdb/${_pkgname}-${pkgver}.tar.bz2)
md5sums=('b89a5fac359c618dda97b88645ceab47')

build() {
  cd ${srcdir}/${_pkgname}-${pkgver}

  unset LDFLAGS
  export CFLAGS="-O2 -pipe"
  export CXXFLAGS="$CFLAGS"
    
  ./configure --prefix=/usr \
    --target=avr \
    --disable-nls \
    --enable-languages=c,c++ \
    --infodir=/usr/share/info \
    --libdir=/usr/lib \
    --libexecdir=/usr/lib \
    --mandir=/usr/share/man \
    --with-system-readline
  make || return 1
}

package() {
  cd ${srcdir}/${_pkgname}-${pkgver}

  make DESTDIR=${pkgdir} install || return 1

  rm -f ${pkgdir}/usr/lib/libiberty.a
  rm -rf ${pkgdir}/usr/share/info
  rm -rf ${pkgdir}/usr/share/gdb
  
}
