# Maintainer : Chris Heien <chris.h.heien@gmail.com>

pkgname=libkmap-svn
pkgver=1214004
pkgrel=1
pkgdesc="Map Library interface for KDE . SVN Version"
arch=('i686' 'x86_64')
url="http://www.digikam.org/"
license=('GPL')
depends=('kdelibs')
makedepends=('subversion' 'cmake' 'pkgconfig')

_svntrunk=svn://websvn.kde.org/home/kde/branches/extragear/graphics/digikam/extra/libkmap
_svnmod=libkmap

build() {
  cd ${srcdir}

  if [ -d ${_svnmod}/.svn ]; then
    (cd ${_svnmod} && svn revert -R .)
    (cd ${_svnmod} && svn -r ${pkgver} up)
  else
    svn co ${_svntrunk} --config-dir ./ -r ${pkgver} ${_svnmod}
  fi

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  cd ${srcdir}/${_svnmod}

  cmake -DCMAKE_INSTALL_PREFIX=/usr \
     -DCMAKE_SKIP_RPATH=ON 

  make all
  make DESTDIR=${pkgdir} install 

}
