# Contributors: Osman Alperen Elhan <alperen@elhan.org>
#               Ahmet Yasin Uslu <yasin@nepjua.org>

pkgname=yacreader-bin
pkgver=6.2.0
pkgrel=2
pkgdesc="Yet Another Comic Reader!"
arch=('x86_64')
url="http://www.yacreader.com/"
license=('GPL')
depends=('qt4' 'poppler-qt')
source=("yacreader-${pkgver}.tar.gz::http://yacreader.googlecode.com/files/YACReader-${pkgver}%20X11-x64-qt4.tar.gz"
        "yacreaderlibrary.desktop"
        "yacreader.desktop")
INTEGRITY_CHECK=('sha512')
sha512sums=('1a5ac46a00fb8c1fd70c8767e8de0a8da544bb69383e43062ee067d6a5c0ac45b7ba4eab68e0b7a991815f6ec1cc6783a0d1ef412ad593a50da87d64d5508916'
            '6984d6f8759f3e37cada63fb069e596a8c0198b3d54330b0d5de7c0275ffbb1e1cc5326a865c2acb820488f5d0795b0bb03f8ebe6a4792dde26488661b78258d'
            '0643f12d1571e2392b553008c60f314e2a13a94abf58709a60cf03e2d430af2ac7c13524b1a142230815288bfd94018cae8abd0c727f24e8e9d7b45c8d64859e')

build() {
    # Get binary sources.
    tar -xzf yacreader-$pkgver.tar.gz
    mv "YACReader-$pkgver X11-x64-qt4" "YACReader"
}
package() {
    install -d $pkgdir/{opt,usr/bin,usr/lib}
    # Install files.
    cd $srcdir
    cp -R $srcdir/YACReader $pkgdir/opt
    chmod 777 -R $pkgdir/opt/YACReader
    # Make YACReader binaries executable.
    chmod 755 $pkgdir/opt/YACReader/YACReader{,Library}
    # Install desktop files
    install -D -m644 yacreader.desktop $pkgdir/usr/share/applications/yacreader.desktop
    install -D -m644 yacreaderlibrary.desktop $pkgdir/usr/share/applications/yacreaderlibrary.desktop

    # Create symlinks
    ln -s /opt/YACReader/YACReader{,Library} $pkgdir/usr/bin/
    ln -s /usr/lib/libpoppler-qt4.so $pkgdir/usr/lib/libpoppler-qt4.so.3
}