# Maintainer: caus909 <contact "at" caus909 "dot" net>
# Contributor: Mathieu Clabaut <mathieu "dot" clabaut "at" systerel.fr>

pkgname=atelierb
_majver=4.2
pkgver=${_majver}.0
pkgrel=1
pkgdesc="the industrial tool to efficiently deploy the B Method"
arch=('i686' 'x86_64')
url="http://www.atelierb.eu"
license=('custom')
if [ "$CARCH" = "x86_64" ]; then
  _pkgarch=_x64
  sha256sums=('4ddc698d530712ca7ed7c02ba9b9d86590601a7e656650aec95723523f8e7d30'
              '55bf266ab8f87d752c38127a1afbca8df325f926a5817f29b10f0b1c2c1cf150'
              'SKIP')
else
  _pkgarch=
  sha256sums=('c18060cde98ab512285bfe92df2d02f147eb2040f4edc1dd05248ca44d4a1a06'
              '55bf266ab8f87d752c38127a1afbca8df325f926a5817f29b10f0b1c2c1cf150'
              'SKIP')
fi
depends=('libxrandr' 'libxcursor' 'libxinerama' 'fontconfig' 'libsm')

optdepends=('texlive-bin' 'firefox')
install=atelierb.install
source=(http://www.atelierb.eu/atelier-b/${_majver}/free/atelierb-free-${pkgver}-linux${_pkgarch}.deb
	AtelierB.desktop
	license.pdf)



package() {
  install -m755 -d "${pkgdir}"/opt/atelierb/
  DEST="${pkgdir}"/opt/atelierb/"${pkgver}"
  FINALDEST=/opt/atelierb/"${pkgver}"
  mkdir -p $DEST
  cd $DEST
  ar vx "${srcdir}"/atelierb-free-"${pkgver}"-linux"${_pkgarch}".deb
  tar xfz data.tar.gz
  mv ./opt/atelierb-"${_majver}"/* $DEST
  rm -fr data.tar.gz control.tar.gz debian-binary opt
  install -m755 -d "${pkgdir}"/usr/share/applications/
  sed -i -e "s+/opt/atelierb-${_majver}+$FINALDEST+g" $DEST/AtelierB $DEST/start*
  cp "${srcdir}"/AtelierB.desktop "${pkgdir}"/usr/share/applications/
  sed -i -e "s+4.1.0+${pkgver}+g" "${pkgdir}"/usr/share/applications/AtelierB.desktop
}
# vim:set ts=2 sw=2 et:
