# Maintainer: Adam Hani Schakaki (krzd) <krzd@krzd.net>
# Contributor: Det <nimetonmaili at gmail a-dot com>
# Contributor: Michael Kanis <mkanis_at_gmx_dot_de>
# Contributor: lh <jason52lh AT gmail.com>

pkgname=mutter
pkgver=2.91.6
_majorver=(`echo $pkgver | egrep -o '[0-9]+\.[0-9]*+'`)
pkgrel=1
pkgdesc="The next-gen WM for GNOME, with compositing by clutter"
arch=('i686' 'x86_64')
license=('GPL')
url="http://www.gnome.org"
depends=('libcanberra-gtk3' 'clutter' 'gconf>=2.28.0' 'startup-notification' 'zenity>=2.28.0' 'gtk3')
makedepends=('gnome-doc-utils>=0.16.0' 'gobject-introspection>=0.9.8' 'glproto' 'intltool')
options=(!libtool !emptydirs)
install=mutter.install
source=("http://ftp.gnome.org/pub/gnome/sources/$pkgname/$_majorver/$pkgname-$pkgver.tar.bz2")
sha256sums=(`wget ${source/.t*}.sha256sum -qO - | grep tar.bz2 | cut -d " " -f1`)

build() {
  cd "$pkgname-$pkgver"

  ./configure --prefix=/usr --sysconfdir=/etc \
        --libexecdir=/usr/lib/mutter \
        --localstatedir=/var --disable-static

  make
}

package() {
  cd "${pkgname}-${pkgver}"
  make GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1 DESTDIR="$pkgdir" install

  install -m755 -d "$pkgdir/usr/share/gconf/schemas"
  gconf-merge-schema "$pkgdir/usr/share/gconf/schemas/$pkgname.schemas" --domain metacity "$pkgdir/etc/gconf/schemas/*.schemas"
  rm -f "$pkgdir/etc/gconf/schemas/*.schemas"
}
