# Contributor: rabyte <rabyte__gmail>

pkgname=o2em
pkgver=1.18
pkgrel=2
pkgdesc="An emulator of the Magnavox Odyssey2 videogame console"
arch=('i686')
url="http://o2em.sourceforge.net/"
license=('custom')
depends=('allegro')
source=(http://downloads.sourceforge.net/$pkgname/o2em118src.zip \
	patch.diff)
md5sums=('be96af886370df337fe8584827717627'
         '7ad5bd1be3a2d8a74d143163a231383e')

build() {
	cd ${srcdir}/o2em118src/SRC

	for i in *; do
		mv -f $i $(echo $i | tr '[A-Z]' '[a-z]') || continue
	done

	patch -Np0 -i ${srcdir}/patch.diff || return 1

	make -f makefile.linux CFLAGS="-Wall -fomit-frame-pointer \
		-I/usr/include" LIBALLEG="`allegro-config --libs`" || return 1
}

package() {
	cd ${srcdir}/o2em118src/SRC

	mkdir -p ${pkgdir}/usr/bin
	install -m755 o2em dis48 ${pkgdir}/usr/bin/

	install -Dm644 ../Docs/LICENSE.TXT \
  		${pkgdir}/usr/share/licenses/${pkgname}/LICENSE
	install -Dm644 o2em.png ${pkgdir}/usr/share/pixmaps/o2em.png
}
