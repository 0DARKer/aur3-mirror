# Maintainer: birdflesh <antkoul at gmail dot com>
# Contributor: said
# Contributor: Panagiotis Papadopoulos <pano_90 AT gmx DOT net>

pkgname=kamoso
pkgver=2.0.2git20130929
pkgrel=2
pkgdesc="An application to take pictures and videos out of your webcam for KDE"
arch=('i686' 'x86_64')
url="https://projects.kde.org/kamoso"
license=('GPL')
depends=('kdebase-runtime' 'qt-gstreamer' 'libkipi')
makedepends=('cmake' 'automoc4' 'boost')
optdepends=('kipi-plugins: Facebook support')
conflicts=('kamoso-git')
source=("$pkgname-$pkgver.tar.gz"::"http://quickgit.kde.org/?p=kamoso.git&a=snapshot&h=e9dab44d9588af5808b7b1a33cd37b9f9a3a3fa5&fmt=tgz"
        'gstreamer-1.0-port.patch')
install=$pkgname.install
md5sums=('d6d086dc5274973033a6be7b5de449d9'
         '0bc87203c9b91db89d5b05e83caacc4b')
         
build() {
  # Patch from https://git.reviewboard.kde.org/r/118979/diff/3/ please test.
  cd "$srcdir/$pkgname"
  patch -p1 -i "$srcdir/gstreamer-1.0-port.patch"

  cd "$srcdir"
  mkdir build
  cd build
  cmake ../$pkgname \
    -DQT_QMAKE_EXECUTABLE=qmake-qt4 \
    -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_INSTALL_PREFIX=/usr
  make
}

package(){
  cd "$srcdir/build"
  make DESTDIR="$pkgdir" install
}
