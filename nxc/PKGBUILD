pkgname=nxc  
pkgver=1.0.1.b35
pkgrel=1 
pkgdesc="Not eXactly C -- to program LEGO's NXT programmable brick"
url="http://bricxcc.sourceforge.net/nbc"
arch=('i686' 'x86_64')
license=('GPL')
depends=('libusb')
makedepends=('fpc' 'lazarus')
source=(http://downloads.sourceforge.net/bricxcc/nbc-${pkgver}.src.tgz 'amd64.patch' 'link_libusb.patch')
md5sums=('2a85611dbefc240013708ed740c80de4' '5ebce437e1bcee397c5b6eb663da5287' '6869f123c3fc591d2921d5ab03feb608')
noextract=("nbc-$pkgver.src.tgz")
build() {
	cd $srcdir
	install -d nbc
	tar xzf nbc-$pkgver.src.tgz -C nbc
	cd nbc
	patch -p1 < ../link_libusb.patch
	[[ $CARCH = x86_64 ]] && patch -p1 < ../amd64.patch || return 1
	cd nxt
	make -f nbclinux.mak || return 1
	install -D -m755 nbc $pkgdir/usr/bin/nbc || return 1
}
