# Contributor: scj <scj(at)archlinux(dot)com>
pkgname=irssi-xmpp-cvs
pkgver=20081118
pkgrel=1
pkgdesc="irssi plugin to connect to the Jabber network"
arch=('i686')
url="http://cybione.org/~irssi-xmpp/"
provides=('irssi-xmpp')
license=('GPL2')
conflicts=('irssi-xmpp')
depends=('loudmouth' 'irssi')
makedepends=('cvs')
install=
source=()
md5sums=()

_cvsroot=":pserver:anonymous@cvs.gna.org:/cvs/irssi-xmpp"
_cvsmod="irssi-xmpp"

build() {
  cd "$srcdir"
  msg "Connecting to $_cvsmod.sourceforge.net CVS server...."
  if [ -d $_cvsmod/CVS ]; then
    cd $_cvsmod
    cvs -z3 update -d
  else
    cvs -z3 -d $_cvsroot co -D $pkgver -f $_cvsmod
    cd $_cvsmod
  fi

  msg "CVS checkout done or server timeout"
  msg "Starting make..."

  rm -r "$srcdir/$_cvsmod-build"
  cp -r "$srcdir/$_cvsmod" "$srcdir/$_cvsmod-build"
  cd "$srcdir/$_cvsmod-build"
  cd "$startdir/src/$pkgname-$pkgver"
  IRSSI_INCLUDE=/usr/include/irssi make || return 1
  DESTDIR=$pkgdir PREFIX=/usr make install
}
# vim:set ts=4 sw=4 et:

