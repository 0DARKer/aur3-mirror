# Maintainer:  swanson <webaake gmail com>
# Contributor: swanson

pkgname=mousepad-git
pkgver=20110729
pkgrel=1
pkgdesc="Mousepad from git with patch for recent items and newer translations"
arch=('i686' 'x86_64')
url="http://www.xfce.org/"
license=('GPL')
depends=('desktop-file-utils' 'gtk2' 'hicolor-icon-theme')
makedepends=('xfce4-dev-tools' 'git' 'pkgconfig>=0.9.0')
optdepends=('libgnomeprintui: for printing support')
provides=('mousepad')
conflicts=('mousepad')
install=mousepad.install
md5sums=('c9c7c6fc12dfe870a44cf25d385ab0d1')
source=('rec_item.patch')


_gitroot="http://git.xfce.org/apps/mousepad/"
_gitname="mousepad"

build() {
  cd "${srcdir}"
  msg "Connecting to GIT server...."

  if [ -d ${_gitname} ] ; then
    cd ${_gitname} && git pull origin
    msg "The local files are updated."
  else
    git clone ${_gitroot} ${_gitname}
  fi

#  msg "GIT checkout done or server timeout"
#  msg "Starting make..."

rm -rf "${srcdir}/${_gitname}-build"
git clone "${srcdir}/${_gitname}" "${srcdir}/${_gitname}-build"
cd "${srcdir}/${_gitname}-build"

#msg "Patching Recent Items bug"
#msg "Thanks to Lionel le Folgoc (https://bugzilla.xfce.org/show_bug.cgi?id=5635)"
patch -p1 -i ../rec_item.patch

export "DESTDIR=$pkgdir"

sh autogen.sh --prefix=/usr 
make || return 1 
make install || return 1
}
