# Maintainer: Joermungand <joermungand at gmail dot com>

pkgname=infamousplugins
pkgver=0.0.20
pkgrel=1
pkgdesc="A collection of open-source LV2 plugins"
arch=('i686' 'x86_64')
url="http://infamousplugins.sourceforge.net"
license=('GPL2')
groups=('lv2-plugins')
depends=('glibc')
makedepends=('qt4' 'lv2')
provides=('infamousplugins')
conflicts=('infamousplugins')
source=("http://downloads.sourceforge.net/project/$pkgname/$pkgname-code-v$pkgver.tar.bz2")
md5sums=('265fdcee4c19c87b5665cd5aef5f6c6c')

build() {
    cd "$srcdir"
    cd src/CellularAutomatonSynth
    qmake-qt4
    make
    cd ..
    mkdir -p ../utils
    gcc rule.c -o ../utils/infamous-rule
    cd EnvelopeFollower
    cp ../Stuck/rms_calc.* ./
    qmake-qt4
    make
    cd ../Hip2B
    qmake-qt4
    make
    cd ../Stuck
	qmake-qt4
	make
	cd ../PowerCut
	qmake-qt4
	make
    cd ../cheap_distortion
    make
}

package() {
    cd "$srcdir/src"
    mkdir -p "$pkgdir/usr/lib/lv2"
    cp -Rf CellularAutomatonSynth/casynth.lv2 "$pkgdir/usr/lib/lv2/"
    cp -Rf EnvelopeFollower/envfollower.lv2 "$pkgdir/usr/lib/lv2/"
    cp -Rf Hip2B/hip2b.lv2 "$pkgdir/usr/lib/lv2/"
    cp -Rf Stuck/stuck.lv2 "$pkgdir/usr/lib/lv2/"
    cp -Rf PowerCut/powercut.lv2 "$pkgdir/usr/lib/lv2/"
    mkdir "$pkgdir/usr/lib/lv2/cheap_distortion.lv2"
    cp cheap_distortion/manifest.ttl "$pkgdir/usr/lib/lv2/cheap_distortion.lv2/"
    cp cheap_distortion/plugin.ttl "$pkgdir/usr/lib/lv2/cheap_distortion.lv2/cheap_distortion.ttl"
    cp cheap_distortion/cheap_distortion.so "$pkgdir/usr/lib/lv2/cheap_distortion.lv2/"
    cd ..
    mkdir -p "$pkgdir/usr/bin"
    cp utils/infamous-rule "$pkgdir/usr/bin/"
    mkdir -p "$pkgdir/usr/share/doc/$pkgname"
    cp CHANGELOG "$pkgdir/usr/share/doc/$pkgname/"
    cp COPYING "$pkgdir/usr/share/doc/$pkgname/"
    chmod a+r "$pkgdir/usr/share/doc/$pkgname/COPYING"
    cp README  "$pkgdir/usr/share/doc/$pkgname/"
}

