# Maintainer: archtux <antonio dot arias99999 at gmail dot com>

pkgname=danbooru-client
pkgver=1.0.2
pkgrel=1
pkgdesc="Application to access Danbooru-based image boards."
arch=('any')
url="http://www.dennogumi.org/projects/danbooru-client"
license=('GPL2')
depends=('kdebase-lib' 'kdebindings-python' 'python2')
makedepends=('cmake>=2.6' 'automoc4')
conflicts=('danbooru-git')
source=(http://www.kde-apps.org/CONTENT/content-files/114343-$pkgname-$pkgver.tar.gz
        http://gitorious.org/danbooru-client/danbooru-client/blobs/raw/9fb3c75e772933282fcce92a0d0e91a1daf03ad8/danbooru/fetchdialog.py)
md5sums=('9a0f48631cdd1266f7adba782596a972'
         'bd6fb5fdb0e7f9e4b4cabcb3fcadcfdc')

build() {
  cd $srcdir/$pkgname-$pkgver

   # Desktop file fix
   sed -i 's_danbooru\_client_python2 /usr/bin/danbooru\_client_' danbooru_client.desktop

   cmake -DCMAKE_INSTALL_PREFIX=`kde4-config --prefix` \
	 -DPYTHON_LIBRARY=/usr/lib/libpython2.7.so \
	 -DPYTHON_EXECUTABLE=/usr/bin/python2 \
	 -DPYTHON_SITE_PACKAGES_DIR=/usr/lib/python2.7/site-packages
   make
   make DESTDIR=$pkgdir install

   # Fixes
   cp danbooru/ui/ui_fetchdialog.py $pkgdir/usr/lib/python2.7/site-packages/danbooru/ui
   cp $startdir/fetchdialog.py $pkgdir/usr/lib/python2.7/site-packages/danbooru
   }
