# Maintainer: Somebody <somebody[at]foo[dot]tld>
pkgname=repetier-host
pkgver=0.90c
pkgrel=1
pkgdesc="nearly complete 3d-printing workflow"
url=('http://www.repetier.com/')
arch=('x86_64' 'i686')
license=('custom')
depends=('mono' 'slic3r')
source=("http://www.repetier.com/?wpdmact=process&did=NDAuaG90cGluaw==" "slic3r.pl")
PKGEXT=".pkg.tar"

build() {
cd ${srcdir}/RepetierHost/
MACHINE_TYPE=`uname -m`
DIR=/usr/share/repetierHost

echo "#!/bin/sh" > repetierHost
echo "cd ${DIR}" >> repetierHost
echo "mono RepetierHost.exe -home ${DIR}&" >> repetierHost
chmod 755 repetierHost
chmod a+rx ../RepetierHost
chmod -R a+r *
chmod -R a+x data
chmod a+x installDep*
rm -r Slic3r/*
rm configureFirst.sh
rm installDependenciesDebian
rm installDependenciesFedora
#ln -s /usr/bin/vendor_perl/slic3r.pl Slic3r/slic3r.pl
install -Dm755 ${srcdir}/slic3r.pl ${srcdir}/RepetierHost/Slic3r/slic3r.pl
}

package() {
mkdir -p $pkgdir/usr/share/
mkdir -p $pkgdir/usr/bin
ln -s /usr/share/repetierHost/repetierHost $pkgdir/usr/bin/repetierHost

install -Dm644 ${srcdir}/RepetierHost/Repetier-Host-licence.txt "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
rm ${srcdir}/RepetierHost/Repetier-Host-licence.txt
cp -a ${srcdir}/RepetierHost $pkgdir/usr/share/repetierHost
}

# vim:set ts=2 sw=2 et:
md5sums=('794486034f7bfa2ed7d7b4ba0ca0321a'
         'efad93131ffb367494f6059a43dcebc6')
