--- src/rr231x_0x-linux-src-v2.5/osm/linux/osm_linux.c        2009-07-15 22:28:28.000000000 -0300
+++ src/rr231x_0x-linux-src-v2.5/osm/linux/osm_linux.c        2011-03-19 20:27:49.000000000 -0300
@@ -875,7 +875,7 @@
        }
 }

-static int hpt_queuecommand (Scsi_Cmnd * SCpnt, void (*done) (Scsi_Cmnd *))
+static int hpt_queuecommand_lck (Scsi_Cmnd * SCpnt, void (*done) (Scsi_Cmnd *))
 {
        struct Scsi_Host *phost = sc_host(SCpnt);
        PVBUS_EXT vbus_ext = get_vbus_ext(phost);
@@ -1409,6 +1409,12 @@
        return 0;
 }

+#ifdef DEF_SCSI_QCMD
+DEF_SCSI_QCMD(hpt_queuecommand)
+#else
+#define hpt_queuecommand hpt_queuecommand_lck
+#endif
+
 static int hpt_reset (Scsi_Cmnd *SCpnt)
 {
        PVBUS_EXT vbus_ext = get_vbus_ext(sc_host(SCpnt));

src/rr231x_0x-linux-src-v2.5/osm
