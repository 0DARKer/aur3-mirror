# Contributor: max-k <max-k@post.com>

if [ $(uname -m) = "x86_64" ] ; then
	_arch="x86_64"
else
	_arch="x86"
fi

_branch="trunk"
_major="6.0.2"
_state=""
_separator1="" #if $_state is set (eg. alpha1 or beta2), $_separator1 must be set to "_", else it must *not* be set.
_separator2="" #if $_state is set (eg. alpha1 or beta2), $_separator2 must be set to "-", else it must *not* be set.
_minor=6757
_year=2010
_month=11
_day=24
_rlsnbr=00

pkgname="komodoedit-nightly"
pkgver="${_major}_${_state}${_separator1}${_minor}"
pkgrel=1
pkgdesc="Open-Source version of ActiveState Komodo IDE - Based on XUL"
arch=(i686 x86_64)
url="http://www.openkomodo.com/"
license=('MPL')
depends=('glibc>=2.4' 'libjpeg>=6.2' 'gcc-libs' 'gtk2')
optdepends=('python: to run what you code')
conflicts=('komodoedit' 'komodoedit-beta')

source=("http://downloads.activestate.com/Komodo/nightly/komodoedit/${_year}/${_month}/${_year}-${_month}-${_day}-${_rlsnbr}-${_branch}/Komodo-Edit-${_major}-${_state}${_separator2}${_minor}-linux-libcpp6-${_arch}.tar.gz")

if [ $_arch = "x86_64" ] ; then
	md5sums=('38015f034e912f6c8c8fca76611048f9')
else
	md5sums=('d23ef72834e7147360c950e637cf4a28')
fi

build() {
	cd ${startdir}/src/Komodo-Edit-${_major}-${_state}${_separator2}${_minor}-linux-libcpp6-${_arch}
	./install.sh -s -I ${startdir}/pkg/opt/${pkgname}
	grep -v ${startdir} ${startdir}/pkg/opt/${pkgname}/share/desktop/komodo-edit-5.desktop > ${startdir}/${pkgname}.desktop
	echo "Exec=/opt/${pkgname}/bin/komodo %F" >> ${startdir}/${pkgname}.desktop
	echo "Icon=/opt/${pkgname}/share/icons/komodo16.png" >> ${startdir}/${pkgname}.desktop
	install -D -m 644 ${startdir}/${pkgname}.desktop ${startdir}/pkg/usr/share/applications/${pkgname}.desktop
}
