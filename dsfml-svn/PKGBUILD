# Contributor: Dustin Mays <dork.fish.wat@gmail.com>

pkgname=dsfml-svn
pkgver=998
pkgrel=1
pkgdesc="D binding for SFML."
arch=('i686' 'x86_64')
url="http://www.sfml-dev.org"
license=('zlib')
depends=('csfml-svn')
makedepends=('dsss')
conflicts=('dsfml')
provides=('dsfml')
source=()
md5sums=()

_svntrunk=https://sfml.svn.sourceforge.net/svnroot/sfml
_svnmod=sfml

build() {
  cd ${srcdir}

  if [ -d $_svnmod/.svn ]; then
    (cd $_svnmod && svn up -r $pkgver && cd ${srcdir})
  else
    svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
  fi

  msg "SVN checkout done or server timeout."

  cp -r $_svnmod $_svnmod-build
  find ./ -name ".svn" | xargs rm -Rf
  cd $_svnmod-build/DSFML/import

  msg "Starting dsss build."
  dsss build || return 1
  cp ../lib/*.a .
  dsss install --prefix=${pkgdir}/usr || return 1
  chmod +r ${startdir}/pkg/usr/share/dsss/manifest/dsfml.manifest
  cd ${pkgdir}/usr/lib

  rm -rf ${srcdir}/$_svnmod-build
}

# vim:syntax=sh
