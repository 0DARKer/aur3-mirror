# Maintainer: Giuseppe Cal√† <jiveaxe@gmail.com>
# Contributer: giacomogiorgianni@gmail.com 

pkgname=grive
pkgver=0.1.1
pkgrel=1
pkgdesc="Open source Linux client for Google Drive"
arch=('i686' 'x86_64')
url="http://match065.github.com/grive/"
license=('GPL')
categories=('network')
depends=('gcc-libs' 'curl' 'json-c' 'openssl' 'boost')
makedepends=('cmake' 'cppunit')
options=(!emptydirs)
source=("${pkgname}-${pkgver}-src.tar.gz::https://nodeload.github.com/Grive/grive/tarball/master")

md5sums=('65f416c7573ce20fe30ce65bafdaeec0')

build() {
  cd "$srcdir/Grive-grive-6d50a0f"
 
  rm -rf build
 
  mkdir build
 
  cd build
 
  cmake .. -DCMAKE_BUILD_TYPE=Release \
           -DCMAKE_INSTALL_PREFIX=/usr 

  sed -i '5s/-pipe/-pipe -fpermissive/' "$srcdir/Grive-grive-6d50a0f/build/libgrive/CMakeFiles/unittest.dir/flags.make"
  sed -i '5s/-pipe/-pipe -fpermissive/' "$srcdir/Grive-grive-6d50a0f/build/libgrive/CMakeFiles/grive.dir/flags.make"
  make
  make DESTDIR="$pkgdir/" install
}
 
#package() {
#    install -dm 755 $pkgdir/usr/bin
#    cp "$srcdir/match065-grive-c01ace7/build/grive" $pkgdir/usr/bin
#}