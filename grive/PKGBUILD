# Maintainer: Giuseppe Cal√† <jiveaxe@gmail.com>
# Contributer: giacomogiorgianni@gmail.com 

pkgname=grive
pkgver=0.1.0
pkgrel=1
pkgdesc="Open source Linux client for Google Drive"
arch=('i686' 'x86_64')
url="http://match065.github.com/grive/"
license=('GPL')
categories=('network')
depends=('gcc-libs' 'curl' 'json-c' 'openssl' 'boost')
makedepends=('cmake' 'cppunit')
options=(!emptydirs)
source=("match065-${pkgname}-${pkgver}-tag-15-g197abfd.tar.gz::https://nodeload.github.com/match065/grive/tarball/master")

md5sums=('bef4eeb9ba4f80c62c3bcc9fdc7165e8')

build() {
  cd "$srcdir/match065-grive-197abfd"
 
  rm -rf build
 
  mkdir build
 
  cd build
 
  cmake .. -DCMAKE_BUILD_TYPE=Release \
           -DCMAKE_INSTALL_PREFIX=/usr 

  sed -i '5s/-pipe/-pipe -fpermissive/' "$srcdir/match065-grive-197abfd/build/libgrive/CMakeFiles/unittest.dir/flags.make"
  sed -i '5s/-pipe/-pipe -fpermissive/' "$srcdir/match065-grive-197abfd/build/libgrive/CMakeFiles/grive.dir/flags.make"
  make
  make DESTDIR="$pkgdir/" install
}
 
#package() {
#    install -dm 755 $pkgdir/usr/bin
#    cp "$srcdir/match065-grive-c01ace7/build/grive" $pkgdir/usr/bin
#}