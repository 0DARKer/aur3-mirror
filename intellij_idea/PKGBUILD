# Maintainer: Alexsandr Pavlov <kidoz at mail dot ru>
pkgname=intellij_idea
_pkgname=idea-IU
pkgver=12.0
_pkgver=123.72
pkgrel=1
pkgdesc="The most intelligent Java IDE."
arch=('i686' 'x86_64')
url="http://www.jetbrains.com/idea"
license=('custom')
depends=('java-environment')
source=(http://download.jetbrains.com/idea/ideaIU-${pkgver}.tar.gz
         intellij_idea
         intellij_idea.desktop)
    
md5sums=('e10609df4796f86d4b845bfede5a89f5'
         '8c1ab687c74a08305ba82706808f5bf0'
         '1f4763a5b2909507a915be70f534716f')
sha512sums=('ca8f941c9b95494a65a8a066ac19739b19384c406e1fd010d8c23e3795db0d3862913c9b813235329efa7eb6fea9f492b62735ec4c75c86539bbaa5c09d0a7b1'
            '23b7ab503a8d3f82fe6ab8cb4585d0249c7cd26497f1a618ca553547f2a38a56d6beea42fcc4e6acc9ac3b141c4060142ef1615a86e12c1092a1a6b6d4fc53c4'
            '0caa1647b27b7e77930989d350cbb9fe949df6b6e893a2bc2db6dfedd3e9fc7af3c4d5c1648d8e6b9e6a2adbd8a9a62aaf4e8b972779a89d2b4a7ff1701f00a6')

build() {
  cd "${srcdir}"
  mkdir -p "${pkgdir}/opt/${pkgname}" || return 1
  cp -r ${srcdir}/${_pkgname}-${_pkgver}/* "${pkgdir}/opt/${pkgname}" || return 1
  if [[ $CARCH = 'i686' ]]; then
    rm -f "${pkgdir}/opt/${pkgname}/bin/libyjpagent-linux64.so"
    rm -f "${pkgdir}/opt/${pkgname}/bin/libbreakgen64.so"
    rm -f "${pkgdir}/opt/${pkgname}/bin/fsnotifier64"
  fi
  if [[ $CARCH = 'x86_64' ]]; then
    rm -f "${pkgdir}/opt/${pkgname}/bin/libyjpagent-linux.so"
    rm -f "${pkgdir}/opt/${pkgname}/bin/libbreakgen.so"
    rm -f "${pkgdir}/opt/${pkgname}/bin/fsnotifier"
  fi

  mkdir -p "${pkgdir}/usr/bin" || return 1
  mkdir -p "${pkgdir}/usr/share/applications" || return 1
  mkdir -p "${pkgdir}/usr/share/pixmaps" || return 1
  mkdir -p "${pkgdir}/usr/share/licenses/${pkgname}" || return 1
  install -m 644 "${startdir}/${pkgname}.desktop" "${pkgdir}/usr/share/applications" || return 1
  install -m 644 "${pkgdir}/opt/${pkgname}/bin/idea.png" "${pkgdir}/usr/share/pixmaps/${pkgname}.png" || return 1
  install -m 644 "${srcdir}/${_pkgname}-${_pkgver}/license/IDEA_license.txt" "${pkgdir}/usr/share/licenses/${pkgname}/${_pkgname}_license.txt" || return 1
  install -m 755 "${startdir}/${pkgname}" "${pkgdir}/usr/bin" || return 1
}

