# Maintainer: archtux <antonio.arias99999@gmail.com>

pkgname=pysoulseek
pkgver=1.2.7c
pkgrel=1
pkgdesc="Soulseek music-sharing client"
arch=('i686' 'x86_64')
url="http://sensi.org/~ak/pyslsk/"
license=('GPL2')
depends=('pyvorbis' 'wxpython')
source=(http://sensi.org/~ak/pyslsk/pyslsk-$pkgver.tar.gz)
md5sums=('65b1849eb7fe8c3552e3dea6843b53b7')

build() {
  cd $srcdir/pyslsk-$pkgver

  # Python2 fix
  sed -i 's_#!/usr/bin/env python_#!/usr/bin/env python_' encode_bitmaps.py pyslsk
  sed -i 's_#!/usr/local/bin/python_#!/usr/local/bin/python2_' setup.py

  # wxPython fix
  sed -i 's_rel\ =\ wxPython.wx.wxRELEASE\_NUMBER_rel\ =\ 1_' pyslsk

  # Install
  python2 setup.py install --root=$pkgdir/ --optimize=1

  # Desktop icon
  install -Dm644 ./img/bird.jpg $pkgdir/usr/share/pixmaps/pysoulseek.jpg
  install -Dm644 $startdir/pysoulseek.desktop $pkgdir/usr/share/applications/pysoulseek.desktop
}