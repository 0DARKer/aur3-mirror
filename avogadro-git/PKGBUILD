# Based on the avogadro PKGBUILD in [extra].

pkgname=avogadro-git
pkgver=20121207
pkgrel=3
pkgdesc="An advanced molecular editor based on Qt"
arch=('i686' 'x86_64')
url="http://avogadro.openmolecules.net/wiki/Main_Page"
license=('GPL2')
depends=('eigen2' 'openbabel' 'python2-pyqt' 'boost-libs' 'glew' 'python2-numpy')
makedepends=('cmake' 'boost' 'doxygen')
conflicts=('avogadro')
provides=('avogadro')

_gitroot="git://github.com/cryos/avogadro.git"
_gitname="avogadro"


build() {
  cd "$srcdir"

  if [ -d "$srcdir/$_gitname" ] ; then
    cd "$_gitname" && git pull origin
   else
    git clone "$_gitroot"
  fi

  mkdir -p "$srcdir/$_gitname-build"
  cd "$srcdir/$_gitname-build"


  cmake "../${_gitname}" \
    -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DPYTHON_EXECUTABLE=/usr/bin/python2 \
    -DQT_MKSPECS_RELATIVE=share/qt/mkspecs
  make
}

package() {
  cd "$srcdir/$_gitname-build"
  make DESTDIR="$pkgdir" install
}
