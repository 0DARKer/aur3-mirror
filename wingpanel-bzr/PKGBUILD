# Maintainer: Dan Serban
# Contributors: Flamelab, friver, crazyelf5

pkgname=wingpanel-bzr
pkgver=latest
pkgrel=1
pkgdesc="A space-saving top panel by the Elementary project"
arch=(i686 x86_64)
url=https://launchpad.net/wingpanel
license=(GPL)
depends=(glib2 libgee libindicator)
makedepends=(bzr gettext intltool vala)
options=('!libtool' '!emptydirs')
install=${pkgname}.install

_bzrtrunk=lp:wingpanel
_bzrmod=wingpanel

build()
{
  msg "Connecting to Launchpad..."
  if [ -d ${_bzrmod} ]; then
    bzr up ${_bzrmod}
    msg2 "The local files have been updated."
  else
    bzr branch ${_bzrtrunk}
  fi
  msg2 "BZR checkout done or server timeout"
  [ -d ${_bzrmod}-build ] && rm -r ${_bzrmod}-build
  cp -a ${_bzrmod} ${_bzrmod}-build
  cd ${_bzrmod}-build
  mkdir build
  cd build
  cmake .. -DCMAKE_INSTALL_PREFIX=/usr
  make
  make DESTDIR="${pkgdir}" install
  mkdir -p "${pkgdir}"/usr/lib/indicators3/6
}

