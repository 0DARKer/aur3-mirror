#Contributor: Javier 'Phrodo_00' Aravena <javier@aravenas.com>
pkgname=awib
pkgver=0.2
pkgrel=1
pkgdesc="Brainfuck compiler for i386 written in brainfuck"
url="http://code.google.com/p/awib/"
license="GPL3"
arch=('x86_64' 'i686')
depends=()
makedepends=('sed')
install=awib.install
source=("http://${pkgname}.googlecode.com/files/${pkgname}-${pkgver}.tar.gz")
md5sums=('dd475e5742d013a92f326bfb04084b91')

build() {
	cd $srcdir/$pkgname-$pkgver/util
    make

	cd $srcdir/$pkgname-$pkgver
    make
    util/bfint8 awib.b < awib.b > awib.c
    gcc -s -O2 awib.c -o awib
    sed '1i#!/usr/bin/bfint8' awib.b > awib-bin.b

    install -d -m755 $pkgdir/usr/bin
    install -m755 util/bfint{8,16,32,64} awib $pkgdir/usr/bin
    install -m755 awib-bin.b $pkgdir/usr/bin/awib.b

    install -d -m755 $pkgdir/usr/share/doc/awib
    head -n13 util/bfint.c|sed -e 's/^...//' -e '/\*/d' > $pkgdir/usr/share/doc/awib/bfint.README
    install -m644 README $pkgdir/usr/share/doc/awib/awib.README
}
