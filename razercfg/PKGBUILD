# Maintainer: Fergus Symon <fergofrog at fergofrog dot com>
pkgname=razercfg
pkgver=0.11
pkgrel=1
pkgdesc="A Razer device configuration tool."
arch=('any')
url="http://bu3sch.de/joomla/index.php/razer-nextgen-config-tool"
license=('GPL')
depends=('python2' 'libusb')
makedepends=('cmake')
optdepends=('python2-qt: for the graphical qrazercfg tool')
install=('razercfg.install')
source=(http://bu3sch.de/razercfg/$pkgname-$pkgver.tar.bz2
        razercfg.desktop
        razerd
        razercfg-python2.patch)
md5sums=('cc5f2ebc1127fdb4a85a3c0db84c02be'
         '1eab70090396d3af15e55228af71c968'
         '73574642df956f0c6848cb1096d45897'
         '911bccb480fe6b51557b533b114b8337')
         
build() {
  cd "$srcdir"
  
  patch -p0 -i razercfg-python2.patch
  sed 's/-O2/-O0/g' -i razercfg-0.11/scripts/cmake.global
  
  cd "$pkgname-$pkgver"
  
  cmake -DCMAKE_INSTALL_PREFIX=/usr . || return 1
  make || return 1
  make DESTDIR="$pkgdir" install || return 1
  
  install -m755 -d $pkgdir/etc/rc.d || return 1
  install -m755 $startdir/razerd $pkgdir/etc/rc.d || return 1
  
  install -m755 -d $startdir/pkg/usr/share/applications || return 1
  install -m644 $startdir/razercfg.desktop $startdir/pkg/usr/share/applications || return 1
}
