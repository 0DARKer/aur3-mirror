# Maintainer: Fergus Symon <fergofrog at fergofrog dot com>
pkgname=razercfg
pkgver=0.16
pkgrel=1
pkgdesc="A Razer device configuration tool."
arch=('any')
url="http://bu3sch.de/joomla/index.php/razer-nextgen-config-tool"
license=('GPL')
depends=('python2' 'libusb')
makedepends=('diffutils' 'patch' 'cmake')
optdepends=('python2-qt: for the graphical qrazercfg tool')
install=('razercfg.install')
source=(http://bu3sch.de/razercfg/$pkgname-$pkgver.tar.bz2
        razercfg.desktop
        razerd
        razercfg-$pkgver-python2.patch)
md5sums=('7cfc0f1dec0b505ab1da31ab86780871'
         '1eab70090396d3af15e55228af71c968'
         '73574642df956f0c6848cb1096d45897'
         '929333e4ee20c53d71dd8b0b571eaa0f')
         
build() {
  cd "$srcdir"
  
  patch -p0 -i razercfg-$pkgver-python2.patch
  #sed 's/-O2/-O0/g' -i razercfg-$pkgver/scripts/cmake.global
  
  cd "$pkgname-$pkgver"
  
  cmake -DCMAKE_INSTALL_PREFIX=/usr . || return 1
  make || return 1
  make DESTDIR="$pkgdir" install || return 1
  
  install -m755 -d $pkgdir/etc/rc.d || return 1
  install -m755 $startdir/razerd $pkgdir/etc/rc.d || return 1
  
  install -m755 -d $startdir/pkg/usr/share/applications || return 1
  install -m644 $startdir/razercfg.desktop $startdir/pkg/usr/share/applications || return 1
}
