# Contributor: larsrh <lars.hupel@gmx.de>
# Maintainer: Elkin Cruz <linuxero789@gmail.com>
pkgname=iron-bin
pkgver=11.0.700.2
pkgrel=1
pkgdesc="A fast web browser based on chromium without Google's tracking 'features'"
arch=('i686' 'x86_64')
url="http://www.srware.net/en/software_srware_iron.php"
license=('BSD')
depends=('alsa-lib' 'libpng12' 'nss' 'ttf-dejavu' 'libxss' 'gtk2')
install=$pkgname.install

# x86_64 source
[[ "$CARCH" == x86_64 ]] && _64=-64

source=(http://www.srware.net/downloads/iron-linux${_64}.tar.gz
        iron{.desktop,.png,.sh} LICENSE)

sha256sums=('3b4a211c652ac2f7e678be142981293bb3c7a7131f2fb6e630d39779832347cf'
            '4c46c4a5433efdf9d39a5cf43d22f4ed230d97e31db9734c2412cb56b7dac16c'
            '77c29198ff3079f4be5469023a5317c18dd7ef9ce34efd3ae4ca0be09d5de285'
            '746148eba30c710dd2ad091afae102bf609501ebbdf8e2633cc88f2fe5262189'
            'ec68693372a025d4cba5214a0b97c66ae62025c80cc34ef6c01c92b32bd0f2d6')

[[ "$CARCH" == x86_64 ]] && sha256sums[0]='c7eec19257527160c9ec4df11de6548201224e22dfdf81e8841555bc438b6d7f'

package() {
	install -Dm755 iron.sh "$pkgdir/usr/bin/iron"
	install -d "$pkgdir/opt"

	local suffix=
	[[ $CARCH = x86_64 ]] && suffix=-64

	mv iron-linux$suffix "$pkgdir/opt/iron"
	rm -f "$pkgdir/opt/iron/"{product_logo_48.png, README, xdg-settings}

	ln -s /lib/libBrokenLocale.so.1 "$pkgdir/opt/iron/libgconf-2.so.4"

	find "$pkgdir/opt/iron/" -type f -exec chmod 644 {} +
	find "$pkgdir/opt/iron/" -type d -exec chmod 755 {} +
	chmod a+x "$pkgdir/opt/iron/iron"
	chmod a+x "$pkgdir/opt/iron/libffmpegsumo.so"

	install -Dm644 iron.png "$pkgdir/usr/share/pixmaps/iron.png"
	install -Dm644 iron.desktop "$pkgdir/usr/share/applications/iron.desktop"
	install -Dm644 LICENSE "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}
