# Contributor: larsrh <lars.hupel@gmx.de>
# Maintainer: Elkin Cruz <linuxero789@gmail.com>
pkgname=iron-bin
pkgver=12.0.750.0
pkgrel=1
pkgdesc="A fast web browser based on chromium without Google's tracking 'features'"
arch=('i686' 'x86_64')
url="http://www.srware.net/en/software_srware_iron.php"
license=('BSD')
depends=('alsa-lib' 'libpng12' 'nss' 'ttf-dejavu' 'libxss' 'gtk2')
install=${pkgname}.install

# x86_64 source
[[ "$CARCH" == x86_64 ]] && _64=-64

source=(http://www.srware.net/downloads/iron-linux${_64}.tar.gz
        iron.{desktop,png,sh} LICENSE)

sha256sums=('8221206a47a125a3c0162770ec3765a9ae064fe5e80cc4b94d813ddbd956c947'
            '42eaae86b96ebae2ebfeb30397cf83b1e662e3ab31d5243c7b6d17137f5228f9'
            '77c29198ff3079f4be5469023a5317c18dd7ef9ce34efd3ae4ca0be09d5de285'
            '746148eba30c710dd2ad091afae102bf609501ebbdf8e2633cc88f2fe5262189'
            'ec68693372a025d4cba5214a0b97c66ae62025c80cc34ef6c01c92b32bd0f2d6')

[[ "$CARCH" == x86_64 ]] && sha256sums[0]='acea8dbae362f40448bff649d534fdd406d61242ca8c9bb3556500c0a39eb475'

package() {
	install -Dm755 iron.sh "${pkgdir}/usr/bin/iron"
	install -d "${pkgdir}/opt"

	local suffix=
	[[ $CARCH = x86_64 ]] && suffix=-64

	mv iron-linux${suffix} "${pkgdir}/opt/iron"
	rm -f "${pkgdir}/opt/iron/"{product_logo_48.png, README, xdg-settings}

	ln -s /lib/libBrokenLocale.so.1 "${pkgdir}/opt/iron/libgconf-2.so.4"

	find "${pkgdir}/opt/iron/" -type f -exec chmod 644 {} +
	find "${pkgdir}/opt/iron/" -type d -exec chmod 755 {} +
	chmod a+x "${pkgdir}/opt/iron/iron"
	chmod a+x "${pkgdir}/opt/iron/libffmpegsumo.so"

    sed -i "s/iron-version/${pkgver}/g" iron.desktop

	install -Dm644 iron.png "${pkgdir}/usr/share/pixmaps/iron.png"
	install -Dm644 iron.desktop "${pkgdir}/usr/share/applications/iron.desktop"
	install -Dm644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
