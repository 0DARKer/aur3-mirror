# Maintainer: Sara <sfauzia at comcast dot net>

pkgname=fbpad-git
pkgver=20111028
pkgrel=1
pkgdesc="a small linux framebuffer virtual terminal"
arch=('i686' 'x86_64')
url="http://repo.or.cz/w/fbpad.git"
license=('GPL')
optdepends=('ft2tf: ttf to tiny font converter')
makedepends=('git')
provides=('fbpad')
conflicts=('fbpad')
source=('config.h')
install=$pkgname.install
md5sums=('33ec2f35ce7455d1e36349ea7aaf2807')

_gitroot=git://repo.or.cz/fbpad.git
_gitname=fbpad

build(){
    cd "${srcdir}"
    msg "Connecting to GIT server...."
    
    if [[ -d ${_gitname} ]]; then
        cd "${_gitname}"
        git pull origin
        msg "The local files are updated."
    else
        git clone "${_gitroot}" -b scrsnap
        cd "${_gitname}"
    fi
    msg "Checkout done or server timeout"
    rm -rf "${srcdir}/${_gitname}-build"
    git clone "${srcdir}/${_gitname}" "${srcdir}/${_gitname}-build"
    cd "${srcdir}/${_gitname}-build"

    cp ${srcdir}/config.h config.h

    msg "Starting make..."
    make
}

package(){
    install -Dm755 "${srcdir}/${_gitname}-build/${_gitname}" "${pkgdir}/usr/bin/${_gitname}"
    install -D -m644 "${srcdir}/${_gitname}-build/README" "${pkgdir}/usr/share/doc/${pkgname}/README"
}
