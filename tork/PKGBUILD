# TorK: Installer: Arch
# Contributor: Darwin Bautista <djclue917@gmail.com>
# Contributor: Chris Giles <Chris.G.27 (at) Gmail.com>
# Contributor: Felix Yan <felixonmars@gmail.com>

libname=tor
pkgname=${libname}k
pkgver=0.31
pkgrel=2
pkgdesc="An anonymity manager for KDE"
arch=("any")
url="http://www.anonymityanywhere.com/${pkgname}/"
license=("GPL")
depends=("geoip>=1.4.3" "kdelibs3" "${libname}")
backup=("etc/${pkgname}-tsocks.conf")
options=("!emptydirs" "!libtool")
install=${pkgname}.install

source=(http://downloads.sourceforge.net/sourceforge/${pkgname}/${pkgname}-${pkgver}.tar.bz2
	fix_net_port.patch)
sha1sums=('09e05ee4d471bad238c166c0d5f8a9770a997516'
	  '70c450031bf5e603801451fc016e5cfc22cfd19c')

build() {
	cd ${srcdir}/${pkgname}-${pkgver}

	# Source the KDE and QT profiles
	source /etc/profile.d/kde3.sh
	source /etc/profile.d/qt3.sh

	msg "Applying patch(es) ..."
	patch -Np1 -i ../fix_net_port.patch

	# Build
	msg "Compiling tork ..."
	./configure --prefix=/opt/kde --mandir=/opt/kde/share/man \
	--sysconfdir=/etc --with-external-geoip --without-arts || return 1
	make || return 1
	make DESTDIR=${pkgdir} install || return 1
}

# vim:set ts=2 sw=2 et:
