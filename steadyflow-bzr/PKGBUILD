# Maintainer: zbito <ztokarczyk at gmail dot com>

pkgname=steadyflow-bzr
_pkgreal=steadyflow
pkgver=91
pkgrel=3
pkgdesc="Steadyflow is a GTK+ based download manager that aims for minimalism, ease of use, and a clean, malleable codebase."
arch=('i686' 'x86_64')
url="https://launchpad.net/steadyflow"
license=('GPL3')
depends=('libgee')
makedepends=('vala' 'bzr')
conflicts=('vala-git' 'vala-devel' 'steadyflow')

_bzrmod=steadyflow
_bzrtrunk=lp:~sikon/${_bzrmod}/trunk

build() {
  msg "Connecting to the server..."

  if [ ! -d ./${_bzrmod} ]; then
    bzr co ${_bzrtrunk} ${_bzrmod}
  else
    bzr up ${_bzrmod}
  fi

  msg "BZR checkout done or server timeout"
  msg "Starting make..."

  rm -rf "${srcdir}/${_bzrmod}-build"
  cp -r "${srcdir}/${_bzrmod}" "${srcdir}/${_bzrmod}-build"
  cd "$srcdir/${_bzrmod}-build"

    cmake -DCMAKE_INSTALL_PREFIX="/usr" . || return 1
    make || return 1
    make install DESTDIR=$pkgdir
}
