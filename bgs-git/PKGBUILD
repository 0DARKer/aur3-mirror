# Maintainer: melchips <truphemus dot francois at gmail dot com>
pkgname="bgs-git"
pkgver=20121029
pkgrel=1
pkgdesc="Imlib2 based, Xinerama/Xrandr-aware minimalist background setter (last git pull)"
arch=("i686" "x86_64")
url="https://github.com/Gottox/bgs"
license=('MIT')
groups=()
depends=("libx11" "libxinerama" "imlib2")
makedepends=("git")
optdepends=()
provides=("bgs")
conflicts=("bgs")
source=()
md5sums=()

_gitroot='git://github.com/Gottox/bgs.git'
_gitname='bgs'

build() {
  # update the repo, else clone a new one
  if [ -d $_gitname ] ; then
      pushd $_gitname
      git pull origin
      popd
      msg 'The local files are updated.'
  else
      git clone $_gitroot
  fi

  msg 'GIT checkout done or server timeout'

  [ -d build ] && rm -rf build
  cp -r $_gitname build
  cd build

  # add the correct settings to config.mk
  sed -e "s|^\(\s*PREFIX =\).*|\1 /usr|" -i config.mk

  msg "Starting build process."
  make || return 1
  make DESTDIR=${pkgdir} install

  msg "Adding package license."
  install -D -m644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}

# vim:set ts=2 sw=2 et:
