 
# Maintainer: Artem A. Klevtsov unikum.pm@gmail.com
pkgname=kdeicons-reflektions-kde4
_pkgname=Reflektions_KDE4
pkgver=1.0
pkgrel=2
pkgdesc="This is a version of the KDE4 port of the "Reflektions" icons."
arch=('i686' 'x86_64')
url="http://kde-look.org/content/show.php/Reflektions_KDE4?content=110944"
license=('CC BY-NC-SA 3.0')
makedepends=('imagemagick' 'unrar')
source=('http://fc04.deviantart.net/fs70/f/2011/189/0/3/reflektions_kde4_v1_0_by_linuxfever-d287xmx.rar')
md5sums=('9a17d11b61edac9b35f20b1e487bc58a')

SIZES="8x8 16x16 22x22 24x24 32x32 48x48 64x64 96x96"
DIRS="actions apps categories devices emblems emotes mimetypes places status" 

build() {
  cd ${srcdir}
  msg2 "Extract files..."
  unrar x -inul reflektions_kde4_v1_0_by_linuxfever-d287xmx.rar
  cd ${srcdir}/${_pkgname}
  
# create the dirs
  for size in $SIZES
  do
	for dir in $DIRS
	do
		mkdir -pm 755 $size/$dir
	done
  done

  msg2 "Convert icons..."
  for dir in $DIRS
  do
	cd ${srcdir}/${_pkgname}/128x128/$dir
	for icon in *
	do
		for size in $SIZES
		do
			convert "$icon" -resize $size ../../$size/$dir/"$icon"
		done
	done
  done
}

package() {
  install -dm 755 ${pkgdir}/usr/share/icons/${_pkgname}
  install -Dm 644 ${srcdir}/${_pkgname}/index.theme ${pkgdir}/usr/share/icons/${_pkgname}/
  cp -r ${srcdir}/${_pkgname}/128x128 ${pkgdir}/usr/share/icons/${_pkgname}

  for size in $SIZES
  do
	cp -r ${srcdir}/${_pkgname}/$size ${pkgdir}/usr/share/icons/${_pkgname}
  done

  cp -r ${srcdir}/${_pkgname}/48x48_or ${pkgdir}/usr/share/icons/${_pkgname}/48x48
  cp -r ${srcdir}/${_pkgname}/32x32_or ${pkgdir}/usr/share/icons/${_pkgname}/32x32
  cp -r ${srcdir}/${_pkgname}/22x22_or ${pkgdir}/usr/share/icons/${_pkgname}/22x22
  cp -r ${srcdir}/${_pkgname}/16x16_or ${pkgdir}/usr/share/icons/${_pkgname}/16x16
  cp -r ${srcdir}/${_pkgname}/8x8_or ${pkgdir}/usr/share/icons/${_pkgname}/8x8
  find ${pkgdir} -type d -print0 | xargs -0 chmod 755
  find ${pkgdir} -type f -print0 | xargs -0 chmod 644
}
