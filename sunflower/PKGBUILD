# Maintainer: Dan Serban
# Contributor: Henrik Olsson

pkgname=sunflower
pkgver=0.1a_xx.latest
pkgrel=1
pkgdesc="Small and highly customizable twin-panel file manager for Linux with support for plugins"
arch=(any)
url=https://code.google.com/p/sunflower-fm/
license=(GPLv3)
depends=(python2 python-notify python-wnck)
makedepends=(lynx)

build()
{
  rm sunflower.tar.gz 2>/dev/null || true
  _url=$(lynx -dump https://code.google.com/p/sunflower-fm/downloads/list | grep -o http.*tgz$ | head -1)
  wget -O sunflower.tar.gz "${_url}"
  bsdtar -xf sunflower.tar.gz
  mv Sunflower sunflower
  mkdir -p "${pkgdir}"/usr/share
  mv sunflower "${pkgdir}"/usr/share/
  mkdir -p "${pkgdir}"/usr/share/pixmaps
  mv "${pkgdir}"/usr/share/sunflower/images/sunflower.svg "${pkgdir}"/usr/share/pixmaps/
  mkdir -p "${pkgdir}"/usr/bin
  USRBINFILE="${pkgdir}"/usr/bin/sunflower
  echo '#!/bin/bash' > "${USRBINFILE}"
  echo 'exec python2 /usr/share/sunflower/Sunflower.py' >> "${USRBINFILE}"
  chmod +x "${USRBINFILE}"
  mkdir -p "${pkgdir}"/usr/share/applications
  DESKTOPFILE="${pkgdir}"/usr/share/applications/sunflower.desktop
  echo "[Desktop Entry]" > "${DESKTOPFILE}"
  echo "Version=1.0" >> "${DESKTOPFILE}"
  echo "Type=Application" >> "${DESKTOPFILE}"
  echo "Name=Sunflower" >> "${DESKTOPFILE}"
  echo "GenericName=File Manager" >> "${DESKTOPFILE}"
  echo "Comment=Sunflower is a small and highly customizable twin-panel file manager" >> "${DESKTOPFILE}"
  echo "Exec=sunflower" >> "${DESKTOPFILE}"
  echo "Icon=sunflower" >> "${DESKTOPFILE}"
  echo "Terminal=false" >> "${DESKTOPFILE}"
  echo "StartupNotify=true" >> "${DESKTOPFILE}"
  echo "Type=Application" >> "${DESKTOPFILE}"
  echo "Categories=System;Utility;Core;GTK;FileTools;FileManager;" >> "${DESKTOPFILE}"
}

