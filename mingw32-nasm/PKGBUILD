_target=i486-mingw32
pkgname=mingw32-nasm
pkgver=2.08.01
pkgrel=4
pkgdesc="80x86 assembler designed for portability and modularity"
arch=(i686 x86_64)
url="http://www.nasm.us"
license=(BSD)
makedepends=('mingw32-gcc' 'mingw32-binutils' 'mingw32-w32api')
source=("http://www.nasm.us/pub/nasm/releasebuilds/${pkgver}/nasm-${pkgver}.tar.bz2")
md5sums=('1e3ebc1289c2be5963571c0937b7a211')
sha1sums=('4684e0bda835fe903a8f1b727710afb46214de07')
sha256sums=('049b9a1381c0c775a07490f272a57c1802627cbfd6b2d675770b72078bdd8bc6')
sha384sums=('f217817525a04e930b5b15104d33dde0600da48e7fb82f05dd4ea5e3f4c7cfbda3d20c39a86ebec64794b83bbe5af81b')
sha512sums=('a80e621a811dfa40bc1af2edfb27a3b8747c171f75bb193dc43017c27fee001668bd23ba333398da1172ec3ab5be820583c015fec65cb8dbcd5a9f78f6e28f39')

build() {
  cd "$srcdir/nasm-$pkgver"

  unset LDFLAGS
  ./configure --prefix=/usr/${_target} --build=$CHOST --host=${_target} || return 1
  make || return 1
  make INSTALLROOT="$pkgdir" install || return 1
  make INSTALLROOT="$pkgdir" install_rdf || return 1

  install -d "${pkgdir}"/usr/share/licenses/mingw32-nasm
  install -m644 -t "${pkgdir}"/usr/share/licenses/mingw32-nasm LICENSE
}
