# Contributor: Jan "heftig" Steffens <jan.steffens@gmail.com>
# Contributor: farid <farid at archlinuc-br.org>
# Contributor: Archie <Mymaud@gmail.com>
# Contributor: ganymede

pkgname=gmic
pkgver=1.4.7.0
pkgrel=1
pkgdesc="GREYC's Magic Image Converter framework : script language, interpreter and command-line executable."
depends=('fftw' 'graphicsmagick' 'ffmpeg' 'opencv')
arch=('i686' 'x86_64')
license=('custom:CeCILL')
source=("http://downloads.sourceforge.net/sourceforge/${pkgname}/${pkgname}_${pkgver}.tar.gz" \
        "link_opencv-2.2.0.patch")
url="http://gmic.sourceforge.net"

build() {
  cd "$srcdir/$pkgname-$pkgver/src"

  patch -p0 -i "$srcdir/link_opencv-2.2.0.patch"

  make linux

  cd "$srcdir/gmic-$pkgver"
  install -D -m755 src/gmic "$pkgdir/usr/bin/gmic"
  install -D -m644 COPYING "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
  install -d "$pkgdir/usr/share/doc/gmic/"
  cp -R html "$pkgdir/usr/share/doc/gmic/"
  install -D -m644 man/gmic.1.gz "$pkgdir/usr/share/man/man1/gmic.1.gz"  
}

md5sums=('357096dbafc79823acd450fe33c7c12d'
         '1b3dafa4f653079c2e2a5c2094bdda02')
