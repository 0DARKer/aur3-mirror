# Maintainer: graysky <graysky AT archlinux DOT us>

pkgname='profile-sync-daemon'
pkgver=5.27
pkgrel=1
pkgdesc='Symlinks and syncs browser profile dirs to RAM thus reducing HDD/SDD calls and speeding-up browsers.'
arch=('any')
url='https://wiki.archlinux.org/index.php/Profile-sync-daemon'
license=('MIT')
depends=('rsync')
optdepends=('cron: allow hourly (default) or periodic syncs of tmpfs <--> HDD/SDD storage')
conflicts=('firefox-sync' 'firefox-tmpfs-daemon' 'chromium-tmpfs' 'tmpfs-store')
replaces=('sync-browsers-daemon')
source=("http://repo-ck.com/source/$pkgname/$pkgname-$pkgver.tar.xz")
backup=('etc/psd.conf')
install=psd.install
sha256sums=('1165539288940dc277bd1924f0dc8e1d4c2995ab53dbd15b233128f4cd66cee7')

build() {
	cd "$srcdir/$pkgname-$pkgver"
	ln -s Makefile.archlinux Makefile
	make
}
package() {
	cd "$srcdir/$pkgname-$pkgver"
	make DESTDIR="$pkgdir" install
	install -Dm644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
	
	# allow pacman to implicately track /etc/psd.conf to inform users of changes
	mv "$pkgdir/etc/psd.conf" "$srcdir/$pkgname-$pkgver"
	install -Dm644 psd.conf "$pkgdir/etc/psd.conf"
}
