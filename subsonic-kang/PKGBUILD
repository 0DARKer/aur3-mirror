#Mantainer: Anthony25
pkgname=subsonic-kang
pkgver=5.0
pkgrel=1
pkgdesc="Fork of the Subsonic project, an open-source web-based media streamer, with the licensing code removed"
url="https://github.com/KHresearch/subsonic"
arch=('i686' 'x86_64' 'armv6h')
license=('GPL')
conflicts=('subsonic' 'subsonic-beta' 'subsonic-kang-git')
depends=('java-runtime-headless' 'libcups')
backup=('var/subsonic/db'
    'var/subsonic/subsonic.sh')
source=("http://prdownloads.sourceforge.net/subsonic/subsonic-${pkgver}-standalone.tar.gz"
    "https://github.com/KHresearch/subsonic/releases/download/v${pkgver}-kang/subsonic-v${pkgver}-kang.war"
	'subsonic.service')
noextract=('subsonic.war')

package() {
  war_name="subsonic-v${pkgver}-kang.war"
  cd $srcdir
  mkdir -p $pkgdir/var/subsonic
  mkdir -p $pkgdir/usr/lib/systemd/system
  find ! -name subsonic.war ! -name subsonic.bat ! -name . \
      ! -name subsonic-${pkgver}-standalone.tar.gz \
      ! -name subsonic.service -exec cp -r {} $pkgdir/var/subsonic \;
  cp -r $startdir/$war_name $pkgdir/var/subsonic/subsonic.war
  cp -r $srcdir/subsonic.service $pkgdir/usr/lib/systemd/system
}

sha256sums=('e13500f5b50693c9aa688f3a97b6aee42dd3609ab443ca1859dcbe1042eecb06'
            'ecdf1de31bd283fca1336ab4f73e7290e428ac6ebbd9e214dce649c971b67d04'
            'd2efc9a73fbc8d9b9f3071bd2a7f6b99c87ea7095fadd44e8108a918778147e5')
