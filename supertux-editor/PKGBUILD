# Contributor: Cilyan Olowen <gaknar@gmail.com>
pkgname=supertux-editor
pkgver=0.3.0
pkgrel=1
pkgdesc="The official SuperTux Level Editor for Milestone 1.9. Usable but still unstable."
arch=(i686)
url="http://supertux.lethargik.org/"
license=('GPL')
depends=('supertux>=0.3.0' 'mesa' 'mono>=1.1.13' 'gtk-sharp-2>=2.8')
makedepends=(ftjam)
install=$pkgname.install
source=(http://download.berlios.de/supertux/$pkgname-$pkgver.tar.bz2
        supertux-editor.desktop)
md5sums=('9d9412fbcd2f9ec0948f22d9a784c7a2'
         '0d00ae72513464e77e95bf0066a07849')

build() {
  cd "$startdir/src/$pkgname-$pkgver"
  # Compile every thing
  msg "Making all"
  jam || return 1
  
  # Copy needed files
  
  # Create directories
  install -d $startdir/pkg/usr/share/$pkgname
  install -d $startdir/pkg/usr/share/$pkgname/data
  install -d $startdir/pkg/usr/share/applications
  install -d $startdir/pkg/usr/share/pixmaps
  install -d $startdir/pkg/usr/bin
  
  msg "Copying files"
  # Copy library files
  for _file in gtkgl-sharp libeditor Lisp LispReader Resources; do
    install -m 755 $_file.dll $startdir/pkg/usr/share/$pkgname
    if [ -e $_file.dll.config ]; then
        install -m 644 $_file.dll.config $startdir/pkg/usr/share/$pkgname
    fi
  done
  
  # Copy datas and executable
  cp -R data/* $startdir/pkg/usr/share/$pkgname/data
  install supertux-editor.exe $startdir/pkg/usr/share/$pkgname
  
  # Copy menu entry and icon
  install $startdir/src/supertux-editor.desktop $startdir/pkg/usr/share/applications
  install supertux-editor.png supertux-editor.xpm $startdir/pkg/usr/share/pixmaps
  
  # Create launcher
  msg "Creating launcher"
  touch $startdir/pkg/usr/bin/supertux-editor
  echo "#/bin/sh" >> $startdir/pkg/usr/bin/supertux-editor
  echo "/usr/bin/mono /usr/share/$pkgname/supertux-editor.exe" >> $startdir/pkg/usr/bin/supertux-editor
  chmod 755 $startdir/pkg/usr/bin/supertux-editor
}

# vim:set ts=2 sw=2 et:
