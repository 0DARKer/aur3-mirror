# Contributor: Alexander Jakopin <setrodox@users.sourceforge.net>
pkgname=mingw32-allegro
pkgver=5.0.6
pkgrel=3
license=('custom')
arch=('any')
options=('!strip' '!buildflags')
depends=(mingw32-runtime mingw32-dx7-headers)
makedepends=('mingw32-gcc' 'cmake')
pkgdesc="Portable library mainly aimed at video game and multimedia programming (mingw32)"
source=("http://downloads.sourceforge.net/project/alleg/allegro/$pkgver/allegro-$pkgver.tar.gz"
'cmake-toolchain.cmake')
url=("http://alleg.sourceforge.net/")
md5sums=('c4b4384ef03ac5f6388f378f3eeff243'
         'dd2b2db48187dff84050fe191d309d81')
build() {
	cd "$srcdir/allegro-$pkgver"
	export MINGDIR="/usr/i486-mingw32"
	unset LDFLAGS
	mkdir package
	cd package
	cmake -DWANT_EXAMPLES=OFF -DCMAKE_TOOLCHAIN_FILE="$srcdir/cmake-toolchain.cmake" .. && make
	make install DESTDIR=$pkgdir
	i486-mingw32-strip -x $pkgdir/usr/i486-mingw32/bin/*.dll
        i486-mingw32-strip -g $pkgdir/usr/i486-mingw32/lib/*.a
}

