# Contributor: dibblethewrecker dibblethewrecker.at.jiwe.dot.org
pkgname=fvwm-cvs
pkgver=20080511
pkgrel=1
arch=('i686')
pkgdesc="A multiple large virtual desktop window manager originally derived from twm."
url="http://www.fvwm.org"
license=
depends=('imlib' 'fribidi' 'perl' 'x-server' 'libstroke' 'perl-tk' 'perl-x11-protocol')
provides=('fvwm-dev')
conflicts=('fvwm-dev' 'fvwm' 'fvwm-trans')
makedepends=('cvs')
source=(fvwm2.desktop)
md5sums=('e52a6ef25a936dcf3ad0e58f2e9ed0ea')
license=('GPL')

_cvsmod="fvwm"
_cvsroot=":pserver:anonymous:guest@cvs.fvwm.org:/home/cvs"

build() {
  cd $startdir/src
  touch ~/.cvspass
  msg "Connecting to $_cvsmod.sourceforge.net CVS server...."
  cvs -z9 -d $_cvsroot/$_cvsmod co -D $pkgver -f $_cvsmod || return 1
  cd $_cvsmod
  aclocal || return 1
  autoheader || return 1
  automake --add-missing || return 1
  autoreconf || return 1

  msg "CVS checkout done or server timeout"
  msg "Starting make..."

  rm -r ../$_cvsmod-build
  cp -r ../$_cvsmod ../$_cvsmod-build 
  cd ../$_cvsmod-build

  ./configure --prefix=/usr --sysconfdir=/etc --libexecdir=/usr/lib \
  --with-xft-prefix=/usr --with-fontconfig=/usr --with-stroke || return 1
  make || return 1
  make DESTDIR=$startdir/pkg install || return 1

  install -d $startdir/pkg/etc/fvwm || return 1
  cp -r sample.fvwmrc/* $startdir/pkg/etc/fvwm || return 1
  rm -f $startdir/pkg/etc/fvwm/{Makefile,Makefile.am,Makefile.in}
  install -Dm 644 ../fvwm2.desktop \
    $startdir/pkg/usr/share/applications/fvwm2.desktop 
  rm -r $startdir/src/$_cvsmod-build
}
# vim:syntax=sh

