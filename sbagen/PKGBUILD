# Contributor: Prurigro
# Maintainer: Prurigro
pkgname=sbagen
pkgver=1.4.4
pkgrel=5
pkgdesc="A binural brainwave generator"
url="http://uazu.net/sbagen"
license="GPL"
arch=('i686' 'x86_64')
_riverver=1.4.1
_rhybagver=0.1.1
install=sbagen.install

source=(http://uazu.net/sbagen/$pkgname-$pkgver.tgz
	http://uazu.net/sbagen/sbagen-river-$_riverver.tgz
	http://uazu.net/sbagen/rhybag-$_rhybagver.tgz)
md5sums=('8fb78158cd83d06417f61e920cb3f099'
	 '76e4f594477c4121b3b560548dc8229e'
	 'bca3aea9621fc62dce16dabfd1861edb')

build() {
	#Compile and install sbagen
	pushd ${srcdir}/$pkgname-$pkgver || return 1
		#sh mk || return 1
		gcc -DT_LINUX -Wall -O3 -s -lm -lpthread -lmad -lvorbis sbagen.c -o sbagen || return 1
		rm readme-windows.txt || return 1
		
		install -d ${pkgdir}/usr/bin || return 1
		install -D -m755 $pkgname ${pkgdir}/usr/bin/$pkgname || return 1

		install -d ${pkgdir}/usr/share/$pkgname/doc || return 1
		install -D -m644 *.txt ${pkgdir}/usr/share/$pkgname/doc || return 1

		install -d ${pkgdir}/usr/share/$pkgname/examples/basics || return 1
		install -D -m644 examples/basics/*.sbg ${pkgdir}/usr/share/$pkgname/examples/basics || return 1

		install -d ${pkgdir}/usr/share/$pkgname/examples/contrib/ghostlab || return 1
		install -D -m644 examples/contrib/ghostlab/*.sbg ${pkgdir}/usr/share/$pkgname/examples/contrib/ghostlab || return 1

		install -d ${pkgdir}/usr/share/$pkgname/examples/contrib/jim || return 1
		install -D -m644 examples/contrib/jim/*.sbg ${pkgdir}/usr/share/$pkgname/examples/contrib/jim || return 1

		install -D -m644 examples/contrib/*.sbg ${pkgdir}/usr/share/$pkgname/examples/contrib || return 1

		install -d ${pkgdir}/usr/share/$pkgname/examples/focus || return 1
		install -D -m644 examples/focus/*.sbg ${pkgdir}/usr/share/$pkgname/examples/focus || return 1

		install -d ${pkgdir}/usr/share/$pkgname/scripts || return 1
		install -D -m755 scripts/* ${pkgdir}/usr/share/$pkgname/scripts || return 1
	popd || return 1
	
	#Compile and install rhybag
	pushd ${srcdir}/rhybag-$_rhybagver || return 1
		cc -O2 -s -lm main.c -o rhybag 2>&1 1>&0 | ./strip_warnings >mk.err || return 1
		install -D -m755 rhybag ${pkgdir}/usr/bin/rhybag || return 1
	popd || return 1
	
	#Install river sounds
	pushd ${srcdir}/$pkgname-$_riverver || return 1
		install -D -m644 river1.ogg ${pkgdir}/usr/share/sbagen/river1.ogg || return 1
		install -D -m644 river2.ogg ${pkgdir}/usr/share/sbagen/river2.ogg || return 1
	popd || return 1
}
