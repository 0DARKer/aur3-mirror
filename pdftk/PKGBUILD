# Contributor: osc
# Contributor: StefanHusmann
# Maintainer: larsrh <hupel@in.tum.de>

pkgname=pdftk
pkgver=1.45
pkgrel=1
pkgdesc="Pdftk is a simple tool for doing everyday things with PDF documents"
arch=('i686' 'x86_64')
url="http://www.pdfhacks.com/pdftk"
license="GPL"
depends=('gcc-gcj>=4.7.2' 'gcc-gcj-ecj')
options=('!makeflags')
source=(
  "http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/${pkgname}-${pkgver}-src.zip"
  "Makefile.Arch.x86_64"
  "Makefile.Arch.i686"
)
sha1sums=(
  "a46aada9ea212c17fd38c5a047aeaee7eebe5351"
  "603eb6aa61fffd56946f4cd95f9d29fa025dde7d"
  "f095eea9c9ffb8df1811514e1cf4e65e731fd9f6"
)

build() {
	cd "$srcdir/$pkgname-$pkgver-dist/$pkgname"

	# copy Makefiles
	cp "$srcdir/Makefile.Arch.x86_64" .
	cp "$srcdir/Makefile.Arch.i686" .

	# Compile the package
	make -f Makefile.Arch.$CARCH
}

package() {
	cd "$srcdir/$pkgname-$pkgver-dist/$pkgname"

	# Install binary
	install -D -m 755 pdftk $pkgdir/usr/bin/pdftk

	# Install licenses and adjust permissions
	cd ..
	LICENSE_DIR="$pkgdir/usr/share/licenses/$pkgname"
	mkdir -p "$LICENSE_DIR"
	cp -R license_gpl_pdftk/* "$LICENSE_DIR"
	chmod -R 0755 "$LICENSE_DIR"
	find "$LICENSE_DIR" -type f -exec chmod -x {} \;

	# Install manpage
	install -D -m 644 "pdftk.1" "$pkgdir/usr/share/man/man1/pdftk.1"
}
