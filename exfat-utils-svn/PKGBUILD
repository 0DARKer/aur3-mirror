# $Id$
# Maintainer: Bob Valantin <valantin89 [at] gmail [dot] com>

pkgname=exfat-utils-svn
pkgver=335
pkgrel=1
pkgdesc="Utilities for exFAT file system"
arch=('i686' 'x86_64')
url="http://code.google.com/p/exfat/"
license=('GPL3')
depends=('glibc')
makedepends=('scons' 'subversion')
provides=('exfat-utils')
conflicts=('exfat-utils')
source=()
md5sums=()

_svnname="exfat-utils"
_svntrunk="https://exfat.googlecode.com/svn/trunk/"

package() {
  cd ${srcdir}
  
  msg "Connecting to SVN server..."
  
  if [ -d ${_svnname}/.svn ]; then
    (cd ${_svnname} && svn up && cd -)
  else
    svn co ${_svntrunk} ${_svnname}
  fi
  
  msg "Starting build..."
  svn export ${_svnname} ${_svnname}-build
  cd ${_svnname}-build
  rm -r fuse

  scons CCFLAGS="${CFLAGS}" LINKFLAGS="${LDFLAGS} " install DESTDIR="${pkgdir}/usr/bin"

  # Install man pages
  install -Dm444 dump/dumpexfat.8 "${pkgdir}/usr/share/man/man8/dumpexfat.8"
  install -m444 fsck/exfatfsck.8 "${pkgdir}/usr/share/man/man8"
  install -m444 mkfs/mkexfatfs.8 "${pkgdir}/usr/share/man/man8"
  install -m444 label/exfatlabel.8 "${pkgdir}/usr/share/man/man8"
}
 
