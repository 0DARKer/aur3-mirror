# Maintainer: Jiulun Du <dujiulun2006 # 126 com>
pkgname=lantern
pkgver=1.4.3
pkgrel=2
pkgdesc="An international network of people working together to defeat internet censorship"
arch=('i686' 'x86_64')
url="https://www.getlantern.org/"
license=('GPL')
depends=(gtk2 libxslt libxtst alsa-lib)
optdepends=(kdebase-kdialog)
backup=()
options=()
install='lantern.install'

case $CARCH in
	'x86_64')
		_arch='64'
		sha256sums=('ca8ea5a939c7776773d3884ea40decf00dd519dde7efc826e2b1c4556e832f03')
		;;
	'i686')
		_arch='32'
		sha256sums=('82df2e5664cec3451efa22fff940b7e9265c658c6771ed1fb70fedbd6a6b0cd4')
		;;
esac

source=("https://s3.amazonaws.com/lantern/newest-${_arch}.deb")

package() {
	cd "$srcdir"
	tar zxf data.tar.gz
	chmod o-w opt/lantern/.install4j/firstrun
	mv opt "$pkgdir"

	tar zxf control.tar.gz

	cd "$startdir"
	touch $install

	echo "post_install() {" >> $install
	cat "$srcdir"/postinst | tail -n+2 | head -n-1 >> $install
	echo "}" >> $install

	echo "pre_remove() {" >> $install
	cat "$srcdir"/prerm | tail -n+2 | head -n-1 >> $install
	echo "}" >> $install

	echo "pre_upgrade() {" >> $install
	echo "pre_remove" >> $install
	echo "}" >> $install

	echo "post_upgrade() {" >> $install
	echo "post_install" >> $install
	echo "}" >> $install
}
