# Maintainer: RaNaN <ranan@pyload.org>
# Contributer: prophy <4prophy@gmail.com>

pkgname='pyload'
pkgver=0.4.4
pkgrel=1
pkgdesc="Downloadtool for One-Click-Hoster written in python."
url="http://bitbucket.org/spoob/pyload/"
license='GPL'
arch=('any')
conflicts=('pyload-hg')
replaces=('pyload-hg')
depends=('python2' 'pycrypto' 'python-pycurl' 'tesseract' 'python-imaging' 'django')
optdepends=('pyqt: Gui'
            'lighttpd: Additional webserver'
            'nginx: Additional webserver'
            'python-flup: for additional webservers')
makedepends=('')

source=(http://get.pyload.org/get/src/$pkgver
	'http://bitbucket.org/ranan/pyload-dist/raw/88fa4a2f3f0c/debian/pyload/usr/share/applications/pyload-gui.desktop' 
        'http://bitbucket.org/ranan/pyload-dist/raw/88fa4a2f3f0c/debian/pyload/usr/share/applications/pyload.desktop' 
	'http://bitbucket.org/ranan/pyload-dist/raw/88fa4a2f3f0c/debian/pyload/usr/share/pixmaps/pyload-gui.png' 
        'http://bitbucket.org/ranan/pyload-dist/raw/88fa4a2f3f0c/debian/pyload/usr/share/pixmaps/pyload.png' )

md5sums=('bd51615863210deaa2ebc7d12d443a0b'
	'b96a4e5091463b3b7fd79208623f1a3a'
	'c67462993d27d5884677dd6e8a8a17d2'
	'73fcec930d25a49e1b99576069d88bd5' 
	'8cbffcc4e7bbd5441a764d844ca2f05e' )

build() {

  cd $srcdir || return 1

  sed -i 's_#!/usr/bin/env python_#!/usr/bin/env python2_'  pyload/pyLoad*.py

  install -d ${pkgdir}/opt/pyload || return 1
  cp -r pyload/* ${pkgdir}/opt/pyload || return 1
 
  install -d ${pkgdir}/usr/share/applications || return 1
  cp pyload.desktop ${pkgdir}/usr/share/applications || return 1
  cp pyload-gui.desktop ${pkgdir}/usr/share/applications || return 1

  install -d ${pkgdir}/usr/share/pixmaps || return 1
  cp pyload.png ${pkgdir}/usr/share/pixmaps || return 1
  cp pyload-gui.png ${pkgdir}/usr/share/pixmaps || return 1

  install -d ${pkgdir}/usr/bin || return 1
  ln -s /opt/pyload/pyLoadCore.py ${pkgdir}/usr/bin/pyLoadCore || return 1
  ln -s /opt/pyload/pyLoadCli.py ${pkgdir}/usr/bin/pyLoadCli || return 1
  ln -s /opt/pyload/pyLoadGui.py ${pkgdir}/usr/bin/pyLoadGui || return 1

}
