# Contributor: Thaodan <theodorstormgrade@gmail.com>

pkgname=wargus
pkgver=2.2.6
pkgrel=2
pkgdesc="Warcraft2 Mod that allows you to play Warcraft2 with the Stratagus engine"
arch=("i686" "x86_64")
url="http://wargus.sourceforge.net/"
license=('GPL')
depends=('stratagus' 'ffmpeg2theora' 'cdparanoia' 'timidity++' 'gtk' )
source=("http://launchpad.net/wargus/trunk/2.2.6/+download/${pkgname}_${pkgver}.orig.tar.gz"
"http://bazaar.launchpad.net/~stratagus/wargus/trunk/diff/1622" "https://bugs.launchpad.net/wargus/+bug/963210/+attachment/2923037/+files/wargus_2.2.6-wartool-libpng15.diff")
md5sums=('fd39631339e8daa9e8c7de46916ad33a'
'fa6cc7983d6d19cd3acdb4f5e4624c98' '20dfdbd9cb4aa02067493bc616f48a12 '
)

build()

{
cd $srcdir/${pkgname}_$pkgver.orig
patch -p0 <../1622
patch < ../wargus_2.2.6-wartool-libpng15.diff
mkdir build
cd build

cmake .. -DCMAKE_BUILD_TYPE=Release \
-DCMAKE_INSTALL_PREFIX=/usr
make || return 1

make DESTDIR="${pkgdir}" install
cd $pkgdir
mv usr/games/wargus usr/bin
rmdir usr/games

msg2 "run sudo wartool -m -v -r /media/cdrom/data /usr/share/games/stratagus/wargus to convert& copy original date"
msg2 "only works with originial dos cd"
}
