--- Makefile.orig	2013-12-30 20:27:50.000000000 +0100
+++ Makefile	2014-04-17 04:16:05.381216414 +0200
@@ -1,7 +1,4 @@
-.PHONY: 	 clean install installwww
-.SUFFIXES:	 .sgml .html .md5 .h .h.html
-.SUFFIXES:	 .1       .3       .7       .8
-.SUFFIXES:	 .1.html  .3.html  .7.html  .8.html
+.PHONY: 	 clean install
 
 # Specify this if you want to hard-code the operating system to appear
 # in the lower-left hand corner of -mdoc manuals.
@@ -19,24 +16,15 @@
 #
 CFLAGS	 	+= -DUSE_WCHAR
 
-# If your system has manpath(1), uncomment this.  This is most any
-# system that's not OpenBSD or NetBSD.  If uncommented, apropos(1),
-# mandocdb(8), and man.cgi will popen(3) manpath(1) to get the MANPATH
-# variable.
-#CFLAGS		+= -DUSE_MANPATH
-
 # If your system does not support static binaries, comment this,
 # for example on Mac OS X.
 STATIC		 = -static
 # Linux requires -pthread to statically link with libdb.
-#STATIC		+= -pthread
+STATIC		+= -pthread
 
 CFLAGS		+= -g -DHAVE_CONFIG_H
 CFLAGS     	+= -W -Wall -Wstrict-prototypes -Wno-unused-parameter -Wwrite-strings
 PREFIX		 = /usr/local
-WWWPREFIX	 = /var/www
-HTDOCDIR	 = $(WWWPREFIX)/htdocs
-CGIBINDIR	 = $(WWWPREFIX)/cgi-bin
 BINDIR		 = $(PREFIX)/bin
 INCLUDEDIR	 = $(PREFIX)/include/mandoc
 LIBDIR		 = $(PREFIX)/lib/mandoc
@@ -49,31 +37,15 @@
 INSTALL_SOURCE	 = $(INSTALL) -m 0644
 INSTALL_MAN	 = $(INSTALL_DATA)
 
-# Non-BSD systems (Linux, etc.) need -ldb to compile mandocdb and
-# apropos.
-# However, if you don't have -ldb at all (or it's not native), then
-# comment out apropos and mandocdb. 
-#
-#DBLIB		 = -ldb
-DBBIN		 = apropos mandocdb man.cgi catman whatis
-DBLN		 = llib-lapropos.ln llib-lmandocdb.ln llib-lman.cgi.ln llib-lcatman.ln
-
-all: mandoc preconv demandoc $(DBBIN)
+all: mandoc preconv demandoc
 
 SRCS		 = Makefile \
 		   NEWS \
 		   TODO \
-		   apropos.1 \
-		   apropos.c \
-		   apropos_db.c \
-		   apropos_db.h \
 		   arch.c \
 		   arch.in \
 		   att.c \
 		   att.in \
-		   catman.8 \
-		   catman.c \
-		   cgi.c \
 		   chars.c \
 		   chars.in \
 		   compat_fgetln.c \
@@ -105,8 +77,6 @@
 		   main.h \
 		   man.7 \
 		   man.c \
-		   man.cgi.7 \
-		   man-cgi.css \
 		   man.h \
 		   man_hash.c \
 		   man_html.c \
@@ -118,11 +88,6 @@
 		   mandoc.c \
 		   mandoc.h \
 		   mandoc_char.7 \
-		   mandocdb.8 \
-		   mandocdb.c \
-		   mandocdb.h \
-		   manpath.c \
-		   manpath.h \
 		   mdoc.7 \
 		   mdoc.c \
 		   mdoc.h \
@@ -167,8 +132,7 @@
 		   test-strptime.c \
 		   tree.c \
 		   vol.c \
-		   vol.in \
-		   whatis.1
+		   vol.in
 
 LIBMAN_OBJS	 = man.o \
 		   man_hash.o \
@@ -247,72 +211,18 @@
 		   tree.o
 $(MANDOC_OBJS): main.h mandoc.h mdoc.h man.h config.h out.h
 
-MANDOCDB_OBJS	 = mandocdb.o manpath.o
-$(MANDOCDB_OBJS): mandocdb.h mandoc.h mdoc.h man.h config.h manpath.h
-
 PRECONV_OBJS	 = preconv.o
 $(PRECONV_OBJS): config.h
 
-APROPOS_OBJS	 = apropos.o apropos_db.o manpath.o
-$(APROPOS_OBJS): config.h mandoc.h apropos_db.h manpath.h mandocdb.h
-
-CGI_OBJS	 = $(MANDOC_HTML_OBJS) \
-		   $(MANDOC_MAN_OBJS) \
-		   $(MANDOC_TERM_OBJS) \
-		   cgi.o \
-		   apropos_db.o \
-		   manpath.o \
-		   out.o \
-		   tree.o
-$(CGI_OBJS): main.h mdoc.h man.h out.h config.h mandoc.h apropos_db.h manpath.h mandocdb.h
-
-CATMAN_OBJS	 = catman.o manpath.o
-$(CATMAN_OBJS): config.h mandoc.h manpath.h mandocdb.h
-
 DEMANDOC_OBJS	 = demandoc.o
 $(DEMANDOC_OBJS): config.h
 
-INDEX_MANS	 = apropos.1.html \
-		   catman.8.html \
-		   demandoc.1.html \
-		   mandoc.1.html \
-		   whatis.1.html \
-		   mandoc.3.html \
-		   tbl.3.html \
-		   eqn.7.html \
-		   man.7.html \
-		   man.cgi.7.html \
-		   mandoc_char.7.html \
-		   mdoc.7.html \
-		   preconv.1.html \
-		   roff.7.html \
-		   tbl.7.html \
-		   mandocdb.8.html
-
-$(INDEX_MANS): mandoc
-
-INDEX_OBJS	 = $(INDEX_MANS) \
-		   man.h.html \
-		   mandoc.h.html \
-		   mdoc.h.html \
-		   mdocml.tar.gz \
-		   mdocml.md5
-
-www: index.html
-
 clean:
 	rm -f libmandoc.a $(LIBMANDOC_OBJS)
-	rm -f mandocdb $(MANDOCDB_OBJS)
 	rm -f preconv $(PRECONV_OBJS)
-	rm -f apropos whatis $(APROPOS_OBJS)
-	rm -f man.cgi $(CGI_OBJS)
-	rm -f catman $(CATMAN_OBJS)
 	rm -f demandoc $(DEMANDOC_OBJS)
 	rm -f mandoc $(MANDOC_OBJS)
 	rm -f config.h config.log $(COMPAT_OBJS)
-	rm -f mdocml.tar.gz
-	rm -f index.html $(INDEX_OBJS)
-	rm -rf *.dSYM
 
 install: all
 	mkdir -p $(DESTDIR)$(BINDIR)
@@ -330,62 +240,18 @@
 	$(INSTALL_MAN) man.7 mdoc.7 roff.7 eqn.7 tbl.7 mandoc_char.7 $(DESTDIR)$(MANDIR)/man7
 	$(INSTALL_DATA) example.style.css $(DESTDIR)$(EXAMPLEDIR)
 
-installcgi: all
-	mkdir -p $(DESTDIR)$(CGIBINDIR)
-	mkdir -p $(DESTDIR)$(HTDOCDIR)
-	$(INSTALL_PROGRAM) man.cgi $(DESTDIR)$(CGIBINDIR)
-	$(INSTALL_DATA) example.style.css $(DESTDIR)$(HTDOCDIR)/man.css
-	$(INSTALL_DATA) man-cgi.css $(DESTDIR)$(HTDOCDIR)
-
-installwww: www
-	mkdir -p $(PREFIX)/snapshots
-	mkdir -p $(PREFIX)/binaries
-	$(INSTALL_DATA) index.html external.png index.css $(PREFIX)
-	$(INSTALL_DATA) $(INDEX_MANS) style.css $(PREFIX)
-	$(INSTALL_DATA) mandoc.h.html man.h.html mdoc.h.html $(PREFIX)
-	$(INSTALL_DATA) mdocml.tar.gz $(PREFIX)/snapshots
-	$(INSTALL_DATA) mdocml.md5 $(PREFIX)/snapshots
-	$(INSTALL_DATA) mdocml.tar.gz $(PREFIX)/snapshots/mdocml-$(VERSION).tar.gz
-	$(INSTALL_DATA) mdocml.md5 $(PREFIX)/snapshots/mdocml-$(VERSION).md5
-
 libmandoc.a: $(COMPAT_OBJS) $(LIBMANDOC_OBJS)
 	$(AR) rs $@ $(COMPAT_OBJS) $(LIBMANDOC_OBJS)
 
 mandoc: $(MANDOC_OBJS) libmandoc.a
 	$(CC) $(LDFLAGS) -o $@ $(MANDOC_OBJS) libmandoc.a
 
-mandocdb: $(MANDOCDB_OBJS) libmandoc.a
-	$(CC) $(LDFLAGS) -o $@ $(MANDOCDB_OBJS) libmandoc.a $(DBLIB)
-
 preconv: $(PRECONV_OBJS)
 	$(CC) $(LDFLAGS) -o $@ $(PRECONV_OBJS)
 
-whatis: apropos
-	cp -f apropos whatis
-
-apropos: $(APROPOS_OBJS) libmandoc.a
-	$(CC) $(LDFLAGS) -o $@ $(APROPOS_OBJS) libmandoc.a $(DBLIB)
-
-catman: $(CATMAN_OBJS) libmandoc.a
-	$(CC) $(LDFLAGS) -o $@ $(CATMAN_OBJS) libmandoc.a $(DBLIB)
-
-man.cgi: $(CGI_OBJS) libmandoc.a
-	$(CC) $(LDFLAGS) $(STATIC) -o $@ $(CGI_OBJS) libmandoc.a $(DBLIB)
-
 demandoc: $(DEMANDOC_OBJS) libmandoc.a
 	$(CC) $(LDFLAGS) -o $@ $(DEMANDOC_OBJS) libmandoc.a
 
-mdocml.md5: mdocml.tar.gz
-	md5 mdocml.tar.gz >$@
-
-mdocml.tar.gz: $(SRCS)
-	mkdir -p .dist/mdocml-$(VERSION)/
-	$(INSTALL_SOURCE) $(SRCS) .dist/mdocml-$(VERSION)
-	( cd .dist/ && tar zcf ../$@ ./ )
-	rm -rf .dist/
-
-index.html: $(INDEX_OBJS)
-
 config.h: config.h.pre config.h.post
 	rm -f config.log
 	( cat config.h.pre; \
@@ -423,12 +289,3 @@
 	  cat config.h.post \
 	) > $@
 
-.h.h.html:
-	highlight -I $< >$@
-
-.1.1.html .3.3.html .7.7.html .8.8.html:
-	./mandoc -Thtml -Wall,stop -Ostyle=style.css,man=%N.%S.html,includes=%I.html $< >$@
-
-.sgml.html:
-	validate --warn $<
-	sed -e "s!@VERSION@!$(VERSION)!" -e "s!@VDATE@!$(VDATE)!" $< >$@
