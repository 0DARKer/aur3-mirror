# $Id: pkgbuild-mode.el,v 1.23 2007/10/20 16:02:14 juergen Exp $
# Maintainer: Alexandre Bique <bique.alexandre@gmail.com>
pkgname=scissy
pkgver=0.6.0
pkgrel=1
pkgdesc="Lightweight and standalone git repository server"
arch=('i686' 'x86_64')
url="https://githube.com/abique/scissy"
license=('MIT')
depends=(git sqlite3 libgit2 gnutls protobuf xz cracklib re2)
source=(
  http://88.191.147.34:4242/scissy/$pkgname-$pkgver.tar.xz
  scissy.install
  scissy.service
  scissy.tmpfiles
)
md5sums=('e2abf759473d29f25ce90a6a545d5a47'
         'd407a8d303917c954e425f08f14cf03c'
         '3dd2e02e5b427d6a832aef3ba0ecfe63'
         'edc0dfecbe8523745157d113fb410646')
install=scissy.install
backup=('etc/scissy/config.json')

build() {
  cd $startdir/src/$pkgname-$pkgver
  mkdir build
  cd build
  cmake -DCMAKE_BUILD_TYPE=release -DCMAKE_INSTALL_PREFIX=/usr ..
  make -j
}

package() {
  cd $srcdir/$pkgname-$pkgver/build

  make DESTDIR=$pkgdir install
  install -D -m644 ${srcdir}/scissy.service ${pkgdir}/usr/lib/systemd/system/scissy.service
  install -D -m644 ${srcdir}/${pkgname}-${pkgver}/LICENSE ${pkgdir}/usr/share/licenses/scissy/LICENSE
  install -d 755 $pkgdir/var/lib/scissy
  install -d 750 $pkgdir/etc/scissy
  install -Dm644 "${srcdir}"/scissy.tmpfiles "${pkgdir}"/usr/lib/tmpfiles.d/scissy.conf
}

# vim:set ts=2 sw=2 et:
