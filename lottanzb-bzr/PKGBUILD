# Contributor: Samed Beyribey <ras0ir AT eventualis DOT org>
# Contributor: Nelson VuDu <vudu DOT curse AT gmail DOT com>

pkgname=lottanzb-bzr
pkgver=1598
pkgrel=1
pkgdesc="The bzr trunk series for LottaNZB, a sabnzbd GUI written in PyGTK"
arch=('any')
url="https://launchpad.net/lottanzb/trunk"
license=('GPL')
depends=('sabnzbd' 'python2' 'python-configobj')
makedepends=('bzr')
provides=('lottanzb')
conflicts=('lottanzb')
install=${pkgname}.install

_bzrmod=trunk
_bzrbranch=lp:lottanzb/${_bzrmod} 

build() {
  cd ${srcdir}

  if [ -d ${_bzrmod}/.bzr ]; then
    (cd ${_bzrmod} && bzr pull -r ${pkgver}) || return 1
  else
    bzr branch ${_bzrbranch} ${_bzrmod} || return 1
  fi

  msg "BZR checkout done or server timeout"
  msg "Starting make..."

  rm -rf "${srcdir}/${_bzrmod}-build"
  cp -r "${srcdir}/${_bzrmod}" "${srcdir}/${_bzrmod}-build"
  cd "${srcdir}/${_bzrmod}-build"
pwd
ls -la
  #
  # BUILD
  #
  python2 setup.py build || return 1
  python2 setup.py install --packaging-mode --root=$pkgdir --prefix=/usr || return 1 
}
