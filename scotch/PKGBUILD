pkgname=scotch
pkgver=5.1.11
pkgrel=1
pkgdesc="a software package and libraries for graph, mesh and hypergraph partitioning, static mapping, and sparse matrix block ordering"
url="http://www.labri.fr/perso/pelegrin/scotch/"
license="custom: CeCILL-C free/libre software license"
depends=('zlib')
arch=('i686' 'x86_64')
source=("http://gforge.inria.fr/frs/download.php/28043/${pkgname}_${pkgver}.tar.gz")
md5sums=('36d638a227f38a219b51fe8ddc2093ac')

build()
{
	cd "${srcdir}/${pkgname}_${pkgver}/src"

	# compile both static
	cp Make.inc/Makefile.inc.i686_pc_linux2 Makefile.inc
	make

	# ...and shared version
	cp Make.inc/Makefile.inc.i686_pc_linux2.shlib Makefile.inc
	make
}

package()
{
	cd "${srcdir}/${pkgname}_${pkgver}"

	install -d "${pkgdir}/usr/bin"
	install -d "${pkgdir}/usr/lib"
	install -d "${pkgdir}/usr/include/${pkgname}"
	install -d "${pkgdir}/usr/man"
	install -d "${pkgdir}/usr/share/doc/${pkgname}"
	install -d "${pkgdir}/usr/share/licenses/${pkgname}"

	cd bin
	for prog in *
	do
		install -m755 ${prog} ${pkgdir}/usr/bin/scotch_${prog}
	done
	cd ..
	
	cp lib/* ${pkgdir}/usr/lib
	cp include/* ${pkgdir}/usr/include/scotch
	cp -r man/* ${pkgdir}/usr/man
	cp -r doc/* ${pkgdir}/usr/share/doc/scotch
	cp doc/CeCILL-C_V1-en.txt "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
