# Maintainer:  Bartlomiej Piotrowski <barthalion@gmail.com>
# Contributor: Thomas Mudrunka <harvie@@email..cz>

pkgname=torchat
pkgver=0.9.9.550
pkgrel=1
pkgdesc="decentralized instant messenger built on top of the Tor Network"
arch=('any')
license=('GPL')
url="http://code.google.com/p/torchat/"
depends=('tor' 'python2' 'wxpython')
source=("http://torchat.googlecode.com/files/${pkgname}-source-${pkgver}.zip"
        "${pkgname}"
        "${pkgname}.desktop")
md5sums=('802ee514e644b1459261c20367f690e5'
         '579b4ff498ff1211960c95c1a7d1efb5'
                  '4b9f593f2fd8dcff9c0e0252e9f199a7')

package() {
    install -d ${pkgdir}/opt/torchat/
    cp -r ${srcdir}/src/* ${pkgdir}/opt/torchat/

    find ${pkgdir}/opt/torchat/ -iname "*.py" | xargs sed -i 's|#!/usr/bin/env python|#!/usr/bin/env python2|'
    find ${pkgdir}/opt/torchat/ -iname "*.py" | xargs sed -i 's|#!/usr/bin/python|#!/usr/bin/python2|'
    rm ${pkgdir}/opt/torchat/portable.txt

    install -d ${pkgdir}/usr/bin
    cp ${srcdir}/torchat ${pkgdir}/usr/bin

	install -d ${pkgdir}/usr/share/applications
    install ${srcdir}/$pkgname.desktop ${pkgdir}/usr/share/applications/

	install -d ${pkgdir}/usr/share/pixmaps
	install ${srcdir}/src/icons/torchat.png ${pkgdir}/usr/share/pixmaps/
}
