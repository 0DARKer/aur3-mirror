# Maintainer: Sergio Correia <sergio.correia@uece.net>
# Contributor: Oleg Smirnov <oleg.smirnov@gmail.com>
# Contributor: Luke McCarthy <luke@iogopro.co.uk>

pkgname=ns
pkgver=2.35
pkgrel=2
pkgdesc="Discrete event simulator targeted at networking research"
url="http://www.isi.edu/nsnam/ns/"
license='GPL'
depends=('gcc-libs' 'otcl')
makedepends=('tclcl')
arch=('i686' 'x86_64')
source=(http://downloads.sourceforge.net/sourceforge/nsnam/ns-2/$pkgver/ns-src-$pkgver.tar.gz
        ns-2.35-linkstate-erase.fix)
md5sums=('0885b3fe2560bf63e75493481197fb6e'
         '8cefd7866550495099bf73605da6a57c')

optdepends=('nam: Tcl/TK based animation tool for viewing network simulation traces',
	    'xgraph: X-Windows application for interactive plotting and graphing')
build() {
  cd ${srcdir}/${pkgname}-${pkgver}
  patch -Np1 -i ${srcdir}/ns-2.35-linkstate-erase.fix || return 1
  ./configure --prefix=$pkgdir/usr --with-tclcl=/usr/lib/tclcl || return 1
  make || return 1
}

package() {
  cd ${srcdir}/${pkgname}-${pkgver}
  install -d ${pkgdir}/usr/bin
  install -d ${pkgdir}/usr/share

  make install || return 1
  # fix man dir in the package
  mv ${pkgdir}/usr/man ${pkgdir}/usr/share
}
