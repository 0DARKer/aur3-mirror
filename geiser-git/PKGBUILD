# Maintainer: Neil Santos <nsantos16+aur@gmail.com>
# Contributor: Joachim Fasting <joachim.fasting@gmail.com>
pkgname=geiser-git
pkgver=20121115
pkgrel=1
pkgdesc='A major mode for Emacs-Scheme interaction'
arch=('any')
url='http://www.nongnu.org/geiser/'
license=('BSD')
optdepends=('racket: supported scheme implementation'
  'guile: supported scheme implementation')
depends=('emacs')
makedepends=('automake' 'git' 'emacs')
install=geiser.install
source=()
md5sums=()

_gitroot="http://git.savannah.gnu.org/r/geiser.git"
_gitname="geiser"

build() {
  cd "$srcdir"

  if [ -d "${srcdir}/${_gitname}/.git" ] ; then
    cd "${_gitname}" && git pull origin || return 1
  else
    git clone "${_gitroot}" || return 1
  fi

  ./autogen.sh || return 1

  mkdir -p "${srcdir}/${_gitname}/build"
  cd "${srcdir}/${_gitname}/build"

  ../configure --prefix="/usr" || return 1
  make all || return 1
  make DESTDIR="${pkgdir}" install || return 1

  install -D -m644 ../COPYING "${pkgdir}/usr/share/licenses/${pkgname}/COPYING"

  rm -rf "${srcdir}/${_gitname}/build"
}

# vi: set ft=sh ts=2 sw=2 sts=2 :
