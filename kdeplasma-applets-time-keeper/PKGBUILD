# Maintainer: hbdee <hbdee.arch@gmail.com>

pkgname=kdeplasma-applets-time-keeper
_pname=timekeeper
pkgver=0.3.1
pkgrel=2
pkgdesc="This plasmoid provides a clock and a calendar function via steampunk interface."
arch=('any')
url="http://kde-apps.org/content/show.php?content=159345"
license=('GPL')
depends=('kdebase-workspace' 'kdeedu-marble')
makedepends=('unzip')
conflicts=('kdeplasma-applet-time-keeper')
source=("http://kde-apps.org/CONTENT/content-files/159345-${_pname}-${pkgver}.plasmoid")
md5sums=('0ca68db060910a23f932e3fba480072a')

prepare() {
  unzip -o -q "$srcdir/159345-${_pname}-${pkgver}.plasmoid" -d "$srcdir/${_pname}"
}

package() {
  sed -i 's;icon.png;timekeeper.png;g' $srcdir/${_pname}/metadata.desktop
  install -Dm644 $srcdir/${_pname}/metadata.desktop ${pkgdir}/usr/share/kde4/services/${_pname}.desktop
  install -Dm644 $srcdir/${_pname}/icon.png $pkgdir/usr/share/pixmaps/timekeeper.png
  mkdir -p ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/{calendar,clock/wheels,luna,timekeeper}
  install -Dm644 $srcdir/${_pname}/metadata.desktop ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/metadata.desktop
  install -Dm644 $srcdir/${_pname}/contents/main.qml ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/main.qml
  install -Dm644 $srcdir/${_pname}/contents/calendar/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/calendar
  install -Dm644 $srcdir/${_pname}/contents/clock/{*.png,Clock.qml,Engravers_MT.ttf} ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/clock
  install -Dm644 $srcdir/${_pname}/contents/clock/wheels/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/clock/wheels
  install -Dm644 $srcdir/${_pname}/contents/luna/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/luna
  install -Dm644 $srcdir/${_pname}/contents/timekeeper/* ${pkgdir}/usr/share/apps/plasma/plasmoids/${_pname}/contents/timekeeper
}
 
