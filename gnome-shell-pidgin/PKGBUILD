# Contributor: Kozec <kozec at kozec dot com>
pkgname=gnome-shell-pidgin
pkgver=0.1
_pidginver=2.7.11
pkgrel=1
pkgdesc="Plugin for the Pidgin IM providing integration with gnome-shell user status menu."
url="http://sourceforge.net/projects/gnomeshpidgin/"
depends=('pidgin' 'dbus-core' 'libpurple')
source=(
	"http://downloads.sourceforge.net/gnomeshpidgin/gnomeShellPidgin.c"
	"http://downloads.sourceforge.net/pidgin/pidgin-${_pidginver}.tar.bz2"
	"include_dbus_server_add_version.patch"
	"Makefile"
	)
license=('GPL')
arch=('i686' 'x86_64')
md5sums=('09c4edcd6a1ce1c7008d942862cf7562'
         'c2e3374410b89057de83e3068d61e087'
         'aaf9f967f51ac5ea193ff40913d509a3')

build() {
	cd "$srcdir"
	mkdir -p "build"
	cd "build"
	[ ! -e pidgin ] && ln -s ../pidgin-${_pidginver} pidgin
	cp -L ../gnomeShellPidgin.c ../Makefile .
	patch -Np0 -i ../include_dbus_server_add_version.patch || return 1
	make gnomeShellPidgin.so || return 1
}

package() {
	mkdir -p "$pkgdir/usr/lib/purple-2/"
	cd "$srcdir/build"
	make DESTDIR="$pkgdir" install
}
