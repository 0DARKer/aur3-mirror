# Contributor: Christopher Heien <chris.h.heien@gmail.com>
pkgname="talend-profiler"
altname="TalendOpenProfiler"
pkgver="4.1.0"
_build="r49467"
pkgrel=1
pkgdesc="Data profiling suite."
arch=("i686 x86_64")
url=("http://www.talend.com")
license=("GPL2")
depends=("gtk2" "glib2")
source=("http://downloads.sourceforge.net/project/talendprofiler/talendprofiler/${pkgver}/TOP-All-${_build}-V${pkgver}.zip" 
	'OpenProfiler32bit.desktop'
	'OpenProfiler64bit.desktop')
sha1sums=("5668bf9aed3a97d6f9731b6be6e175e5e5d55abd"
	  "6e6737c6f5b03030fb8b2d0855e8cbe9d45f154e"
	  "18f96bb008ea91a6ab0c4430a803e6b0fa2de49f")
build(){
	
    mkdir -p $pkgdir/opt/talend $pkgdir/usr/bin $pkgdir/usr/share/applications
    mv $srcdir/TOP-All-${_build}-V${pkgver} $pkgdir/opt/talend/$altname
    cd $pkgdir/opt/talend/$altname
    
    #remove all non-Linux arch
    rm -rf  *macosx* && \
    rm -rf *solaris* && \
    rm -rf *gtk-ppc* && \
    rm -rf *win32* || return 1

    ln -s /opt/talend/$altname/$altname-linux-gtk-x86 $pkgdir/usr/bin || return 1
    ln -s /opt/talend/$altname/$altname-linux-gtk-x86_64 $pkgdir/usr/bin || return 1.    

    chmod +x $pkgdir/opt/talend/$altname/$altname-linux-gtk-x86 || return 1
    chmod +x $pkgdir/opt/talend/$altname/$altname-linux-gtk-x86_64 || return 1

    install --mode=0755 $srcdir/OpenProfiler32bit.desktop $pkgdir/usr/share/applications/OpenProfiler32bit.desktop || return 1
    install --mode=0755 $srcdir/OpenProfiler64bit.desktop $pkgdir/usr/share/applications/OpenProfiler64bit.desktop || return 1
}
