# This is a PKGBUILD for Gazebo from the Player/Stage project
# Contributor: Vladimir Ermakov <vooon341@gmail.com>
pkgname=gazebo
pkgver=0.8pre3
_pkgver="0.8-pre3"
pkgrel=2
pkgdesc="Robotic systems environment"
arch=(i686 x86_64)
url="http://playerstage.sf.net"
license=('GPL')
depends=('fltk' 'ogre' 'ode' 'gdal' 'libxml2') # ogre: ogre-branch-1.4 (v1.4.9) in AUR
makedepends=('pkgconfig' 'scons')
provides=('gazebo')
source=(http://mesh.dl.sourceforge.net/sourceforge/playerstage/${pkgname}-${_pkgver}.tar.gz
        patch.diff)
md5sums=('3e0c4fa87b28ad396d5d5074884724b3'
         'c0ac1f4beac967f58d63f099c79f932f')

build() {
  cd "$startdir/src/$pkgname-$_pkgver"

  patch -p0 < ../patch.diff

  #scons prefix=/usr destdir="$startdir/pkg" || return 1
  scons prefix=/usr destdir="$startdir/pkg" install || return 1

  # workaraund "scons: *** [install] /usr/share/gazebo/Media: Is a directory"
  mkdir "$startdir/pkg/usr/share"
  mkdir "$startdir/pkg/usr/share/$pkgname"
  cp -R ./Media "$startdir/pkg/usr/share/$pkgname"
  cp -R ./worlds "$startdir/pkg/usr/share/$pkgname"
}

# vim:set ts=2 sw=2 et:

