#Contributor: Chernmy <chernmy@gmail.com> 
#Maintainer: xgdgsc<xgdgsc@gmail.com>
pkgname=wiznote
pkgver=1.4
pkgrel=1
pkgdesc="Opensource Cross platform cloud note-taking application"
arch=('i686' 'x86_64')
url="https://github.com/WizTeam/WizQTClient"
license=('GPLv3')
depends=('qt' 'qtwebkit')

#PKGEXT=".pkg.tar"

if [ "${CARCH}" = 'x86_64' ]; then
    ARCH='x64'
    md5sums=('b4f1517ba4dcf0da217bc8ce2278109f' '79dc25087251d6ec57c693c677745133')
    #source=('http://download.wiz.cn/download?product=wiznote&client=linux-x64' 'wiznote.desktop')
else 
    ARCH='x86'
    md5sums=('55a885249043fa2a4585d65bdd6299fd' '79dc25087251d6ec57c693c677745133')
   #source=('http://download.wiz.cn/download?product=wiznote&client=linux-x86' 'wiznote.desktop')
fi


_source_name=${pkgname}_${pkgver}_${CARCH}.tar.gz
source=("${_source_name}::http://download.wiz.cn/download?product=wiznote&client=linux-$ARCH" "wiznote.desktop")

package() {
    #msg "Extracting..."
    #ar -xv wiznote-$pkgver-beta-$ARCH.deb || return 1
    #tar -xvf data.tar.gz || return 1
    #tar -xvf $srcname
    #msg2 "Done extracting!"
    msg "Copying files"
    mkdir -p $pkgdir/opt/wiznote
    mkdir -p $pkgdir/usr/share/applications
    #rm -rf $srcdir/wiznote_v$pkgver\_$ARCH/lib
    #rm -rf $srcdir/wiznote_v$pkgver\_$ARCH/plugins
    rm -rf $srcdir/lib
    rm -rf $srcdir/plugins
    cp -R $srcdir/* $pkgdir/opt/wiznote
    install -Dm644 "$srcdir/wiznote.desktop" "$pkgdir/usr/share/applications/wiznote.desktop"
    msg2 "Done copying files"
    rm -rf  $pkgdir/opt/wiznote/"$_source_name"
    rm -rf  $pkgdir/opt/wiznote/wiznote.desktop
}
