# Maintainer: M0Rf30

pkgname=pump.io
pkgver=0.3.0
pkgrel=1
pkgdesc="This is pump.io. It's a stream server that does most of what people really want from a social network"
url='http://pump.io'
license=('Apache')
arch=('i686' 'x86_64')
depends=('nodejs' 'graphicsmagick')
optdepends=('mongodb' 'redis')
provides=('pumpio')
conflicts=('pumpio-git' 'pumpio')
install=${pkgname}.install
backup=(etc/webapps/$pkgname/$pkgname.json)
source=(https://github.com/e14n/pump.io/archive/v$pkgver.tar.gz
        $pkgname.service
        $pkgname.json)

build() {
  cd $srcdir/$pkgname-$pkgver
  export PYTHON=/usr/bin/python2
  npm install
  npm install databank-mongodb
  npm install databank-redis
}

package() {
  cd $srcdir
  mkdir -p $pkgdir/usr/share/webapps/
  mkdir -p $pkgdir/usr/lib/systemd/system/
  mkdir -p $pkgdir/etc/webapps/$pkgname/

  cp -r $pkgname-$pkgver $pkgdir/usr/share/webapps/$pkgname
  cp $pkgname.json $pkgdir/etc/webapps/$pkgname/$pkgname.json
  cp $pkgname.service $pkgdir/usr/lib/systemd/system/
}


md5sums=('fdc06c33645594049eaab481af133f75'
         'b79cc45e7c19aaad1ffca2b9424914ed'
         'd072eb2d992586e013c06c64786fc4ca')
