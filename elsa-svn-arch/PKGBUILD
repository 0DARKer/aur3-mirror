# Contributor: Swift Geek <swiftgeek+spam@gmail.com>

pkgname=elsa-svn-arch
pkgver=59138
pkgrel=1
pkgdesc="Successor of the e17 display manager - Entrance"
url="http://trac.enlightenment.org/e"
license=("GPL")
arch=("i686" "x86_64")
provides=('elsa')
conflicts=('entrance')
depends=('elementary')
makedepends=('svn')
source=()
md5sums=()

_svntrunk="http://svn.enlightenment.org/svn/e/trunk/PROTO/elsa/"
_svnmod="elsa"

build ()
{
	cd $srcdir

# SVN checkout
	msg "Connecting to $_svntrunk SVN server...."
	if [ -d $_svnmod/.svn ]; then
		(cd $_svnmod && svn up -r $pkgver)
	else
		svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
	fi

	msg "SVN checkout done or server timeout"
	msg "Starting make..."
	cp -r $_svnmod $_svnmod-build
	cd $_svnmod-build
	./autogen.sh --prefix=/usr --sysconfdir=/etc
	make || return 1
	make DESTDIR=$pkgdir install || return 1

# install license files
	install -Dm644 $srcdir/$_svnmod-build/COPYING \
	$pkgdir/usr/share/licenses/$pkgname/COPYING

# install arch specific files
	install -Dm644 $startdir/elsa \
	$pkgdir/etc/pam.d/elsa

# install arch specific files
	install -Dm644 $startdir/elsa.conf \
	$pkgdir/etc/elsa.conf

# Clean after make :>	
	rm -r $srcdir/$_svnmod-build
}

