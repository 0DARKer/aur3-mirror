# Maintainer: archtux <antonio.arias99999@gmail.com>

pkgname=whaawmp-bzr
pkgver=568
pkgrel=1
pkgdesc="A GTK+ Media player written in python and using gstreamer"
arch=('i686' 'x86_64')
url="http://home.gna.org/whaawmp/"
license=('GPL3')
depends=('gstreamer0.10-good' 'gstreamer0.10-python' 'pygtk')
makedepends=('bzr' 'intltool')
conflicts=('whaawmp')

_bzrmod=whaawmp
_bzrtrunk=lp:whaawmp

build() {
   cd $srcdir

  msg "Connecting to the server...."

  if [ ! -d ./${_bzrmod} ]; then
    bzr co ${_bzrtrunk} ${_bzrmod}
  else
    bzr up ${_bzrmod}
  fi

  msg "BZR checkout done or server timeout"
  msg "Starting make..."


  cd whaawmp/

  #Python2 fix
  sed -i 's_exec python_exec python2_' whaaw-thumbnailer.sh whaawmp.sh
  sed -i 's_#!/usr/bin/env python_#!/usr/bin/env python2_' setup.py ./src/whaawmp.py ./po/potool.py
  sed -i 's_#! /usr/bin/env python_#! /usr/bin/env python2_' ./src/thumbnailer.py

  python2 setup.py install --root $pkgdir
}