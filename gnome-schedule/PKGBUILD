# Maintainer: Dan Serban
# Contributors: William Rea, Roman Kyrylych, Ionut Biru

pkgname=gnome-schedule
pkgver=2.x.x.latest
pkgrel=1
pkgdesc="GNOME frontend to cron and at"
arch=(i686 x86_64)
url=http://gnome-schedule.sourceforge.net/
license=(GPL)
depends=(at dcron gconf gnome-panel-bonobo gnome-python libglade pygtk)
makedepends=(intltool gnome-doc-utils lynx)
install=gnome-schedule.install

build()
{
  rm gnome-schedule.tar.gz 2>/dev/null || true
  _url=$(lynx -dump http://sourceforge.net/projects/gnome-schedule/ | grep -o http.*projects.*download)
  wget -O gnome-schedule.tar.gz ${_url}
  bsdtar -xf gnome-schedule.tar.gz
  cd $(ls -1d gnome-schedule-*/ | tail -1)
  export PYTHON=/usr/bin/python2
  export CRONTAB_CONFIG=/usr/bin/crontab
  ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var --disable-scrollkeeper
  make
  make -j1 GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1 DESTDIR="${pkgdir}" install
  mkdir -p "${pkgdir}"/usr/share/gconf/schemas
  gconf-merge-schema "${pkgdir}"/usr/share/gconf/schemas/gnome-schedule.schemas "${pkgdir}"/etc/gconf/schemas/*.schemas
  rm -rf "${pkgdir}"/etc/gconf/schemas/
}

