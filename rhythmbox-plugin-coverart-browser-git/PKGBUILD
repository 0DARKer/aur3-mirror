# Maintainer: Zhengyu Xu <xzy3186[at]gmail[dot]com>
pkgname=rhythmbox-plugin-coverart-browser-git
pkgver=20130221
pkgrel=1
pkgdesc="a Rhythmbox plugin that lets you browse and play your music via an album art view"
url="https://github.com/fossfreedom/coverart-browser"
arch=('x86_64' 'i686')
license=('GPLv3')
depends=('glib2' 'gtk3' 'rhythmbox' 'python2-mako' 'mutagen' 'python2-requests' 'python2-lxml')
conflicts=('rhythmbox-plugin-coverart-browser')
makedepends=('git')

_gitroot="git://github.com/fossfreedom/coverart-browser.git"
_gitname="coverart-browser"
install=$pkgname.install
build() {
  cd ${srcdir}
  msg2 "Connecting to GIT server..."
  if [[ -d "$_gitname" ]]; then
    cd "$_gitname" && git pull origin
    msg2 "The local files are updated."
  else
    git clone "$_gitroot" "$_gitname"
  fi
  msg2 "GIT checkout done or server timeout."
  cd "${srcdir}/$_gitname"
  ############# fix crash bugs ################
  #sed -i "s/self.entry_changed_id/#self.entry_changed_id/g" coverart_album.py
  #sed -i "s/self._entry_changed/#self._entry_changed/g" coverart_album.py

  make DESTDIR=${pkgdir} install
}

# vim:set ts=2 sw=2 et:
