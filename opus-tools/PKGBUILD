pkgname=opus-tools
pkgver=20120425
pkgrel=1
pkgdesc="Opus-tools is a collection of tools for working with opus files (currently under development)."
arch=(i686 x86_64)
url="http://wiki.xiph.org/Opus-tools"
license=(BSD)
depends=(opus)
source=()
md5sums=()
_gitroot="git://git.xiph.org/users/greg/opus-tools.git"
_gitname="opus-tools"

build(){
  cd "$srcdir"
  if [[ -d "$_gitname" ]]; then
    cd "$_gitname"
    git reset --hard && git clean -dxf
    git pull origin
  else
    git clone "$_gitroot" "$_gitname"
    cd "$_gitname"
  fi
  cd "$srcdir/$_gitname/src"

  sed -i "s/\.\.\/\.\.\/opus\/include/\\/usr\/include\/opus/" Makefile
  sed -i "s/\.\.\/\.\.\/opus\/\.libs\/libopus\.a/\/usr\/lib\/libopus\.a/" Makefile
  sed -i "s/\-Wall//" Makefile
  make
}

package() {
  cd "$srcdir/$_gitname/src"
  mkdir -p $pkgdir/usr/bin
  cp ./opusdec $pkgdir/usr/bin
  cp ./opusenc $pkgdir/usr/bin
} 

