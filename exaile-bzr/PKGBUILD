# Contributor: Stefan Lohmaier <noneuss at gmail doot com>
# Contributor: Aren Olson <reacocard@gmail.com>

pkgname=exaile-bzr
pkgver=3865
pkgrel=1
pkgdesc="Exaile is a full-featured music player for GTK+"
url="http://www.exaile.org"
license=('GPL2' 'GPL3')
arch=('i686' 'x86_64')
depends=('python' \
    'gstreamer0.10-python' \
    'gstreamer0.10-good-plugins' \
    'mutagen' \
    'dbus-python' \
    'pygtk>=2.14' \
    'python2-bsddb')
makedepends=('bzr' 'make')
optdepends=('pycddb: CD metadata retrieval' \
    'hal: device autodetection' \
    'gstreamer0.10-bad-plugins: replaygain, equalizer, more codecs' \
    'gstreamer0.10-ugly-plugins: more codecs' \
    'gstreamer0.10-ffmpeg: more codecs')
provides=('exaile')
conflicts=('exaile' 'exaile-svn')
replaces=('exaile-svn')
source=()
md5sums=()
sha1sums=()

_bzrmod=exaile
_bzrtrunk=http://bazaar.launchpad.net/~exaile-devel/exaile/exaile-0.3.x

build() {
  cd $startdir/src
  msg "Connecting to the server...."

  if [ -d ./$_bzrmod ]; then
    cd ./$_bzrmod && bzr up && cd ..
  else
    bzr co --lightweight $_bzrtrunk $_bzrmod
  fi

  [ -d ./$_bzrmod-build ] && rm -fr ./$_bzrmod-build
  cp -r ./$_bzrmod ./$_bzrmod-build
  cd ./$_bzrmod-build

  msg "Checkout done or server timeout"
  msg "Starting make..."

  make PREFIX=/usr DESTDIR=$startdir/pkg install
}
