# Maintainer: Pierre-Antoine Paganelli pavanpe@yahoo dot fr
# Based on Chris Bolton <http://scr.im/chris-kun> PKGBUILD
pkgname=utorrent-server
pkgver=25376
pkgrel=2
pkgdesc="uTorrent's linux-native server intended for users seeking a fast, commandline only client with remote web-based management."
arch=('i686' 'x86_64')
url="http://www.utorrent.com/downloads/linux"
license=(custom)
makedepends=('unzip')
depends=('glibc' 'gcc-libs' 'bash' 'openssl098' 'zlib')
conflicts=('utserver')
install=$pkgname.install


if [[ $CARCH == i686 ]]; then
source=(http://download.utorrent.com/linux/utorrent-server-3.0-25053.tar.gz https://sites.google.com/site/ultimasites/files/utorrent-webui.2011052812020568.zip utserver.conf utserver utserver.sh EULA)
md5sums=('49f6376e9df19f773763180464367c2c'
	 'cc3abcac5b78f4689438937e44ffcc94'
         '8775b57e10241709a5a3b582a3b11d3f'
         '028f1c75f82516535f07c8136d6b8c51'
         '96bc6f7c70ed629efbcae17a13a84f9b'
         '1d419096bb07845f7e64ad9a7b10d963')

else 
source=(http://download.utorrent.com/linux/utorrent-server-3.0-ubuntu-25376.x64.tar.gz https://sites.google.com/site/ultimasites/files/utorrent-webui.2011052812020568.zip utserver.conf utserver utserver.sh EULA)
md5sums=('5be6a068d42c1b350d69f67f52cc4805'
	 'cc3abcac5b78f4689438937e44ffcc94'
         '8775b57e10241709a5a3b582a3b11d3f'
         '028f1c75f82516535f07c8136d6b8c51'
         '96bc6f7c70ed629efbcae17a13a84f9b'
         '1d419096bb07845f7e64ad9a7b10d963')

fi

build() {
  install -dm755 $pkgdir/usr/share/doc/utserver
  install -dm755 $pkgdir/usr/share/utserver/{webui,webui2,downloads/in_progress,torrents,.tmp}  
}

package() {
  cd $srcdir/utorrent-server-v3_0
  install -Dm755 utserver $pkgdir/usr/bin/utserver
  install -m644 docs/* $pkgdir/usr/share/doc/utserver
  unzip webui.zip -d $pkgdir/usr/share/utserver/webui2
  cd $srcdir
  unzip utorrent-webui.2011052812020568.zip -d $pkgdir/usr/share/utserver/webui
  install -m755 utserver.conf $pkgdir/usr/share/utserver
  install -m755 utserver.sh $pkgdir/usr/share/utserver
  install -Dm755 utserver $pkgdir/etc/rc.d/$pkgname
  install -Dm755 EULA $pkgdir/usr/share/licenses/utserver/EULA
}
