# Maintainer: Diego <cdprincipe@at@gmail@dot@com>
# Contributor: Matias De Lellis
# Contributor: bailey385 <bailey7698@163.com>

_pkgname=pragha
pkgname=${_pkgname}-git
pkgver=v1.1.1.780.gefafdb5
pkgrel=1
pkgdesc="A lightweight GTK+ music player"
arch=('i686' 'x86_64')
url="http://pragha.wikispaces.com/"
license=('GPL')
depends=('git' 'gstreamer0.10-base' 'gtk2' 'libcdio' 'libnotify' 'sqlite3' 'desktop-file-utils' 'taglib' 'dbus-glib' 'hicolor-icon-theme')
optdepends=('exo: better session management'
            'liblastfm_c-git: last.fm scrobbling'
            'keybinder: global keyboard shortcuts'
            'glyr-git: search lyrics, artists info, and album art')
makedepends=('autoconf' 'xfce4-dev-tools')
provides=('pragha')
conflicts=('pragha')
options=('!libtool')

install=pragha.install
source=(git+git://github.com/matiasdelellis/pragha.git
        'cdio-includes.patch')
md5sums=('SKIP'
         'd7d32211076534a6ac31862d8cd93a7d')


pkgver() {
  cd $srcdir/$_pkgname
  git describe --always | sed 's|-|.|g'
}

prepare() {
  cd $srcdir/$_pkgname
  patch -Np1 -i "$srcdir/cdio-includes.patch"
}

build() {
  cd $srcdir/$_pkgname

  LIBS+="-ldbus-glib-1"

  ./autogen.sh
  ./configure --prefix=/usr

  make
#  make all-recursive
}

package() {
  cd $srcdir/$_pkgname
  make ${MAKEFLAGS} DESTDIR=${pkgdir} install
#  install -m 644 data/pragha.desktop ${pkgdir}/usr/share/applications
#  install -d ${pkgdir}/usr/share/pixmaps
#  install -m 644 data/pragha.png ${pkgdir}/usr/share/pixmaps/
#  install -m 644 data/pragha.1 ${pkgdir}/usr/share/man/man1/
}

