# Maintainer: Andrea Cattaneo <andrea.cattaneo.dev@gmail.com>

pkgname=genymotion

pkgver=2.0.1

pkgrel=2

pkgdesc="Genymotion is a complete set of tools that provides a virtual environment for Android."

arch=('i686' 'x86_64')

license="UNKNOWN"

md5sums=('adf7d7e019c5e265e536f987176f4908')

if test "$CARCH" == x86_64; then
	_ARCH="x64"
	md5sums+=('65723e3fbea1765ea25284ed5a62f4dd')
else
	_ARCH="x86"
	md5sums+=('fafd8e84504eac85619df6a7054945ee')
fi

url="http://www.genymotion.com/"

depends=('virtualbox>=4.1.1' 'qt4' 'qtwebkit' 'gcc-libs' 'glib2' 'libpng12' 'libsm' 'libxrender' 'fontconfig' 'libx11' 'bzip2' 'expat' 'libxau' 'libxdmcp' 'openssl' 'net-tools' )

optdepends=('android-sdk: for developers')

install=genymotion.install

source=("genymotion.desktop" "https://ssl-files.genymotion.com/genymotion/genymotion-${pkgver}/genymotion-${pkgver}_${_ARCH}.bin")

build() {
  cd $srcdir

  chmod +x ${pkgname}-${pkgver}_${_ARCH}.bin

}
package(){
	cd $pkgdir
	install -d "$pkgdir/opt"
	yes | ${srcdir}/${pkgname}-${pkgver}_${_ARCH}.bin -d $pkgdir/opt/genymotion
	rm opt/genymotion/libQt*
	install -d "$pkgdir/usr/bin/"
	ln -s /opt/genymotion/genymotion $pkgdir/usr/bin/genymotion
    ln -s /opt/genymotion/genymotion-shell $pkgdir/usr/bin/genymotion-shell
	install -Dm644 "$srcdir/genymotion.desktop" "$pkgdir/usr/share/applications/genymotion.desktop"

}