# Maintainer: Andrea Cattaneo <andrea.cattaneo.dev@gmail.com>

pkgname=genymotion

pkgver=2.1.0

pkgrel=1

pkgdesc="Complete set of tools that provides a virtual environment for Android."

arch=('i686' 'x86_64')

license="UNKNOWN"

md5sums=('dad138a5aaa3060e44279ea6a6114860')

if test "$CARCH" == x86_64; then
    _ARCH="x64"
    md5sums+=('7a89dd4c13f4a75178049402eba93f21')
else
    _ARCH="x86"
    md5sums+=('2e49c1e4bff9e75d9b180f19abc71600')
fi

url="http://www.genymotion.com/"

depends=('virtualbox>=4.1.1' 'qtwebkit' 'libpng12' 'net-tools' 'qca' 'ffmpeg-compat' 'protobuf')

optdepends=('android-sdk: for developers')

install=genymotion.install
source=("genymotion.desktop" "http://files2.genymotion.com/genymotion/genymotion-${pkgver}/genymotion-${pkgver}_${_ARCH}.bin")

build() {
    cd $srcdir
    chmod +x ${pkgname}-${pkgver}_${_ARCH}.bin
}

package(){
    cd $pkgdir
    install -d "$pkgdir/usr"
    yes | ${srcdir}/${pkgname}-${pkgver}_${_ARCH}.bin -d $pkgdir/usr/ &>/dev/null
    rm usr/genymotion/libQt*
    install -d "$pkgdir/usr/bin/"
    ln -s /usr/genymotion/genymotion $pkgdir/usr/bin/genymotion
    ln -s /usr/genymotion/genymotion-shell $pkgdir/usr/bin/genymotion-shell
    install -Dm644 "$srcdir/genymotion.desktop" "$pkgdir/usr/share/applications/genymotion.desktop"
    chown -R root:root $pkgdir/usr/genymotion
}