From c305191e45260b364b2d00ec4b149092de66853b Mon Sep 17 00:00:00 2001
From: xantares <xantares09@hotmail.com>
Date: Tue, 26 Aug 2014 12:08:58 +0000
Subject: [PATCH 5/5] cmake: build scangui

---
 CMakeLists.txt         |  6 ++++--
 scangui/CMakeLists.txt | 14 ++++++++++++++
 2 files changed, 18 insertions(+), 2 deletions(-)
 create mode 100644 scangui/CMakeLists.txt

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 86c9c85..3e51187 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -140,8 +140,10 @@ configure_file (cconf.h.in cconf.h)
 add_subdirectory(scantool)
 
 if (BUILDGUI)
-	#add_subdirectory(scangui)
-	message(FATAL_ERROR "scangui can't be built through cmake yet")
+	find_package(FLTK)
+	if (FLTK_FOUND)
+		add_subdirectory(scangui)
+	endif()
 endif ()
 
 ###### misc files to include in bin packages
diff --git a/scangui/CMakeLists.txt b/scangui/CMakeLists.txt
new file mode 100644
index 0000000..3ea00bc
--- /dev/null
+++ b/scangui/CMakeLists.txt
@@ -0,0 +1,14 @@
+### build source file lists (useful later)
+set (SCANGUI_SRCS scangui.cxx scangui.h scanguiCallbacks.cxx scanguiInit.cxx )
+set (SCANGUI_HEADERS scangui.h)
+
+# scangui binary
+add_custom_command(OUTPUT scangui.cxx scangui.h
+		   COMMAND ${FLTK_FLUID_EXECUTABLE} -c ${CMAKE_CURRENT_SOURCE_DIR}/scangui.fl
+                   DEPENDS scangui.fl)
+include_directories(${CMAKE_CURRENT_BINARY_DIR})
+
+add_executable(scangui ${SCANGUI_SRCS} ${SCANGUI_HEADERS})
+target_link_libraries(scangui ${FLTK_LIBRARIES})
+install(TARGETS scangui DESTINATION bin)
+
-- 
2.1.0

