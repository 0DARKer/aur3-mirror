# Maintainer : SpepS < dreamspepser at yahoo dot it >
# Contributor: Ronald van Haren <ronald.archlinux.org>
# Contributor: JJDaNiMoTh <jjdanimoth.aur@gmail.com>

_pkgname=compiz-decorator-gtk
pkgname=compiz-decorator-gtk-no-gnome
pkgver=0.8.6
pkgrel=1
pkgdesc="Decorator of Compiz for GNOME"
url="http://www.go-compiz.org/"
license=('GPL2' 'LGPL2' 'MIT')
arch=('i686' 'x86_64')
depends=('compiz-core' 'libwnck>=2.28')
makedepends=('metacity>=2.28' 'intltool>=0.23')
groups=('compiz')
options=('!libtool' '!emptydirs')
conflicts=('compiz-git' 'compiz-decorator-gtk-git' 'compiz-decorator-gtk')
provides=('compiz-decorator-gtk')
source=(http://releases.compiz.org/$pkgver/compiz-$pkgver.tar.gz)
install=compiz-decorator-gtk.install
md5sums=('af0586557e0291c47b924e33bccacc60')

build()
{
  cd $srcdir/compiz-$pkgver
  
  ./configure --prefix=/usr --sysconfdir=/etc \
	    --disable-gnome \
	    --disable-librsvg \
	    --enable-metacity \
	    --enable-gtk \
	    --enable-gconf \
	    --with-gconf-schema-file-dir=/etc/gconf/schemas \
	    --disable-dbus \
	    --disable-annotate \
	    --disable-kde || return 1

  make || return 1

  pushd gtk
  make DESTDIR=$pkgdir install || return 1
  mkdir -p $startdir/pkg/usr/share/gconf/schemas
  install -m644 window-decorator/gwd.schemas \
                $startdir/pkg/usr/share/gconf/schemas/gwd.schemas
  popd

  for i in dbus gconf ini inotify png regex svg glib kconfig
  do
    rm $startdir/src/compiz-$pkgver/metadata/compiz-$i.schemas
  done

  gconf-merge-schema \
    ${startdir}/pkg/usr/share/gconf/schemas/${_pkgname}.schemas \
      	$startdir/src/compiz-$pkgver/metadata/*.schemas

  rm -rf ${startdir}/pkg/etc

# install MIT license
install -Dm644 $srcdir/compiz-$pkgver/COPYING.MIT \
	$pkgdir/usr/share/licenses/${_pkgname}/COPYING.MIT
}
