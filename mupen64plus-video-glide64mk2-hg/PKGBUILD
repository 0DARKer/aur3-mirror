# Contributer: BeholdMyGlory <larvid@gmail.com>
pkgname=mupen64plus-video-glide64mk2-hg
pkgver=77
pkgrel=1
pkgdesc="Video plugin for Mupen64Plus 2.0 based on 10th anniversary release code from gonetz. Latest hg pull."
url="http://bitbucket.org/richard42/mupen64plus-video-glide64mk2"
license=("GPL")
arch=(i686 x86_64)
groups=(mupen64plus-hg)
depends=(mupen64plus-core-hg boost)
makedepends=(mercurial)
source=("${pkgname%-*}::hg+http://bitbucket.org/richard42/mupen64plus-video-glide64mk2")
md5sums=('SKIP')

pkgver() {
	"$SRCDEST/${pkgname%-*}"
	hg identify -ni | awk 'BEGIN{OFS=".";} {print $2,$1}'
}

build() {
	cd "${srcdir}/${pkgname%-*}"
	sed -i "s,BOOST_SUFFIX ?= -mt,BOOST_SUFFIX ?= ,g" "projects/unix/Makefile"
	sed -i "s,BOOST_THREAD_SUFFIX ?= -mt,BOOST_THREAD_SUFFIX ?= ,g" "projects/unix/Makefile"
	make -C projects/unix all NO_RESAMP=0
}

package() {
	cd "${srcdir}/${pkgname%-*}"
	make -C projects/unix PREFIX=/usr DESTDIR=${pkgdir} install
}