# Maintainer: Jakob Nixdorf <flocke [swirly thing] shadowice [dot] org>

pkgname=perl-javascript
pkgver=1.16
pkgrel=1
pkgdesc="Perl extension for executing embedded JavaScript"
depends=('perl>=5.10.0' 'glibc' 'perl-test-exception' 'spidermonkey' 'xulrunner' 'nspr')
license=('GPL' 'PerlArtistic')
url="http://search.cpan.org/dist/JavaScript/"
source=(http://search.cpan.org/CPAN/authors/id/C/CL/CLAESJAC/JavaScript-$pkgver.tar.gz)
options=('force' '!emptydirs')
arch=(i686 x86_64)

build()
{
  cd ${srcdir}/JavaScript-$pkgver

  # dirty hack to pass the correct includes to the script
  export JS_THREADSAFE=1 JS_UTF8=1 JS_ENABLE_E4X=1 JS_INC="/usr/include/js -I/usr/include/xulrunner-1.9.2 -I/usr/include/nspr"
  perl Makefile.PL INSTALLDIRS=vendor || return 1
  make || return 1
  make DESTDIR=${pkgdir} install || return 1
  
  # Remove .packlist and perllocal.pod files.
  find ${pkgdir} -name '.packlist' -delete
  find ${pkgdir} -name 'perllocal.pod' -delete

}

md5sums=('c3c4a744e0a5018b94f53341baa18df7')
