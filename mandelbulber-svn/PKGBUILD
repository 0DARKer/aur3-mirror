# Maintainer: Wilfried Fauvel <wilfried.fauvel at gmail>

pkgname=mandelbulber-svn
pkgver=93
pkgrel=1
pkgdesc='Mandelbulber is an easy to use, handy but experimental application designed to help you render 3D Mandelbrot fractals called Mandelbulb and some other kind of 3D fractals like Mandelbox, Bulbbox, Juliabulb, Menger Sponge.'
arch=('i686' 'x86_64')
url='http://code.google.com/p/mandelbulber/'
license=('GPL')
depends=('gtk2' 'libjpeg' 'libsndfile' 'libpng12')
makedepends=('subversion' 'cmake')
provides=('mandelbulber')
conflicts=('mandelbulber')
source=()
install=mandelbulber.install
md5sums=()

_svnmod="mandelbulber"
_svntrunk="http://mandelbulber.googlecode.com/svn/trunk/"

build() {

  # Connecting to SVN
  if [ -d ${_svnmod}/.svn ]; then
  (cd ${_svnmod} && svn up -r $pkgver)
  else
  svn co ${_svntrunk} --config-dir ./ -r $pkgver ${_svnmod}
  fi

  msg "SVN checkout done or server timeout"
  msg "Starting cmake..."

  # Build
  cd ${_svnmod}/src
  cmake .
  cmake --build . 

  # Install
  install -m755 -d "${pkgdir}/usr/share/mandelbulber"
  install -m755 -d "${pkgdir}/usr/bin"

  install -Dm755 "${srcdir}/mandelbulber/src/mandelbulber" \
                 "${pkgdir}/usr/bin/"

  install -m755 -d "${pkgdir}/usr/share/mandelbulber/.mandelbulber"
  mv ${srcdir}/mandelbulber/mandelbulber/.mandelbulber ${pkgdir}/usr/share/mandelbulber/
  chmod -R 755 ${pkgdir}/usr/share/mandelbulber/.mandelbulber
}

