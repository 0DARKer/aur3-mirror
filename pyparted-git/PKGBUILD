# Maintainer: Gen2ly <dirk.r.gently@gmail.com>
pkgname=pyparted-git
pkgver=20090821
pkgrel=1
pkgdesc="Python bindings for libparted"
arch=('any')
url="https://fedorahosted.org/pyparted/"
license=('GPL2')
depends=('python' 'python-decorator' 'parted-git')
makedepends=('git')
source=()

_gitroot="git://git.fedorahosted.org/pyparted.git/"
_gitname="pyparted"

build() {
  cd ${srcdir}
  msg "Connecting to git.fedorahosted.org GIT server...."

  if [ -d ${srcdir}/$_gitname ] ; then
    cd $_gitname && git pull origin
    msg "The local files are updated."
    else
    git clone $_gitroot
  fi

# Bug: Undefined Module Constant
#sed -i -e "s:    PyModule_AddIntConstant(m, "PARTITION_APPLE_TV_RECOVERY", PED_PARTITION_APPLE_TV_RECOVERY);:/*    PyModule_AddIntConstant(m, "PARTITION_APPLE_TV_RECOVERY", PED_PARTITION_APPLE_TV_RECOVERY); */:g" ${srcdir}/$_gitname/src/_pedmodule.c
# Ugly hack, as couldn't get above to work
sed -i -e "482d" ${srcdir}/$_gitname/src/_pedmodule.c

  cd ${srcdir}/$_gitname
  sh autogen.sh
  ./configure --prefix=/usr
  make || return 1
  make DESTDIR="$pkgdir/" install || return 1
}

md5sums=()
