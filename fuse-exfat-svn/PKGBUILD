# Maintainer: Bob Valantin <valantin89@gmail.com>

pkgname=fuse-exfat-svn
pkgver=330
pkgrel=1
pkgdesc="Free exFAT file system implementation"
arch=('i686' 'x86_64')
url="http://code.google.com/p/exfat/"
license=('GPL3')
depends=('fuse')
makedepends=('scons' 'subversion')
optdepends=('exfat-utils-git: utilities for exFAT file system'
            'util-linux: to mount exFAT volumes automatically')
provides=('fuse-exfat')
conflicts=('fuse-exfat')
source=()
md5sums=()

_svnname="fuse-exfat"
_svntrunk="https://exfat.googlecode.com/svn/trunk/"

package() {
  cd ${srcdir}
  
  msg "Connecting to SVN server..."
  
  if [ -d ${_svnname}/.svn ]; then
    (cd ${_svnname} && svn up && cd -)
  else
    svn co ${_svntrunk} ${_svnname}
  fi
  
  msg "Starting build..."
  svn export ${_svnname} ${_svnname}-build
  cd ${_svnname}-build
  rm -r dump fsck label mkfs

  scons CCFLAGS="${CFLAGS}" LINKFLAGS="${LDFLAGS} " install DESTDIR="${pkgdir}/usr/bin"
  
  # Install man page
  install -Dm444 fuse/mount.exfat-fuse.8 "${pkgdir}/usr/share/man/man8/mount.exfat-fuse.8"
}  
