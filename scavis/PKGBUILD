# Maintainer: jdarch <jda -dot- cloud -plus- archlinux -at- gmail -dot- com>

pkgname=scavis
pkgver=1.7
pkgrel=1
pkgdesc="An environment for scientific computation, data analysis and data visualization"
arch=('any')
url="http://jwork.org/scavis/"
license=('custom')
depends=('java-runtime')
source=("${pkgname}.png"
        "${pkgname}.desktop"
        "http://sourceforge.net/projects/scavis/files/${pkgver}/${pkgname}-${pkgver}.zip")
md5sums=('7497f0ea6fc54e4a927a9deb01d88154'
         '833aa84ff09e48d6fcd681f24aee0d7c'
         '1523b0e231d955993bcf77365ded36b7')
sha512sums=('c8ee268ed079f6b2dd4b0d14910e0e107460e89aadee082759d6a04d1090909735c6601cdaec57227efc444ef392471f090fd78517ebc64ece7a8cec773ab6a4'
            '6f53e07d8b2b2cff762c04c4f2eec6a61ae356493cf726a6ad8361fbbcca28d81adbab7ac41d912fae3366fedd845dbba9ddf029bdefbabe70df9a03d004d62d'
            'df849e5908ff513d7480ac8629c8c66f20c5d016455f2338b381c06cd104aab8cc11cba00fc28a317595243c6bb35e1b56e5e4e24af6ebe63fb2ef9bdb0bfc31')

prepare() {
  rm "${srcdir}/${pkgname}/"*.bat
  sed -i "s#\`pwd\`#\"/usr/share/java/${pkgname}\"#g" "${srcdir}/${pkgname}/${pkgname}.sh"
  sed -i 's#JYTHON_HOME=$JEHEP_HOME\"/lib/jython\"#JYTHON_HOME=$HOME\"/.jehep/jython\"#g' "${srcdir}/${pkgname}/${pkgname}.sh"
}

package() {
  install -d "${pkgdir}/usr/share/java/${pkgname}/"
  cp -dr --no-preserve=mode,ownership "${srcdir}/${pkgname}/"* "${pkgdir}/usr/share/java/${pkgname}/"
  install -m644 -D "${srcdir}/${pkgname}/Docs/license.txt" "${pkgdir}/usr/share/licenses/${pkgname}/license.txt"
  install -m755 -D "${srcdir}/${pkgname}/${pkgname}.sh" "${pkgdir}/usr/bin/${pkgname}.sh"
  install -m644 -D "${srcdir}/${pkgname}.png" "${pkgdir}/usr/share/pixmaps/${pkgname}.png"
  install -m644 -D "${srcdir}/${pkgname}.desktop" "${pkgdir}/usr/share/applications/${pkgname}.desktop"
}
