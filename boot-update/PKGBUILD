# Mantainer: William DÃ­az <wdiaz[at]archlinux[dot]us>

pkgname=boot-update
pkgver=1.4.9
pkgrel=1
pkgdesc="Funtoo Core Boot Framework for global boot loader configuration"
arch=("i686" "x86_64")
url="http://funtoo.org/en/funtoo/core/boot/"
license=("GPL3")
depends=('python' 'grub2')
makedepends=()
install="${pkgname}.install"
binfont="grub-unifont-1.0"
source=("http://www.funtoo.org/archive/${pkgname}/${pkgname}-${pkgver}.tar.bz2"
        "http://www.funtoo.org/archive/grub/${binfont}.tar.bz2"
        "boot.conf.example")
md5sums=('7c6e9b0dfa175fe5a2bba2026e7a4e9f'
         '568d7d4a0938d950f6b3596b6c658b21'
         '5619c35bf437061744fa294d5eaca68e')

build() {
  echo "Nothing to compile"
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  # Install Python Modules
  install -d "${pkgdir}"/usr/lib/python2.6/site-packages/
  cp -R python/modules/funtoo "${pkgdir}"/usr/lib/python2.6/site-packages/ || return 1

  # Install bin
  install -d "${pkgdir}"/sbin
  install sbin/boot-update "${pkgdir}"/sbin || return 1

  # Documentation
  install -d "${pkgdir}"/etc
  install -m644 "${srcdir}"/boot.conf.example "${pkgdir}"/etc || return 1

  install -d  "${pkgdir}"/usr/share/doc/"${pgname}"
  install -m644 doc/*.rst "${pkgdir}"/usr/share/doc/"${pgname}" || return
  install -m644 "${srcdir}"/boot.conf.example "${pkgdir}"/usr/share/doc/"${pgname}" || return 1

  install -d "${pkgdir}"/usr/share/man/{man8,man5} || return
  [ -e doc/boot.conf.5 ] && gzip doc/boot.conf.5
  [ -e doc/boot-update.8 ] &&  gzip doc/boot-update.8
  install -m644 doc/boot.conf.5.gz "${pkgdir}"/usr/share/man/man5
  install -m644 doc/boot-update.8.gz "${pkgdir}"/usr/share/man/man8

  # Install Unifont
  cp -R "${srcdir}"/boot "${pkgdir}" || return 1
}
