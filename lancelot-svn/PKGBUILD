# Contributor: Andrey Pirozhkov tabwizard@gmail.com
pkgname=lancelot-svn
pkgver=1.7
pkgrel=1
pkgdesc="Lancelot is an application launcher menu (or ALI) for KDE 4 designed to provide a place from which all your jobs begin."
arch=('i686' 'x86_64')
url="http://lancelot.fomentgroup.org/main"
license=('GPL')
depends=('kdelibs' 'kdebase-workspace')
makedepends=('cmake' 'subversion' 'python' 'automoc4')
source=()
build() {
    svn co -N svn://anonsvn.kde.org/home/kde/branches/KDE/4.2/kdeplasma-addons/
    svn up -N kdeplasma-addons/applets
    svn up kdeplasma-addons/applets/lancelot
    cd kdeplasma-addons
    awk '{if($1~/add_subdirectory/) {print ("#") $1} else {print}}' CMakeLists.txt > CMakeLists.txt1
    awk '{if($1~/add_subdirectory\(applets/) {print "add_subdirectory(applets)"} else {print}}' CMakeLists.txt1 > CMakeLists.txt
    rm ./CMakeLists.txt1
    cd applets
    awk '{if($1~/add_subdirectory/) {print ("#") $1} else {print}}' CMakeLists.txt > CMakeLists.txt1
    awk '{if($1~/add_subdirectory\(lancelot/) {print "add_subdirectory(lancelot)"} else {print}}' CMakeLists.txt1 > CMakeLists.txt
    rm ./CMakeLists.txt1
    cd ..
    mkdir build
    cd build
    cmake .. -DCMAKE_INSTALL_PREFIX=`kde4-config --prefix` -DCMAKE_BUILD_TYPE=release
    make VERBOSE=1 || return 1
    make DESTDIR=$startdir/pkg install || return 1
}