# Contributor: Jed Brown <jed@59A2.org>
pkgname=(parmetis-mpich)
_prefix=/opt/mpich
pkgver=4.0.2p3
_pkgver=4.0.2-p3
pkgrel=1
pkgdesc="A parallel graph partitioning library, built against MPICH"
url="http://glaros.dtc.umn.edu/gkhome/metis/parmetis/overview"
arch=('i686' 'x86_64')
license="custom"
depends=(mpich metis)
makedepends=(cmake)
conflicts=()
replaces=(hdf5-mpich2)
backup=()
source=(http://ftp.mcs.anl.gov/pub/petsc/externalpackages/parmetis-${_pkgver}.tar.gz)
md5sums=('320c32122981b51f3f03ab01bd1e2b3e')
# "Upstream" is unmaintained and does not reply or apply to critical patches
#source=(http://glaros.dtc.umn.edu/gkhome/fetch/sw/parmetis/parmetis-$pkgver.tar.gz)

build() {
  cd $srcdir/parmetis-$_pkgver
  make config cc=${_prefix}/bin/mpicc mpicc=${_prefix}/bin/mpicc mpicxx=${_prefix}/bin/mpicxx shared=1 prefix=${_prefix}
  make
}

package () {
  cd $srcdir/parmetis-$_pkgver
  make install DESTDIR=$pkgdir
}
