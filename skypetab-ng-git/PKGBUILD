pkgname=skypetab-ng-git
_pkgname=skypetab-ng
pkgver=v0.5.0.fixed.23.gbdc9887
pkgrel=1
pkgdesc='A program that adds tabs to Skypeâ„¢ for Linux'
url='http://keks-n.net/skypetab'
arch=('i686' 'x86_64')
license=('GPL')
depends=('qt4' 'qtwebkit' 'skype')
options=(!strip)
makedepends=('git')
[[ "${CARCH}" = 'x86_64' ]] && makedepends+=('gcc-multilib')
source=('git+http://github.com/kekekeks/skypetab-ng.git' 'skypetab-ng.sh')
_gitname=skypetab-ng
sha1sums=('SKIP' 'b6bf1bcaf0b278793367b07830b1e8bac0beea45')

pkgver () {
  cd ${_gitname}
  echo $(git describe --always | sed 's/-/./g')
}

build() {
  cd ${_gitname}
  qmake-qt4 -spec linux-g++-32 
}

package() {
  cd ${_gitname}
  make INSTALL_ROOT=${pkgdir} install
  # moving libs to /usr/lib32 instead of /usr/lib on 64-bit systems
  [[ "${CARCH}" = 'x86_64' ]] && mv ${pkgdir}/usr/lib ${pkgdir}/usr/lib32
  if [[ $CARCH == i686 ]]; then
	_libdir="usr/lib"
  else
	_libdir="usr/lib32"
  fi
  # replace skypetab-ng script with updated one
  sed "s#@LIBDIR@#/${_libdir}#" "${srcdir}/${_pkgname}.sh" > "${pkgdir}/usr/bin/${_pkgname}"
  chmod +x "${pkgdir}/usr/bin/${_pkgname}"
}
