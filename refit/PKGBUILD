# Contributor : Alessio 'mOLOk' Bolognino <themolok at gmail dot com>

pkgname=refit
pkgver=0.14
pkgrel=1
pkgdesc="A GUI bootloader for Apple-Intel Macs and other (U)EFI based systems"
arch=('i686' 'x86_64')
license=('BSD')
depends=('glibc' 'gnu-efi')
url="http://refit.sourceforge.net"
source=(http://downloads.sourceforge.net/refit/refit-src-${pkgver}.tar.gz)

md5sums=('16f02fa5b5decdee17eebd5cd863b3f0')

build() {
    
    cd ${srcdir}/refit-src-${pkgver}/
    
    make -C libeg 
    make -C refit
    
    make -C gptsync -f Makefile.unix
    rm ${srcdir}/refit-src-${pkgver}/gptsync/gptsync.o
    
    make -C gptsync -f Makefile

}

package() {

    cd ${srcdir}/refit-src-${pkgver}/
    
    install -D ${srcdir}/refit-src-${pkgver}/gptsync/gptsync ${pkgdir}/sbin/gptsync
    install -D -m644 ${srcdir}/refit-src-${pkgver}/refit/refit.efi ${pkgdir}/usr/lib/refit/refit/refit.efi
    install -D -m644 ${srcdir}/refit-src-${pkgver}/gptsync/gptsync.efi ${pkgdir}/usr/lib/refit/tools/gptsync.efi

    # install the man page
    install ${srcdir}/refit-src-${pkgver}/gptsync/gptsync.8 ${pkgdir}/usr/share/man/man8/gptsync.8
        
    # install the license
    install -D ${srcdir}/refit-src-${pkgver}/LICENSE.txt ${pkgdir}/usr/share/licenses/refit/LICENSE
    
}
