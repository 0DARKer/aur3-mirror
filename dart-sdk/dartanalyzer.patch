--- src/dart-sdk/bin/dartanalyzer	2013-10-22 05:51:13.000000000 -0600
+++ dartanalyzer	2013-10-28 11:52:35.136788959 -0600
@@ -8,7 +8,13 @@
 # Setting SCRIPT_DIR this way is ugly, but is needed to handle the case where
 # dart-sdk/bin has been symlinked to. On MacOS, readlink doesn't work
 # with this case.
-SCRIPT_DIR="$(cd "${0%/*}" ; pwd -P)"
+_source="${BASH_SOURCE[0]}"
+while [ -h "$_source" ]; do # resolve $_source until the file is no longer a symlink
+  SCRIPT_DIR="$( cd -P "$( dirname "$_source" )" && pwd )"
+  _source="$(readlink "$_source")"
+  [[ $_source != /* ]] && _source="$SCRIPT_DIR/$_source" # if $_source was a relative symlink, we need to resolve it relative to the path where the symlink file was located
+done
+SCRIPT_DIR="$(cd "${_source%/*}" ; pwd -P)"
 DART_ANALYZER_HOME="$(cd "${SCRIPT_DIR%/*}" ; pwd -P)"
 
 FOUND_BATCH=0
