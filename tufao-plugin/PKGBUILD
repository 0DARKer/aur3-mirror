# Maintainer: Vinícius dos Santos Oliveira <vini.ipsmaker@gmail.com>
pkgname=tufao-plugin
pkgver=0.2
pkgrel=1
pkgdesc="A QtCreator plugin to work with Tufão."
arch=('i686' 'x86_64')
url="https://github.com/vinipsmaker/tufao"
license=('LGPL3')
depends=('qtcreator=2.7.0')
source=('http://releases.qt-project.org/qtcreator/2.7.0/qt-creator-2.7.0-src.tar.gz'
        "https://github.com/vinipsmaker/tufao-qtcreatorplugin/archive/${pkgver}.tar.gz")
md5sums=('7bf25d211ff8babea47c2034f1b93d08'
         'ce9f5b0fd3b6aeda2ac13217b7d27b7a')

build() {
  if [ -z "$QTC_BUILD" ]; then
    if [ -z "$QTC_SOURCE" ]; then
      export QTC_SOURCE="$srcdir/qt-creator-2.7.0-src"
    fi
    cd "$QTC_SOURCE"

    export QTC_BUILD="${QTC_SOURCE}-build"

    mkdir -p "$QTC_BUILD"
    cd "$QTC_BUILD"
    qmake "$QTC_SOURCE"
    make
  fi

  cd "$srcdir/tufao-qtcreatorplugin-${pkgver}"
  qmake
  make
}

package() {
  if [ -z "$QTC_BUILD" ]; then
    if [ -z "$QTC_SOURCE" ]; then
      export QTC_SOURCE="$srcdir/qt-creator-2.7.0-src"
    fi

    export QTC_BUILD="$QTC_SOURCE/build"
  fi

  cd "${QTC_BUILD}/lib/qtcreator/plugins"
  mkdir -p "$pkgdir/usr/lib/qtcreator/plugins"
  cp -r TufaoTeam "$pkgdir/usr/lib/qtcreator/plugins"
}
