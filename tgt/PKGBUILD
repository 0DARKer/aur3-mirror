# Contributor: Frederik Vos <frederik.vos@linvirt.nl>
pkgname=tgt
pkgver=1.0.24
pkgrel=1
pkgdesc="tgt daemon and userspace tools(ISCSI Support)"
arch=('x86_64' 'i686')
url="http://stgt.sourceforge.net/"
license=('GPL')
groups=()
depends=('perl-config-general')
makedepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=( 'etc/tgt/targets.conf' )
options=()
install=
source=(https://github.com/fujita/tgt/zipball/v$pkgver
        0001-Remove-dummy-RAID-controller-from-LUN-0.patch)

noextract=()
md5sums=('7354470a6d729a5acc9ed3de33206980'
         '6584d884d1fd0c901cd6e35217cbe194')

build() {
  cd "$srcdir/fujita-tgt-e039354"
   
  # uncomment the next line, if you're a VMware or MS user
  # patch -p1 < "${srcdir}/0001-Remove-dummy-RAID-controller-from-LUN-0.patch"

  make ISCSI=1 PREFIX="$pkgdir" || return 1

  make DESTDIR="$pkgdir" install
  
  mkdir -p $pkgdir/etc/rc.d

  cp scripts/initd.sample $pkgdir/etc/rc.d/tgt

  chmod 755 $pkgdir/etc/rc.d/tgt
}

# vim:set ts=2 sw=2 et:
