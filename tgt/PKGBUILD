# This is an example PKGBUILD file. Use this as a start to creating your own,
# and remove these comments. For more information, see 'man PKGBUILD'.
# NOTE: Please fill out the license field for your package! If it is unknown,
# then please put 'unknown'.

# Contributor: Frederik Vos <frederik.vos@linvirt.nl>
pkgname=tgt
pkgver=1.0.14
pkgrel=1
pkgdesc="tgt daemon and userspace tools(ISCSI Support)"
arch=('x86_64' 'i686')
url="http://stgt.sourceforge.net/"
license=('GPL')
groups=()
depends=('perl-config-general')
makedepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=( 'etc/tgt/targets.conf' )
options=()
install=
source=(http://stgt.sourceforge.net/releases/$pkgname-$pkgver.tar.gz
remove-doc-ibmvstgt.patch)
noextract=()
#md5sums=() #generate with 'makepkg -g'
md5sums=('9292ee9783ca63f533a21493992461ff'
         '8eba865f1f7ebf3d00b8b8a4a0b1d2a4')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  patch -p1 < "${srcdir}/remove-doc-ibmvstgt.patch"
  make ISCSI=1 PREFIX="$pkgdir" || return 1

  make DESTDIR="$pkgdir" install
  
  mkdir -p $pkgdir/etc/rc.d

  cp scripts/initd.sample $pkgdir/etc/rc.d/tgt

  chmod 755 $pkgdir/etc/rc.d/tgt
}

# vim:set ts=2 sw=2 et:
