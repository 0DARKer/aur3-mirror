# Maintainer: Diego <cdprincipe@at@gmail@dot@com>

pkgname=solaar-git
pkgver=0.8.99.669.ca2f5f9
pkgrel=1
pkgdesc="Linux devices manager for the Logitech Unifying Receiver"
arch=("any")
url="http://pwr.github.io/Solaar/"
license=('GPL')
depends=(
      'systemd' 'python' 'python-pyudev' 'python-gobject'
      )
optdepends=(
      'gtk3: required for GUI application'
      'gobject-introspection: required for GUI application'
      'python-gobject: required for GUI application'
      )
makedepends=('git')
install=solaar.install
conflicts=('solaar')
source=('git://github.com/pwr/Solaar.git')
md5sums=('SKIP')

pkgver() {
  cd Solaar
#  git describe --always --tags | sed 's#-#_#g;s#v##'
  echo $(head -n1 ChangeLog | grep -o '[0-9].*[0-9]').$(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

package() {
  cd "$srcdir/Solaar"
  python setup.py install --root="$pkgdir/" --optimize=1
  
  # Install udev rule
  install -d "${pkgdir}"/etc/udev/rules.d/
  install -m644 rules.d/42-logitech-unify-permissions.rules "${pkgdir}"/etc/udev/rules.d/42-logitech-unify-permissions.rules
}

