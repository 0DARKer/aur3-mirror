# Maintainer: Iru Dog <mytbk920423@gmail.com>

# NOTE: This package relies on Mplayer's configure script to detect what is
# useful on your system. Build it on the machine you will use it on.
# If some features don't work, install the related optdepends *before*
# building.
# Before reporting any bug, please download a fresh copy of the package from
# the AUR and build the package using makepkg (not Yaourt).

pkgname=mplayer-build
pkgbase=mplayer
pkgver=1.1
pkgrel=3
pkgdesc='Famous multimedia player,snapshot version, without GUI'
arch=('i686' 'x86_64')
url='http://www.mplayerhq.hu/'
license=('GPL')
depends=('libxv' 'alsa-lib' 'libass' 'zlib' 'xvidcore') 
makedepends=('tar' 'yasm')
conflicts=('mplayer')
provides=("mplayer")
backup=('etc/mplayer/codecs.conf' 'etc/mplayer/input.conf')
source=()
md5sums=()

mplayer_source='http://www.mplayerhq.hu/MPlayer/releases/mplayer-export-snapshot.tar.bz2' 
mplayer_tar='mplayer-export-snapshot.tar.bz2'

ffmpeg_source='http://ffmpeg.org/releases/ffmpeg-snapshot.tar.bz2'
ffmpeg_tar='ffmpeg-snapshot.tar.bz2'


build() {
	rm -rf $srcdir/*/
	wget -S -N $mplayer_source
	wget -S -N $ffmpeg_source

	tar xf mplayer-export-snapshot.tar.bz2 -C $srcdir
	cd $srcdir
	mv mplayer-*/ mplayer/
	tar xf ffmpeg-snapshot.tar.bz2 -C $srcdir/mplayer/
	cd mplayer/
	unset CFLAGS LDFLAGS

	./configure --prefix=/usr --confdir=/etc/mplayer --enable-menu \
	--disable-mencoder --disable-mpg123 --disable-x264 \
	--disable-ossaudio --disable-arts --disable-cddb --disable-libdv \
	--disable-libgsm --disable-librtmp --disable-libdca \
	--disable-libschroedinger-lavc --disable-faad \
	--disable-faac --disable-vdpau\

	make
	make DESTDIR=$pkgdir install
}

