# Maintainer: Yosef Or Boczko <yosefor3@walla.com>

_pkgname=gnome-icon-theme
pkgname=$_pkgname-git
pkgver=20130320
pkgrel=1
pkgdesc="GNOME default icons"
arch=(any)
depends=('hicolor-icon-theme' 'icon-naming-utils' 'gtk-update-icon-cache' 'gnome-icon-theme-symbolic')
makedepends=('git' 'gnome-common' 'automake' 'itstool' 'libxml2' 'yelp-tools')
url="http://www.gnome.org"
license=('GPL')
groups=('gnome')
install=$_pkgname.install
options=('!emptydirs')
conflicts=('gnome-icon-theme')
replaces=('gnome-icon-theme')
provides=('gnome-icon-theme' 'gnome-icon-theme=3.7.91')

_gitroot=http://git.gnome.org/browse/gnome-icon-theme
_gitname=gnome-icon-theme

build() {
	cd $srcdir
	msg "Connecting to GIT server...."

	if [ -d $srcdir/$_gitname ] ; then
		cd $_gitname && git pull origin
		msg "The local files are updated."
	else
		git clone $_gitroot
	fi

	msg "GIT checkout done or server timeout"
	msg "Starting make..."

	rm -rf "$srcdir/$_gitname-build"
	cp -r "$srcdir/$_gitname" "$srcdir/$_gitname-build"
	cd "$srcdir/$_gitname-build"

	./autogen.sh --prefix=/usr
	make
}

package() {
    cd "$srcdir/$_gitname-build"
    
    make DESTDIR="$pkgdir" install
    rm -f  "${pkgdir}/usr/share/icons/gnome/icon-theme.cache"
    
    rm -rf "$srcdir/$_gitname-build"
}
