# Contributor: Yonathan Dossow
# Maintainer: Ansgar Taflinski <ataflinski@uni-koblenz.de>
pkgname=xf86-video-qxl
pkgver=0.1.0
pkgrel=5
pkgdesc="Xorg X11 qxl video driver"
arch=(x86_64 i686)
url="http://www.x.org"
license=('MIT')
groups=(xorg-drivers)
depends=( 'xf86dgaproto' 'xproto' 'fontsproto' 'randrproto' 'renderproto' 'videoproto' 'resourceproto' 'scrnsaverproto')
makedepends=('pkgconfig' 'xorg-server-devel' 'patch' 'spice-protocol>=0.12.2')
source=("http://xorg.freedesktop.org/releases/individual/driver/$pkgname-$pkgver.tar.bz2" "mibstore.patch")
conflicts=('xf86-video-qxl-git')
md5sums=('3d854268744ff92751430d83b8acaeb6'
         '052aee3aad4052e48dfcd84cc3d90988')

build() {  
  cd "$srcdir/$pkgname-$pkgver"/src/uxa/
  patch -Nup0 < "$srcdir"/mibstore.patch
  cd "$srcdir/$pkgname-$pkgver"
  ./configure --prefix=/usr
  make -j1
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir/" INSTALL='install -p' install
}

