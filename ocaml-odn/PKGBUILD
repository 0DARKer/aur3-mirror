# Maintainer: Magnus Therning <magnus@therning.org>

pkgname=ocaml-odn
pkgver=0.0.3
pkgrel=1
pkgdesc="OCaml data notation"
arch=('i686' 'x86_64')
url="https://forge.ocamlcore.org/projects/odn"
# LGPL + linking exception
license=('LGPL')
depends=('ocaml' 'ocaml-type-conv' 'ocaml-fileutils' 'ocaml-findlib' 'ocaml-ounit')
source=(
    https://forge.ocamlcore.org/frs/download.php/505/ocaml-data-notation-${pkgver}.tar.gz
    )
options=(!strip)
changelog=$pkgname.changelog

build() {
    cd ${srcdir}/ocaml-data-notation-${pkgver}

    ocaml setup.ml -configure --prefix /usr --destdir ${pkgdir}
    ocaml setup.ml -build
}

package() {
    cd ${srcdir}/ocaml-data-notation-${pkgver}

    # ocamlfind is broken, IMHO
    mkdir -p ${pkgdir}$(ocamlfind printconf path)
    OCAMLFIND_DESTDIR=${pkgdir}$(ocamlfind printconf path) ocaml setup.ml -install
}

sha256sums=('b5ece18759bb688d9067691e3a336f9bf786dbc27860eba7638b818de6313814')
