# Maintainer: wifiextender <aaron_caffrey at hotmail dot com>

pkgname=firefox-stable
pkgver=29.0
pkgrel=1
pkgdesc="Latest stable firefox x86_64 (en-GB)"
arch=('x86_64')
license=('MPL' 'GPL' 'LGPL')
url="http://www.mozilla.org/projects/firefox"
depends=('dbus-glib' 'gtk2' 'lib32-libxt' 'libxt' 'alsa-lib' 'nss' 'lib32-libxcb' 'libxcb')
source=("https://ftp.mozilla.org/pub/mozilla.org/firefox/releases/latest/linux-x86_64/en-GB/firefox-$pkgver.tar.bz2"
        'firefox-stable.desktop')
md5sums=('SKIP' 'SKIP')

build() {
  # directory and files
  msg "Installing Firefox $pkgver ..."
  cd ${pkgdir}
  mkdir -p {usr/bin,usr/lib}
  cp -r ${srcdir}/firefox usr/lib/${pkgname}
  mv usr/lib/${pkgname}/firefox usr/lib/${pkgname}/firefox-bin
  #mv usr/lib/${pkgname}/firefox-bin usr/lib/${pkgname}/firefox-bin
  cat <<EOF > usr/bin/${pkgname}
#!/bin/bash
/usr/lib/${pkgname}/run-mozilla.sh /usr/lib/${pkgname}/firefox-bin \$*
EOF
  chmod +x usr/bin/${pkgname}

  # desktop icons
  cd ${srcdir}
  install -d ${pkgdir}/usr/share/applications
  install -Dm644 firefox-stable.desktop ${pkgdir}/usr/share/applications
  install -Dm644 firefox/browser/icons/mozicon128.png ${pkgdir}/usr/share/pixmaps/firefox.png
  msg "Firefox $pkgver was installed successfully"
}

