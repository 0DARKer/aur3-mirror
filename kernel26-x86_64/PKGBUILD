# Maintainer: xduugu
pkgname=kernel26-x86_64
pkgver=2.6.30.5
pkgrel=1
pkgdesc="Arch's x86_64 kernel for i686 userland"
arch=('i686')
url="http://www.kernel.org"
license=('GPL2')
groups=('base')
depends=('coreutils' 'kernel26-firmware>=2.6.30' 'module-init-tools' 'mkinitcpio>=0.5.20')
optdepends=('crda: to set the correct wireless channels of your country')
provides=("kernel26=$pkgver-$pkgrel")
conflicts=('kernel26')
replaces=('kernel24' 'kernel24-scsi' 'kernel26-scsi'
          'alsa-driver' 'ieee80211' 'hostap-driver26'
          'pwc' 'nforce' 'squashfs' 'unionfs' 'ivtv'
          'zd1211' 'kvm-modules' 'iwlwifi' 'rt2x00-cvs'
          'gspcav1' 'atl2' 'wlan-ng26' 'aufs' 'rt2500')
backup=(etc/mkinitcpio.d/${pkgname%-*}.preset)
install=$pkgname.install
# makepkg --source workaround
source=(ftp://dummy.xyz/${pkgname%-*}-$pkgver-$pkgrel-x86_64.pkg.tar.gz)
noextract=(${pkgname%-*}-$pkgver-$pkgrel-x86_64.pkg.tar.gz)
md5sums=('4add217467ce2add37cc12874ab03ced')
sha256sums=('53107581571dd7abf2a6868d82e427f7b309ca96748cc9fabcdd19d897150f2b')

_get_package() {
  if [ ! -e ${pkgname%-*}-$pkgver-$pkgrel-x86_64.pkg.tar.gz ]; then
    echo -e "\033[1;32m==> \033[0mGetting x86_64 kernel26 package via pacman"

    local package;
    while [ -z "$package" ]; do
      package=$(su -c 'pacman -Sp kernel26' | tail -1 | sed 's/i686/x86_64/g')
    done

    wget -c "$package" || return 1
  fi
}

_get_package

build() {
  mkdir -p "$srcdir/$pkgname" &&
    cd "$srcdir/$pkgname" &&
    bsdtar xf "$srcdir/$(basename $source)" || return 1

    mv * "$pkgdir" || return 1
}

# vim:set ts=2 sw=2 et:
