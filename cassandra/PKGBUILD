# Contributor: Thomas Dziedzic < gostrc at gmail >

pkgname=cassandra
pkgver=0.8.0
pkgrel=1
pkgdesc="NoSQL database"
arch=('any')
url="http://cassandra.apache.org/"
license=('APACHE')
depends=('java-runtime')
source=("http://apache.mirror.anlx.net/cassandra/$pkgver/apache-$pkgname-$pkgver-bin.tar.gz")
md5sums=('ea97a815c3ee8c08ad408eb075f495cf')

package() {
  cd apache-cassandra-${pkgver}

  mkdir -p ${pkgdir}/var/{lib,log}/cassandra
  mkdir -p ${pkgdir}/usr/bin
  mkdir -p ${pkgdir}/usr/share/cassandra

  sed -i 's_`dirname $0`/.._/usr/share/cassandra_' bin/cassandra.in.sh

  chown http:http ${pkgdir}/var/{lib,log}/cassandra

  cp -a {lib,conf,interface} ${pkgdir}/usr/share/cassandra/

  cd bin

  install \
    cassandra \
    cassandra-cli \
    json2sstable \
    nodetool \
    sstable2json \
    sstablekeys \
    stop-server \
    ${pkgdir}/usr/bin/

  install \
    cassandra.in.sh \
    ${pkgdir}/usr/share/cassandra/
}
