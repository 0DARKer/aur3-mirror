pkgname=cassandra
pkgver=0.7.0
pkgrel=1
pkgdesc="Cassandra NoSQL database"
arch=('any')
url="http://cassandra.apache.org/"
license=('APACHE')
groups=()
depends=('java-runtime')
makedepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
source=("http://apache.mirror.anlx.net/cassandra/$pkgver/apache-$pkgname-$pkgver-bin.tar.gz")
noextract=()
md5sums=('475eb1a95fe8a4def78903bc6726852e')

build() {
  cd "$srcdir/apache-$pkgname-$pkgver"

  mkdir -p $pkgdir/var/{lib,log}/cassandra
  mkdir -p $pkgdir/usr/bin
  mkdir -p $pkgdir/usr/share/cassandra

  sed -i 's/`dirname $0`\/../\/usr\/share\/cassandra/' bin/cassandra.in.sh

  chown http:http $pkgdir/var/{lib,log}/cassandra

  cp -a {lib,conf,interface} $pkgdir/usr/share/cassandra/

  install bin/cassandra.in.sh $pkgdir/usr/share/cassandra
  install bin/cassandra $pkgdir/usr/bin/
  install bin/cassandra-cli $pkgdir/usr/bin/
  install bin/clustertool $pkgdir/usr/bin/
  install bin/nodetool $pkgdir/usr/bin/
  install bin/json2sstable $pkgdir/usr/bin/
  install bin/sstablekeys $pkgdir/usr/bin/
  install bin/sstable2json $pkgdir/usr/bin/
  install bin/stop-server $pkgdir/usr/bin/
}
