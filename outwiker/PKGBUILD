# 

pkgname=outwiker
_pkgname=Outwiker
pkgver=1.5.0
pkgrel=1
arch=('any')
pkgdesc="Outliner and personal wiki with keeping the tree of notes in the form of directories on a disk"
url="http://jenyay.net/Outwiker/English"
license=('GPL3')
depends=('wxpython' 'pywebkitgtk')
optdepends=('mimetex: rendering of formulas'
            'python-gnomeprint: printing non-latin symbols')
conflicts=(outwiker-bzr)
source=(http://jenyay.net/uploads/Soft/${_pkgname}/${pkgname}_${pkgver}-627_all.deb)
sha1sums=('0c6389d70da756e24f9f2e519be00efa7f425a1d')

build() {
   /bin/true
}

package() {  
   ar x ${pkgname}_${pkgver}-627_all.deb
   tar xf data.tar.gz -C ${pkgdir}
   cd ${pkgdir}
   # python2 fix
   for file in $(find . -name '*.py' -print); do
      sed -i 's_#!.*/usr/bin/python_#!/usr/bin/python2_' $file
      sed -i 's_#!.*/usr/bin/env.*python_#!/usr/bin/env python2_' $file
   done
   sed -i -e 's/python /python2 /' ${pkgdir}/usr/bin/${pkgname}
   find ${pkgdir}/usr/share/${pkgname} -type f -exec chmod a-x,u+w {} \;
}
