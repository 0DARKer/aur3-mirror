# Maintainer: Christian Hesse <mail@eworm.de>
# Contributor: Sergej Pupykin <pupykin.s+arch@gmail.com>
# Contributor: Gergely Tamas <dice@mfa.kfki.hu>

pkgname=gq-git
pkgver=2013.04.05
pkgrel=1
pkgdesc="interactive graphical LDAP browser - git version"
conflicts=gq
provides=gq
url="http://sourceforge.net/projects/gqclient"
license=("GPL")
depends=('libxml2' 'gtk2' 'libgnome-keyring' 'libglade' 'libldap>=2.4.18' 'libgpg-error' 'libgcrypt' 'krb5')
makedepends=('intltool' 'pkgconfig' 'git' 'gnome-common')
arch=('i686' 'x86_64')
install=gq.install
source=('git://gqclient.git.sourceforge.net/gitroot/gqclient/gqclient'
	'http://www.eworm.de/download/linux/gq-pane.patch'
	'http://www.eworm.de/download/linux/gq_glib.patch')

pkgver() {
	cd gqclient/
	#git describe --tags --long | sed 's|^[^0-9]*||;s|-|.|g'
	date +%F | sed 's|^[^0-9]*||;s|-|.|g'
}

build() {
	cd gqclient/

	patch -Np1 -i ${srcdir}/gq-pane.patch
	patch -Np1 -i ${srcdir}/gq_glib.patch

	sed -i 's/AM_CONFIG_HEADER/AC_CONFIG_HEADERS/' configure.in

	./autogen.sh --prefix=/usr --disable-debugging --disable-update-mimedb --with-kerberos5=yes
	make
}

package() {
	cd gqclient/

	make DESTDIR=${pkgdir} install
}

sha256sums=('SKIP'
            '0b444deca182ed960d19e0200f6af8a675a25644cac80db1a228046c3d54fb5c'
            '3bdd9115c0717073decf1ee36bd784fe33e850224aca7c7f13a17463e45f0d53')
