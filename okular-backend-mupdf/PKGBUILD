# Maintainer: xylosper <darklin20@gmail.com>

pkgname=('okular-backend-mupdf')
pkgver=0.0.1
pkgrel=3
pkgdesc="MuPDF-based backend for Okular"
arch=('i686' 'x86_64')
license=('GPL')
depends=('kdegraphics-okular' 'jbig2dec')
makedepends=('gcc' 'svn' 'automoc4' 'cmake' 'unzip')
mupdf=mupdf-1.2-source
source=($pkgname'.patch' $pkgname::'svn+svn://anonsvn.kde.org/home/kde/trunk/playground/graphics/okular/mupdf' 'http://mupdf.googlecode.com/files/'$mupdf'.zip')
md5sums=('3847d6fdad9574a8c922f42b017cccc9' 'SKIP' '230e7d679f54c91edd1ebe54f6f8bc15')
url='http://websvn.kde.org/trunk/playground/graphics/okular/mupdf'

build() {
	cd $srcdir/$pkgname
	ln -s ../$mupdf mupdf
	patch -p1 < ../$pkgname.patch
	cp -f CMakeLists-fitz.txt mupdf/CMakeLists.txt
	cp -rf cmake mupdf
	mkdir build && cd build
	cmake -DCMAKE_INSTALL_PREFIX:PATH=$pkgdir/usr .. && make
}

package() {
	cd $srcdir/$pkgname/build
	make install
}
