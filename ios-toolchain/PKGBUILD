# Maintainer: yetist <yetist@gmail.com>
pkgname=ios-toolchain
_pkgname=cctools
pkgver=20121126
_pkgver=836
pkgrel=1
pkgdesc="A simple and clean ios toolchain based on llvm/clang under linux"
arch=('i686' 'x86_64')
url="http://code.google.com/p/ios-toolchain-based-on-clang-for-linux"
license=('GPL')
makedepends=('llvm' 'clang')
source=("http://ios-toolchain-based-on-clang-for-linux.googlecode.com/files/$_pkgname-$_pkgver.tar.gz"
'ios-toolchain.sh')
md5sums=('3f5f809a864019f6a22357bea23d20a8'
         'e5a8bba803d455df3791aeb4141db525')

build() {
  cd "$srcdir/$_pkgname-$_pkgver"

  export CC=clang
  export CXX=clang++
  export CFLAGS=-fno-stack-protector
  export CXXFLAGS=-fno-stack-protector

  ./configure --target=arm-apple-darwin9 --prefix=/opt/ios/toolchain
  make
}

package() {
  cd "$srcdir/$_pkgname-$_pkgver"
  export CC=clang
  export CXX=clang++
  export CFLAGS=-fno-stack-protector
  export CXXFLAGS=-fno-stack-protector

  make DESTDIR="$pkgdir/" install
  mkdir -p $pkgdir/usr/bin/
  ln -sf /opt/ios/toolchain/bin/arm-apple-darwin9-ld ${pkgdir}/usr/bin/arm-apple-ios-ld
  ln -sf /opt/ios/toolchain/bin/arm-apple-darwin9-as ${pkgdir}/usr/bin/arm-apple-ios-as
  install -Dm755 $srcdir/ios-toolchain.sh $pkgdir/etc/profile.d/ios-toolchain.sh
}

# vim:set ts=2 sw=2 et:
