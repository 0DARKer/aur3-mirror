# Maintainer: yetist <yetist@gmail.com>
pkgname=ios-toolchain
_pkgname=cctools
pkgver=836.1
pkgrel=1
pkgdesc="A simple and clean ios toolchain based on llvm/clang under linux"
arch=('i686' 'x86_64')
url="http://code.google.com/p/ios-toolchain-based-on-clang-for-linux"
license=('GPL')
makedepends=('llvm' 'clang')
optdepends=('ldid' 'proj2make')
source=("http://ios-toolchain-based-on-clang-for-linux.googlecode.com/files/$_pkgname-$pkgver-for-linux.tar.gz"
"cctools-fix-build.patch")
sha256sums=('5fd5677fd847aa2e0ebeb49b37e908057cc7835468dfb1462b3d2fd32a9bed7e'
            '5e8a8c7b67c28c3c94de89dd15ccabac60e5d554de5b09a1eea4f56a68cda7c4')

build() {
  cd "$srcdir/$_pkgname-$pkgver"

  export CC=clang
  export CXX=clang++
  export CFLAGS=-fno-stack-protector
  export CXXFLAGS=-fno-stack-protector

  patch -p1 -i $srcdir/cctools-fix-build.patch

  #./configure --target=arm-apple-ios --prefix=/usr
  ./configure --target=arm-apple-darwin9 --prefix=/usr
  make
}

package() {
  cd "$srcdir/$_pkgname-$pkgver"
  export CC=clang
  export CXX=clang++
  export CFLAGS=-fno-stack-protector
  export CXXFLAGS=-fno-stack-protector

  make DESTDIR="$pkgdir/" install
}

# vim:set ts=2 sw=2 et:
sha256sums=('5fd5677fd847aa2e0ebeb49b37e908057cc7835468dfb1462b3d2fd32a9bed7e'
            '1e3608ff17d1e3ea6ddaa849a73961f9fd3c358264a625d12b504dc723ce330a')
