# Contributor: Nick B <Shirakawasuna at gmail _dot_com>
pkgname=seaview
pkgver=4.2.11
pkgrel=1
pkgdesc="A multiplatform GUI for multiple sequence alignment and molecular phylogeny."
arch=('i686' 'x86_64')
url="http://pbil.univ-lyon1.fr/software/seaview.html"
license=('GPL3')
depends=('glibc' 'fltk')
source=(http://pbil.univ-lyon1.fr/software/seaview_data/seaview.tar.gz
		http://pbil.univ-lyon1.fr/software/seaview_data/seaview4.tgz)
md5sums=('2c163df7cfce7d25f38375a6411ed147'
         '9789666ec80dd3b5888e493112aff774')
noextract=(seaview4.tgz)

[ "$CARCH" = "x86_64" ] &&
depends=('lib32-gcc-libs' 'fltk') &&
source=(http://pbil.univ-lyon1.fr/software/seaview_data/seaview.tar.gz
		http://pbil.univ-lyon1.fr/software/seaview_data/seaview4-64.tgz) &&
md5sums=('2c163df7cfce7d25f38375a6411ed147'
		 '219ced81a7406d113a123b539caf8a4c') &&
noextract=(seaview4-64.tgz)

build() {

  mkdir -p $pkgdir/usr/{bin,share/seaview}
  mv $srcdir/seaview $srcdir/seaviewbuild
  [ "$CARCH" = "i686" ] &&
  tar xf $srcdir/seaview4.tgz &&
  rm $srcdir/seaview/seaview &&
  mv $srcdir/seaview/* $srcdir/
  [ "$CARCH" = "x86_64" ] &&
  tar xf $srcdir/seaview4-64.tgz

  cd $srcdir/seaviewbuild
  make || return 1

  install -m755 ./seaview $pkgdir/usr/share/seaview/ || return 1
  install -m755 $srcdir/clustalw $pkgdir/usr/share/seaview/ || return 1
  install -m755 $srcdir/muscle $pkgdir/usr/share/seaview/ || return 1

  [ "$CARCH" = "i686" ] &&
  install -m755 $srcdir/phyml_3.0.1_linux32 $pkgdir/usr/share/seaview/
  [ "$CARCH" = "x86_64" ] &&
  install -m755 $srcdir/phyml_3.0.1_linux64 $pkgdir/usr/share/seaview/

  ln -s /usr/share/seaview/clustalw $pkgdir/usr/bin/clustalw
  ln -s /usr/share/seaview/muscle $pkgdir/usr/bin/muscle
  [ "$CARCH" = "i686" ] &&
  ln -s /usr/share/seaview/phyml_3.0.1_linux32 $pkgdir/usr/bin/phyml_3.0.1_linux32
  [ "$CARCH" = "x86_64" ] &&
  ln -s /usr/share/seaview/phyml_3.0.1_linux64 $pkgdir/usr/bin/phyml_3.0.1_linux64

  echo "#!/bin/bash" > $pkgdir/usr/bin/seaview
  echo "" >> $pkgdir/usr/bin/seaview
  echo "cd /usr/share/seaview" >> $pkgdir/usr/bin/seaview
  echo "./seaview" >> $pkgdir/usr/bin/seaview
  chmod 755 $pkgdir/usr/bin/seaview

}
