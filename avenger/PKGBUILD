# Contributor: bl4ckb1t <bl4ckb1t@gmail.com>
pkgname=avenger
pkgver=0.8.2
pkgrel=2
pkgdesc="highly configurable, MTA-independent SMTP filter server."
arch=('i686' 'x86_64')
url="http://www.mailavenger.org"
license=('GPL')
depends=('db' 'libsasl' 'libpcap' 'openssl')
source=(http://www.mailavenger.org/dist/$pkgname-$pkgver.tar.gz)
md5sums=('2a2faa40c8b37c145d97c93386b12c17')

build() {
  cd $startdir/src/$pkgname-$pkgver

  #quick and dirty patch to compile with gcc 4.7.0 (x86_64)
  [[ "${CARCH}" == 'x86_64' ]] &&
     patch -p0 < $startdir/avenger_x86_64_gcc47.patch

  ./configure --prefix=/usr --enable-sasl --enable-ssl
  make || return 1
  make mandir=/usr/share/man DESTDIR=$startdir/pkg install
  install -Dm644 COPYING ${startdir}/pkg/usr/share/licenses/${pkgname}/COPYING
}
