# Contributor: Claudio Riva <firetux83@gmail.com>

pkgname=pdfmod
pkgver=0.9.0
pkgrel=2
pkgdesc="A simple tool for modifying PDF documents"
arch=('i686' 'x86_64')
url="http://live.gnome.org/PdfMod"
license=('GPL2')
depends=('mono' 'gnome-doc-utils' 'hyena>=0.3')
makedepends=('pkgconfig' 'intltool>=0.35.0')
install=$pkgname.install
source=(http://download.gnome.org/sources/$pkgname/0.9/$pkgname-$pkgver.tar.bz2
        mono2.8.patch)
md5sums=('80ee1628611b84aca0850888462136a5'
         '71b86e5c70601ce7e8ece9d49e18ecdf')

build() {
  export MONO_SHARED_DIR="${srcdir}/.wabi"
  mkdir -p "${MONO_SHARED_DIR}"
  
  cd "$srcdir/$pkgname-$pkgver"

  ./configure --prefix=/usr
  
  #Patch to enable compiling with mono 2.8
  patch -Np0 -i ${srcdir}/mono2.8.patch
  
  #libpoppler-glib fix
  sed -i 's/libpoppler-glib\.so\.4/libpoppler-glib\.so/g' \
    lib/poppler-sharp/poppler-sharp/poppler-sharp.dll.config
  
  make || return 1
  make DESTDIR="$pkgdir/" install
}
