# Maintainer: archtux <antonio dot arias99999 at gmail dot com>

pkgname=qomp
pkgver=0.6
pkgrel=1
pkgdesc="Online Music Player that supports Yandex.Music, Myzuka.ru and ProstoPleer.com"
arch=('i686' 'x86_64')
url="https://code.google.com/p/qomp/"
license=('GPL2')
depends=('phonon-qt4')
conflicts=('qomp-git')
source=(http://sourceforge.net/projects/qomp/files/$pkgver/qomp-${pkgver}_beta.tar.gz)
md5sums=('ef4f109a54cebfac7a994ff7bebebe29')

prepare() { 
  cd $srcdir
  cmake -DCMAKE_INSTALL_PREFIX=/usr

  # Fix phonon paths
  cd src
  sed -i 's|<Phonon/MediaObject>|"/usr/include/qt4/phonon/mediaobject.h"|' qompphonon{player.{cpp,h},metadataresolver.h}
  sed -i 's|<Phonon/AudioOutput>|"/usr/include/qt4/phonon/audiooutput.h"|' qompphononplayer.cpp
  sed -i 's|<Phonon/SeekSlider>|"/usr/include/qt4/phonon/seekslider.h"|' qompphononplayer.cpp
  sed -i 's|<Phonon/VolumeSlider>|"/usr/include/qt4/phonon/volumeslider.h"|' qompphononplayer.cpp
}

build() {
  cd $srcdir
  make
}

package() {
  cd $srcdir
  make DESTDIR=$pkgdir install
}