# Maintainer: fauno <fauno@kiwwwi.com.ar>
pkgname=transmission-remote-cli-git
pkgver=20120412
pkgrel=1
pkgdesc="Curses interface for the daemon of the BitTorrent client Transmission"
arch=('any')
url="https://github.com/fagga/transmission-remote-cli"
license=('GPL3')
depends=('python2')
makedepends=('git')
optdepends=('transmission-daemon>=2.40: for local transmission management'
            'adns-python: Resolve IPs to host names'
            'python-geoip: Guess which country peers come from')
conflicts=('transmission-remote-cli')
replaces=('transmission-remote-cli')
source=(python2.patch)
md5sums=('6273609fb3a7294328aeaa526b76411c')

_gitroot="https://github.com/fagga/transmission-remote-cli.git"
_gitname="transmission-remote-cli"

build() {
    cd "${srcdir}"
    echo "Connecting to the GIT repository..."

    if [ -d "$_gitname" ] ; then
        pushd "$_gitname"
        git pull origin
        echo "The local files are updated."
    else
        git clone "$_gitroot" "$_gitname"
        pushd "$_gitname"
    fi

    echo "GIT checkout done or server timeout"

    rm -rf "${srcdir}/$_gitname-build"
    git clone "${srcdir}/$_gitname" "${srcdir}/$_gitname-build"

    cd "${srcdir}/$_gitname-build"

    msg "Starting make..."

    patch -Np1 -i ${srcdir}/python2.patch
}

package(){
    cd "${srcdir}/${_gitname}-build"

	install -d "${pkgdir}/usr/bin/"
	install -Dm755 transmission-remote-cli.py "${pkgdir}/usr/bin/transmission-remote-cli"
}
