# Maintainer: Abelardo Ricart

pkgname=higan
pkgver=092
pkgrel=5
pkgdesc="A Nintendo multi-system emulator formerly known as bsnes"
arch=('i686' 'x86_64')
url=http://byuu.org/higan/
license=(GPL)
replaces=('bsnes')
depends=('openal' 'libgl')
optdepends=('alsa' 'pulseaudio' 'sdl')
source=("http://higan.googlecode.com/files/${pkgname}_v${pkgver}-source.tar.xz" "Makefile.patch")
install=higan.install
md5sums=('ef6a6a9bc6861d26da01c2e03e6dfe9e' '049b514c1c3ca847b7efae50dcd0e3b6')

build() {
   cd "${srcdir}/${pkgname}_v${pkgver}-source/${pkgname}/nall"
   patch -p0 -i ${srcdir}/Makefile.patch
   cd "${srcdir}/${pkgname}_v${pkgver}-source/${pkgname}"
   make clean && make profile=accuracy
}

package()
{
  cd "${srcdir}/${pkgname}_v${pkgver}-source/${pkgname}"
  install -D -m 755 out/higan ${pkgdir}/usr/bin/higan
  install -D -m 644 data/higan.png ${pkgdir}/usr/share/pixmaps/higan.png
  install -D -m 644 data/higan.desktop ${pkgdir}/usr/share/applications/higan.desktop
  
  # Copy over config files.
  mkdir -p ${pkgdir}/usr/share/higan
  cp -R profile/* ${pkgdir}/usr/share/higan
  cp data/cheats.bml ${pkgdir}/usr/share/higan
}

