# Maintainer: Abelardo Ricart

pkgname=higan
pkgver=092
pkgrel=2
pkgdesc="A Nintendo multi-system emulator formerly known as bsnes"
arch=(any)
url=http://byuu.org/higan/
license=(GPL)
replaces=('bsnes')
depends=('openal')
optdepends=('alsa' 'pulseaudio' 'sdl')
source=("http://higan.googlecode.com/files/higan_v$pkgver-source.tar.xz" "Makefile.patch")
md5sums=('ef6a6a9bc6861d26da01c2e03e6dfe9e' '049b514c1c3ca847b7efae50dcd0e3b6')

build() {
   cd "$srcdir/higan_v$pkgver-source/$pkgname/nall"
   patch -p0 -i $srcdir/Makefile.patch
   cd "$srcdir/higan_v$pkgver-source/$pkgname"
   make clean && make profile=accuracy
   #make clean && make profile=balanced
   #make clean && make profile=performance
}

package()
{
  cd "$srcdir/higan_v$pkgver-source/$pkgname"
  install -D -m 755 out/higan $pkgdir/usr/bin/higan
  install -D -m 644 data/higan.png $pkgdir/usr/share/pixmaps/higan.png
  install -D -m 644 data/higan.desktop $pkgdir/usr/share/applications/higan.desktop
  mkdir -p ~/.config/higan
  cp -R profile/* ~/.config/higan
  cp data/cheats.bml ~/.config/higan/cheats.bml
  chmod -R 777 ~/.config/higan
}

