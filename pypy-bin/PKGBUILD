# Maintainer: Marti Raudsepp <marti@juffo.org>
# Contributor: Sven-Hendrik Haase <sh@lutzhaase.com>
pkgname=pypy-bin
pkgver=1.4
pkgrel=1
pkgdesc="Python interpreter and JIT written in Python"
url="http://pypy.org/"
arch=('i686' 'x86_64')
depends=('python2' 'libffi' 'openssl-compatibility' 'ncurses' 'expat' 'zlib' 'bzip2')
conflicts=('pypy')
provides=('pypy')
license=('MIT')

[ "${CARCH}" = "i386"   ] && source=(http://pypy.org/download/pypy-$pkgver-linux.tar.bz2)
[ "${CARCH}" = "x86_64" ] && source=(http://pypy.org/download/pypy-$pkgver-linux64.tar.bz2)
[ "${CARCH}" = "i386"   ] && md5sums=('f1e192e1619aa09bd192a0e19197da3d')
[ "${CARCH}" = "x86_64" ] && md5sums=('95531a85a8baca915ec8885b097d6797')

build() {
  # fix permission modes
  find $srcdir/pypy-$pkgver -perm 0700 -exec chmod 755 '{}' \;
  find $srcdir/pypy-$pkgver -perm 0600 -exec chmod 644 '{}' \;

  mkdir -p $pkgdir/usr/share/licenses/$pkgname/
  cp $srcdir/pypy-$pkgver/LICENSE $pkgdir/usr/share/licenses/$pkgname

  mkdir -p $pkgdir/opt/
  mv $srcdir/pypy-$pkgver $pkgdir/opt/pypy

  mkdir -p $pkgdir/usr/bin/
  ln -s /opt/pypy/bin/pypy $pkgdir/usr/bin/pypy
}

# vim: ts=2 sw=2 et:
