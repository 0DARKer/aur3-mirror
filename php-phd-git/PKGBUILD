# Maintainer: Joris Steyn <jorissteyn@gmail.com>

# This package is a build depencency for php-manpages-svn

pkgname=php-phd-git
pkgver=20130407
pkgrel=1
pkgdesc='The PHP DocBook renderer from GIT (includes pman build scripts)'
arch=('any')
url='https://wiki.php.net/doc/phd/'
license=('PHP')
depends=('php' 'php-sqlite')
conflicts=()
provides=()
makedepends=('git')

build() {
    cd "$srcdir"
    if [ ! -d phd ]; then
        msg "Retrieving PhD from git..."
        git clone git://git.php.net/phd.git phd
    fi

    # todo: optionally allow dependencies for creating PEAR packages,
    # not doing this by default because the whole point of this is 
    # generating the manpages ourselves and without the ambiguous pman
    # wrapper.
    #if [ ! -d fakepear ]; then
        # updating the channel means having more privileges than we
        # really want to have while packaging, so skip this for now
        #pear channel-update doc.php.net

        # this will install the package in the fakeroot environment
        # so pear isn't really needed after building the package
        #pear config-set preferred_state beta
        #pear install --packagingroot "$srcdir"/fakepear PEAR_PackageFileManager2
    #fi
}

package() {
    install -d "$pkgdir"/usr/share/php/phd
    cp -r "$srcdir"/phd/* "$pkgdir"/usr/share/php/phd/

    # only needed when generating pman
    #cp -r "$srcdir"/fakepear "$pkgdir"/usr/share/php/phd/fakepear
}

