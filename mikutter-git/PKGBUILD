# Maintainer: Mizki Suzumori <mizki9577 at gmail dot com>
pkgname=mikutter-git
pkgver=20130307
pkgrel=2
pkgdesc="a moest mikutter client"
arch=('any')
url="http://mikutter.hachune.net/"
license=('GPL3')
depends=('ruby-gtk2' 'ruby-cairo')
optdepends=('libnotify: notify support')
makedepends=('git')
provides=('mikutter')
conflicts=('mikutter' 'mikutter-svn')

_gitroot=git://toshia.dip.jp/mikutter.git
_gitname=mikutter

build() {
	cd "$srcdir"
	msg "Connecting to GIT server...."

	if [[ -d "$_gitname" ]]; then
		cd "$_gitname" && git pull origin
		msg "The local files are updated."
	else
		git clone "$_gitroot" "$_gitname"
	fi

	msg "GIT checkout done or server timeout"
}

package() {
	mkdir $pkgdir/opt
	cp -R $srcdir/$_gitname $pkgdir/opt
	rm -rf $(find $pkgdir -type d -name ".git")
	mkdir -p $pkgdir/usr/bin
	cat <<EOF > $pkgdir/usr/bin/mikutter
#!/bin/sh
ruby /opt/mikutter/mikutter.rb $@
EOF
	chmod a+x ${pkgdir}/usr/bin/mikutter
}

# vim:set ts=2 sw=2 et:
