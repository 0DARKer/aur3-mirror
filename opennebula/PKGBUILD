# Contributor: Mikhail Kulemin <mihkulemin@gmail.com>
# Contributor: Michael Pusterhofer <pusterhofer (at) student (dot) tugraz (dot) at>

pkgname=opennebula
#_srcname=one
pkgver=2.2
_srcver=2.2
pkgrel=1
pkgdesc="Virtual Management Infrastructure tool for Clouds"
arch=('i686' 'x86_64')
url="http://opennebula.org/"
license=('Apache 2.0')
depends=('ruby' 'xmlrpc-c-abyss' 'openssl' 'sqlite3')
makedepends=('pkgconfig' 'scons')
install=(one.install)
source=(http://dev.opennebula.org/attachments/download/339/opennebula-$pkgver.tar.gz 
	oneuser.patch 
	oned)

build() {
    # Patching oneuser script (strange non ASCII symbol in help message)
    cd "$srcdir/opennebula-2.2"
#    patch -p0 < $srcdir/oneuser.patch

    # Generating build system
    scons || return 1
 
	DESTDIR=$pkgdir ./install.sh || return 1
	install -D -m755 "$srcdir"/oned "$pkgdir"/etc/rc.d/one
}

md5sums=('170f8a5bbf81a39efc2ac27cc86b4881'
         'f5c68993a6ee0cd3e600c9816945592c'
         '654626c304fdae47e896f4e466977cc5')
