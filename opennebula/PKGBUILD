# Maintainer: Jason St. John <jstjohn .. purdue . edu>
# Contributor: Mikhail Kulemin <mihkulemin@gmail.com>
# Contributor: Michael Pusterhofer <pusterhofer (at) student (dot) tugraz (dot) at>

pkgname=opennebula
pkgver=3.0
_srcver=3.0.0
pkgrel=1
pkgdesc="Virtual management infrastructure as a service (IaaS) tool for cloud computing (NOTE: Read the PKGBUILD!)"
arch=('i686' 'x86_64')
url="http://opennebula.org/"
license=('Apache 2.0')
depends=('ruby>=1.8.7' 'xmlrpc-c-abyss' 'openssl' 'sqlite3' 'openssh' 'libxml2' 'curl'
  'libxslt' 'expat')
makedepends=('pkgconfig' 'scons')
optdepends=('nfs-utils: for using the shared file system storage model'
  'mysql: optional replacement for SQLite as the DB back-end'
  'libmysqlclient: required if using MySQL instead of SQLite')
install=(opennebula.install)
changelog=(ChangeLog)
source=(http://dev.opennebula.org/attachments/download/478/opennebula-$_srcver.tar.gz 
	oned)
sha512sums=('0fa2feff23771e583f682e4e705e10793bb0479dbe2421410a1ff1ffd0d3f54de58db09722a02f4ca07acb42e1e175b19fb0b304f462a4a10ad9da8bf64dddd4'
            'de18c9ad2eec30b90276618389f28b876566d514a484bf5d4d0cda84152b29fa7c9836114eff00176936fba609666034171d02d360df8c5b41db3caeb4efe7af')

build() {
  cd "$srcdir/opennebula-$_srcver"

  # Generating build system
  scons || return 1

  # Uncomment this (and comment out the above section) to use MySQL instead of SQLite.
  #scons mysql=yes || return 1
 
	DESTDIR=$pkgdir ./install.sh || return 1
	install -D -m755 "$srcdir"/oned "$pkgdir"/etc/rc.d/one

  # Uncomment this if you plan on running the Sunstone web GUI on this server.
  #gem install json rack sinatra thin

  # Uncomment this if you plan on using OpenNebula Watch (for accounting and statistics).
  # NOTE: OpenNebula 3.0.0 has a bug that requires patching! Read this link for instructions:
  # http://opennebula.org/documentation:rel3.0:acctd_conf#considerations_limitations 
  #gem install json sequel sqlite3

}

# vim:set ts=2 sw=2 et:
