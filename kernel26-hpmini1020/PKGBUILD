
pkgname=kernel26-hpmini1020
pkgver=2.6.32.4
pkgrel=2
pkgdesc="Kernel 2.6 customized for HP mini 110-1020 netbooks"
arch=(i686)
license=('GPL2')
groups=('base')
url="http://www.kernel.org"
depends=('coreutils' 'module-init-tools')
install=kernel26-hpmini1020.install
source=('http://www.kernel.org/pub/linux/kernel/v2.6/linux-2.6.32.4.tar.bz2'
	'kernel26-hpmini1020.install'
	'dot_config')
md5sums=('471e0fe07e27796f041ecb990302ccc4'
         '8393cb68e90491f92635f5ccd8527b15'
         '4add852bf0eb1ead61eff2d91c2a5a48')

build() {

# prepare
	cd ${srcdir}/linux-${pkgver}
	make mrproper
# copy config file
	cp ${startdir}/dot_config ${srcdir}/linux-${pkgver}/.config
# updating config file to custom kernel version
# optionaly, you can "make menuconfig" or so, to change config options.
	make oldconfig
#make menuconfig


# build the kernel

  make || return 1

# install our modules
  mkdir -p $pkgdir/{lib/modules,boot}
  make INSTALL_MOD_PATH=$pkgdir modules_install || return 1

  cd $srcdir/linux-${pkgver}

# install the kernel
  install -D -m644 System.map $startdir/pkg/boot/System.map26-hpmini
  install -D -m644 arch/x86/boot/bzImage ${pkgdir}/boot/vmlinuz26-hpmini

# set correct depmod command for install
  sed -i -e "s/KERNEL_VERSION=.*/KERNEL_VERSION=${pkgver}-hpmini/g" $startdir/kernel26-hpmini1020.install
}