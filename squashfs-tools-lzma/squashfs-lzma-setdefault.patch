diff --git a/squashfs-tools/mksquashfs.c b/squashfs-tools/mksquashfs.c
index 276f680..913eea7 100644
--- a/squashfs-tools/mksquashfs.c
+++ b/squashfs-tools/mksquashfs.c
@@ -4234,6 +4234,8 @@ int main(int argc, char *argv[])
 		fragmentb_mbytes = FRAGMENT_BUFFER_DEFAULT;
 	int s_minor = SQUASHFS_MINOR;
 
+	compression=LZMA_COMPRESSION;
+
 	pthread_mutex_init(&progress_mutex, NULL);
 	block_log = slog(block_size);
 	if(argc > 1 && strcmp(argv[1], "-version") == 0) {
@@ -4357,8 +4359,8 @@ int main(int argc, char *argv[])
 				exit(1);
 			}
 #ifdef USE_LZMA
-		} else if(strcmp(argv[i], "-lzma") == 0) {
-			compression = LZMA_COMPRESSION;
+		} else if(strcmp(argv[i], "-nolzma") == 0) {
+			compression = ZLIB_COMPRESSION;
 #endif
 		} else if(strcmp(argv[i], "-ef") == 0) {
 			if(++i == argc) {
