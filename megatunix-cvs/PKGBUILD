pkgname=megatunix-cvs
pkgver=PRE_0_9_20
pkgrel=1
pkgdesc="Tuning software for the MegaSquirt electronic fuel injection system"
arch=('i686' 'x86_64')
url="http://megatunix.sourceforge.net/"
license=('GPL')
groups=()
depends=('gtkglext' 'flex' 'bison' 'glade' 'libglade')
makedepends=('make' 'gcc' 'cvs' 'gdb' 'automake')
optdepends=()
provides=('megatunix')
conflicts=('megatunix')
install=()
source=()
noextract=()
md5sums=() #generate with 'makepkg -g'

_cvsroot=":pserver:anonymous@megatunix.cvs.sourceforge.net:/cvsroot/megatunix"
_cvsmod="MegaTunix"

build() {
    cd ${srcdir}

    msg "Connecting to $_cvsmod.sourceforge.net CVS server..."
    if [ -d $_cvsmod/MegaTunix ]; then
        cvs -z3 update -d
    else
        cvs -z3 -d $_cvsroot co -r PRE_0_9_20-branch -P -f $_cvsmod
    fi

    msg "CVS checkout complete (or server timeout)"
    msg "Starting make..."

    cp -r $_cvsmod $_cvsmod-build
    cd $_cvsmod-build

    ./autogen.sh --enable-debug --prefix=/usr 
    make || return 1
    make DESTDIR=${pkgdir} install || return 1


    rm -r $srcdir/$_cvsmod-build
}

