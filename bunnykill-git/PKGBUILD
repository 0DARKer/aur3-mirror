# Contributor: Stefan Mark <mark@unserver.de>

pkgname=bunnykill-git
pkgver=20100814
pkgrel=1
pkgdesc="Kill all those cute fluffy bunnys! Spill their blood!!"
arch=('i686' 'x86_64')
url="http://e-x-a.org/?view=projects"
license=('GPL')
depends=('freealut' 'openal' 'freetype2' 'libvorbis' 'libpng' 'sdl' 'freeglut' 'scons')
makedepends=('scons' 'wget')

_gitroot="http://e-x-a.org/repos/bunnykill.git"
_gitname="bunnykill"

build() {
  cd $srcdir

  msg "Connecting to GIT server...."

  if [ -d $_gitname ] ; then
    cd $_gitname && git pull origin
    msg "The local files are updated."
  else
    git clone $_gitroot $_gitname
  fi

  cd "$srcdir/$_gitname"

  msg "GIT checkout done or server timeout"

  msg "Patching..."
  wget -N 0mark.unserver.de/filez/bunnykill_patch.1.diff
  patch -p 1 -N < bunnykill_patch.1.diff || true

  msg "Starting scons..."
  scons

  msg "And installing..."
  mkdir -p $pkgdir/usr/share/bunnykill
  cp -R data $pkgdir/usr/share/bunnykill
  mkdir -p $pkgdir/usr/bin
  cp bunnykill $pkgdir/usr/bin
}

