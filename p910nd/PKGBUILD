# Maintainer: Danilo Luvizotto <danilo.luvizotto@gmail.com>
# Contributor: Wieland Hoffmann <the_mineo@web.de>
# Contributor: G_Syme <demichan(at)mail(dot)upb(dot)de>
pkgname=p910nd
pkgver=0.95
pkgrel=3
pkgdesc="A small printer daemon intended for diskless workstations that passes jobs directly to the printer"
arch=('i686' 'x86_64' 'armv6h')
url="http://p910nd.sourceforge.net"
license=('GPL2')
backup=('etc/conf.d/p910nd')
options=('emptydirs')
source=(http://downloads.sf.net/$pkgname/$pkgname-$pkgver.tar.bz2 \
        $pkgname.service)

build() {
  cd $srcdir/$pkgname-$pkgver
  sed -e "s|/var/lock/subsys|/var/lock/$pkgname|" -i $pkgname.c
  sed -e 's|$(INSTALL) $(INITSCRIPT) $(DESTDIR)$(SCRIPTDIR)/$(PROG)||' -i Makefile
  make CONFIGDIR=/etc/conf.d INITSCRIPT="" SCRIPTDIR=""
  make CONFIGDIR=/etc/conf.d INITSCRIPT="" SCRIPTDIR="" DESTDIR=$pkgdir install
  install -d -m755 $pkgdir/var/lock/$pkgname
  install -d -m755 $pkgdir/usr/lib/systemd/system
  install -m644 $srcdir/$pkgname.service $pkgdir/usr/lib/systemd/system/$pkgname.service
  chmod 1777 $pkgdir/var/lock
}
md5sums=('c7ac6afdf7730ac8387a8e87198d4491'
         'c40b7745d2c6b4427358cc95a0c50220')
