# Maintainer: ian kremlin <ian [AT] kremlin [DOT] cc>
# Former Maintainer: Dennis Hamester <dennis.hamester [AT] gmail [DOT] com>

pkgname=dwarffortress-phoebus
pkgver=0.40.1

# rewrite by kremlin, july 8th 2014
pkgrel=6
epoch=1

pkgdesc="Dwarf Fortress preloaded with Phoebus tileset"

# need confirmation that i686 works
arch=('i686 x86_64')
url="http://www.bay12games.com/dwarves/"
license="custom:dwarffortress_phoebus"
groups="games"
depends=('lib32-sdl_image' 'lib32-sdl_ttf' 'lib32-gtk2' 'lib32-glu')

source=('https://kremlin.cc/Phoebus_34_11v00.zip'
		'https://kremlin.cc/dfmirror/df_40_01_linux.tar.bz2'
		'df_linux_installme'
		'LICENSE')

md5sums=('6b5d7734093a7f72d6b6038db9a342dc'
         'b2d4de76a4f67ad1233f465496911640'
         '9848de8da4babe7c11f51b947bd5235e'
         'eddfb4bd478f9c64e6801bda7c7791ba')

sha512sums=('cea7e22e91713bdb4cc41827111063ca02a1f4b9bdb148a2eadd218a1edefc706a1d1fd6a2d121a85b62fbba0b808ba81df1f91541d2e892d14eeea05e0684ab'
            'f9292c5823ca15c391277c2bd4139a8c649614636c64f9e6a9d91a4a255f9d65295d8e855a2ce0d91b87ae8ef147f5aa63f37c3c51d14e9e36cefb6dde6ef9b9'
            '44288977c6560f77db968d39e402e98d76d1f8691419c7ed0c8d4db5a7172c4180830b484a0c43cda6f0f731847d1d8c204dd548fa525a1691c5f1d5905584c7'
            '7da52d8a51b00c97b3f6ad715475c7fbc53090d76f182e2820d886b0996a106fc8dffac0ad4458e203b8aec96670f0cb052f59b7a7ecc364f46c484a2ce6d86e')

prepare() {
	mv "${srcdir}"/raw/graphics/* df_linux/raw/graphics/
	mv "${srcdir}"/raw/objects/* df_linux/raw/objects/
	mv "${srcdir}"/data/init/phoebus/* df_linux/data/init/
	mv "${srcdir}"/data/art/* df_linux/data/art/
	chmod -R a+rx "${srcdir}"/*
}

package() {
	install -d "${pkgdir}"/usr/share/
	mv "${srcdir}"/df_linux/ "${pkgdir}"/usr/share/df_linux
	install -D -m644 "${srcdir}"/LICENSE "${pkgdir}"/usr/share/licenses/dwarffortress-phoebus/LICENSE
	install -D -m755 "${srcdir}"/df_linux_installme "${pkgdir}"/usr/bin/df_linux
	mkdir -p -m777 "${pkgdir}"/usr/share/df_linux/data/save/current/ # savedir should be world writable
	chmod a+w "${pkgdir}"/usr/share/df_linux/data/index # this one too
}
