# Maintainer: speps <speps at aur dot archlinux dot org>

pkgname=nomacs
pkgver=0.3.2
pkgrel=1
pkgdesc="A Qt image viewer"
arch=(i686 x86_64)
url="http://www.nomacs.org/"
license=('GPL3')
depends=('qt' 'exiv2' 'libraw' 'opencv')
makedepends=('cmake')
install="$pkgname.install"
source=("http://downloads.sourceforge.net/project/$pkgname/$pkgname-$pkgver/$pkgname-$pkgver-source.zip")
md5sums=('144d74f73954c865afafb8d3b7b6a6f1')

build() {
  cd "$srcdir"
  [ -d bld ] || mkdir bld && cd bld
  cmake .. -DCMAKE_INSTALL_PREFIX=/usr

  # opencv fix
  sed -i "s|$| $(pkg-config --libs opencv)|" \
    `find . -name link.txt`

  make
}

package() {
  cd "$srcdir/bld"
  make DESTDIR="$pkgdir/" install
}

# vim:set ts=2 sw=2 et:
