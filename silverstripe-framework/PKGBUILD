# Maintainer: Jacob Grevald <archpkg@jacobgrevald.dk>

pkgname=silverstripe-framework
pkgver=v3.0.5
pkgrel=1
pkgdesc="An object-oriented PHP5 web application framework"
arch=('any')
url="http://www.silverstripe.org"
license=('BSD')
depends=('php>=5.3.2')
optdepends=(
  'silverstripe-cms: CMS integration'
)
options=('!strip')
install=silverstripe-framework.install
source=("http://www.silverstripe.org/assets/releases/SilverStripe-framework-${pkgver}.tar.gz"
	"lighttpd.example.conf")
md5sums=('82b4e0e0dfd34426fef6271fb899c617'
         '30405058d0307d7e7a692d1dc97c5a1e')

package() {
  mkdir -p ${pkgdir}/etc/webapps/silverstripe/
  mkdir -p ${pkgdir}/usr/share/webapps
  mkdir -p ${pkgdir}/usr/share/licenses/silverstripe-framework/

  cd ${srcdir}/SilverStripe-framework-${pkgver}
  sed -n '/Copyright/,/ DAMAGE./p' README.md > ${pkgdir}/usr/share/licenses/silverstripe-framework/LICENSE
  mv mysite mysite-new
  mv themes themes-new

  cd ${pkgdir}/usr/share/webapps
  cp -Ra ${srcdir}/SilverStripe-framework-${pkgver} silverstripe

  cp ${srcdir}/lighttpd.example.conf ${pkgdir}/etc/webapps/silverstripe/lighttpd.example.conf
}
