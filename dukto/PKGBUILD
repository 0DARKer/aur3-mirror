# Maintainer: jfperini <@jfperini>
# Contributor: jfperini <@jfperini>

pkgname=dukto
pkgver=R6
pkgrel=1
pkgdesc="A simple, fast and multi-platform file transfer tool for LAN users"
url="http://code.google.com/p/dukto/"
arch=('any')
license=('GPL')
depends=('qt4')
makedepends=('subversion')
conflicts=('dukto-svn')
provides=('dukto-svn')

_svntrunk='http://dukto.googlecode.com/svn/trunk/'
_svnmod='dukto-read-only'

build()
{
  svn co $_svntrunk $_svnmod
  cd $srcdir/dukto-read-only
  sed -i "47i#include <unistd.h>" qtsingleapplication/qtlocalpeer.cpp
  qmake-qt4 dukto.pro
  make
}

package (){
  cd $srcdir/$_svnmod
  install -Dm755 "$pkgname" "$pkgdir/usr/bin/$pkgname"
  mkdir -p "$pkgdir/usr/share/pixmaps"
  install -Dm644 "$pkgname.png" "$pkgdir/usr/share/pixmaps/$pkgname.png"
   
  echo "[Desktop Entry]
  Version=1.0
  Encoding=UTF-8
  Type=Application
  Categories=AudioVideo
  Name=$pkgname
  Comment=Watch TV channels on Linux
  Exec=$pkgname
  Icon=/usr/share/pixmaps/$pkgname.png
  StartupNotify=true
  Terminal=false" | tee "$pkgname.desktop"
  echo -e "...Ok.\n"
  
  install -Dm644 "$pkgname.desktop" "$pkgdir/usr/share/applications/$pkgname.desktop"

}

