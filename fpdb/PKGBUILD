# Contributor: flub <flub123[at]gmx[dot]de>
# Maintainer: Davide Iosca <dvdios[at]aol[dot]com>
pkgname=fpdb
pkgver=0.30.7
_major=0.30
pkgrel=2
pkgdesc="An open source tracker/HUD for use with on-line poker."
url="http://sourceforge.net/projects/fpdb/"
arch=('x86_64' 'i686')
license=('AGPL' 'GPL')
depends=('pygtk' 'python2-matplotlib' 'python2-wnck' 'python-xlib' 'pypoker-eval')
source=("http://sourceforge.net/projects/fpdb/files/fpdb/${_major}/${pkgname}-${pkgver}.tar.gz")
md5sums=('afbb1220522cf838b2cc6bd8bce4e6b2')

package() {

  # building... setup requires ${pkgdir} which is no longer available in build()
  cd "${srcdir}/${pkgname}-${pkgver}"
  python2 setup.py install --root="${pkgdir}/" --optimize=1
  cp "pyfpdb/Cards01.png" "${pkgdir}/usr/lib/python2.7/site-packages/fpdb/"
  cp "pyfpdb/Cards02.png" "${pkgdir}/usr/lib/python2.7/site-packages/fpdb/"
  cp "pyfpdb/HUD_main.pyw" "${pkgdir}/usr/lib/python2.7/site-packages/fpdb/"
  cp "pyfpdb/fpdb.pyw" "${pkgdir}/usr/lib/python2.7/site-packages/fpdb/"
  cd "${pkgdir}/usr/lib/python2.7/site-packages/fpdb/"
  sed -i 's|#!/usr/bin/env python|#!/usr/bin/python2|g' *.py
  sed -i 's|#!/usr/bin/env python|#!/usr/bin/python2|g' *.pyw
  chmod +x "fpdb.pyw"

  # packaging
  mkdir "${pkgdir}/usr/bin"
  ln -s "../lib/python2.7/site-packages/fpdb/fpdb.pyw" "${pkgdir}/usr/bin/fpdb"
}