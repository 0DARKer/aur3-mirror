# Maintainer: Stefan Reuter <stefan dot gert dot r at gmail dot com>

pkgname=fusion-qt4-hg
_hgname=fusion-qt4
pkgver=10.28dfbab78a90
_qt4ver=4.8.5
_pkgfqn="qt-everywhere-opensource-src-${_qt4ver}"
pkgrel=1
pkgdesc="This is new Fusion GUI style, ported from Qt 5 to Qt 4."
arch=('i686' 'x86_64')
url="https://code.google.com/p/fusion-qt4/"
license=('LGPL')
depends=('qt4')
makedepends=('mercurial' 'qt4-private-headers')
source=('hg+https://code.google.com/p/fusion-qt4/'
	"http://download.qt-project.org/official_releases/qt/4.8/${_qt4ver}/${_pkgfqn}.tar.gz")
md5sums=('SKIP'
	 '1864987bdbb2f58f8ae8b350dfdbe133')

pkgver() {
  cd $_hgname
  echo $(hg identify -n).$(hg identify -i)
}

prepare() {
  cd $_hgname
  sed -i "s|QTSRC = E:/Soft/QtSDK/QtSources/4.8.0/src|\
QTSRC =\ ${srcdir}/qt-everywhere-opensource-src-${_qt4ver}/src|g" fusion.pro
  sed -i "s|DESTDIR = \$\$\[QT_INSTALL_PLUGINS\]/styles|\
DESTDIR = ${pkgdir}/\$\$\[QT_INSTALL_PLUGINS\]/styles|g" fusion.pro
}

build() {
  cd $_hgname
  qmake-qt4
  make
}
