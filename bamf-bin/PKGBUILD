# Maintainer: Dan Serban

pkgname=bamf-bin
pkgver=0.2.94
pkgrel=1
pkgdesc="libbamf-dev and libbamf0 from Ubuntu Maverick"
arch=(i686 x86_64)
url=https://launchpad.net/bamf
license=(GPL)
_filearch=i386 && _soarch=i386
[ "$CARCH" = "x86_64" ] && _filearch=amd64 && _soarch=x86_64
_libbamf_dev_ubu_ver=0.2.94-0ubuntu1
_libbamf0_ubu_ver=0.2.94-0ubuntu1

build()
{
  _url_prefix="http://archive.ubuntu.com/ubuntu/pool/main"

  # --- libbamf-dev ---
  _file="libbamf-dev_${_libbamf_dev_ubu_ver}_${_filearch}.deb"
  cd "${srcdir}"
  wget "${_url_prefix}/b/bamf/${_file}"
  bsdtar -xf "${_file}" data.tar.gz
  bsdtar -xf data.tar.gz -C "${pkgdir}"
  rm data.tar.gz
  cd "${pkgdir}"/usr/lib
  mv ${_soarch}-linux-gnu/pkgconfig .
  rm -r ${_soarch}-linux-gnu
  cd "${pkgdir}"/usr/include/libbamf
  mv libbamf/*.h .
  rm -r libbamf

  # --- libbamf0 ---
  _file="libbamf0_${_libbamf0_ubu_ver}_${_filearch}.deb"
  cd "${srcdir}"
  wget "${_url_prefix}/b/bamf/${_file}"
  bsdtar -xf "${_file}" data.tar.gz
  bsdtar -xf data.tar.gz usr/lib/${_soarch}-linux-gnu/libbamf.so.0.0.0
  rm data.tar.gz
  install -Dm644 usr/lib/${_soarch}-linux-gnu/libbamf.so.0.0.0 "${pkgdir}"/usr/lib/libbamf.so.0.0.0
  cd "${pkgdir}"/usr/lib
  ln -s libbamf.so.0.0.0 libbamf.so.0
  ln -s libbamf.so.0.0.0 libbamf.so
}

