# Contributor: giniu <gginiu@gmail.com>
pkgname=serna
pkgver=4.3
_distversion=4.3.0-20110203
pkgrel=2
pkgdesc="Serna Free Open Source XML Editor"
license=('GPL')
url="http://www.syntext.com/products/serna-free/"
source=("http://downloads.syntext.com/serna/serna-free-${_distversion}-linux.tgz"
        serna.sh)
arch=('i686' 'x86_64')
[ "$CARCH" = "i686"   ] && depends=('gcc-libs' 'libxmu' 'libxft' 'libxinerama')
[ "$CARCH" = "x86_64" ] && depends=('gcc-libs-multilib' 'lib32-libxmu' 'lib32-libxft' 'lib32-libxinerama')
makedepends=('binutils' 'tar' 'gzip' 'sed')
md5sums=('0f515df41e09c4a7a4109080d4351995'
         '324816ab1d649be335810eab5150a356')

build() {
  cd "${srcdir}"/serna-free-${pkgver}
  mkdir -p "${pkgdir}"/opt
  mkdir -p "${pkgdir}"/usr/bin
  tar -xzf serna-free-${pkgver}.tgz -C "${pkgdir}"/opt
  sed -e "s/pkgver/${pkgver}/g" ../serna.sh > "${pkgdir}"/opt/serna-free-${pkgver}/bin/serna.sh
  chmod 755 "${pkgdir}"/opt/serna-free-${pkgver}/bin/serna.sh
  chmod 775 "${pkgdir}"/opt/serna-free-${pkgver}/bin/serna.bin
  chmod 755 "${pkgdir}"/opt/serna-free-${pkgver}/utils/publishing/*.sh
  chmod -R a+r "${pkgdir}"/opt/serna-free-${pkgver}
  chmod a+x `find "${pkgdir}"/opt/serna-free-${pkgver} -type d`
  ln -sf /opt/serna-free-${pkgver}/bin/serna.sh "${pkgdir}"/usr/bin/serna
  chown -R root:root "${pkgdir}"
}

