# Maintainer: OmeGa <omega at mailoo dot org>
# Contributor: Tianjiao Yin <ytj000+aur@gmail.com>

pkgname=firefox-extension-downthemall
_addons_file=165521
pkgver=2.0.15
pkgrel=1
pkgdesc="The first and only download manager/accelerator built inside Firefox!"
arch=('any')
url="http://www.downthemall.net/"
license=('GPL2')
depends=('firefox')
source=(https://addons.mozilla.org/firefox/downloads/file/${_addons_file}/downthemall-$pkgver-fx+sm.xpi)
sha1sums=('2b2fc117ed6752dcc999c03ca24e49897ab7d3b7')

build() {
  cd $srcdir
  local emid=$(sed -n '/.*<em:id>\(.*\)<\/em:id>.*/{s//\1/p;q}' install.rdf) || return 1
  local dstdir=$pkgdir/usr/lib/firefox/extensions/${emid}
  install -d $dstdir
#  sed -i 's#<em:maxVersion>.*</em:maxVersion>#<em:maxVersion>20.*</em:maxVersion>#' install.rdf
  cp -R * $dstdir
  rm $dstdir/*.xpi
  find $pkgdir -type d -exec chmod 0755 {} \;
  find $pkgdir -type f -exec chmod 0644 {} \;
}


