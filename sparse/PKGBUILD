# Contributor: Dan McGee <dpmcgee@gmail.com>

pkgname=sparse
pkgver=0.4.2
pkgrel=1
pkgdesc="A Semantic Parser for C"
arch=('i686' 'x86_64')
url="http://sparse.wiki.kernel.org/index.php/Main_Page"
license=('custom:OSL')
depends=('perl' 'libxml2')
source=(http://www.kernel.org/pub/software/devel/$pkgname/dist/$pkgname-$pkgver.tar.gz
        0001-Makefile-fix-permissions-mixup-on-install.patch)

build() {
  cd $startdir/src/$pkgname-$pkgver

  # fix some of the build permission issues, submitted this upstream
  patch -Np1 < ../0001-Makefile-fix-permissions-mixup-on-install.patch

  make PREFIX=/usr || return 1
  make PREFIX=/usr DESTDIR=$startdir/pkg install

  # install license
  mkdir -p $startdir/pkg/usr/share/licenses/sparse
  install -m644 LICENSE $startdir/pkg/usr/share/licenses/sparse/
}

md5sums=('c94e67a35db9f30f00fe92a462304125'
         'b78f53b7ae90071df2ff5820fa23e0a2')
