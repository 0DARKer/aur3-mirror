# PKGBUILD made by: Gris Ge <cnfourt@gmail.com>
pkgname="beaker"
pkgver="0.5.59_3"
pkgrel="1"
pkgdesc="An automated testing framework proposed for Fedora. Successor to RHTS"
arch=('i686' 'x86_64')
makedepends=('git' 'turbogears>=1.1.1')
url="https://fedorahosted.org/beaker"
license=('GPL')
depends=('python2=2.7' 'turbogears>=1.1.1' 'python-kobo>=0.3.1' 'python-lxml>=2.2.8')
source=('beaker_python2.patch')
md5sums=('a6ebe070838f3e96fdbdb74850203243')

build() {
	cd $srcdir
    if [ ! -d beaker_full ]
        then
            git clone git://git.fedorahosted.org/git/beaker.git beaker_full
        else
            cd beaker_full
            git pull
    fi
    #echo git finished
    cd $srcdir/beaker_full
    #echo build archive
    git archive --format=tar $pkgname-${pkgver//_/-} > $srcdir/$pkgname-${pkgver//_/-}.tar
    mkdir -p $srcdir/beaker
    cd $srcdir/beaker
    #pwd
    tar xfv $srcdir/$pkgname-${pkgver//_/-}.tar
    #pwd
    patch -p1 -i $srcdir/beaker_python2.patch
    make
    DESTDIR=$pkgdir make install
}

