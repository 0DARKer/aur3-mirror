pkgname=dropbear_initrd_encrypt
pkgver=0.8
pkgrel=12
pkgdesc="provides SSH access in initrd to enter root luks passphrase "
arch=(i686 x86_64)
url="https://mw.vc/2009/08/08/luks-pass-over-ssh-archlinux/"
license=('GPL')
depends=('dropbear' 'cryptsetup' 'mkinitcpio-nfs-utils' 'psmisc' 'iproute2')
install=$pkgname.install
source=(dropbear_hook dropbear_install encryptssh_hook encryptssh_install)
md5sums=('9499518c882d810c6c090e60ab9617b7'
         'b57e55e586cf73cf900b4ce50b6c6196'
         'd6215b016f4b73c0d3017d0c8230c99d'
         '021ed02865e4043e5929737430242616')

build() {
  install -Dm644 "$srcdir"/dropbear_hook "$pkgdir"/lib/initcpio/hooks/dropbear
  install -Dm644 "$srcdir"/dropbear_install "$pkgdir"/lib/initcpio/install/dropbear
  install -Dm644 "$srcdir"/encryptssh_hook "$pkgdir"/lib/initcpio/hooks/encryptssh
  install -Dm644 "$srcdir"/encryptssh_install "$pkgdir"/lib/initcpio/install/encryptssh
}
