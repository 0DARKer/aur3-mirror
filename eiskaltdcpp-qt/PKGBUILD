# Maintainer: Vitaly M. <jauthu@gmail.com>
# Contributor: dhamp <dhamp@ya.ru>

_name=eiskaltdcpp
pkgname=eiskaltdcpp-qt
pkgver=2.2.1
_tarver=$pkgver
_prerel=
pkgrel=2
license=('GPL3')
arch=('i686' 'x86_64')
depends=('qt>=4.7.0' 'miniupnpc' 'bzip2' 'pcre')
optdepends=('aspell: spellchecking'
            'qtscriptgenerator: qt scripts'
            'php: php scripts')
pkgdesc="Qt-version of DC and ADC client based on dcpp core"
url="http://code.google.com/p/eiskaltdc/"
makedepends=('gcc' 'pkgconfig' 'cmake' 'gettext')
conflicts=('eiskaltdcpp-svn' 'eiskaltdcpp' 'eiskaltdcpp-gtk' 'eiskaltdcpp-gtk-svn')
options=(!emptydirs)
install=$pkgname.install
source=("http://eiskaltdc.googlecode.com/files/$_name-$_tarver$_prerel.tar.bz2")
sha1sums=('d0cf505a73f0ee08434ba738c83f494de1f38ac1')
build() {
  cd $srcdir
  rm -rf $srcdir/$_name-$_tarver$_prerel/build
  mkdir $srcdir/$_name-$_tarver$_prerel/build
  cd $srcdir/$_name-$_tarver$_prerel/build
  cmake .. -DCMAKE_INSTALL_PREFIX=/usr -DUSE_MINIUPNP=ON -DPERL_REGEX=ON -DUSE_JS=ON -DUSE_GTK=OFF -DLOCAL_BOOST=ON -DWITH_EXAMPLES=ON -DCMAKE_BUILD_TYPE=Release -DUSE_QT_QML=ON -DLUA_SCRIPT=ON -DWITH_LUA_SCRIPTS=ON
  make
  make DESTDIR=$pkgdir install
}
