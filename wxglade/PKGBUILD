# Maintainer: Brad Fanella <bradfanella@archlinux.us>
# Contributor: jrutila
# Contributor: grimi <grimi@poczta.fm>
# Contributor: jht <stefano@inventati.org>

pkgname=wxglade
pkgver=0.6.3
pkgrel=2
pkgdesc="A GUI designer for wxWidgets written in Python"
arch=('i686' 'x86_64')
license=('MIT')
url="http://wxglade.sourceforge.net/"
depends=('wxpython')
makedepends=('sed')
source=("http://downloads.sourceforge.net/sourceforge/wxglade/wxGlade-$pkgver.tar.gz" \
        "wxglade.desktop")
md5sums=('05faaab4639b4aadf6d3b32e745ba0d3'
         '50a9ad5d58bb6cd7f71bfa93aa131162')

build() {
  	cd $startdir/src/wxGlade-$pkgver
  	pv=2.7

  	# Make some dirs
  	mkdir -p $startdir/pkg/usr/share/{man/man1,doc/python-wxglade,locale}
  	mkdir -p $startdir/pkg/usr/share/{applications,pixmaps,licenses/wxglade}
  	mkdir -p $startdir/pkg/usr/lib/python$pv/site-packages/wxglade
  	mkdir -p $startdir/pkg/usr/share/python-wxglade/icons
  	mkdir -p $startdir/pkg/usr/bin

  	# Fix makefile
  	sed 's\zwxglade.py;\wxglade.py;\' -i Makefile

  	make PYVER=$pv DESTDIR=${startdir}/pkg install

  	# Fix exe
  	sed 's\pv="2.3"\pv="'$pv'"\' -i $startdir/pkg/usr/bin/wxglade
  	sed 's\exec python\exec python2\' -i $startdir/pkg/usr/bin/wxglade

  	# Install locale
  	cp -a locale/* $startdir/pkg/usr/share/locale/

  	# Copy license.txt and credist.txt
  	install -m644 license.txt $startdir/pkg/usr/share/licenses/wxglade
  	install -m644 license.txt credits.txt $startdir/pkg/usr/lib/python$pv/site-packages/wxglade

  	# Install launcher
  	install -m644 icons/icon.xpm $startdir/pkg/usr/share/pixmaps/wxglade.xpm
	install -m644 $startdir/src/wxglade.desktop $startdir/pkg/usr/share/applications

}
