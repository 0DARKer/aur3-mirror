# Contributor: Jakub Schmidtke <sjakub-at-gmail-dot-com>

pkgname=mingw32-qwt-static
pkgver=6.0.1
pkgrel=1
pkgdesc="Qt Widgets for Technical Applications (mingw32)"
arch=('i686' 'x86_64')
license=('GPL')
url="http://qwt.sourceforge.net"
depends=('mingw32-qt-static' 'mingw32-gcc')
options=('!strip' '!buildflags')
source=("http://downloads.sourceforge.net/qwt/qwt-${pkgver}.tar.bz2")
md5sums=('ace68558eab873e2da7e641179c4ef0c')

build() {
    unset CFLAGS
    unset CXXFLAGS
    unset LDFLAGS

    cd "${srcdir}/qwt-${pkgver}"

    export QTDIR=/usr/i486-mingw32
    export QMAKESPEC=/usr/share/qt/mkspecs/win32-g++-cross

    sed -i 's|+= QwtDll|-= QwtDll|' qwtconfig.pri
    sed -i 's|+= QwtDesigner|-= QwtDesigner|' qwtconfig.pri
    sed -i "s|C:/Qwt-\$\$QWT_VERSION|${pkgdir}${QTDIR}|" qwtconfig.pri
    sed -i "s|= target doc|= target|" src/src.pro

    ${QTDIR}/bin/qmake

    make
}

package() {
    cd "${srcdir}/qwt-${pkgver}"
    make install || return 1
}
