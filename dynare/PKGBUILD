# Maintainer: Rasmus
pkgname=dynare
pkgver=4.2.4
_mpkgver=4.2
pkgrel=4
pkgdesc="A software platform for handling (economic) DSGE and OLG models."
arch=('any')
url="http://www.dynare.org/"
license=('GPL')
depends=('octave' 'boost' 'blas')
## 'gsl' 'libmatio' <-- needed in some future version. . .
makedepends=('gcc-fortran')
optdepends=('latex: manual etc.'
             'octave-optim: suggested extension'
	     'epstools: for some export')
source=(http://www.dynare.org/download/${pkgname}-$_mpkgver/source/${pkgname}-${pkgver}.tar.gz)
md5sums=('b33b294aa58b2d9a82c3057130f171bc')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  ./configure --prefix=/usr --libdir=/usr/lib/dynare  #  --enable-org-export --disable-matlab
  make
##  make pdf
##  make html
##  make info
}

check() {
  cd "$srcdir/$pkgname-$pkgver"
 # make check
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make  DESTDIR="$pkgdir/" install
  mkdir -p $pkgdir/usr/lib/dynare/mex/octave
  for i in $srcdir/$pkgname-$pkgver/mex/octave/*.mex;
  do
    install -D -m 644  "$i" "$pkgdir/usr/lib/dynare/mex/octave/";
  done
  cp -r $srcdir/$pkgname-$pkgver/matlab/* $pkgdir/usr/lib/dynare/matlab
  cp -r $srcdir/$pkgname-$pkgver/preprocessor $pkgdir/usr/lib/dynare/matlab/
  rm $pkgdir/usr/lib/dynare/matlab/dynare_m
  ln -s /usr/lib/dynare/matlab/preprocessor/dynare_m  $pkgdir/usr/lib/dynare/matlab/dynare_m


  install -D -m 644 "$srcdir/$pkgname-$pkgver/dynare.el" "$pkgdir/usr/share/emacs/site-lisp/dynare.el"
}
