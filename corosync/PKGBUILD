# Maintainer: gls <ghostlovescorebg at gmail dot com>

pkgname=corosync
pkgver=2.3.3
pkgrel=1
pkgdesc="Cluster engine for nodal communication systems with additional features for implementing high availability within applications."
arch=('i686' 'x86_64')
url="http://www.corosync.org/"
license=('BSD')
makedepends=('nss' 'libstatgrab' 'net-snmp' 'libqb')
depends=('nss' 'libstatgrab' 'net-snmp' 'libqb')
provides=('corosync=2.1.0')
conflicts=('corosync1')
source=("http://corosync.org/download/corosync-$pkgver.tar.gz"
	"corosync.service")
md5sums=('e68e97bff74fc56c86493dc7def5f1bc'
         'abc267226faafc7dc8246634277705ea')
 
build() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  ./configure --prefix=/usr        \
              --sysconfdir=/etc    \
              --localstatedir=/var \
              --enable-systemd     \
              --enable-monitoring  \
              --enable-snmp        \
              --enable-dbus        \
              --with-systemddir=/usr/lib/systemd/system
  make
  make DESTDIR="${pkgdir}" install
  ## Updated and fixed up systemd service unit and associated start/stop script:
  cp ${srcdir}/corosync.service ${pkgdir}/usr/lib/systemd/system/corosync.service
}
