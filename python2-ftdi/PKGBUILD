#Maintainer: Randy Heydon <randy.heydon at clockworklab dot net>
#Based on the PKGBUILD created for libftdi.
pkgname=python2-ftdi
pkgver=0.19
pkgrel=1
pkgdesc="Python bindings to libftdi"
arch=("i686" "x86_64")
url="http://www.intra2net.com/en/developer/libftdi/download.php"
license=("GPL2" "LGPL2.1")
depends=("libftdi" "python2")
makedepends=("swig")
options=('!libtool')
source=("http://www.intra2net.com/en/developer/libftdi/download/libftdi-$pkgver.tar.gz")
md5sums=('e6e25f33b4327b1b7aa1156947da45f3')
sha1sums=('0f08caf8e754ace69cd682489fae3f7f09920fe1')

build() {
  cd "$srcdir/libftdi-$pkgver"
  sed -i '/no-install/d' examples/Makefile.in
  #Have configure look for the python2 executable first.
  #Many more changes are needed to make it work with python3.
  sed -i 's/python python2/python2/' configure
  ./configure --prefix=/usr --enable-python-binding
  make
}

package() {
  cd "$srcdir/libftdi-$pkgver"
  make DESTDIR="$pkgdir" install

  #Strip out all non-python components
  cd $pkgdir
  #rm -r `ls --hide=usr`
  cd usr
  rm -r `ls --hide=lib`
  cd lib
  rm -r `ls --hide=python2.[0-9]`
}
