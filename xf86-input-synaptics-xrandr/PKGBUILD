# Maintainer: affenkaraffe
# Contributor: Jan de Groot <jgc@archlinux.org>
# Contributor: Tobias Powalowski  <tpowa@archlinux.org>
# Contributor: Thomas BÃ¤chler <thomas@archlinux.org>
# Contributor: Alexander Baldeck <alexander@archlinux.org>
origname=xf86-input-synaptics
pkgname=${origname}-xrandr
pkgver=1.7.1
pkgrel=1
_upstreamname=xf86-input-synaptics
_gitversion=dfc3a8ed713c2878407c6443c4d3092da3125e0c
pkgdesc="Synaptics driver for notebook touchpads with patch to enable axis rotation."
arch=('i686' 'x86_64')
license=('custom')
url="http://xorg.freedesktop.org/"
depends=('libxtst' 'mtdev')
makedepends=('xorg-server-devel' 'X-ABI-XINPUT_VERSION=19' 'libxi' 'libx11' 'resourceproto' 'scrnsaverproto')
conflicts=('xorg-server<1.14.0' 'X-ABI-XINPUT_VERSION<19' 'X-ABI-XINPUT_VERSION>=20' 'synaptics' 'synaptics-xrandr')
replaces=('synaptics-xrandr')
provides=('synaptics')
conflicts=('synaptics')
groups=('xorg-drivers' 'xorg')


options=(!libtool)
backup=('etc/X11/xorg.conf.d/50-synaptics.conf')
source=(http://xorg.freedesktop.org/releases/individual/driver/${origname}-${pkgver}.tar.bz2
        add_tapbuttons.diff
				synaptics-xrandr-new.patch)

md5sums=('6505de717972b6a24b8eb13e69eb996c'
         '37e93467e7d9b6f67af301ccfd26f961'
         'b3c527a1bd97485fd32d2151562d3308')
				 
build() {
  cd "${srcdir}/${origname}-${pkgver}"
  
  # * upstream disabled tapping by default if a physical left button is present - see FS#33282
  # * enable MatchDevicePath directive by default - FS#33291
  patch -Np1 -i ${srcdir}/add_tapbuttons.diff
	patch -Np1 -i ${srcdir}/synaptics-xrandr-new.patch
  
  ./configure --prefix=/usr
  make
}

package() {
  cd "${srcdir}/${origname}-${pkgver}"
  make DESTDIR="${pkgdir}" install
  install -m755 -d "${pkgdir}/etc/X11/xorg.conf.d"
  install -m644 conf/50-synaptics.conf "${pkgdir}/etc/X11/xorg.conf.d/"
  install -m755 -d "${pkgdir}/usr/share/licenses/${pkgname}"
  install -m644 COPYING "${pkgdir}/usr/share/licenses/${pkgname}/"

  rm -rf "${pkgdir}/usr/share/X11"
}


