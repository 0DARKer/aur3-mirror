#Maintainer: Lubosz Sarnecki <lubosz@gmail.com> 

_realname=libkeyfinder
pkgname=$_realname-git
pkgver=72.2c03152
pkgrel=1
pkgdesc="Musical key detection for digital audio."
arch=('i686' 'x86_64')
url="http://www.ibrahimshaath.co.uk/keyfinder/"
license=('GPL3')
depends=('qt5-base' 'fftw' 'boost-libs') 
makedepends=('git' 'boost')
provides=($_realname)
conflicts=($_realname)

_gitname=libKeyFinder

source=("git://github.com/ibsh/libKeyFinder.git" "build.patch")
sha256sums=("SKIP" '600fe84fcd4762960a42b43bcfc66e2324b5f2453c53557f5bed0bb588451eb5')

pkgver() {
  cd $_gitname
  echo $(git rev-list --count master).$(git rev-parse --short master)
}

build() {
  cd $_gitname
  patch -p1 < ../../build.patch

  qmake PREFIX=/usr
  make
}

package() {
  cd $_gitname

  make INSTALL_ROOT="${pkgdir}" install
  
  mkdir -p ${pkgdir}/usr/include/keyfinder
  cp ${srcdir}/${_gitname}/*.h ${pkgdir}/usr/include/keyfinder
}
