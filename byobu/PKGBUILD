# -*- shell-script -*-
# Contributor: Baptiste Jonglez <baptiste--aur at jonglez dot org>
# Contributor: Adrian C. <anrxc..sysphere.org>

pkgname=byobu
pkgver=5.15
pkgrel=1
pkgdesc="Enhanced profile and useful notifications for tmux (or optionally screen)"
arch=("any")
url="https://launchpad.net/byobu"
license=("GPL3")
depends=("tmux" "libnewt" "python2")
makedepends=("gettext" "patch")
optdepends=("screen")
install="${pkgname}.install"
source=("${url}/trunk/${pkgver}/+download/${pkgname}_${pkgver}.orig.tar.gz"
    "${pkgname}.diff" # for the python2 issue & arch-specific config
    "statusrc")
sha1sums=('e41e7f75bf393aaa42c89ffbf2206ce0aed6c45f'
          '9724abee1668f8c09ba149d75f1fb2eb7145b07f'
          '8e8eb3a01f5e0df1f4125b0fbf21447b7e01f7b4')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  # fix python -> python2
  patch -uNp1 -i "${srcdir}/${pkgname}.diff"

  ./configure --prefix=/usr --sysconfdir=/etc
  make
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  make install DESTDIR="$pkgdir"

  # Install custom configuration for arch
  install -D -m644 ${srcdir}/statusrc "${pkgdir}/usr/share/${pkgname}/status/"
}
