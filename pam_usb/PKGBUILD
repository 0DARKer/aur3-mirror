# Maintainer: mickael9 <mickael9 at gmail dot com>

pkgname=pam_usb
pkgver=0.4.2
pkgrel=2
pkgdesc="PAM modules that enables either two-factor or password-less authentication using an USB storage device (such as an USB Flash Memory Token)"
url="http://www.pamusb.org/"
license=("GPL")
depends=(libxml2 pam hal pmount dbus-python pygobject)
arch=('i686' 'x86_64')
backup=('etc/pamusb.conf')
md5sums=('2320b752dd0b030dfbb0a3935e7dc899')
source=(http://downloads.sourceforge.net/sourceforge/pamusb/$pkgname-$pkgver.tar.gz)

build() {
    mkdir -p "$pkgdir/lib/security"
    mkdir -p "$pkgdir/usr/bin"
    mkdir -p "$pkgdir/usr/share/man/man1"
    mkdir -p "$pkgdir/etc/pam.d"
    
    cd "$srcdir/$pkgname-$pkgver"
    
    make || return 1
    make DESTDIR="$pkgdir" install

    sed -i 1s/python/python2/ "$pkgdir/usr/bin/pamusb-"{agent,conf}
}
