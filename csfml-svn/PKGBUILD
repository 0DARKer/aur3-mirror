# Contributor: Dustin Mays <dork.fish.wat@gmail.com>

pkgname=csfml-svn
pkgver=998
pkgrel=1
pkgdesc="C binding for SFML."
arch=('i686' 'x86_64')
url=http://sfml-dev.org
license=('zlib')
depends=('sfml-svn')
conflicts=('csfml')
provides=('csfml')
source=()
md5sums=()

_svntrunk=https://sfml.svn.sourceforge.net/svnroot/sfml
_svnmod=sfml

build() {
  cd ${srcdir}

  if [ -d $_svnmod/.svn ]; then
    (cd $_svnmod && svn up -r $pkgver)
  else
    svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
  fi

  msg "SVN checkout done or server timeout."

  cp -r $_svnmod $_svnmod-build
  cd $_svnmod-build/CSFML

#  msg "Patching..."
#  sed -i '32 a\#include <cstring>' src/SFML/Network/Socket{TCP,UDP}.cpp
#  sed -i '29 a\#include <cstring>' src/SFML/Network/IPAddress.cpp

  msg "Starting make."
  make || return 1
  find ./ -name ".svn" | xargs rm -Rf
  make DESTDIR=${pkgdir}/usr install || return 1

  rm -rf ${srcdir}/$_svnmod-build
}

# vim:syntax=sh
