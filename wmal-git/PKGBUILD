# Maintainer: Joost Bremmer < toost dot b at gmail dot com>

pkgname=wmal-git
pkgver=20130322
pkgrel=1
pkgdesc="A lightweight and simple updater for MyAnimeList, Melative or VNDB."
arch=('x86_64' 'i686')
url="http://z411.github.io/wmal-python/"
license=('GPLv3')
depends=('python2')
makedepends=('python2'
'git')
optdepends=('pygtk'
'python2-urwid'
)

_gitroot=https://github.com/z411/wmal-python.git
_gitname=wmal

pkgver() {
  cd "${srcdir}/${_gitname}"
  git log -1 --format="%cd" --date=short | sed 's|-||g'
}


build() {
   cd $srcdir/
   msg "Connecting to GIT server...."

   if [[ -d ${_gitname} ]]; then
     cd ${_gitname} && git pull origin
     msg "The local files are updated."
   else
     git clone ${_gitroot} ${_gitname}
   fi

  msg "GIT checkout done or server timeout"
  msg "Starting build..."

  rm -rf "$srcdir/$_gitname-build"
  git clone "$srcdir/$_gitname" "$srcdir/$_gitname-build"
  cd "$srcdir/$_gitname-build"



}

package() {
   cd $srcdir/${_gitname}
   python2 setup.py install --prefix=/usr --root=${pkgdir} --optimize=1
}
