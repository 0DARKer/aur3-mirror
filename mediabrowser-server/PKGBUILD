# Maintainer: Daniel Seymour <dannyseeless at gmail dot com>

pkgname=mediabrowser-server
pkgver=3.0.5347.23908
pkgrel=4
pkgdesc="The MediaBrowser server"
arch=('i686' 'x86_64')
url="http://www.mediabrowser.tv"
license=('GPL')
groups=()
depends=('mono' 'libgdiplus')
makedepends=('unzip')
optdepends=()
install=mediabrowser-server.install
source=("https://www.dropbox.com/s/07hh1g4x9xo28jb/MBServer.Mono.zip" 
        "mediabrowser.service" "mediabrowser")
md5sums=('224579f8e118eaa41e52a8af81106110'
         'fb4626c1c3b878ab82622fdcc4849277'
         'a546c362bd2f25443e49024c8a969937')

package() {
  mkdir -p $pkgdir/opt/$pkgname
  mkdir -p $pkgdir/usr/bin
  mkdir -p $pkgdir/usr/lib/systemd/system

  unzip MBServer.Mono.zip -d $pkgdir/opt/$pkgname	
  if [[ $CARCH = "i686" ]]; then
    # Patch the sqlite library to work on 32-bit systems.
    cp $pkgdir/opt/$pkgname/sqlite3/linux/lib/libsqlite3.so.0.8.6 $pkgdir/opt/$pkgname/sqlite3/linux/lib64/libsqlite3.so.0.8.6
  fi

  install -Dm755 mediabrowser $pkgdir/usr/bin
  install -Dm644 mediabrowser.service $pkgdir/usr/lib/systemd/system
}

