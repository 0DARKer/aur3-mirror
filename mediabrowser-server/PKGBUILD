# Maintainer: Daniel Seymour <dannyseeless at gmail dot com>

pkgname=mediabrowser-server
pkgver=3.0.5321.33359
pkgrel=1
pkgdesc="Media server and transcoder"
arch=('i686' 'x86_64')
url="http://www.mediabrowser.tv"
license=('GPL')
groups=()
depends=('mono' 'libgdiplus')
makedepends=()
optdepends=()
install=mediabrowser-server.install
source=("https://www.dropbox.com/s/07hh1g4x9xo28jb/MBServer.Mono.zip" 
        "mediabrowser-server.service" "mediabrowser-server")
md5sums=('6da4a10cb5c92b62d3e6e168fa149807'
         '50054f5af3bd7200698db2ecb7c6f891'
         '593df6b8425960cf2226ec4053b84dcd')

package() {
  mkdir -p $pkgdir/opt/$pkgname
  mkdir -p $pkgdir/usr/bin
  mkdir -p $pkgdir/etc/systemd/system

  cp -r $srcdir/* $pkgdir/opt/$pkgname/	
  if [[ $CARCH = "i686" ]]; then
    # Patch the sqlite library to work on 32-bit systems.
    cp $pkgdir/opt/$pkgname/sqlite3/linux/lib/libsqlite3.so.0.8.6 $pkgdir/opt/$pkgname/sqlite3/linux/lib64/libsqlite3.so.0.8.6
  fi

  install -Dm755 mediabrowser-server $pkgdir/usr/bin
  install -Dm644 mediabrowser-server.service $pkgdir/etc/systemd/system
}

