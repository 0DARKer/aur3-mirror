# Maintainer: Daniel Seymour <dannyseeless at gmail dot com>

pkgname=mediabrowser-server
pkgver=3.0.5322.32595
pkgrel=1
pkgdesc="Media server and transcoder"
arch=('i686' 'x86_64')
url="http://www.mediabrowser.tv"
license=('GPL')
groups=()
depends=('mono' 'libgdiplus')
makedepends=('unzip')
optdepends=()
install=mediabrowser-server.install
source=("https://www.dropbox.com/s/07hh1g4x9xo28jb/MBServer.Mono.zip" 
        "mediabrowser-server.service" "mediabrowser-server")
md5sums=('ed6b69549a0b44067a4a681fd13ddaa0'
         'd96b8e628e8a20137311a56c3df6d268'
         '3f15d696dc19c1c645c07535d315a4a6')

package() {
  mkdir -p $pkgdir/opt/$pkgname
  mkdir -p $pkgdir/usr/bin
  mkdir -p $pkgdir/etc/systemd/system

  unzip MBServer.Mono.zip -d $pkgdir/opt/$pkgname	
  if [[ $CARCH = "i686" ]]; then
    # Patch the sqlite library to work on 32-bit systems.
    cp $pkgdir/opt/$pkgname/sqlite3/linux/lib/libsqlite3.so.0.8.6 $pkgdir/opt/$pkgname/sqlite3/linux/lib64/libsqlite3.so.0.8.6
  fi

  install -Dm755 mediabrowser-server $pkgdir/usr/bin
  install -Dm644 mediabrowser-server.service $pkgdir/etc/systemd/system
}

