# Contributor: David Spicer <azleifel at googlemail dot com>

pkgname=gnome-dvb-daemon
pkgver=0.1.23
pkgrel=2
pkgdesc="A daemon to setup DVB devices, record and watch TV shows and browse EPG"
arch=('i686' 'x86_64')
url="http://live.gnome.org/DVBDaemon"
license=('GPL3')
depends=('dbus-python' 'gstreamer0.10-bad-plugins' 'gstreamer0.10-good-plugins'
         'gstreamer0.10-python' 'gstreamer0.10-rtsp>=0.10.7' 'hicolor-icon-theme'
         'libgee>=0.5.0' 'pygtk' 'vala')
makedepends=('pkg-config' 'intltool')
optdepends=('linuxtv-dvb-apps: For initial DVB tuning data'
            'totem: To watch live TV streamed by gnome-dvb-daemon')
options=(!libtool)
install=${pkgname}.install
source=(http://ftp.gnome.org/pub/GNOME/sources/gnome-dvb-daemon/0.1/${pkgname}-${pkgver}.tar.bz2)
md5sums=('2eb597e8fae125f704491a5f90cc2365')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  #
  # BUILD
  #
  install -d -m755 "${pkgdir}/usr/share/doc/${pkgname}"

  for _file in client/gnomedvb/DBusWrapper.py client/gnome-dvb-control client/gnome-dvb-setup; do
     sed -i -e '1c#!/usr/bin/env python2' "${_file}"
  done

  PYTHON=/usr/bin/python2 ./configure --prefix=/usr --sysconfdir=/etc --enable-totem-plugin
  make
  make DESTDIR="${pkgdir}" install

  # Install documents
  for _file in AUTHORS ChangeLog NEWS README; do
    install -m644 "${_file}" "${pkgdir}/usr/share/doc/${pkgname}"
  done
}
