# Maintainer: Michael Schubert <mschu.dev at gmail>

pkgname=libsbml
_pkgname=libSBML
pkgver=5.0.0
pkgrel=2
pkgdesc="XML-based description language for computational models in systems biology"
url="http://sbml.org/Software/libSBML"
license=('LGPL')
arch=('i686' 'x86_64')
depends=('gcc-libs' 'libxml2')
optdepends=('bzip2' 'python2' 'perl' 'ruby' 'octave' 'java-runtime')
builddepends=('swig')
options=('!libtool')
md5sums=('dd6937fb9ede3d3b916a8f8bbd5333a0')
source=("http://downloads.sourceforge.net/project/sbml/$pkgname/$pkgver/$_pkgname-$pkgver-src.tar.gz")

build() {
  mkdir -p "$srcdir/build" && cd "$srcdir/build"

  msg "HINT: enable the bindings you would like to use in the PKGBUILD"
  # set binding=1 to enable building
  python=0
  perl=0
  java=0
  ruby=0
  octave=0

  cmake -DCMAKE_BUILD_TYPE=release -DWITH_PYTHON=$python -DWITH_JAVA=$java \
    -DWITH_OCTAVE=$octave -DWITH_PERL=$perl -DWITH_RUBY=$ruby \
    -DCMAKE_INSTALL_PREFIX=/usr ../$pkgname-$pkgver

  make || return 1

  make DESTDIR="$pkgdir" install
  
  if [ $python == 1 ]; then
    pydir=`python2 -c "from distutils.sysconfig import get_python_lib; print get_python_lib()"`
    echo /usr/share/libsbml/bindings/python/libsbml > libsbml.pth
    install -Dm644 libsbml.pth "$pkgdir/$pydir/libsbml.pth"
  fi
}
