# Maintainer: ksj <podhorsky.ksj@gmail.com>
# Contributor: ksj <podhorsky.ksj@gmail.com>

pkgname=geany-gtk3-git
pkgver=1.24
pkgrel=1
pkgdesc="Fast and lightweight IDE (git version)"
arch=('x86_64' 'i686')
url="https://github.com/b4n/geany/tree/wip/gtk3-support"
license=('GPL2')
depends=('gtk3' 'hicolor-icon-theme' 'desktop-file-utils' 'python')
makedepends=('git' 'automake' 'autoconf' 'intltool')
conflicts=('geany')
provides=('geany')
install='geany-gtk3-git.install'

_gitroot=https://github.com/b4n/geany.git
_gitname=geany
build() {
    cd "$srcdir"
    msg "Connecting to GIT server...."
    if [[ -d $_gitname/.git ]]; then
        pushd $_gitname && git pull
        msg2 "The local files are updated."
        popd
    else
        git clone $_gitroot
    fi
    msg2 "GIT checkout done or server timeout"

    rm -rf $_gitname-build/
    cp -r $_gitname/ $_gitname-build/
    cd $_gitname-build/
    
    ./autogen.sh --prefix=/usr
    ./configure --enable-gtk3 --prefix=/usr
    make
}

package() {
    cd "$srcdir/$_gitname-build"
    make PREFIX=/usr DESTDIR="$pkgdir" install
}
