# Maintainer: kevku <kevku@gmx.com>
pkgname=libdigidocpp
pkgver=3.7.0.972
pkgrel=2
pkgdesc="Library for creating DigiDoc signature files (Official version by AS Sertifitseerimiskeskus)"
arch=('x86_64' 'i686')
url="http://www.id.ee/"
license=('LGPL')
depends=('xml-security-c' 'minizip')
makedepends=('cmake' 'xsd' 'libdigidoc' 'pcsclite' 'opensc')
conflicts=('libdigidocpp-svn' 'sk-libdigidocpp-svn')
source=("https://installer.id.ee/media/sources/$pkgname-$pkgver.tar.gz"
	"https://installer.id.ee/media/sources/$pkgname-$pkgver.tar.gz.asc"
	"libdigidocpp-minizip.patch")
sha256sums=('01a2e2d4e52d7faee406a017366b05c6e5c53b475c7a98a34a5a520599a1039f'
            'ce166751578a53b026be237d22105baf6d708a61fa40afe0f8f08382d135954a'
            '84f688599fc7f3dcba8df66639e45be73e9d675b8de237d9285f7a49d8db8e26')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  patch -p1 < "$srcdir/libdigidocpp-minizip.patch"
  cmake . -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_INSTALL_LIBDIR="lib" -DCMAKE_INSTALL_SYSCONFDIR="/etc" -DCERTS_LOCATION="/usr/share/esteid/certs"
  make 
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir/" install
}

