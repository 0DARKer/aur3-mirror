# Contributor: Roberto Nobrega <rwnobrega@gmail.com>
# Contributor: max.bra <max dot bra at alice dot it>

pkgname=gnome-gmail
pkgver=1.7
pkgrel=3
pkgdesc="Allows Gmail to be selected as the default mail application for the desktop"
arch=('i686' 'x86_64')
url="http://gnome-gmail.sourceforge.net/"
license=('GPL2')
depends=('gnome-control-center' 'gnome-python-desktop')
optdepends=('nautilus-sendto: automatically upload an email with a file attachment from nautilus')
makedepends=('intltool')
source=(http://downloads.sourceforge.net/project/gnome-gmail/Version_$pkgver/$pkgname-$pkgver.tar.gz)
md5sums=('b1aa6d2313c927fe2e762275f2c1a136')
install=$pkgname.install

build() {
    sed -i -e 's|#!/usr/bin/python|#!/usr/bin/python2|' "${srcdir}"/"$pkgname-$pkgver"/gnome-gmail
    sed -i -e 's|#!/usr/bin/python|#!/usr/bin/python2|' "${srcdir}"/"$pkgname-$pkgver"/setOOmailer
    sed -i -e 's|#!/usr/bin/python|#!/usr/bin/python2|' "${srcdir}"/"$pkgname-$pkgver"/evolution

    cd "$srcdir"/"$pkgname-$pkgver"
    ./configure --prefix=/usr --with-gconf-schema-file-dir=/usr/share/gconf/schemas
    make
}

package() {
    cd "$srcdir"/"$pkgname-$pkgver"
    make DESTDIR="$pkgdir" install || return 1

    rm -R "$pkgdir"/usr/share/man
}

