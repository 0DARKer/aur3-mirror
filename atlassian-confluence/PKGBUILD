# Maintainer: Vlad <avireti@gmail.com>
# Contributor: Sebastien Bariteau <numkem@gmail.com>
pkgname=atlassian-confluence
pkgver=5.6.4
pkgrel=3
pkgdesc="Atlassian's Confluence Enterprise wiki"
url="http://www.atlassian.com/software/confluence/overview"
license=('custom')
arch=('i686' 'x86_64')
backup=(etc/conf.d/confluence opt/atlassian-confluence/conf/server.xml)
install=confluence.install
source=(http://www.atlassian.com/software/confluence/downloads/binary/atlassian-confluence-${pkgver}.tar.gz
        confluence.conf.d
        confluence.service)
md5sums=('7e0c11d33d88e08fa439b734d25f6471'
         'd5f4910d3177ef217747339f948b48ea'
         'd7020d3cfa1bfaa22279e7b54f532478')
depends=('jre7')
optdepends=('mysql-connector: connect to MySQL'
            'libcups: used by bin/config.sh'
            'fontconfig: used by bin/config.sh')

package() {
	cd $srcdir/
	mkdir -p ${pkgdir}/opt/atlassian-confluence/
	cp -r ${srcdir}/atlassian-confluence-${pkgver}/* ${pkgdir}/opt/atlassian-confluence/

	# Setup systemd service
	install -m755 -d "${pkgdir}/usr/lib/systemd/system"
	install -D -m644 ${srcdir}/confluence.service ${pkgdir}/usr/lib/systemd/system/
	install -D -m644 ${srcdir}/confluence.conf.d ${pkgdir}/etc/conf.d/confluence
}
