# Maintainer: Christian Hesse <mail@eworm.de>

pkgname=remmina-git
pkgver=20111125
pkgrel=1
pkgdesc="Remmina remote desktop client written in GTK+ - git checkout "
arch=(i686 x86_64)
url="http://remmina.sourceforge.net/"
license=('GPL')
provides=(remmina)
conflicts=(remmina)
depends=(gtk3 zlib libjpeg avahi vte libssh libgcrypt libunique)
makedepends=(git intltool pkgconfig gettext libxdmcp)
optdepends=('remmina-plugins-git: Plugins for remmina, including xdmcp vnc telepathy rdp and nx')
install=remmina.install

_gitroot="https://github.com/FreeRDP/Remmina"
_gitname="remmina"
_gitbranch="cmake"

build() {
  cd "${srcdir}"
  msg "Connecting to GIT server...."

  if [ -d ${_gitname} ] ; then
    cd ${_gitname} && git pull origin
    msg "The local files are updated."
  else
    git clone -b ${_gitbranch} ${_gitroot} ${_gitname}
  fi
  msg "GIT checkout done or server timeout"

  msg "Cloning to build directory"
  rm -rf "${srcdir}/${_gitname}-build"
  git clone "${srcdir}/${_gitname}" "${srcdir}/${_gitname}-build"

  msg "Starting make..."
  cd "${srcdir}/${_gitname}-build/remmina/"
  ./autogen.sh
  ./configure --prefix=/usr --enable-nls \
	--enable-avahi --enable-vte --enable-unique \
	--enable-ssh --enable-gcrypt || return 1
  make || return 1
  make DESTDIR=${pkgdir} install
}
md5sums=()
