# Maintainer: Wesley Merkel <ooesili@gmail.com>
pkgname=qfi
pkgver=0.2.0
pkgrel=1
pkgdesc='Quickly edit commonly used files'
#_dist=Qfi
arch=('any')
#url="https://metacpan.org/release/$_dist"
url="https://github.com/ooesili/$pkgname"
license=('GPL')
depends=('perl' 'sudo')
optdepends=('bash-completion: autocomplete targets and options')
options=('!emptydirs' 'purge' '!strip')
#source=("http://search.cpan.org/CPAN/authors/id/BAZ/$_dist-$pkgver.tar.gz")
install=${pkgname}.install
source=("https://github.com/ooesili/qfi/archive/v${pkgver}.tar.gz"
        'qfi.install')
sha512sums=('03afd8b3f4c835757405a0dd2c66899fee3ff6b0a066ab5c0089675442629a12ac2323fd4fef98df043a02579de0c86b121a40468f3d7154a14215b913c8093b'
            '1854e87f2bdbc40382b56de1b695f0d0915aa324388303df47273d82d41959c7502fa7352c2c66bd98122e48d2e468d7aa815c38105cbbdd098c39c92c50ad8c')

build() {
    cd "$srcdir/$pkgname-$pkgver"

    # change environment variables that may cause unpredicatable behavior
    unset PERL5LIB PERL_MM_OPT PERL_MB_OPT PERL_LOCAL_LIB_ROOT
    export PERL_MM_USE_DEFAULT=1 MODULEBUILDRC=/dev/null

    # create and build script and build
    /usr/bin/perl Build.PL
    ./Build
}

# look into this once tests are written
#check() (
    #cd "$srcdir/$_dist-$pkgver"
    #unset PERL5LIB PERL_MM_OPT PERL_MB_OPT PERL_LOCAL_LIB_ROOT
    #export PERL_MM_USE_DEFAULT=1
    #./Build test
#)

package() {
    cd "$srcdir/$pkgname-$pkgver"

    # change environment variables that may cause unpredicatable behavior
    unset PERL5LIB PERL_MM_OPT PERL_MB_OPT PERL_LOCAL_LIB_ROOT

    # install
    ./Build install --installdirs=vendor --destdir="$pkgdir"
}
