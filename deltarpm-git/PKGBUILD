# Maintainer: Thomas Dziedzic < gostrc at gmail >

pkgname=deltarpm-git
pkgver=20110225
pkgrel=1
pkgdesc='Package for deltarpms'
arch=('i686' 'x86_64')
license=('BSD')
url='http://gitorious.org/deltarpm/deltarpm'
depends=('python-lxml' 'rpm' 'yum')

_gitroot='git://gitorious.org/deltarpm/deltarpm.git'
_gitname='deltarpm'

build() {
  if [ -d ${_gitname} ] ; then
    cd ${_gitname}
    git pull origin
  else
    git clone ${_gitroot} ${_gitname}
    cd ${_gitname}
  fi

  # python2 fixes
  #find -type f -exec sed -i -e 's_#!/usr/bin/python_&2_' -e 's_python -c_python2 -c_' -e 's_PYTHON=python_&2_' {} \;
  sed -i -e 's_usr/local_usr_' -e 's/python python3/python2 python3/' Makefile

  make all python
}

package() {
  cd ${_gitname}

  make DESTDIR=${pkgdir} install

  install -D -m644 LICENSE.BSD \
    ${pkgdir}/usr/share/licenses/deltarpm-git/LICENSE.BSD
}
