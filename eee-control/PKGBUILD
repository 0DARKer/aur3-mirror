# Mainteiner: dieghen89 <dieghen89@gmail.com>
# Contributor: Stunts <f.pinamartins@gmail.com>

pkgname=eee-control
pkgver=0.9.7.1
pkgrel=1
pkgdesc="A utility for the EeePC family which allows the user to modify the FSB, toggle hardware on and off and more."
arch=('i686' 'x86_64')
url="http://greg.geekmind.org/eee-control"
license=('BSDL')
backup=('etc/eee-control.conf')
depends=('python2' 'dbus-python' 'gconf' 'python-wnck' 'pygtk' 'python-notify' 'acpid' 'consolekit' 'python2-gconf')
makedepends=()
conflicts=()
source=(https://launchpadlibrarian.net/71593692/${pkgname}_${pkgver}_all.deb
	eee-control-daemon.rc
	eee-control-daemon.conf.diff
	eee-control-daemon.diff)

build() {
  cd ${srcdir}/
  bsdtar xvf eee-control_${pkgver}_all.deb
  bsdtar xvf data.tar.gz
  # Some patch for compatibility in arch
  patch -Np1 < eee-control-daemon.diff
  patch -Np1 < eee-control-daemon.conf.diff
  # Now python 2.7 is called python2
  for i in eee-control-daemon eee-control-tray ; do
    sed -i -e "s|/usr/bin/python|/usr/bin/python2|g" $srcdir/usr/bin/$i
  done 
  # Move the files
  rm -r etc/{init,init.d}
  mv $srcdir/usr/lib/python2.7/{dist,site}-packages
  sed -i '329d' $srcdir/usr/lib/python2.7/site-packages/EeeControl/tray.py
  sed -i '329d' $srcdir/usr/lib/python2.7/site-packages/EeeControl/tray.py
  for i in etc usr ; do cp -r $i $pkgdir ; done
  install -D -m 755 $srcdir/usr/share/eee-control/eee-control.conf $pkgdir/etc/eee-control.conf
  install -D -m 755 $srcdir/eee-control-daemon.rc $pkgdir/etc/rc.d/eee-control-daemon 
}
md5sums=('586c72a26cfdfe75b40dfd46c8bb4d49 '
         'f66a56858f0e9ee4b274c55df5fcf7fc'
         '9a03658a5c1d358fc4d0a12fd95305ea'
         'b22072d36fb4febae53698d841115112')
