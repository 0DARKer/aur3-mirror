# Contributor: Audren Cezar <audrencezar@gmail.com>

pkgname=lgob-svn
pkgver=771
pkgrel=1
pkgdesc="Set of Lua bindings that uses gobject-instrospection"
arch=(i686 x86_64)
url="http://oproj.tuxfamily.org" 
depends=('lua>=5.1' 'vte' 'libwebkit' 'gtksourceview2'
	'gtkspell' 'poppler-glib' 'goocanvas' 'clutter-gtk')
makedepends=('gcc')
license=(LGPL)
source=()
md5sums=()
conflicts=('lgob')
provides=('lgob=10.03')

_svntrunk="svn://svn.tuxfamily.org/svnroot/oproj/oprojsvn/lgob/trunk"
_svnmod="lgob"

build() { 
  cd "$startdir/src"

  if [ -d "$_svnmod/.svn" ]; then
    msg "SVN update $_svnmod"
    (cd "$_svnmod" && svn up -r "$pkgver")
  else
    msg "SVN checkout $_svntrunk $_svnmod"
    svn co "$_svntrunk" --config-dir ./ -r "$pkgver" "$_svnmod"
  fi

  msg "SVN operation done or server timeout. Preparing sources..."

  rm -rf "$_svnmod-build"
  cp -ruTf "$_svnmod" "$_svnmod-build"
  cd "$_svnmod-build"

  msg "In `pwd` Starting make..."
  
  if [ ${CARCH} = 'i686' ]; then
    lua build.lua ${startdir}/pkg/usr
  else
    lua build.lua ${startdir}/pkg/usr AMD64=1
  fi
}
