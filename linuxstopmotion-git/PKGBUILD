# Maintainer: Mark Coolen <mark dot coolen at gmail dot com>
pkgname=linuxstopmotion-git
_realname=linuxstopmotion
pkgver=2013-4-12
pkgrel=1
pkgdesc="software for capturing and creating stop-motion animations - development version"
arch=('i686' 'x86_64')
url="http://www.linuxstopmotion.org"
license=('GPL2')
depends=('qt4' 'sdl_image' 'libxml2' 'libvorbis' 'inotify-tools')
install=$_realname.install
conflicts=('stopmotion')
source=($_realname::git+http://git.code.sf.net/p/$_realname/code
	'X11_to_libs.patch')
md5sums=('SKIP'
	'77eebd5e3dfb72c9cb2fb6b27d142283')

pkgver() {
  cd $_realname
  #uses the time of the last commit
  git describe --always | sed 's|-|.|g'
}	

build() {
	cd $_realname
	patch -p1 -i ../X11_to_libs.patch
	qmake stopmotion.pro
	make PREFIX=/usr
}

package() {
	cd $_realname
	#make install
	install -D -m755 stopmotion $pkgdir/usr/bin/stopmotion
	install -D -m644 stopmotion.desktop $pkgdir/usr/share/applications/stopmotion.desktop
	install -D -m644 graphics/stopmotion.png $pkgdir/usr/share/pixmaps/stopmotion.png
	install -D -m644 stopmotion.mime $pkgdir/usr/share/mime-info/stopmotion.mime
	install -D -m644 stopmotion.1 $pkgdir/usr/share/man/man1/stopmotion.1
	gzip $pkgdir/usr/share/man/man1/stopmotion.1
	mkdir -p $pkgdir/usr/share/doc/stopmotion/
	cd manual
	cp -r * $pkgdir/usr/share/doc/stopmotion/
}
