Index: istanbul-0.2.2/istanbul/main/tray_icon.py
===================================================================
--- istanbul-0.2.2.orig/istanbul/main/tray_icon.py	2009-12-30 11:50:39.000000000 +0100
+++ istanbul-0.2.2/istanbul/main/tray_icon.py	2009-12-30 11:50:47.000000000 +0100
@@ -23,7 +23,6 @@
 from istanbul.main.preferences import Preferences
 
 import gtk
-import egg.trayicon
 
 import locale, gettext
 _ = gettext.gettext
@@ -33,20 +32,13 @@
     state = RecordingState.STOPPED
     current_screencast = None
     popup_menu = TrayPopupMenu()
-    event_box = Screen().event_box
+    tray_image = gtk.StatusIcon()
 
     def __init__(self):
-        gtk.window_set_default_icon_name(gtk.STOCK_MEDIA_RECORD)
-        self.tray_image = gtk.Image()
-        self.tray_image.set_from_stock(gtk.STOCK_MEDIA_RECORD, gtk.ICON_SIZE_SMALL_TOOLBAR)
-        self.event_box.add(self.tray_image)
-        self.tooltips = gtk.Tooltips()
-        self.tooltips.set_tip(self.event_box,
-            _("Left click to start screencast.  Right click for menu."))
-        self.tray_container = egg.trayicon.TrayIcon("istanbul")
-        self.tray_container.add(self.event_box)
-        self.event_box.connect("button-press-event", self._trayicon_clicked)
-        self.tray_container.show_all()
+        self.tray_image.set_from_stock(gtk.STOCK_MEDIA_RECORD)
+        self.tray_image.set_tooltip(_("Left click to start screencast.  Right click for menu."))
+        self.tray_image.connect("button-press-event", self._trayicon_clicked)
+        self.tray_image.set_visible(True)
 
     def _trayicon_clicked(self, widget, event):
         """
@@ -55,21 +47,17 @@
         """
         if event.button == 1:
             if self.state == RecordingState.STOPPED:
-                self.tray_image.set_from_stock(gtk.STOCK_MEDIA_STOP, 
-                    gtk.ICON_SIZE_SMALL_TOOLBAR)
-                self.tooltips.set_tip(self.event_box,
-                    _("Left click to stop recording screencast."))
+                self.tray_image.set_from_stock(gtk.STOCK_MEDIA_STOP)
+                self.tray_image.set_tooltip(_("Left click to stop recording screencast."))
                 self.state = RecordingState.RECORDING
                 self.current_screencast = Screencast(self.stop_handler)
                 self.current_screencast.selector = self.popup_menu.selector
                 self.current_screencast.start_recording()
 
             elif self.state == RecordingState.RECORDING:
-                self.tray_image.set_from_stock(gtk.STOCK_HARDDISK,
-                    gtk.ICON_SIZE_SMALL_TOOLBAR)
+                self.tray_image.set_from_stock(gtk.STOCK_HARDDISK)
                 self.state = RecordingState.SAVING
-                self.tooltips.set_tip(self.event_box,
-                    _("In process of saving to disk."))
+                self.tray_image.set_tooltip(_("In process of saving to disk."))
                 self.current_screencast.stop_recording()
                
         # only show popup if in idle state                    
@@ -77,11 +65,8 @@
             self.popup_menu.show()
     
     def stop_handler(self, event):
-        self.tray_image.set_from_stock(gtk.STOCK_MEDIA_RECORD, 
-            gtk.ICON_SIZE_SMALL_TOOLBAR)
+        self.tray_image.set_from_stock(gtk.STOCK_MEDIA_RECORD)
         self.state = RecordingState.STOPPED
-        self.tooltips.set_tip(self.event_box,
-            _("Left click to start screencast.  Right click for menu."))
+        self.tray_image.set_tooltip(_("Left click to start screencast.  Right click for menu."))
         return False
 
-
Index: istanbul-0.2.2/istanbul/main/main.py
===================================================================
--- istanbul-0.2.2.orig/istanbul/main/main.py	2009-12-30 11:51:23.000000000 +0100
+++ istanbul-0.2.2/istanbul/main/main.py	2009-12-30 11:51:33.000000000 +0100
@@ -49,8 +49,6 @@
 
 import gst
 
-import egg.trayicon
-
 _ = gettext.gettext
 
 class Istanbul:

Index: istanbul-0.2.2/configure
===================================================================
--- istanbul-0.2.2.orig/configure	2007-08-08 22:54:20.000000000 +0200
+++ istanbul-0.2.2/configure	2007-08-08 22:54:36.000000000 +0200
@@ -22509,7 +22509,7 @@
 
 try:
 
-    import egg.trayicon
+    import sys
 
     sys.exit(0)
 except ImportError:
