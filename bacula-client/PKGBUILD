# Bacula (client): Installer: Arch
# Contributor: Xavion <Xavion (dot) 0 (at) Gmail (dot) com>
# Contributor: Matthew <pyther@pyther.net>

basename=bacula
pkgname=${basename}-client
pkgver=5.0.3
pkgrel=3
pkgdesc="A network backup tool for Linux, Unix, Mac and Windows. This is the client edition."
conflicts=("${basename}")
arch=("i686" "x86_64")
url="http://www.${basename}.org"
license=("GPL2")
backup=("etc/${basename}/bconsole.conf"
		"etc/${basename}/${basename}-fd.conf")
source=(http://downloads.sourceforge.net/project/bacula/bacula/${pkgver}/bacula-${pkgver}.tar.gz)
md5sums=('9de254ae39cab0587fdb2f5d8d90b03b')
build() {
	cd ${srcdir}/${basename}-${pkgver}

	# Build
	./configure --prefix=/usr \
		--enable-smartalloc --enable-client-only \
		--enable-bat --enable-tray-monitor \
		--without-openssl \
		--sysconfdir=/etc/${basename} \
		--with-scriptdir=/etc/${basename}/scripts || return 1

	make || return 1
	make DESTDIR=${pkgdir} install || return 1

	# Permissions
	chmod a+x ${pkgdir}/usr/sbin/bconsole
	#chmod a+x ${pkgdir}/etc/${basename}/scripts/{bconsole}

	# Daemons
	mkdir -p ${pkgdir}/etc/rc.d/
	ln -s /usr/sbin/${basename} ${pkgdir}/etc/rc.d/
	#cp --preserve=mode ${startdir}/extra/${basename}* ${pkgdir}/etc/rc.d/
}

