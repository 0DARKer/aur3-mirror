# Contributor: Alberto Penaforte <apenafor@gmail.com>

pkgname=spooles
pkgver=2.2
pkgrel=3
pkgdesc="SParse Object Oriented Linear Equations Solver"
arch=('i686' 'x86_64')
url="http://netlib.sandia.gov/linalg/spooles"
license=('GPL')
depends=()
source=(http://netlib.sandia.gov/linalg/spooles/${pkgname}.${pkgver}.tgz
        Make.inc)
md5sums=('5789ca60d1ae565a4eaef6d03ca837af'
         '23029d3d181afa0b26499a059c8045ea')

build() {
  cd ${srcdir}
  cp -f ../Make.inc .
  make -j 3 lib || return 1
  mkdir -p ${pkgdir}/usr/lib
  mkdir -p ${pkgdir}/usr/include/spooles
  cp spooles.a ${pkgdir}/usr/lib/libspooles.a
  cp *.h ${pkgdir}/usr/include/spooles
  for l in `ls`; do
    if [ -d $l -a $l != 'documentation' ]
    then
      mkdir ${pkgdir}/usr/include/spooles/$l
      [[ -f $l/$l.h ]] && cp $l/*.h ${pkgdir}/usr/include/spooles/$l
    fi
  done

  # Fix permissions
  cd ${pkgdir}/usr/include/spooles
  chmod -R oug+r *
  cd ${pkgdir}/usr/lib
  chmod oug+r *
}
