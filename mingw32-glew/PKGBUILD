# Maintainer: Stefanos Carlstr√∂m <jagot (at) tipota (dot) org>
pkgname=mingw32-glew
pkgver=1.5.8
pkgrel=1
pkgdesc="Mingw32 version of GLEW, The OpenGL Extension Wrangler Library"
arch=('i686' 'x86_64')
url="http://glew.sourceforge.net/"
license=('Modified BSD/MIT/GPL')
depends=('mingw32-gcc' 'mingw32-w32api')
makedepends=('sed')
source=(http://downloads.sourceforge.net/glew/glew-${pkgver}.tgz Makefile.patch Makefile.mingw.patch)
noextract=()
md5sums=('342c8dc64fb9daa6af245b132e086bdd'
         '29e35d7f07eb1dad80558604aab9e4bb'
         'c4ab3fed651dba5e64eb549b5c4d9b59')

build() {
  cd "$srcdir/glew-$pkgver"

  patch Makefile -i "../../Makefile.patch"
  patch config/Makefile.mingw -i "../../Makefile.mingw.patch"

  echo -e "#!/bin/sh\necho mingw" > config/config.guess

  sed 's/-lGLEW/-lglew32/' glew.pc.in > glew.pc.in2
  mv glew.pc.in2 glew.pc.in

  GLEW_DEST=/usr/i486-mingw32/ make || return 1
}

package() {
  cd "$srcdir/glew-$pkgver"
  mkdir -p "$pkgdir/usr/i486-mingw32/lib/pkgconfig"
  GLEW_DEST="$pkgdir/usr/i486-mingw32" make install
}
