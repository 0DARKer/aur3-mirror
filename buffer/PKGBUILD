# Maintainer: M.Carreira <manuel@carreira.com.pt>
pkgname=buffer
pkgver=1.19
pkgrel=3
_rpmver=1.19-8
_tarver=1.19-9
pkgdesc="Speed up writing tapes on remote tape drives"
arch=('i686' 'x86_64')
url="http://www.hello-penguin.com/software.htm"
changelog=('ChangeLog')
license=('GPL')
makedepends=('rpmextract')
source=(http://www.invoca.ch/pub/packages/buffer/${pkgname}-${_rpmver}.src.rpm)
md5sums=('ab2123db876c8a4cda0f4ff604bb3724')

build() {
  cd "$startdir/src"
  echo "reading..."
  rpm2cpio "${pkgname}-${_rpmver}.src.rpm" | bsdtar -xf-
  gunzip ${pkgname}_${_tarver}.diff.gz
  bsdtar xzvf ${pkgname}_${pkgver}.orig.tar.gz
  patch -p0 < ${pkgname}_${_tarver}.diff
  cd "$srcdir/$pkgname-$pkgver"
  make CFLAGS="-g -Wall -D_FILE_OFFSET_BITS=64 -D_LARGEFILE_SOURCE -fomit-frame-pointer"

  install -p -m 755 -D buffer $pkgdir/usr/bin/buffer
  install -p -m 644 -D buffer.man $pkgdir/usr/share/man/man1/buffer.1
  DOCDIR="${pkgdir}/usr/share/doc/${pkgname}-${pkgver}"
  install -d $DOCDIR
  install -p -m 644 -D COPYING README ${DOCDIR}
}

# vim:set ts=2 sw=2 et:
