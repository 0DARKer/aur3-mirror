# Contributor: pressh <pressh funnysymbol gmail dot com>

pkgname=convertall
pkgver=0.4.2
pkgrel=1
pkgdesc="Unit conversion program (Qt)"
arch=('i686' 'x86_64')
url="http://convertall.bellz.org/"
license=('GPL')
depends=('pyqt')
source=(http://download.berlios.de/$pkgname/$pkgname-$pkgver.tar.gz \
	correctpaths.patch convertall.desktop)
md5sums=('5a11ee406cc816b6b64114cbb6243bee'
         'a221431ec71b5a8d0f2667797bddcbb4'
         '96c24fde148d2237e95110fda2bc1709')

build() {
# patch executable to have the correct paths
patch -Np0 < $srcdir/correctpaths.patch || return 1

# create install directories
  install -d $pkgdir/usr/{bin,share/pixmaps}

# copy files manually
cp -rf $srcdir/ConvertAll/source $pkgdir/usr/share/$pkgname
cp -rf $srcdir/ConvertAll/icons $pkgdir/usr/share/$pkgname
cp -rf $srcdir/ConvertAll/doc $pkgdir/usr/share/$pkgname/help
cp -rf $srcdir/ConvertAll/data $pkgdir/usr/share/$pkgname

# create symlink in /usr/bin
ln -s /usr/share/$pkgname/$pkgname.py $pkgdir/usr/bin/$pkgname

# install desktop file
install -Dm644 $srcdir/$pkgname.desktop \
	$pkgdir/usr/share/applications/$pkgname.desktop

# symlink icon in /usr/share/pixmaps
ln -s /usr/share/$pkgname/icons/$pkgname.svg \
	$pkgdir/usr/share/pixmaps/$pkgname.svg
}
