# Contributor: Piotr Rogo≈ºa <rogoza dot piotr at gmail dot com>
# Created: 21/06/2011
pkgname=ovz-web-panel
pkgver=2.0
pkgrel=1
pkgdesc='GUI web-based frontend for controlling of the hardware and virtual servers with the OpenVZ virtualization technology'
arch=('any')
url='http://code.google.com/p/ovz-web-panel/'
license=('GPLv2')
groups=('openvz')
depends=("ruby1.8" "rubygems1.8" "ruby-sqlite3" "kernel26-openvz" "vzctl")
optdepends=("vzquota: quota control" "vzpkg: VPS package tools" "vzdump: for snapshot")
install=owp.install
source=("http://ovz-web-panel.googlecode.com/files/$pkgname-$pkgver.tgz" "owp")
backup=("opt/ovz-web-panel/config/config.yml" "opt/ovz-web-panel/utils/hw-daemon/hw-daemon.ini" "etc/owp.conf")
options=("!strip")

build(){
  cd "$srcdir"
  install -dm755 $pkgdir/opt || return 1
  tar -c $pkgname | tar -x -C $pkgdir/opt || return 1
  grep  '/usr/bin/env ruby' $pkgdir/opt/$pkgname -rl | xargs perl -pi -e 's#/usr/bin/env ruby$#/usr/bin/env ruby-1.8#' || return 1
  install -Dm755 owp $pkgdir/etc/rc.d/owp || return 1
  install -Dm644 $pkgname/config/config.yml.sample $pkgdir/opt/$pkgname/config/config.yml || return 1
  install -Dm644 $pkgname/config/owp.conf.sample $pkgdir/etc/owp.conf || return 1
  install -Dm644 $pkgname/utils/hw-daemon/hw-daemon.ini.sample \
    $pkgdir/opt/ovz-web-panel/utils/hw-daemon/hw-daemon.ini || return 1 
  install -dm755 $pkgdir/var/lock || return 1
}

# vim:set ts=2 sw=2 et ft=sh tw=100:

md5sums=('2f9e8258558a12067a244a66025ba5c6'
         '91459ec04562d7e11eb79120c2a9e350')
