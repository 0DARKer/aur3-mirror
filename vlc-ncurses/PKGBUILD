# Maintainer: taylorchu <tailinchu at gmail.com>

pkgname='vlc-ncurses'
pkgver=20120130
pkgrel=1
pkgdesc='VLC minus qt4 minus uncommon modules plus love'
arch=('i686' 'x86_64')
url='http://www.videolan.org/vlc/'
license='GPL'

depends=('libass' 'libxv' 'xcb-util-keysyms' 'ttf-freefont' 'fribidi' 'ncurses' 'ffmpeg' 'libxml2')
	
makedepends=('libass' 'libxv' 'xcb-util-keysyms' 'ttf-freefont' 'fribidi' 'ncurses' 'ffmpeg' 'libxml2')

options='!libtool'
conflicts='vlc'
provides='vlc'

source=()
md5sums=()

_gitroot='git://git.videolan.org/vlc.git'
_gitname='vlc'
_buildir=${_gitname}-build

build() {
	cd ${srcdir}

	msg 'Connecting to GIT server...'

	if [ -d ${_gitname} ]; then
		cd ${_gitname} && git pull origin
		cd ..
	else
		git clone ${_gitroot} --depth 1
	fi

	msg 'GIT checkout done or server timeout.'

	if [ -d ${_buildir} ]; then
		msg 'Cleaning previous build...'
		rm -rf ${_buildir}
	fi

	cp -r ${_gitname} ${_buildir}
	cd ${_buildir}

	msg 'Generating necessary files...'

	./bootstrap

	msg 'Generating done.'
	msg 'Configuring VLC...'


#disable all auto and default enabled modules that i dont need
	./configure --prefix=/usr \
--disable-telepathy \
--disable-sout \
--disable-lua \
--disable-httpd \
--disable-vlm \
--disable-libproxy \
--disable-live555 \
--disable-linsys \
--disable-dshow \
--disable-smb \
--disable-v4l2 \
--disable-decklink \
--disable-vcd \
--disable-libcddb \
--disable-screen \
--disable-gme \
--disable-sid \
--disable-mkv \
--disable-mod \
--disable-mpc \
--disable-crystalhd \
--disable-switcher \
--disable-swscale \
--disable-postproc \
--disable-a52 \
--disable-png \
--disable-zvbi \
--disable-telx \
--disable-tiger \
--disable-sdl-image \
--disable-qt4 \
--disable-skin2 \
--disable-libtar \
--disable-visual \
--disable-projectm \
--disable-atmo \
--disable-libgcrypt \
--disable-gnutls \
--disable-taglib \
--disable-dc1394 \
--disable-dv \
--disable-blueray \
--disable-gnomevfs \
--disable-ogg \
--disable-mux_ogg \
--disable-shout \
--disable-twolame \
--disable-dca \
--disable-flac \
--disable-vorbis \
--disable-speex \
--disable-theora \
--disable-dirac \
--disable-schroedinger \
--disable-fluidsynth \
--disable-kate \
--disable-svg \
--disable-caca \
--disable-portaudio \
--disable-jack \
--disable-samplerate \
--disable-goom \
--disable-bonjour \
--disable-mtp \
--disable-upnp \
--disable-notify \
--disable-sqlite \
--disable-gles2 \
--disable-gles1 \
--disable-dvdread \
--disable-dvdnav \
--disable-opencv \
--disable-mad \
--disable-libmpeg2




	CFLAGS="$CFLAGS -fPIC"

	msg 'Starting make...'

	make || return 1
	make DESTDIR=${pkgdir} install || return 1
}
