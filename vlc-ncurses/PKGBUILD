# Maintainer: taylorchu <tailinchu at gmail.com>

pkgname='vlc-ncurses'
pkgver=20120130
pkgrel=1
pkgdesc='VLC minus qt4 minus uncommon modules plus love '
arch=('i686' 'x86_64')
url='http://www.videolan.org/vlc/'
license='GPL'

depends=('ffmpeg' 'fribidi' 'lua' 'ncurses'
	'ttf-freefont' 'xdg-utils' 'libdvdnav' 'libmad' 'libmpeg2' 'libxv' 'libass')
	
makedepends=('ffmpeg' 'fribidi' 'lua' 'ncurses'
	'ttf-freefont' 'xdg-utils' 'libdvdnav' 'libmad' 'libmpeg2' 'libxv' 'libass')

options='!libtool'
conflicts='vlc'
provides='vlc'

source=()
md5sums=()

_gitroot='git://git.videolan.org/vlc.git'
_gitname='vlc'
_buildir=${_gitname}-build

build() {
	cd ${srcdir}

	msg 'Connecting to GIT server...'

	if [ -d ${_gitname} ]; then
		cd ${_gitname} && git pull origin
		cd ..
	else
		git clone ${_gitroot} --depth 1
	fi

	msg 'GIT checkout done or server timeout.'

	if [ -d ${_buildir} ]; then
		msg 'Cleaning previous build...'
		#rm -rf ${_buildir}
	fi

	cp -r ${_gitname} ${_buildir}
	cd ${_buildir}

	msg 'Generating necessary files...'

	./bootstrap

	msg 'Generating done.'
	msg 'Configuring VLC...'

	./configure --prefix=/usr --enable-merge-ffmpeg   --disable-rpath \
--disable-httpd \
--disable-taglib \
--disable-live555 \
--disable-smb \
--disable-dvbpsi \
--disable-v4l2 \
--disable-vcd \
--disable-libcddb \
--disable-mkv \
--disable-mpc \
--disable-avcodec \
--disable-avformat \
--disable-postproc \
--disable-libtar \
--disable-a52 \
--disable-png \
--disable-zvbi \
--disable-telx \
--disable-kate \
--disable-tiger \
--disable-xcb \
--disable-xvideo \
--disable-sdl \
--disable-sdl-image \
--disable-qt4 \
--disable-visual \
--disable-projectm \
--disable-atmo \
--disable-notify \
--disable-dc1394 \
--disable-dv \
--disable-gnomevfs \
--disable-ogg \
--disable-mux_ogg \
--disable-shout \
--disable-twolame \
--disable-dca \
--disable-flac \
--disable-vorbis \
--disable-speex \
--disable-theora \
--disable-dirac \
--disable-schroedinger \
--disable-fluidsynth \
--disable-svg \
--disable-caca \
--disable-pulse \
--disable-portaudio \
--disable-jack \
--disable-upnp \
--disable-goom \
--disable-bonjour \
--disable-mtp \
--disable-osso_screensaver




	CFLAGS="$CFLAGS -fPIC"

	msg 'Starting make...'

	make || return 1
	make DESTDIR=${pkgdir} install || return 1
}
