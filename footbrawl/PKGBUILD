# Maintainer: Pavle Simovic <xpio at tesla.rcub.bg.ac dot rs>

pkgname=footbrawl
pkgver=1.0
pkgrel=1
pkgdesc="Isometric fantasy football game with roguelike elements"
url="http://forums.tigsource.com/index.php?topic=29644.0"
arch=('i686' 'x86_64')
license=('unknown')
depends=('java-runtime')
source=($pkgname-$pkgver.zip::https://dl.dropbox.com/s/958sry0iz2qesse/${pkgname}-${pkgver}.zip?dl=1
	${pkgname}.desktop)
md5sums=('e859eff35fbc6432c9fa5046a5b5b806'
         'a563cf72e00b75a81613e0bf44be3ba9')

package() {
  cd ${srcdir}/${pkgname}

  # cleanup, then move jar and resources to /usr/share
  rm -rf lib/natives-{macosx,windows}
  install -d $pkgdir/usr/share/${pkgname}
  mv *.jar lib res $pkgdir/usr/share/${pkgname}

  # create and copy empty configuration file to var, then link it to usr
  echo '{}' > game.cfg
  install -d -m775 -o root -g games $pkgdir/var/games
  install -d -m775 -o root -g games $pkgdir/var/games/${pkgname}
  install -m 665 -o root -g games game.cfg $pkgdir/var/games/${pkgname}/game.cfg
  ln -s $pkgdir/var/games/${pkgname}/game.cfg $pkgdir/usr/share/${pkgname}

  # create and copy run script
  echo "cd /usr/share/${pkgname} && java -jar footbrawl.jar" > ${pkgname}.sh
  install -D ${pkgname}.sh $pkgdir/usr/bin/${pkgname}

  # copy documentation, .desktop file and icon 
  install -d ${pkgdir}/usr/share/doc/${pkgname}
  mv *.txt ${pkgdir}/usr/share/doc/${pkgname}
  install -D -m644 ${pkgdir}/usr/share/${pkgname}/res/images/appIcon16x16.png \
    ${pkgdir}/usr/share/icons/hicolor/16x16/${pkgname}.png
  install -D -m644 ${pkgdir}/usr/share/${pkgname}/res/images/appIcon32x32.png \
    ${pkgdir}/usr/share/icons/hicolor/32x32/${pkgname}.png
  install -D -m644 ${srcdir}/${pkgname}.desktop ${pkgdir}/usr/share/applications/${pkgname}.desktop
}
