# Maintainer: Lex Black (autumn-wind at web.de)
# Contributor: 


pkgname=gimp-resynth-git
pkgver=20121122
pkgrel=1
pkgdesc="Suite of gimp plugins for texture synthesis. Git-Version"
arch=('any')
url="https://github.com/bootchk/resynthesizer"
license=('GPL2')
depends=('gimp')
makedepends=('git')
conflicts=('gimp-resynth')
provides=('gimp-resynth' 'gimp-plugin-resynthesizer')
options=('!emptydirs')
source=()
md5sums=()

_gitname=resynthesizer
_gitroot=git://github.com/bootchk/resynthesizer


build() {

	cd "${srcdir}"
	msg "Connecting to GIT server...."
	if [ -d ${_gitname} ] ; then
		cd ${_gitname} && git pull origin
		msg "The local files are updated."
	else
		#git clone --depth=1 $_gitroot $_gitname
		git clone ${_gitroot} ${_gitname}
	fi

  	msg "GIT checkout done or server timeout"
  	msg "Starting make..."

	rm -rf "${srcdir}/${_gitname}-build"
	mkdir "${srcdir}/${_gitname}-build"
	git clone "${srcdir}/${_gitname}" "${srcdir}/${_gitname}-build"

	cd "$srcdir/${_gitname}-build"

	./configure --disable-maintainer-mode --prefix=/usr
	make
}

package() {
	cd "${srcdir}/${_gitname}-build"
	
	make DESTDIR="$pkgdir/" install
	sed -i 's|/usr/bin/env python|/usr/bin/env python2|' "$pkgdir"/usr/lib/gimp/2.0/plug-ins/*.py
}
