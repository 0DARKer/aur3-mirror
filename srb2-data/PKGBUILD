# Maintainer: DeedleFake <yisszev at beckforce dot com>

pkgname=srb2-data
pkgver=2.0.6
pkgrel=3
pkgdesc="Sonic Robo Blast 2's data files."
arch=('any')
license=('GPL')
url='http://www.srb2.org'
depends=()
provides=()
conflicts=()
makedepends=('unrar' 'icoutils')
optdepends=()
source=(http://srb2.org/files/SRB2_v${pkgver//\./}.exe)
noextract=()
md5sums=('6f998fb6403c07b304f26c89c3276b86')

build() {
  cd "$srcdir"

  unrar x SRB2_v${pkgver//\./}.exe

  wrestool -tgroup_icon -o. -x srb2win.exe
  convert *.ico srb2.png
}

package() {
  cd "$srcdir"

  install -m 644 -D music.dta "$pkgdir/usr/share/games/srb2/music.dta"
  install -m 644 -D drill.dta "$pkgdir/usr/share/games/srb2/drill.dta"
  install -m 644 -D knux.plr "$pkgdir/usr/share/games/srb2/knux.plr"
  install -m 644 -D rings.wpn "$pkgdir/usr/share/games/srb2/rings.wpn"
  install -m 644 -D sonic.plr "$pkgdir/usr/share/games/srb2/sonic.plr"
  install -m 644 -D tails.plr "$pkgdir/usr/share/games/srb2/tails.plr"
  install -m 644 -D zones.dta "$pkgdir/usr/share/games/srb2/zones.dta"
  install -m 644 -D soar.dta "$pkgdir/usr/share/games/srb2/soar.dta"
  install -m 644 -D srb2.srb "$pkgdir/usr/share/games/srb2/srb2.srb"

  local _icon="$(find srb2{,-1}.png)"
  install -m 644 -D "$_icon" "$pkgdir/usr/share/pixmaps/srb2.png"
}
