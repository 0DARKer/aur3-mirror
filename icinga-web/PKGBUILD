pkgname=icinga-web
pkgver=1.6.2
pkgrel=1
pkgdesc="Icinga New Web Interface"
license=('GPL')
arch=('i686' 'x86_64')
depends=('icinga' 'php-pear' 'php-xsl' 'php-ldap')
url="http://www.icinga.org"
source=("http://downloads.sourceforge.net/project/icinga/icinga-web/$pkgver/icinga-web-${pkgver}.tar.gz")
md5sums=('ffc837fb5e2bba72b5a08b986f1c7158')

build() {
  cd $srcdir/$pkgname-$pkgver

  ./configure \
  --with-web-user=http \
  --with-web-group=http \
  --with-web-path=/icinga-web \
  --with-db-socket=/run/mysqld/mysqld.sock \
  --with-enable-sla \
  --with-conf-dir=/etc/conf.d \
  --with-log-dir=/var/log/icinga \
  --with-icinga-bin=/usr/share/icinga-web/bin \
  --with-cache-dir=/usr/share/icinga-web/app/cache \
  --with-icinga-cfg=/usr/share/icinga-web/etc

  make \
    prefix=$pkgdir/usr/share/icinga-web \
    exec_prefix=${prefix} \
    LOGDIR=$pkgdir/var/log/icinga \
    CFGDIR=${prefix}/etc \
    BINDIR=${exec_prefix}/bin \
    CGIDIR=${exec_prefix}/sbin \
    HTMLDIR=${prefix}/share \
    CACHEDIR=$pkgdir/usr/share/icinga-web/app/cache \
    LOGFOLDER=$pkgdir/var/log/icinga \
    install
}
