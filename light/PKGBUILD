# Maintainer: Fredrik Haikarainen <fredrik.haikarainen@gmail.com>

pkgname=light
pkgver=20140705
pkgrel=1
pkgdesc='Program to easily change brightness on backlight-controllers.'
arch=('any')
url='https://github.com/haikarainen/light'
license=('GPL3')
depends=('glibc')
makedepends=('gcc' 'make' 'glibc' 'git')
conflicts=('lightscript')
provides=('lightscript')

_gitroot='https://github.com/haikarainen/light.git'
_gitname='light'

build() {
  cd "$srcdir"
  msg "Connecting to GIT server...."

  if [ -d $_gitname ] ; then
    cd $_gitname && git pull origin
    msg "The local files are updated."
  else
    git clone $_gitroot
    cd $_gitname
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  make
}

package() {
  mkdir -p "$pkgdir/etc/light/mincap"
  mkdir -p "$pkgdir/usr/bin"

  cp "$srcdir/light/light" "$pkgdir/usr/bin/light"
  cp "$srcdir/light/LICENSE" "$pkgdir/etc/light/LICENSE"
  cp "$srcdir/light/README" "$pkgdir/etc/light/README"
  cp "$srcdir/light/CHANGELOG" "$pkgdir/etc/light/CHANGELOG"

  chown root "$pkgdir/usr/bin/light"
  chmod a+xs "$pkgdir/usr/bin/light"
}
