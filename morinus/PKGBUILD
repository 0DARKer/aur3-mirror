# Maintainer: Martin C. Doege <mdoege at compuserve dot com>

pkgname=morinus
pkgver=6.2
pkgrel=3
pkgdesc="Astrology software in wxPython"
url="https://sites.google.com/site/pymorinus/"
license=("GPL3")
install=${pkgname}.install
depends=(wxpython python2-imaging)
arch=(i686 x86_64)
source=("https://sites.google.com/site/pymorinus/Home/Morinus.zip"
        'morinus.patch'
        'options.patch'
        'placedb.patch'
        )
md5sums=('48b46dcf208d3099ab7e7a12fae30d55'
         'b49217822e54ca07f54c59381a857574'
         'eb443f82da4cf176aa6bbc7c9a08fd1a'
         '0d9894dae21c06c167fc5a321e3ccdc0')

build() {
  cd $srcdir/Morinus/SWEP/src/
  python2 setup.py build
  cp build/lib.linux-$CARCH-2.7/sweastrology.so $srcdir/Morinus/
  cd $srcdir/Morinus/
  rm -r SWEP/src Images Opts
  mkdir -p $pkgdir/usr/bin
  cp $srcdir/Morinus/morinus.py $pkgdir/usr/bin/morinus
  rm $srcdir/Morinus/morinus.py
  mkdir -p $pkgdir/usr/lib/python2.7/site-packages/$pkgname
  patch $srcdir/Morinus/options.py $srcdir/../options.patch
  patch $srcdir/Morinus/placedb.py $srcdir/../placedb.patch
  cp -pr $srcdir/Morinus/* $pkgdir/usr/lib/python2.7/site-packages/$pkgname/
  patch $pkgdir/usr/bin/morinus $srcdir/../morinus.patch
  touch $pkgdir/usr/lib/python2.7/site-packages/morinus/__init__.py
  chmod 755 $pkgdir/usr/bin/morinus
  }
