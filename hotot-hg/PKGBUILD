#
# Maintainer: Tayhe <admin at tayhe dot com>
#
# Contributor: Alessio Sergi <asergi at archlinux dot us>
#
 
#
pkgname=hotot-hg
#
_realname=hotot
#
pkgver=725
#
pkgrel=1
#
pkgdesc="A lightweight & open source microblogging client"
#
arch=('any')
#
url="http://code.google.com/p/hotot"
#
license=('LGPL3')
#
depends=('desktop-file-utils' 'python-distutils-extra' 'python-notify' \
#
         'python-keybinder' 'python2' 'pywebkitgtk')
#
makedepends=('mercurial')
#
provides=(${_realname})
#
conflicts=(${_realname})
#
install=${pkgname}.install
#
 
#
_hgroot="https://${_realname}.googlecode.com/hg/"
#
_hgrepo=${pkgname}
#
 
#
build() {
#
  cd "${srcdir}"
#
 
#
  msg "Connecting to Mercurial server...."
#
 
#
  if [ -d ${_hgrepo} ] ; then
#
    cd ${_hgrepo} && hg pull -u
#
    msg "The local files are updated."
#
  else
#
    hg clone ${_hgroot} ${_hgrepo}
#
  fi
#
 
#
  msg "Mercurial checkout done or server timeout"
#
  msg "Starting make..."
#
 
#
  rm -rf "${srcdir}/${_hgrepo}-build"
#
  cp -r "${srcdir}/${_hgrepo}" "${srcdir}/${_hgrepo}-build"
#
  cd "${srcdir}/${_hgrepo}-build"
#
 
#
  # python2 fix
#
  for file in $(find . -name '*.py' -print) scripts/hotot; do
#
      sed -i 's_#!/usr/bin/env python_#!/usr/bin/env python2_' ${file}
#
      sed -i 's_#!/usr/bin/python_#!/usr/bin/python2_' ${file}
#
  done
#
 
#
  python2 setup.py build
#
}
#
 
#
package() {
#
  cd "${srcdir}/${_hgrepo}-build"
#
 
#
  python2 setup.py install --root="${pkgdir}" --optimize=1
#
}
#
 
