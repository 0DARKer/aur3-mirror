# Maintainer: Tayhe <admin at tayhe dotcom>
pkgname=hotot-hg
pkgver=665
pkgrel=1
pkgdesc="A lightweight & open source microblogging software, coding using Python language."
arch=('i686' 'x86_64')
url="http://code.google.com/p/hotot/"
license=('LGPL')
depends=('python2' 'pywebkitgtk' 'python-notify' 'python-keybinder' )
makedepends=('mercurial' 'python-distutils-extra' 'gettext')
provides=('hotot')
conflicts=('hotot')
source=('hotot.desktop')
md5sums=('5c758a6c9b14f8695ed5698082a2f6a4')

_hgroot="https://hotot.googlecode.com/hg/"

_hgrepo="hotot"

build() {
  cd $srcdir

  if [ -d $_hgrepo/.hg ]; then
    (cd $_hgrepo && hg up -r $pkgver)
  else
    hg clone -r $pkgver $_hgroot/$_hgrepo $_hgrepo
  fi

  msg "Mercurial checkout done or server timeout"

  if [ -d $_hgrepo-build ]; then
    msg "Removing old build directory"
    rm -rf $_hgrepo-build
  fi
  
  msg "Copying repository to build directory"
  cp -r $srcdir/$_hgrepo $srcdir/$_hgrepo-build
  
  msg "Starting build"
  cd $srcdir/$_hgrepo-build

  # build
  msg "Running setup.py"
  python2 setup.py install --root=$startdir/pkg || return 1
  install -d $pkgdir/usr/share/applications/ || return 1
  install -m 644 $srcdir/../hotot.desktop $pkgdir/usr/share/applications || return 1
}

  
 
