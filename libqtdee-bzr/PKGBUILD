# Contributor: Marius Dransfeld <marius.dransfeld@googlemail.com>

pkgname=libqtdee-bzr
pkgver=22
pkgrel=1
pkgdesc="Qt bindings for libdee"
arch=('i686' 'x86_64')
url="https://launchpad.net/dee-qt"
license=('GPL')
depends=('qt')
makedepends=('cmake' 'bzr' 'dee')

_bzrtrunk=lp:dee-qt
_bzrmod=dee-qt

build() {
   cd "$srcdir"
  msg "Connecting to Bazaar server...."

  if [ -d $_bzrmod ] ; then
    cd ${_bzrmod} && bzr  pull ${_bzrtrunk} -r ${pkgver}
    msg "The local files are updated."
  else
    bzr  branch ${_bzrtrunk} ${_bzrmod} -q -r ${pkgver}
  fi

  msg "Bazaar checkout done or server timeout"
  msg "Starting make..."

  cd ${srcdir}/${_bzrmod}
  rm -rf build
  mkdir build
  cd build
  cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr ..
  make
  make DESTDIR=${pkgdir} install
  install -D ../libqtdee.pc $pkgdir/usr/lib/pkgconfig/libqtdee.pc
}

