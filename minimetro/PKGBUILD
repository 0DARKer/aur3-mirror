# Maintainer: William Giokas <1007380@gmail.com>

pkgname=minimetro
_pkgname=MiniMetro
pkgver=alpha9e
_build=alpha9
pkgrel=2
pkgdesc='minimalistic subway layout game'
url='http://dinopoloclub.com/minimetro/'
license=('custom:None')
arch=('i686' 'x86_64')
depends=('libgl' 'libx11' 'glu')
source=("http://static.dinopoloclub.com/minimetro/builds/${_build}/MiniMetro-${pkgver}-linux.tar.gz")
md5sums=('7f4cadfd7d5d7a89c12bead2e399741b')

case $CARCH in
  i686)
    _notarch=x86_64
    _arch=x86
    ;;
  x86_64)
    _notarch=x86
    _arch=x86_64
    ;;
esac

package() {
  install -dm 755 "$pkgdir"/usr/bin
  install -dm 755 "$pkgdir"/opt/minimetro
  _inst_loc=opt/minimetro/MiniMetro-${pkgver}-linux_Data
  cp -r "$srcdir"/MiniMetro-${pkgver}-linux_Data/ \
        "$srcdir"/MiniMetro-${pkgver}-linux.$_arch \
        "$pkgdir"/opt/minimetro/

  find "$pkgdir"/opt/minimetro \
    -name "$_notarch" \
    -type d \
    -exec rm -r {} +

  chmod -R g+w "$pkgdir"/opt/minimetro

  cat << EOF > "$pkgdir"/usr/bin/minimetro
#!/opt/minimetro/MiniMetro-alpha9e-linux.$_arch
EOF

  chmod +x "$pkgdir"/usr/bin/minimetro
}
