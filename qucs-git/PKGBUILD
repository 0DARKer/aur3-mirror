# Contributor: markuman <markuman@gmail.com>

_pkgname=qucs
pkgname=$_pkgname-git
pkgver=20130410
pkgrel=1
pkgdesc="An integrated circuit simulator with a graphical user interface. (qt4 git version)"
arch=('i686' 'x86_64')
url="http://qucs.sourceforge.net"
license=('GPL')
depends=('qt4' 'gperf')
makedepends=('git' 'autoconf' 'automake' 'perl-gd' 'perl-xml-libxml')
optdepends=('freehdl: to permit digital circuit simulation'
	    'asco: to enable circuit optimization'
	    'perl')
source=('adms.patch'
	'qucs-git::git+http://git.code.sf.net/p/qucs/git')
md5sums=('2a69f84f9e5bdb889cadab56803c33de'
	'SKIP')
conflicts=($_pkgname)

build() {

  patch -Np1 -i "${srcdir}/adms.patch"
  cd "$srcdir/$pkgname/$_pkgname-core/adms"
  chmod u+x autogen_lin.sh
  ./autogen_lin.sh
  make -j1

  cd "$srcdir/$pkgname/$_pkgname"
  sh autogen.sh
  ./configure --enable-maintainer-mode --prefix=/usr
  make

  cd "$srcdir/$pkgname/$_pkgname-core"
  sh autogen.sh
  ./configure --enable-maintainer-mode --prefix=/usr
  make -j1

}

package() {

  cd "$srcdir/$pkgname/$_pkgname-core/adms"
  make DESTDIR="$pkgdir" install
  
  cd "$srcdir/$pkgname/$_pkgname"
  make DESTDIR="$pkgdir" install

  cd "$srcdir/$pkgname/$_pkgname-core"
  make DESTDIR="$pkgdir" install

}
