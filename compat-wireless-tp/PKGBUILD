# $Id: PKGBUILD 378 2008-04-19 14:48:22Z thomas $
# Contributor: buddabrod <buddabrod@gmail.com>

pkgname=compat-wireless-tp
_kernver=2.6.25-tp
pkgver=2008_06_11
_realver=${pkgver//_/-}
pkgrel=1
pkgdesc="Snapshots of the wireless-testing tree ported to older kernels - for kernel26tp"
url="http://linuxwireless.org"
depends=('kernel26tp>=2.6.25' 'kernel26tp<2.6.26')
arch=('i686' 'x86_64')
license=('GPL')
install=$pkgname.install
source=(http://linuxwireless.org/download/compat-wireless-2.6/compat-wireless-${_realver}.tar.bz2
	#http://www.orbit-lab.org/kernel/compat-wireless-2.6/2008/05/${pkgname}-${_realver}.tar.bz2
        makefile.patch)
md5sums=('f361de2c65f9160b270f0ddeecde422f'
         '16a1b9c1d13d71166471d80e295c529f')
md5sums=()
build() {
  cd ${startdir}/src/compat-wireless-${_realver}
  patch -Np1 -i ../makefile.patch || return 1
  echo -ne "CONFIG_IWL3945_LEDS=y\nCONFIG_IWLWIFI_LEDS=y\nCONFIG_MAC80211_LEDS=y\n" >> config.mk
  make KLIB=/lib/modules/${_kernver} DESTDIR=${startdir}/pkg install || return 1
  sed -i -e "s/KERNEL_VERSION='.*'/KERNEL_VERSION='${_kernver}'/" $startdir/*.install
}
