# Maintainer: Kazuki Przyborowski <kazukiprzyborowski[at]gmail[dot]com>
pkgname=python2-upcean
pkgver=2.0.0
pkgrel=4
pkgdesc="A test upc/ean moudle package."
url="https://github.com/GameMaker2k/PyUPC-EAN/"
arch=('any' 'i686' 'x86_64')
license=('BSD')
depends=('python2' 'python2-imaging' 'readline')
makedepends=()
conflicts=()
replaces=()
backup=()
install=''
source=("https://github.com/GameMaker2k/PyUPC-EAN/archive/master.tar.gz")
md5sums=('b2fddb4d9f62d57ab23404b8500b48bd')
sha256sums=('7360eea5c2cbbdef543e8e0894266bb31178e9330ce663527600d5298f184bb4')
sha384sums=('c48abaa76226ea48239ea18ea59b3098e7d8c9b4e9047886539500c1730cb5b4b7b3cd7d22fb598d88e4e8a6c507557b')
sha512sums=('2602fb6d2f46d1ae98eaba9a03cfa770a80075bffbee32ad9f6c2a9760e6c3b9dc04b07e283b178de604097f439a80085c776d7105dc03871f37e61eba68937b')

build() {
  cd "${srcdir}/PyUPC-EAN-master/upctest-pil/upcean"
  find . -iname "*.py"  | xargs sed -i.bak -e '1s"^#!.\+$"#!/usr/bin/python2"'
  rm *.py.bak
}

package() {
  cd "${srcdir}/PyUPC-EAN-master/upctest-pil"
  test -z "$pkgdir/usr/share/licenses/python2-upcean" || /usr/bin/mkdir -p "$pkgdir/usr/share/licenses/python2-upcean"
  /usr/bin/install -c "./LICENSE" "$pkgdir/usr/share/licenses/python2-upcean/LICENSE"
  PREFIX="$pkgdir$(/usr/bin/python2 -c "from distutils.sysconfig import get_python_lib; print(get_python_lib());")"
  export PREFIX
  PYTHON="/usr/bin/python2" ./setup
  EggFile="$pkgdir$(/usr/bin/python2 -c "from distutils.sysconfig import get_python_lib; print(get_python_lib());")/$(/usr/bin/python2 -c "import sys; print 'upcean-2.0.0.3-py'+str(sys.version_info[0])+'.'+str(sys.version_info[1])+'.egg-info';")"
  export EggFile
  touch $EggFile
  echo -e "Metadata-Version: 1.0\nName: python2-upcean\nVersion: 2.0.0.3\nSummary: A test upc/ean moudle package.\nHome-page: https://github.com/GameMaker2k/Python-Scripts/tree/master/upctest\nAuthor: Kazuki Przyborowski\nAuthor-email: kazukiprzyborowski[at]gmail[dot]com\nLicense: BSD\nDownload-URL: https://github.com/GameMaker2k/Python-Scripts/archive/master.tar.gz\nDescription: A test upc/ean moudle package.\nPlatform: UNKNOWN" > "$EggFile"
}

# vim:set ts=2 sw=2 et:
