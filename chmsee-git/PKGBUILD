# Contributor: Your Name <your@mail.org>

pkgname=chmsee-git
conflicts=chmsee
provides=chmsee
pkgver=20100408
pkgrel=1
pkgdesc="A chm (MS HTML help file format) viewer based on xulrunner."
url="http://chmsee.googlecode.com/"
arch=('i686' 'x86_64')
license=('GPL')
depends=( 'xulrunner' 'libglade' 'chmlib' )
makedepends=('git' 'cmake' 'intltool')
source=()
md5sums=()

_gitroot="git://github.com/lidaobing/chmsee.git"
_gitname="chmsee"

build() {
  cd ${srcdir}
  msg "Connecting to git.freedesktop.org GIT server...."

  if [ -d ${srcdir}/$_gitname ] ; then
  cd $_gitname && git pull origin
  msg "The local files are updated."
  else
  git clone $_gitroot
  fi



  msg "GIT checkout done or server timeout"

  cd ${srcdir}
  rm -r -f $_gitname-build
  git clone $_gitname $_gitname-build
  cd ${srcdir}/$_gitname-build
  msg "Starting make..."
  cmake -DCMAKE_INSTALL_PREFIX:PATH=/usr || return 1
  make || return 1
  DESTDIR=${pkgdir} make install || return 1

  find ${pkgdir} -type f -name '*.la' -exec rm {} \;
  cd ${srcdir}
  rm -r -f $_gitname-build
} 

