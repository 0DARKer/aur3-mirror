
pkgname=archiva
pkgver=1.3.6
pkgrel=1
pkgdesc="Apache Archivaâ„¢ is an extensible repository management software that helps taking care of your own personal or enterprise-wide build artifact repository"
arch=("any")
url="http://archiva.apache.org/"
license=("Apache")
groups=()
depends=("java-runtime")
source=("http://www.us.apache.org/dist/archiva/$pkgver/binaries/apache-archiva-$pkgver-bin.tar.gz" 
        "archiva.service"
        "archiva.patch")
md5sums=("997a67da720c0848cfee4726e23984fb" 
         "d741d8899541001f6ab062b2772428e4"
         "a63d8eca413e9b4a530e751f025f1658")

package() {
  cd "$srcdir"
  sed -i 's/8080/8081/' apache-archiva-$pkgver/conf/jetty.xml
  patch apache-archiva-$pkgver/bin/archiva < "$srcdir/archiva.patch"
  mkdir -p "$pkgdir/usr/share/java/archiva"
  cp -r apache-archiva-$pkgver/* "$pkgdir/usr/share/java/archiva"
  chmod 444 "$pkgdir/usr/share/java/archiva"
  install -Dm644 archiva.service "$pkgdir/usr/lib/systemd/system/archiva.service"
  
}
