# Maintainer: Jerome Rose <jrose.pub at gmail.com>
# Contributor: Thomas Dziedzic < gostrc at gmail >
# Contributor: Sven-Hendrik Haase <sh@lutzhaase.com>

pkgname=stackless-python2
pkgver=2.7.2
pkgrel=3
pkgdesc="Python is a high-level scripting language. Stackless is an experimental implementation that supports continuations, generators, microthreads, and coroutines."
arch=('i686' 'x86_64')
url="http://www.stackless.com"
depends=('bzip2' 'expat' 'gdbm' 'libffi' 'openssl' 'zlib')
optdepends=('tk: for tkinter')
makedepends=('mercurial' 'python2')
confilcts=('python2')
provides=('python2=2.7.2')
license=('python')

build() {
	cd "$srcdir"
	hg clone http://hg.python.org/stackless/
	cd stackless
	hg update "v${pkgver}-slp"
 	
	grep -rl "env python" . | xargs \
	sed -i 's|/usr/bin/env python|/usr/bin/env python2|'
	
	./configure \
		--prefix=/usr \
		--with-threads \
		--enable-shared \
		--enable-stacklessfewerregisters
	make
}

package() {
echo foo
	cd "$srcdir/stackless"
	make DESTDIR="$pkgdir/" install
	cd "$pkgdir/usr/bin"
	mv python python2
}
