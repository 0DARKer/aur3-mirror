# Maintainer: naelstrof <naelstrof@gmail.com>
pkgname=projectzomboid
pkgver=0.2.0rRC2.5
pkgrel=1
pkgdesc="Project Zomboid is a Zombie Survival RPG. You need a key from projectzomboid.com in order to play."
arch=('i686' 'x86_64' )
url="http://projectzomboid.com/"
license=('custom')
groups=()
depends=()
makedepends=()
optdepends=('jre7-openjdk: opensource java implementation (recommended)'
            'jre: proprietary java implemntation'
            'openjdk6: opensource java 6 implementation'
            'java-gcj-compat: another java implementation')
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
changelog=
#Architecture specific packages, using a simple check to figure out which one to download.
_arch=`uname -m`
if [[ "$_arch" == "x86_64" ]]
then
    source=(https://s3.amazonaws.com/alpha.projectzomboid.com/projectzomboid-amd64.tar.gz)
    md5sums=('b10d46ec74fcd0dd19c237b2b59f2555')
else
    source=(https://s3.amazonaws.com/alpha.projectzomboid.com/projectzomboid-i386.tar.gz)
    md5sums=('aa6b0f3ec15fb04b68d6373142db1b8f')
fi
noextract=()

package() {
    cd "$srcdir/$pkgname"

    #Install all the package files
    mkdir -p "$pkgdir/opt/$pkgname"
    cp -R * "$pkgdir/opt/$pkgname"
    mkdir -p "$pkgdir/usr/bin"
    #cp projectzomboid.sh "$pkgdir/usr/bin/projectzomboid"
    #default script has to be ran from the game directory.
    echo "#!/bin/bash
/opt/projectzomboid/projectzomboid.sh" > "$pkgdir/usr/bin/projectzomboid"
    chmod +x "$pkgdir/usr/bin/projectzomboid"

    #Now create desktop entry
    mkdir -p "$pkgdir/usr/share/applications"
    echo "[Desktop Entry]
Version=0.2.0rRC2.5
Name=Project Zomboid
GenericName=Project Zomboid
Comment=Survival Zombie RPG
Exec=/usr/bin/projectzomboid
Terminal=false
Icon=projectzomboid.png
Type=Application
Categories=Game;
MimeType=;" > "$pkgdir/usr/share/applications/projectzomboid.desktop"
    mkdir -p "$pkgdir/usr/share/pixmaps"
    cp projectzomboid.png "$pkgdir/usr/share/pixmaps"
}
