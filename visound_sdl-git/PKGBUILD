# Maintainer: Adrien Sohier <adrien.sohier@art-software.fr>

pkgname=visound_sdl-git
_gitname=visound
_gitrepo="http://homer.art-software.fr/projects"
pkgver=0.1.5.beta
pkgrel=3
pkgdesc="Modular Sound Visualizer"

arch=('i686' 'x86_64' 'armv6h')
url="http://www.art-software.fr/index.php"
license=(GPLv3)
source=("git+${_gitrepo}/${_gitname}.git")
md5sums=(SKIP)

depends=('sdl<1.3' 'sdl_gfx')
makedepends=('git')
conflicts=('visound_sdl2-git' 'visound_sfml-git')


build() {
	cd ${srcdir}/${_gitname}
	git checkout $(git tag|sort -V|tail -1)
	mkdir build

	pushd build &&
	cmake .. -DCMAKE_BUILD_TYPE=Release -DBACKEND=SDL1 &&
	make clean &&
	make &&
	popd
}

pkgver() {
	cd ${srcdir}/${_gitname}
	git tag|sort -V|tail -1|tr "-" "."|sed "s@^v@@"
}

package() {
	cd ${srcdir}/${_gitname}
	install -dm755 ${pkgdir}/usr/bin
	install -m755 bin/vs ${pkgdir}/usr/bin/
}
