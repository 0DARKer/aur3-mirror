# Contributor: Sloonz <sloonz+aur@gmail.com>

pkgname=rewritefs-git
pkgver=20130320
pkgrel=1
pkgdesc="A FUSE filesystem intended to be used like Apache mod_rewrite"
arch=(i686 x86_64)
url="http://github.com/sloonz/rewritefs"
license=(GPL)
depends=(fuse pcre)
makedepends=(make)

_gitroot="http://github.com/sloonz/rewritefs.git"
_gitname="rewritefs"

build() {
  if [[ -d "$srcdir/$_gitname" ]] ; then
    cd "$srcdir/$_gitname"
    git pull origin
  else
    cd "$srcdir"
    git clone $_gitroot
  fi
  
  rm -rf "$srcdir/$_gitname-build" &&
  cp -r "$srcdir/$_gitname" "$srcdir/$_gitname-build" || return 1
  
  cd "$srcdir/$_gitname-build"

  make
}

package() {
  cd "$srcdir/$_gitname-build"
  make DESTDIR=$pkgdir PREFIX=/usr install &&
  install -d "$pkgdir/usr/share/doc/rewritefs" &&
  install config.example "$pkgdir/usr/share/doc/rewritefs" &&
  install config.simple "$pkgdir/usr/share/doc/rewritefs"
}
