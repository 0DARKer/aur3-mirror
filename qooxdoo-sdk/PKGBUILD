# This is an example PKGBUILD file. Use this as a start to creating your own,
# and remove these comments. For more information, see 'man PKGBUILD'.
# NOTE: Please fill out the license field for your package! If it is unknown,
# then please put 'unknown'.

# Maintainer: Your Name <youremail@domain.com>
pkgname=qooxdoo-sdk
pkgver=1.4
pkgrel=1
dirname=qooxdoo
epoch=
pkgdesc="A comprehensive and innovative framework for creating rich internet applications (RIAs)."
arch=(i686 x86_64)
url="http://qooxdoo.org"
license=('LGPL' 'EGPL')
groups=()
depends=(python2)
makedepends=(unzip)
checkdepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
changelog=
source=(http://downloads.sourceforge.net/qooxdoo/$dirname-$pkgver-sdk.zip)
noextract=($dirname-$pkgver-sdk.zip)
md5sums=('6c1a60b1a94d57b2918c3c299008e7e5') #generate with 'makepkg -g'

build() {
  cd "$srcdir"
  unzip "$dirname-$pkgver-sdk.zip"

  cd "$srcdir/$dirname-$pkgver-sdk"
  
  msg "Changing links to python2"
  
  for x in `find -regex ".*[.]py$"`; do 
    line=`head -n 1 "$x" | head -c 2`; 
    if [ "$line" = '#!' ]; then 
      echo '#!/usr/bin/env python2' > "${x}-edit"; 
      tail -n +2 $x >> "${x}-edit";
      mv "${x}-edit" $x;
      chmod a+x $x;
    fi; 
  done
}

package() {
  mkdir -p "$pkgdir/opt/"
  mv "$srcdir/$dirname-$pkgver-sdk" "$pkgdir/opt/$pkgname"
}

# vim:set ts=2 sw=2 et:
