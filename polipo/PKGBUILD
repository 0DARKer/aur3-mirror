# Maintainer: SataMaxx <maximewack(a)free(dot)fr>
# Contributor: Thomas Holmquist <thomas@vorget.com>
# Contributor: Jan Boehringer <ja(a)bm-boehringer.de>
# Contributor: Alex Griffin <griffin.aj(a)gmail.com>

pkgname=polipo
pkgver=1.0.4.1
pkgrel=3
pkgdesc="A small and fast caching web proxy."
arch=('i686' 'x86_64')
url="http://www.pps.jussieu.fr/~jch/software/polipo/"
license=('GPL')
depends=(glibc)
makedepends=(texinfo)
install=polipo.install
source=(http://freehaven.net/~chrisd/polipo/polipo-$pkgver.tar.gz
	polipo)
md5sums=('bfc5c85289519658280e093a270d6703'
	 'cdcc13e8b0fd4b5b2a67829cdf9ca5b1')

build() {
  cd "$srcdir/$pkgname-$pkgver"

  make all || return 1

  make  DESTDIR="$pkgdir" \
	PREFIX="$pkgdir/usr" \
	LOCAL_ROOT="$pkgdir/usr/share/polipo/www" \
	DISK_CACHE_ROOT="$pkgdir/var/cache/polipo" \
  install || return 1

  mkdir $pkgdir/usr/share/info
  mv $pkgdir/usr/info/polipo.info $pkgdir/usr/share/info/
  rm -r $pkgdir/usr/info/

  install -d $pkgdir/etc/polipo/ $pkgdir/etc/rc.d/ \
  $pkgdir/var/cache/polipo/

  install -Dm 644 config.sample $pkgdir/etc/polipo/

  install -Dm 644 forbidden.sample $pkgdir/etc/polipo/

  install -D $startdir/polipo $pkgdir/etc/rc.d/
  
  mv $pkgdir/usr/man $pkgdir/usr/share/
}
