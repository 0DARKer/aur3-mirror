# Maintainer: Lev Lybin <lybin@yandex.com>
# Contributor: Benjamin Richter <br@waldteufel-online.net>
# Contributor: Changaco <changaco@changaco.net>
# Contributor: Artyom Smirnov <smirnoffjr@gmail.com>

pkgname=gajim-hg
pkgver=12818
pkgrel=1
pkgdesc="Jabber/XMMP instant messenger client written in PyGTK"
arch=('i686' 'x86_64')
url="http://hg.gajim.org/gajim"
license=('GPL3')
depends=('pygtk>=2.16' 'python2>=2.5' 'python2-pyopenssl')
makedepends=('mercurial' 'intltool>=0.40.1')
optdepends=(
	'dbus-python: Python bindings for DBUS'
	'dnsutils: for SRV support'
	'farsight2: video/voice support'
	'gstreamer0.10-good: video/voice support'
	'gstreamer0.10-bad: video/voice support'
	'libxss: for idle module'
	'gtkspell: spelling support (install aspell-LANG!)'
	'notification-daemon: for desktop notification'
	'pycrypto: End to end encryption'
	'python-gnomekeyring: for GnomeKeyring support as password storage'
	'kwalletcli: for support of KDE Wallet as password storage'
	'dbus-glib: for zeroconf (bonjour), the "enable link-local messaging" checkbox'
	'avahi: for zeroconf (bonjour), install dbus-glib!'
	'python-notify: Notification popups')
provides=('gajim')
conflicts=('gajim' 'gajim-svn')
replaces=('gajim-svn')
install=gajim.install

_hgroot=http://hg.gajim.org
_hgrepo=gajim

build() {
    export PYTHON=`which python2`
    cd "${srcdir}/${_hgrepo}"
    hg update default
    ./autogen.sh --prefix=/usr
    make
}

package() {
    cd "${srcdir}/${_hgrepo}"
    make DESTDIR="${pkgdir}" install
}
