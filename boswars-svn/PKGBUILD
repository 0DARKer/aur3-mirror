# Contributor: Chris Feldman <t27man89@gmail.com>
pkgname=boswars-svn
pkgver=9588
pkgrel=1
pkgdesc="Bos Wars is a real-time strategy game that uses a modified version of the Stratagus game engine"
arch=(i686 x86_64)
url="http://www.boswars.org/index.shtml"
license="GPL"
depends=('sdl' 'zlib' 'lua' 'libvorbis' 'libogg' 'libtheora' 'libmikmod')
makedepends=('scons' 'subversion')
source=(boswars boswars.png boswars.desktop)
md5sums=('700c1ec74564c334a77403b1b2a84d74' '26d251560c5c4171462494d9778406c1'\
         '9dd495a2f125c5b97a9523257397c492')

_svntrunk=svn://bos.seul.org/svn/bos/bos/trunk
_svnmod=boswars
_revnumber=$pkgver


build() {
  cd $startdir/src
  touch ~/.subversion
  msg "Connecting to bos.seul.org SVN server...."
  svn co $_svntrunk $_svnmod $pkgver

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  cd ./$pkgver/trunk
  scons

  mkdir -p $startdir/pkg/{opt/bos,usr/bin,usr/share/pixmaps,usr/share/applications}
  
  # install files
  cp -rf campaigns doc graphics intro languages maps music scripts sounds units video $startdir/pkg/opt/bos

  install -D -m 755 $startdir/src/$pkgver/trunk/boswars \
	  $startdir/pkg/opt/bos/boswars

  install -D -m 755 $startdir/src/boswars \
	  $startdir/pkg/usr/bin/boswars

  install -D -m 644 $startdir/src/boswars.png \
	  $startdir/pkg/usr/share/pixmaps/boswars.png

  install -D -m 644 $startdir/src/boswars.desktop \
	  $startdir/pkg/usr/share/applications/boswars.desktop		

  # remove nasty files
  find $startdir/pkg/ -name ".svn" -type d -exec rm -fr {} +
}


