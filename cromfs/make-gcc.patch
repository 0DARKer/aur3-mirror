diff -aur old/cromfs-defs.hh new/cromfs-defs.hh
--- old/cromfs-defs.hh	2011-07-29 13:21:50.000000000 +0200
+++ new/cromfs-defs.hh	2012-04-10 22:57:13.412283769 +0200
@@ -14,6 +14,7 @@
 
 #include "lib/endian.hh"
 
+#include <unistd.h>
 #include <vector>
 #include <string>
 #include <map>
diff -aur old/lib/cromfs-blockindex.hh new/lib/cromfs-blockindex.hh
--- old/lib/cromfs-blockindex.hh	2011-07-29 13:21:50.000000000 +0200
+++ new/lib/cromfs-blockindex.hh	2012-04-10 23:11:30.339279987 +0200
@@ -122,23 +122,23 @@
 
     void Del(K index, const V& b)
     {
-        for(typename autoindex_base::iterator i = lower_bound(index);
+        for(typename autoindex_base::iterator i = this->lower_bound(index);
             i != autoindex_base::end() && i->first == index;
             ++i)
         {
-            if(i->second == b) { erase(i); ++deleted; break; }
+            if(i->second == b) { this->erase(i); ++deleted; break; }
         }
     }
     void Add(K index, const V& b)
     {
-        insert(std::make_pair(index, b));
+        this->insert(std::make_pair(index, b));
         ++added;
     }
     bool Find(K index, V& res, find_index_t& nmatch) const
     {
         if(nmatch.first)
         {
-            nmatch.i     = lower_bound(index);
+            nmatch.i     = this->lower_bound(index);
             nmatch.first = false;
         }
         if(nmatch.i == autoindex_base::end()) { nmatch.last = true; return false; }
