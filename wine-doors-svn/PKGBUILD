# Contributor: Ali H. Caliskan <ali.h.caliskan AT gmail DOT com>
# Contributor: Enrico Morelli <morelli@cerm.unifi.it>
# Contributor: Jonathan Wiersma <arch aur at jonw dot org>
# Contributor: Josh D Miller <josh AT joshdmiller DOT com>
pkgname=wine-doors-svn
pkgver=1667
pkgrel=2
pkgdesc="Application designed to make installing windows software on Linux"
arch=('i686' 'x86_64')
url="http://www.wine-doors.org"
license=('GPL')
provides=('wine-doors')
if [ "$CARCH" = "i686" ]; then
depends=('wine' 'gnome-python-desktop' 'pycairo' 'python-lxml' \
	 'libglade' 'cabextract' 'librsvg' 'orange' 'xorg-utils')
else
depends=('bin32-wine' 'gnome-python-desktop' 'pycairo' 'python-lxml' \
	 'libglade' 'cabextract' 'librsvg' 'orange' 'xorg-utils')
fi
makedepends=(svn)
install=wine-doors.install
source=('preferences.xml' wine-doors.desktop)
_svntrunk=http://www.wine-doors.org/svn/wine-doors/trunk
_svnmod=wine-doors
md5sums=('aa56fa48a034a29426d52e368135c7ac' '140ada18020a63352a8c72409f58d11c')

build() {
	# Checkout SVN repository
	msg "Checking out SVN repository..."
	svn co ${_svntrunk} --config-dir ./ -r ${pkgver} ${_svnmod} || return 1
	msg "SVN checkout finished or server timed out..."

	# Makedir /usr/share/wine-doors
	mkdir -p $pkgdir/usr/share/wine-doors
	cd $pkgdir/usr/share/wine-doors
	mkdir -p dtd pixmaps registry src

	# Install wine-doors dtd
	install -m644 $srcdir/wine-doors/dtd/* \
	$pkgdir/usr/share/wine-doors/dtd || return 1

        # Install wine-doors pixmaps
	install -m644 $srcdir/wine-doors/pixmaps/* \
	$pkgdir/usr/share/wine-doors/pixmaps || return 1

        # Install wine-doors registry
	install -m644 $srcdir/wine-doors/registry/* \
	$pkgdir/usr/share/wine-doors/registry || return 1

        # Install wine-doors src
	install -m644 $srcdir/wine-doors/src/* \
	$pkgdir/usr/share/wine-doors/src || return 1

	# Install wine-door man document
	install -Dm644 $srcdir/wine-doors/dist/debian/wine-doors.1 \
	$pkgdir/usr/share/man/man1/wine-doors.1 || return 1

	# Install wine-doors preferences.xml
	install -Dm644 $srcdir/preferences.xml \
	$pkgdir/etc/wine-doors/preferences.xml || return 1

	# Install wine-doors.desktop
	mkdir -p $pkgdir/usr/share/applications
	install -Dm644  $srcdir/wine-doors.desktop \
	$pkgdir/usr/share/applications/

	# Set permission for winedoors.py
	chmod 755 $pkgdir/usr/share/wine-doors/src/winedoors.py

	# Create symbolic link directory
	mkdir -p $pkgdir/usr/bin
}
