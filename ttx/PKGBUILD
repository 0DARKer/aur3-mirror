# Maintainer: archtux <antonio dot arias99999 at gmail dot com>

pkgname=ttx
pkgver=0.0.4
pkgrel=1
pkgdesc="Teletext-browser with support for Dutch, Belgian, Austrian, German, Croatian, Portuguese, Finnish, Spanish and Italian teletext services"
arch=('i686' 'x86_64')
url="http://code.google.com/p/ttx-teletext/"
license=('GPL3')
depends=('gtk3' 'libsoup')
makedepends=('intltool')
install=ttx.install
source=(http://ttx-teletext.googlecode.com/files/ttx-$pkgver.tar.gz
        ttx-gtk310.patch)
md5sums=('8a500019dafd05b8fd4062269cc43d02'
         '441413b5797bd345eea2b8c82f3daf9e')

prepare() {
  cd $srcdir/$pkgname-$pkgver/src
  
  # Patch for building with GTK 3.10
  echo ""
  patch < $srcdir/ttx-gtk310.patch
  echo ""

  # Fix desktop file 
  cd ..
  sed -i "s|Comment=Application for viewing Teletext on your desktop|GenericName=Teletext Browser|" ttx-gtk.desktop.in
  
  libtoolize --force
  aclocal
  autoheader
  automake --force-missing --add-missing
  autoconf
  intltoolize
  ./configure --prefix=/usr
}

build() {
  cd $srcdir/$pkgname-$pkgver
  make
}

package() {
  cd $srcdir/$pkgname-$pkgver
  make DESTDIR=$pkgdir install
}