#Mantainer: Filippo Squillace <sqoox85@gmail.com>
pkgname=pyshell
pkgver=0.9.3
pkgrel=1
author=fsquillace
pkgdesc="An Enhanced Bash Shell Framework."
arch=(any)
url="https://github.com/fsquillace/pyshell"
license=('GPLv2')
depends=('bash' 'rsync' 'python')
makedepends=('asciidoc' 'xmlto')
provides=()
options=()
source=(https://github.com/downloads/$author/$pkgname/$pkgname-$pkgver.tar.gz)
install=$pkgname.install


#To debug uncomment this:
#md5=$(md5sum ${pkgname}-${pkgver}.tar.gz )
#md5sums=(${md5:0:32})
md5sums=('658e7b44e6b111030401772491b209bd')
optdepends=('ranger: file manager integrated with pyshell'
            'remind: event organizer')

build() {
  cd "$srcdir"

  echo "Moving the licence into /usr/share/licenses/${pkgname} ..."
  mkdir -p "$pkgdir/usr/share/licenses/${pkgname}"
  mv -f "$pkgname/LICENSE" $pkgdir/usr/share/licenses/${pkgname}/

  echo "Copying the $pkgname directory into the pkg directory ..."
  mkdir -p "$pkgdir/opt"
  cp -rf "$pkgname" "$pkgdir/opt/$pkname"

  # Generate manual page
  echo "Generating manual page..."
  /usr/bin/asciidoc -d manpage -b docbook -o ${pkgname}.1.xml $pkgname/doc/${pkgname}.1.txt
  /usr/bin/xmlto man ${pkgname}.1.xml # Add --skip-validation if it doesn't work
  /bin/gzip ${pkgname}.1
  mkdir -p "${pkgdir}/usr/share/man/man1/"
  cp ${pkgname}.1.gz ${pkgdir}/usr/share/man/man1/
}

# vim:set ts=2 sw=2 et:
