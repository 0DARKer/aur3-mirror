#Mantainer: Filippo Squillace <sqoox85@gmail.com>
pkgname=pyshell
pkgver=0.9.2
pkgrel=1
pkgdesc="PyShell is a very light Framework written in Python used to get easy the use of the shell Bash and automate many daily activities of the administrator."
arch=(any)
url="http://pyshell.googlecode.com/"
license=('GPLv3')
depends=('bash' 'rsync' 'python')
makedepends=('asciidoc' 'xmlto')
provides=()
options=()
source=($url/files/${pkgname}-${pkgver}.tar.gz)
install=pyshell.install

#To debug uncomment this:
#md5=$(md5sum ${pkgname}-${pkgver}.tar.gz )
#md5sums=(${md5:0:32})
md5sums=('31b227ba65d429698a784f98df8d9fea')
optdepends=('ranger: file manager integrated with pyshell'
            'remind: event organizer')

build() {
  cd "$srcdir"

  echo "Moving the licence into /usr/share/licenses/pyshell ..."
  mkdir -p "$pkgdir/usr/share/licenses/pyshell"
  mv -f "$pkgname/LICENSE" $pkgdir/usr/share/licenses/pyshell/

  echo "Copying the $pkgname directory into the pkg directory ..."
  mkdir -p "$pkgdir/opt"
  cp -rf "$pkgname" "$pkgdir/opt/$pkname"

  echo "Removing tests directory ..."
  rm -fr $pkgdir/opt/$pkgname/tests

	# Removes all .svn directories
	echo "Removing all .svn directories..."
	find $pkgdir/opt/$pkgname -name ".svn" -type d -exec rm -fr {} +

  # Generate manual page
  echo "Generating manual page..."
  /usr/bin/asciidoc -d manpage -b docbook -o ${pkgname}.1.xml $pkgname/doc/${pkgname}.1.txt
  /usr/bin/xmlto man ${pkgname}.1.xml # Add --skip-validation if it doesn't work
  /bin/gzip ${pkgname}.1
  mkdir -p "${pkgdir}/usr/share/man/man1/"
  cp ${pkgname}.1.gz ${pkgdir}/usr/share/man/man1/
}

# vim:set ts=2 sw=2 et:
