# Original by Tim Besard <tim dot besard at gmail dot com>
pkgname=rakudo-star
pkgver=2010.12
pkgrel=1
pkgdesc="A Perl 6 distribution built on the Parrot virtual machine"
arch=('i686' 'x86_64')
url='http://rakudo.org/'
license=(PerlArtistic)
depends=('parrot>=2.11.0')
makedepends=('perl>=5.8')
source=(http://cloud.github.com/downloads/rakudo/star/$pkgname-$pkgver.tar.gz)
md5sums=('06623c9719c846e15016dfd344616307')

build() {
    cd "$srcdir/$pkgname-$pkgver"
    perl Configure.pl || return 1

    mkdir -p "$pkgdir"/usr/bin

    make

    # work around a broken build system
    cp rakudo/perl6 "$pkgdir"/usr/bin
    export PERL6LIB="$pkgdir$(parrot_config libdir)$(parrot_config versiondir)/languages/perl6/lib"

    make DESTDIR="$pkgdir" install || return 1
}

