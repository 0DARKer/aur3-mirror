# Maintainer: Patrick McCarty <pnorcks at gmail dot com>

pkgname=bmap-tools
pkgver=2.2
_relcommit=9113300a4f
pkgrel=1
pkgdesc="Tools for Tizen that increase flashing speed for large raw images"
arch=(any)
url="http://git.infradead.org/users/dedekind/bmap-tools.git"
license=('GPL2')
depends=('python2')
makedepends=('git')
source=()
md5sums=()

_gitbase="git://git.infradead.org/users/dedekind/bmap-tools.git"
_gitrepo="bmap-tools"

build() {
  cd "$srcdir"

  msg "Connecting to git.infradead.org..."

  if [ -d $_gitrepo ] ; then
    cd $_gitrepo && git pull origin
    msg "The local files are updated."
  else
    git clone $_gitbase
  fi

  msg "Git clone done or server timeout"
  msg "Starting make..."

  rm -rf "$srcdir/$_gitrepo-build"
  git clone "$srcdir/$_gitrepo" "$srcdir/$_gitrepo-build"
  cd "$srcdir/$_gitrepo-build"

  # tags are missing, so check out the release commit
  git checkout $_relcommit

  python2 setup.py build
}

package() {
  cd "$srcdir/$_gitrepo-build"

  python2 setup.py install --root=$pkgdir/ --optimize=1

  install -Dm644 docs/man1/bmaptool.1 "$pkgdir"/usr/share/man/man1/bmaptool.1
} 

# vim:set ts=2 sw=2 et:
