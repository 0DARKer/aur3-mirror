# Contributor: Artyom Smirnov <smirnoffjr@gmail.com>

pkgname=proftpd-nls
_pkgname=proftpd
pkgver=1.3.2
pkgrel=2
pkgdesc="A high-performance, scalable FTP server (compiled with mod_lang)"
arch=('i686' 'x86_64')
url="http://www.proftpd.org"
license=('GPL')
depends=('glibc' 'pam' 'ncurses' 'libcap' 'perl')
backup=('etc/proftpd.conf' 'etc/conf.d/proftpd')
conflicts=('proftpd')
provides=('proftpd')
source=(ftp://ftp.proftpd.org/distrib/source/$_pkgname-$pkgver.tar.bz2 proftpd \
        proftpd.logrotate proftpd.conf.d)

md5sums=('89f5e31fc3d3e02b66424dfc6cc5892d'
         '2ab07084433a57c994e65eabdf3971a9'
         'ddb09eb13131becdf0e081eef413116b'
         '71d5932b0461c318ed68c2c0c2660736')

build() {
  cd "$srcdir/$_pkgname-$pkgver"
  ./configure --prefix=/usr --disable-pam \
    --with-modules=mod_quotatab:mod_quotatab_file \
    --sysconfdir=/etc --localstatedir=/var --enable-ctrls \
	--enable-nls

  make || return 1
  make DESTDIR="$pkgdir" install
  install -D -m644 ../proftpd.logrotate "$pkgdir/etc/logrotate.d/proftpd"
  install -D -m644 ../proftpd.conf.d "$pkgdir/etc/conf.d/proftpd"
  install -D -m755 ../proftpd "$pkgdir/etc/rc.d/proftpd"
  cd "$pkgdir/etc"
  sed -i 's|nogroup|nobody|g' proftpd.conf
  sed -i 's|UseIPv6|#UseIPv6|g' proftpd.conf
}

