# Maintainer: Kyle Brady  <kyle at spark-gap dot com>
# Contributor: Patrick Hof <courts@offensivethinking.org>
# Contributor: Michael Fellinger <mf@rubyists.com>

pkgname=haxe
pkgver=2.07
pkgrel=1
pkgdesc="An open source programming language."
arch=('i686' 'x86_64')
url="http://haxe.org"
license=('GPL')
depends=('neko')
makedepends=('ocaml' 'cvs' 'subversion' 'zlib')
options=('!strip')
install=${pkgname}.install
source=('http://haxe.org/file/install.ml'
        'haxe.profile')
md5sums=('b6f240860962274dc1fc60d7e2f3b066'
         '79cbf6ebdb3d56e980d1a17fa9cb3b2d')

build() {
  cd "$srcdir"
  sed -i 's+:anonymous+:anonymous:anonymous+' install.ml || return 1 
  ocaml install.ml

  install -d ${pkgdir}/usr/bin/ ${pkgdir}/opt/haxe/
  cp -r haxe/std ${pkgdir}/opt/haxe/
  cp bin/* ${pkgdir}/usr/bin/
  find "$pkgdir" -name ".svn" -print0 | xargs -0 rm -rf

  export HAXE_LIBRARY_PATH=haxe/std:.
  bin/haxe haxe/std/tools/haxedoc/haxedoc.hxml
  bin/haxe haxe/std/tools/haxelib/haxelib.hxml

  install haxedoc haxelib ${pkgdir}/usr/bin/
  install -D -T "${srcdir}/haxe.profile" "${pkgdir}/etc/profile.d/haxe.sh"
}

# vim:set ts=2 sw=2 et:
