pkgname=qtcreator-qt4
_pkgname=qt-creator
pkgver=2.7.0
pkgrel=1
pkgdesc='Lightweight, cross-platform integrated development environment'
arch=('i686' 'x86_64')
url='http://qt-project.org'
license=('LGPL')
depends=('qt4')
makedepends=('make' 'gcc')
provides=('qtcreator')
replaces=('qtcreator<=2.7.0')
optdepends=('gdb: for the debugger'
'cmake: for cmake project support'
'openssh-askpass: for ssh support'
'git: for git support'
'mercurial: for mercurial support'
'bzr: for bazaar support'
'valgrind: for analyze support')
install=qtcreator.install
source=("http://releases.qt-project.org/qtcreator/2.7.0/$_pkgname-2.7.0-src.tar.gz" "qtcreator.desktop")
md5sums=("7bf25d211ff8babea47c2034f1b93d08" "82888d4be900e7833d768050a135cd37")

build() {
	cd "$srcdir/$_pkgname-$pkgver-src"
	qmake-qt4 -r

	Threads=1
	if [ `uname` == "Linux" ]; then
		Threads=`cat /proc/cpuinfo | grep processor | awk '{a++} END {print a}'`
	fi

	make -j$Threads
}

package() {
	cd "$srcdir/$_pkgname-$pkgver-src"

	make INSTALL_ROOT="$pkgdir/usr/" install
	make INSTALL_ROOT="$pkgdir/usr/" install_docs

	install -Dm644 "$srcdir/qtcreator.desktop" "$pkgdir/usr/share/applications/qtcreator.desktop"
	install -Dm644 "$srcdir/$_pkgname-$pkgver-src/LGPL_EXCEPTION.TXT" "$pkgdir/usr/share/licenses/qtcreator/LGPL_EXCEPTION.TXT"
}
