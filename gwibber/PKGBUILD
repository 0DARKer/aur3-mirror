# Maintainer: György Balló <ballogy@freestart.hu>
pkgname=gwibber
pkgver=3.2.0.1
pkgrel=1
pkgdesc="Microblogging client for GNOME, which supports Twitter, Identi.ca, StatusNet, Facebook, Flickr, Digg, FriendFeed and Qaiku"
arch=(i686 x86_64)
url="http://gwibber.com/"
license=(GPL)
depends=(libgee 'libnotify>=0.7' 'dee>=0.5.18-2' json-glib gtkspell3 dbus-python gnome-keyring python-gnomekeyring python-wnck python-egenix-mx-base python2-oauth python-imaging python-pycurl python-simplejson pywebkitgtk pyxdg hicolor-icon-theme xdg-utils)
makedepends=('vala>=0.9.2' 'vala<0.13' 'intltool>=0.35.0' 'gobject-introspection>=0.10')
optdepends=('python2-gtkspell: spell-checking support'
            'python-notify: notification support')
options=(!libtool)
install=$pkgname.install
source=(http://launchpad.net/$pkgname/3.2/$pkgver/+download/$pkgname-$pkgver.tar.gz)
md5sums=('4038c998791806c09189110b2fc06f48')

build() {
  cd "$srcdir/$pkgname-$pkgver"

  # python2 fix
  find . -type f | xargs sed -i 's@^#!.*python$@#!/usr/bin/python2@'

  # Remove unused dbusmenu dependency
  sed -i 's/--pkg Dbusmenu-0.4//' client/Makefile.{am,in}

  ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var \
              --disable-static --disable-schemas-compile --disable-unity

  make
}

package() {
  cd "$srcdir/$pkgname-$pkgver"

  make DESTDIR="$pkgdir" install
}
