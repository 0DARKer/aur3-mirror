# Maintainer: Kevin Cox <kevincox.ca@gmail.com>
pkgname='cloudprint-server-systemd'
pkgver='0'
pkgrel=1
pkgdesc='A systemd service file for starting Chromium in Google Cloud Print proxy mode.'
arch=('any')
url='https://support.google.com/chromeos/a/bin/answer.py?hl=en&answer=2616503'
license=('MIT style')
depends=('chromium')
makedepends=()

source=('cloudprint-server.service'
        'http://www.google.com/support/enterprise/static/chromeos/docs/admin/en/generate_cloudprint_config.py.zip'
        'generate_cloudprint_config.py.patch'
        'generate_cloudprint_config.sh')
sha1sums=('3008e6e48bcd5a488aeec8ec4059dfe01950c8f6'
          '462fe8a6a15e9fd7db3f480129daa56f67975574'
          'da095c991e55fc1e3a19952fcd0dface7330c93b'
          '76ac62958d31369312100059b94ed7d8a5adaba0')

build() {
	unzip -o generate_cloudprint_config.py.zip
	patch generate_cloudprint_config.py generate_cloudprint_config.py.patch
	
	mkdir -p "$pkgdir/usr/lib/systemd/system/"
	mkdir -p "$pkgdir/usr/lib/cloudprint-server/"
	mkdir -p "$pkgdir/etc/cloudprint-server/"
	chmod 600 "$pkgdir/etc/cloudprint-server/"
	
	install -v -m 755 -t "$pkgdir/usr/lib/cloudprint-server/" *.py *.sh
	install -v -m 644 -t "$pkgdir/usr/lib/systemd/system/" *.service
}

