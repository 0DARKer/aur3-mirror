# Maintainer: Dan Serban
# Contributors: Dany Martineau, Jordi De Groof

pkgname=mp3diags
pkgver=1.x.xx.xxx.latest
pkgrel=1
pkgdesc="Identify issues with your MP3 files, fix some of these issues and make other changes"
url=http://mp3diags.sourceforge.net/
license=(GPL)
arch=(i686 x86_64)
depends=(boost-libs qt)
makedepends=(boost lynx)
optdepends=('mp3gain: MP3 normalization support')

build()
{
  rm MP3Diags.tar.gz 2>/dev/null || true
  _url=$(lynx -dump "http://sourceforge.net/projects/mp3diags/files/mp3diags-src/" | grep -o http.*MP3Diags-1.*tar.gz/download | head -1)
  wget -O MP3Diags.tar.gz "${_url}"
  bsdtar -xf MP3Diags.tar.gz
  cd $(ls -1d MP3Diags-*/ | tail -1)
  ./AdjustMt.sh
  qmake
  make
  mkdir -p "${pkgdir}"/usr/bin "${pkgdir}"/usr/share/{applications,pixmaps}
  install -D bin/MP3Diags "${pkgdir}"/usr/bin/MP3Diags
  install -D desktop/MP3Diags.desktop "${pkgdir}"/usr/share/applications/MP3Diags.desktop
  install -D desktop/MP3Diags48.png "${pkgdir}"/usr/share/pixmaps/MP3Diags.png
}

