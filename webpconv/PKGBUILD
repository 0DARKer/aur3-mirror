# Maintainer: David Watzke <david@watzke.cz>

pkgname=webpconv
pkgver=0.0.5
pkgrel=1
pkgdesc="WebP image converter"
url="http://code.google.com/speed/webp"
arch=('i686' 'x86_64')
license=('custom:WEBP')
depends=('libpng' 'libjpeg' 'libvpx' 'zlib')
source=("http://webp.googlecode.com/files/webp-leptonica-${pkgver}.tar.gz")
md5sums=('da695d17be466156825b6ee799136042')

build() {
	cd "${srcdir}"

	cd "${srcdir}/webp"/leptonlib*/src
	make

	#cd "${srcdir}/webp"/libwebp/src
	#for x in "${srcdir}/webp"/leptonlib*/src/*.h; do
	#	[[ ! -e "${x##*/}" ]] && ln -s "$x"
	#done
	cd "${srcdir}/webp"/libwebp
	CPPFLAGS="-I../../leptonlib-1.066/src" LDFLAGS="-L../../leptonlib-1.066/lib/nodebug" \
		./configure --prefix=/usr
	make
}

package() {
	install -D -m755 "${srcdir}/webp/libwebp/src/webpconv" "${pkgdir}/usr/bin/webpconv"
	install -D -m644 "${srcdir}/webp/libwebp/LICENSE" "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
