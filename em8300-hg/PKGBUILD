# $Id: PKGBUILD 12108 2010-02-27 14:47:28Z ibiru $
# Contributor: Jaroslaw Swierczynski <swiergot@juvepoland.com>

pkgname=em8300-hg
pkgver=727
pkgrel=1
pkgdesc="DXR3 and Hollywood+ driver"
arch=('i686' 'x86_64')
url="http://dxr3.sourceforge.net/"
license=('GPL2')
depends=('kernel26>=2.6.33' "em8300-utils-hg=$pkgver")
makedepends=('kernel26-headers>=2.6.36')
install=em8300.install
conflicts=('em8300')
provides=('em8300')
source=()
md5sums=()
_hgroot=http://hg.assembla.com/
_hgrepo=em8300-cgmeiner

build() {
    cd $srcdir
    
    if [ -d ${_hgrepo} ]; then
        cd ${startdir}/src/${_hgrepo}
        hg pull -u
    else
	hg clone ${_hgroot}${_hgrepo} || return 1
# same but fixing changeset:
#	hg clone ${_hgroot}${_hgrepo} -r $pkgver || return 1
	
	cd ${startdir}/src/${_hgrepo}
    fi
					    
    msg "Mercurial clone done or server timeout"
    msg "Starting make..."


    cd $srcdir/${_hgrepo}/modules



  make || return 1
  make DESTDIR=$pkgdir install || return 1

  chmod 644 $pkgdir/lib/modules/*/em8300/*.ko
}
