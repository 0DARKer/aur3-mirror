# Maintainer: padfoot

pkgname="xf86-input-egalax-linux3"
pkgver="2.1.1402"
pkgrel=2
pkgdesc="eGalaxTouch touchscreen driver"
url="http://home.eeti.com.tw/web20/eGalaxTouchDriver/linuxDriver.htm"
license=('custom:EULA')
arch=('i686' 'x86_64')

_architect='32'
[ "$CARCH" = "x86_64" ] && _architect='64'

source=("eGTouch_v${pkgver}.L-x.tar.gz::http://home.eeti.com.tw/web20/drivers/touch_driver/Linux/20120202/eGTouch_v${pkgver}.L-x.tar.gz"
    "eGalaxConfig.desktop"
    "eGTouchD")
install='xf86-input-egalax-linux3.install'

backup=(etc/eGTouchL.ini)

depends=('linux>=3.0' 'libpng12' 'gtk3' 'gksu')
provides=('eGTouchD')
conflicts=('egalax' 'touchkit' 'eGTouchd')
groups=('xorg-input-drivers')

md5sums=('544a676a3657efa00978451f9ad42289'
         '0ee99c83fd74bdb8357427eae9b2dc7d'
         '38a96cbc7707b914757dd34f2d9d1f9b')
         
build() {
    mkdir -p \
        "$pkgdir/etc/X11/xorg.conf.d" \
        "$pkgdir/etc/rc.d" \
        "$pkgdir/usr/share/eGTouch/example" \
        "$pkgdir/usr/share/applications" \
        "$pkgdir/usr/share/pixmaps" \
        "$pkgdir/usr/share/icons/hicolor/scalable/apps" \
        "$pkgdir/usr/share/licenses/$pkgname" \
        "$pkgdir/usr/bin" || return 1

    cd $srcdir/eGTouch_v${pkgver}.L-x/eGTouch${_architect}

    install -D -m755 eGTouchU $pkgdir/usr/bin
    install -D -m755 eGTouchD $pkgdir/usr/bin
    install -D -m755 eGTouchL.ini $pkgdir/etc
    install -D -m644 GetEvent.c $pkgdir/usr/share/eGTouch/example

    install -D -m644 Rule/52-egalax-virtual.conf $pkgdir/etc/X11/xorg.conf.d
    install -D -m644 Rule/eGTouchU.png $pkgdir/usr/share/pixmaps
    install -D -m644 Rule/eGTouchU.png $pkgdir/usr/share/icons/hicolor/scalable/apps

    cd ../

    install -D -m644 readme $pkgdir/usr/share/eGTouch
    install -D -m644 eula.pdf $pkgdir/usr/share/licenses/$pkgname

    install -D -m644 Guide/"EETI eGTouch Utility Guide for Linux v1.00.pdf" $pkgdir/usr/share/eGTouch
    install -D -m644 Guide/"EETI_eGTouch_Linux_Programming_Guide_v2.1.pdf" $pkgdir/usr/share/eGTouch

    cd ../../

    install -D -m755 eGalaxConfig.desktop $pkgdir/usr/share/applications
    install -D -m755 eGTouchD $pkgdir/etc/rc.d
}