# Maintainer: padfoot

pkgname="xf86-input-egalax-linux3"
pkgver="1.01.1014"
pkgrel=2
pkgdesc="eGalaxTouch touchscreen driver"
url="http://home.eeti.com.tw/web20/eGalaxTouchDriver/linuxDriver.htm"
license=('custom:EULA')
arch=('i686' 'x86_64')

_architect='32'
[ "$CARCH" = "x86_64" ] && _architect='64'

source=("eGalaxTouch_v${pkgver}.L-x.tar.gz::http://home.eeti.com.tw/web20/drivers/touch_driver/Linux/20111125/eGTouch_v${pkgver}.L-x.tar.gz"
    "eGalaxCalib.desktop"
    "eula.pdf"
    "eGTouchd")
install='xf86-input-egalax-linux3.install'

depends=('linux>=3.0' 'libpng12' 'gtk3')
provides=('eGTouchd')
conflicts=('egalax' 'touchkit')
groups=('xorg-input-drivers')

md5sums=('7d6be35d52b46dd0537869d6ddfe24f9'
         '634872a577befea4da8228dae82f361f'
         '4ef63bb423c175f6bf56cc444ccca006'
         '1d8d3c7b7a2cc8f4b2f6b6384fea0790')
         
build() {
    cd $srcdir/eGTouch_v${pkgver}.L-x

    tar -xzf eGTouch${_architect}.tar.gz || return 1

    cd eGTouch${_architect}

    mkdir -p \
        "$pkgdir/etc/X11/xorg.conf.d" \
        "$pkgdir/etc/rc.d" \
        "$pkgdir/usr/share/eGTouch/example" \
        "$pkgdir/usr/share/applications" \
        "$pkgdir/usr/share/pixmaps" \
        "$pkgdir/usr/share/icons/hicolor/48x48/apps" \
        "$pkgdir/usr/share/licenses/$pkgname" \
        "$pkgdir/usr/bin" || return 1

    install -D -m755 eGalaxCalib $pkgdir/usr/bin
    install -D -m755 eGTouchd $pkgdir/usr/bin
    install -D -m755 eGTouchd.ini $pkgdir/etc
    install -D -m644 event.c $pkgdir/usr/share/eGTouch/example
    install -D -m644 event_multi.c $pkgdir/usr/share/eGTouch/example
    install -D -m644 readme $pkgdir/usr/share/eGTouch
    install -D -m644 Rule/52-egalax-virtual.conf $pkgdir/etc/X11/xorg.conf.d
    install -D -m644 Rule/eGalaxCalib.png $pkgdir/usr/share/pixmaps
    install -D -m644 Rule/eGalaxCalib.png $pkgdir/usr/share/icons/hicolor/48x48/apps

    cd ../

    install -D -m644 "EETI_eGTouch_Linux_ Guide_v1.02.pdf" $pkgdir/usr/share/eGTouch

    cd ../../

    install -D -m755 eGalaxCalib.desktop $pkgdir/usr/share/applications
    install -D -m644 eula.pdf $pkgdir/usr/share/licenses/$pkgname
    install -D -m755 eGTouchd $pkgdir/etc/rc.d
}