# Contributor: Alexander Minges <alexander.minges@athemis.de>
pkgname=kdeedu-cantor-svn
pkgver=1211313
pkgrel=1
pkgdesc="Graphical frontend to Maxima, R and Sage"
arch=(i686 x86_64)
url="http://edu.kde.org"
license=('GPL')
depends=('kdelibs>=4.3.0' 'kdebase-runtime>=4.3.0')
makedepends=(cmake automoc4)
optdepends=('keedu-marble>=4.3.0' 'kdeedu-kalgebra>=4.3.0' 'maxima' 'sage-mathematics' 'r' 'libspectre' 'octave')
provides=('kdeedu-cantor')
conflicts=('kdeedu-cantor')
replaces=('kdeedu-cantor')

source=(kdeedu-cantor-svn.install)
md5sums=('fccc9d7f7ce5e4fb4fa3a0d23d9c211f')


_svntrunk=svn://anonsvn.kde.org/home/kde/trunk/KDE/kdeedu
_svnmod=kdeedu

build() {
  cd $srcdir

  if [ -d $_svnmod/.svn ]; then
    (cd $_svnmod && svn up -r $pkgver)
  else
    svn co -N $_svntrunk
    cd kdeedu
    svn up cantor cmake data libkdeedu
    cd ..
  fi

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  rm -rf $_svnmod-build
  mkdir $_svnmod-build
  cd $_svnmod-build

  cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_BUILD_TYPE=RELEASE ../$_svnmod
  make || return 1

  cd cantor
  make DESTDIR=$pkgdir install
  cd $srcdir/..
  rm -rf $srcdir/$_svnmod-build
}


