pkgname=firewalld
pkgver=0.1.3
pkgrel=1
pkgdesc="firewalld is a firewall service daemon that provides a dynamic customizable firewall with a D-BUS interface"
arch=('any')
url="http://fedorahosted.org/firewalld"
license=('GPL2')
depends=('dbus-python' 'iptables' 'ebtables' 'gtk2' 'hicolor-icon-theme' 'pygtk')
makedepends=('gettext' 'gettext' 'intltool')
install=$pkgname.install
source=("http://fedorahosted.org/released/$pkgname/$pkgname-$pkgver.tar.bz2" "$pkgname")
md5sums=('936eeaed708893e4e0cdf85b4799c7b3'
         '9dfd451a91935bc41eefb529e573befa')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  export PYTHON=python2
  sed -i '1 s|^|#!/usr/bin/python\n|' $(find "$srcdir" -name '*.py') 
  sed -i 's|#![ ]*/usr/bin/python|#!/usr/bin/python2|' $(grep -rl '#!/usr/bin/python' "$srcdir")
  ./autogen.sh
  ./configure --prefix=/usr --sysconfdir=/etc
  make
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir" install
  rm -rf $pkgdir/etc/rc.d/init.d
  mv "$pkgdir"/etc/sysconfig "$pkgdir"/etc/conf.d
  install -Dm 755 $srcdir/firewalld $pkgdir/etc/rc.d/firewalld
} 
