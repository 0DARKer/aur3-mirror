pkgname=liblogicalaccess
pkgver=1.74
pkgrel=1
pkgdesc="RFID Library for Windows and Linux"
arch=('i686' 'x86_64')
url="http://liblogicalaccess.islog.com/"
license=(LGPL)
depends=('gcc-libs' 'zlib' 'boost' 'openssl')
makedepends=('cmake' 'gcc')
source=("https://github.com/islog/liblogicalaccess/archive/${pkgver}.tar.gz")
md5sums=('8ea69262ef5674b000ee60e8821edd36')

prepare () {
  # 1.74 does not compile
  rm -rf "$srcdir/${pkgname}-${pkgver}"
  git clone https://github.com/xantares/liblogicalaccess.git ${pkgname}-${pkgver}
}

build () {
  cd "$srcdir/${pkgname}-${pkgver}"
  cmake -DCMAKE_INSTALL_PREFIX=/usr .
  make
  pushd plugins/pluginscards
  cmake -DCMAKE_INSTALL_PREFIX=/usr .
  make
  popd
  pushd plugins/pluginsreaderproviders
  cmake -DCMAKE_INSTALL_PREFIX=/usr .  
  make
}

package () {
  cd "$srcdir/${pkgname}-${pkgver}"
  make install DESTDIR="$pkgdir"
  pushd plugins/pluginscards
  make install DESTDIR="$pkgdir"
  popd
  pushd plugins/pluginsreaderproviders
  make install DESTDIR="$pkgdir"
  install -d "$pkgdir"/etc/ld.so.conf.d
  echo "/usr/lib/logicalaccess" > "$pkgdir"/etc/ld.so.conf.d/logicalaccess.conf
}
