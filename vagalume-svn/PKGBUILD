# Contributor: zhuqin <zhuqin83@gmail.com>

pkgname=vagalume-svn
pkgver=348
pkgrel=1
pkgdesc="Vagalume is a Last.fm client for Gnome and Maemo"
arch=('i686' 'x86_64')
url="http://vagalume.igalia.com"
license=('GPL')
depends=('curl' 'gstreamer0.10-ugly-plugins' 'gtk2' 'libxml2' 'libnotify')
makedepends=('pkgconfig')
source=()
md5sums=()
conflicts=('vagalume')

_svntrunk=https://garage.maemo.org/svn/vagalume/trunk
_svnmod=vagalume

build() {
  cd $srcdir
  msg "Updating SVN entries for $_svnmod ..."

  if [ -d $_svnmod/.svn ]; then
    (cd $_svnmod && svn up -r $pkgver)
  else
    svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
  fi

  cp -r $_svnmod $_svnmod-build

  cd $_svnmod-build

  msg "Finished update, starting build ..."
  
  ./autogen.sh
  ./configure --prefix=/usr
  make || return 1
  make DESTDIR=$pkgdir install
  
  rm -rf $srcdir/$_svnmod-build
}