# Contributor: John Gerritse <reaphsharc@gmail.com>
pkgname=celtx
pkgver=2.7
pkgrel=3
pkgdesc="Integrated solution for media pre-production and collaboration."
url="http://celtx.com/"
arch=('any')
license=('CePL') 
depends=('autoconf' 'zip' 'python2')
conflicts=('celtx-bin')
source=("http://download.celtx.com/source/$pkgname-2-7-src.tar.bz2" 'CePL-1.3.txt' 'celtx.desktop')
md5sums=('486f6cd11e867e7d3545f2909c30f80b'
         '998912d308020615adb0bcf22b845970'
         'c64e4173b5af998ffa158d3c085b996e')

build() {
  cd ${srcdir}/$pkgname-2-7-src/mozilla
  # Add .mozconfig Options
  install mozconfig-nodebug-linux .mozconfig

  # Build
  cd ${srcdir}/$pkgname-2-7-src/mozilla
  PYTHON=python2 make -f client.mk build || return 1
  make -C ../objdir/$pkgname/installer || return 1

  # Install
  install -d ${pkgdir}/opt
  cd ${pkgdir}/opt
  tar xvjpf ${srcdir}/$pkgname-2-7-src/objdir/dist/$pkgname-$pkgver.en-US.linux-$CARCH.tar.bz2 || return 1

  # Install extra files
  install -D -m644 "${srcdir}/CePL-1.3.txt" "${pkgdir}/usr/share/licenses/${pkgname}/license.txt" || return 1
  install -D -m644 "${srcdir}/celtx.desktop" "${pkgdir}/usr/share/applications/celtx.desktop" || return 1
}
