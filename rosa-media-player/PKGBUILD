# Maintainer: VÃ­tor Ferreira <vitor.dominor at gmail dot com>
# Contributor: Andrei Gutu
# text : The new mediaplayer from ROSA(based on SMPlayer)

pkgname=rosa-media-player
pkgver=1.0
pkgrel=3
pkgdesc="The new multimedia player(based on SMPlayer) with clean and elegant UI."
arch=(i686 x86_64)
url=https://abf.rosalinux.ru/projects/64693
#source=(http://mirror.yandex.ru/rosa/rosa2012lts/repository/srpms/main/release/$pkgname-$pkgver-0.src.rpm)
license=(GPL)
depends=('qt>=4.2.0' 'mplayer')
optdepends=('mencoder: video splitting support'
            'ffmpeg: audio cutting and video recording support')
makedepends=('git' 'qt>=4.2.0')
install="$pkgname".install

_gitroot="https://abf.rosalinux.ru/uxteam/ROSA_Media_Player.git"
_gitname="rosa-media-player-git"

build()
{
  msg "Connecting to GIT server...."
  
  if [ -d $_gitname ] ; then
    ( cd $_gitname && git pull origin )
    msg "The local files are updated."
  else
    git clone $_gitroot $_gitname
  fi
  
  rm -rf "${_gitname}_build"
  cp -r "${_gitname}"{,_build}
  
  cd "${_gitname}_build/$pkgname"
  make PREFIX=/usr
}

package()
{
  cd "$srcdir/"${_gitname}_build/$pkgname""
  make PREFIX=/usr DESTDIR="$pkgdir" install
}
