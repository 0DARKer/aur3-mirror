# Contributor: Olivier Mehani <shtrom-aur@ssji.net>
# $Id: PKGBUILD 260 2010-10-19 23:15:16Z shtrom $
pkgname=mpdris-svn
pkgver=31
pkgrel=1
pkgdesc="An implementation of the XMMS2 media player interface MPRIS as a client for MPD"
arch=('i686' 'x86_64')
url="http://ayeon.org/projects/mpDris/"
license=('GPL')
depends=('python>=2.4' 'dbus-python>=0.80' 'pygobject>=2.14' 'python-mpd>=0.2.0')
optdepends=('mpd: the Music Player Daemon')
makedepends=('subversion')
backup=(etc/mpDris.conf)

_svntrunk=http://svn.ayeon.org/mpris/mpDris
_svnmod=mpdris

build() {
  cd "$srcdir"

  if [ -d $_svnmod/.svn ]; then
    (cd $_svnmod && svn up -r $pkgver)
  else
    svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
  fi

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  rm -rf "$srcdir/$_svnmod-build"
  cp -r "$srcdir/$_svnmod" "$srcdir/$_svnmod-build"
  cd "$srcdir/$_svnmod-build"

  python setup.py install --root=$pkgdir
  sed "1s/python/&2/" $pkgdir/usr/bin/mpDris
  install -m 0644 -D mpDris.conf $pkgdir/etc/mpDris.conf
}
