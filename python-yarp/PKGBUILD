# Contributor: Victor NoÃ«l

_realpkgname=yarp
pkgname=python-$_realpkgname
pkgver=2.3.1
pkgrel=2
pkgdesc="Yet Another Robot Platform"
url="http://eris.liralab.it/yarp/"
license=('GPL')
arch=('i686' 'x86_64')
makedepends=('cmake' 'swig')
depends=('yarp' 'python' 'gcc-libs')
options=(!libtool)
source=(http://downloads.sourceforge.net/yarp0/$_realpkgname-$pkgver.tar.gz yarp-swig-python3.patch)

build() {
  cd $srcdir/$_realpkgname-$pkgver/example/swig

  patch -p1 < $srcdir/yarp-swig-python3.patch

  cd $srcdir/

  rm -rf build-$pkgname-$pkgver
  mkdir build-$pkgname-$pkgver
  cd build-$pkgname-$pkgver

  # -DSWIG_MODULE_python_EXTRA_FLAGS=-py3 does not do anything apparently...
  cmake ../$_realpkgname-$pkgver/example/swig/ -DSWIG_MODULE_python_EXTRA_FLAGS=-py3 -DPYTHON_EXECUTABLE=/usr/bin/python -DPYTHON_INCLUDE_DIR=/usr/include/python3.1 -DPYTHON_LIBRARY=/usr/lib/libpython3.1.so -DCMAKE_INSTALL_PREFIX=/usr -DCREATE_PYTHON=TRUE
  make
}

package() {
  cd $srcdir/build-$pkgname-$pkgver

  make DESTDIR=$pkgdir install
}

md5sums=('e05edcfdad6b2f0165729cae1f41f43f' '50a0e9427d6739ef08c1b52db3be7596')
