# Maintainer: Guillaume ALAUX <guillaume at alaux dot net>
# Contributor: K. Hampf <khampf@users.sourceforge.net>
# Contributor: Kevin Sullivan <ksullivan@archlinux.us>

pkgname=prey-tracker
pkgver=0.5.10
pkgrel=2
pkgdesc='Remote tracking and monitoring application for laptops, smartphones, and other electronic devices'
arch=('any')
url='http://preyproject.com/'
license=('GPL3')
install=prey-tracker.install

# DEPENDENCY NOTE: the project says curl *or* wget can be used.
#   Also, it says scrot *or* imagemagick can be used. You may adjust the
#   dependencies as needed with this information.
depends=('curl' 'imagemagick' 'perl-io-socket-ssl' 'perl-net-ssleay' 'python'
         'wireless_tools' 'lsb-release')
optdepends=('pygtk: for gui configuration'
            'xawtv: webcam features (includes streamer)'
            'mpg123: needed for audible alarm'
            'laptop-detect: checks whether you have a laptop'
 
            # NOTE: if you want to exclusively use one of the below, feel free to delete the original dependency above 
            'wget: alternative to curl'
            'scrot: alternative to imagemagick')

source=(http://preyproject.com/releases/${pkgver}/prey-${pkgver}-linux.zip
        1.56-overzealous-version-check.patch
        prey-tracker.timer
        prey-tracker.service)
sha256sums=('aa73c3a7cdef38f2aa55864f359d9734c4b6ed8cd824896e6490105d05f88cd9'
            '9614243b70f943ea732c33fc898266f297be199088eaf760ecf2b9951038d464'
            '582df8941bacc79fd6aa2651ab051c668de0115db1d6297172bb13dba61319f1'
            '1cfa5490e4d3a0e37814c715a08ae52d425bcb267cefb2983d3eb8872a8b1488')
backup=('usr/share/prey/config')

package() {
  cd ${srcdir}/prey
  patch -p1 < ${srcdir}/1.56-overzealous-version-check.patch

  # make directories and move files to /usr/share/prey/
  mkdir -p ${pkgdir}/usr/share
  cp -r ${srcdir}/prey ${pkgdir}/usr/share/

  # symlink the config
  install -d "${pkgdir}/etc"
  ln -s "/usr/share/prey/config" "${pkgdir}/etc/prey-tracker.conf"

  # systemd stuff
  install -d "${pkgdir}/usr/lib/systemd/system"
  install -m644 "${srcdir}/prey-tracker.timer" "${srcdir}/prey-tracker.service" "${pkgdir}/usr/lib/systemd/system"
}

# vim:set ts=2 sw=2 et:
