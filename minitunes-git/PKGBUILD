# Maintainer: Alessio Sergi <asergi [at] archlinux [dot] us>

pkgname=minitunes-git
_realname=minitunes
pkgver=20101220
pkgrel=1
pkgdesc="Just another music player, only better"
arch=('i686' 'x86_64')
url="http://gitorious.org/minitunes"
license=('GPL3')
depends=('hicolor-icon-theme' 'phonon' 'taglib' 'xdg-utils')
makedepends=('git')
optdepends=('gstreamer0.10-plugins: to install with phonon-gstreamer'
            'phonon-gstreamer: gstreamer backend'
            'phonon-mplayer-git: mplayer backend'
            'phonon-vlc: vlc backend'
            'phonon-xine: xine backend')
provides=($_realname)
conflicts=($_realname)
install=$pkgname.install
source=()
md5sums=()

_gitroot="git://gitorious.org/$_realname/$_realname.git"
_gitname=$_realname

build() {
  cd $srcdir

  msg "Connecting to GIT server...."

  if [ -d $_gitname ] ; then
    cd $_gitname && git pull origin
    msg "The local files are updated."
  else
    git clone $_gitroot
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  rm -rf $srcdir/$_gitname-build
  git clone $srcdir/$_gitname $srcdir/$_gitname-build
  cd $srcdir/$_gitname-build

  qmake PREFIX=/usr
}

package() {
  cd $srcdir/$_gitname-build

  make INSTALL_ROOT=$pkgdir install
}
