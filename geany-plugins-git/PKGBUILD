# Maintainer: Alexander RÃ¸dseth <rodseth@gmail.com>
# Contributor: eht16 <enrico.troeger@uvena.de>
# Contributor: Addict7 <nicolasfloquet@gmail.com>

pkgname=geany-plugins-git
pkgver=1.24.77.g36fdddc
pkgrel=1
pkgdesc='Various plugins for Geany'
arch=('x86_64' 'i686')
url='http://plugins.geany.org/'
license=('GPL')
depends=('geany' 'vte' 'lua' 'libwebkit' 'ctpl' 'gpgme' 'gtkspell' 'hicolor-icon-theme')
makedepends=('git' 'libtool' 'python' 'gpgme' 'ctpl' 'lua' 'intltool' 'vala')
optdepends=('hspell: hebrew spell checker')
install="$pkgname.install"
provides=('geany-plugins')
conflicts=('geany-plugins-svn' 'geany-plugins')
source=('geany-plugins::git://github.com/geany/geany-plugins.git')
sha256sums=('SKIP')

pkgver() {
  cd geany-plugins

  git describe --tags | sed 's/-/./g'
}

prepare() {
  cd geany-plugins

  # Using Autotools
  #./autogen.sh
  # Failed attempt to fix the Python libpath detection
  #sed "s:'config':'':" -i configure

  # Fixing problem with the Waf wscript
  sed 's/revision > 0/revision != ""/g' -i wscript
}

build() {
  cd geany-plugins

  # Using Autotools
  #./configure --prefix=/usr --libexecdir=/usr/lib
  # make

  # Using Waf (geanylua currently does not build)
  ./waf configure --skip-plugins=geanylua
  ./waf build
}

package() {
  # Using Autotools
  #make -C geany-plugins DESTDIR="$pkgdir" install

  # Using Waf
  cd geany-plugins
  ./waf install --destdir="$pkgdir"
}

# vim:set ts=2 sw=2 et:
