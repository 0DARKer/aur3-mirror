# Maintainer: P. Badredin <p dot badredin at gmail dot com>
# Contributor: Justin Blanchard <UncombedCoconut at gmail dot com>

pkgname=stockfish
pkgver=2.1.1
_bookver=2.1.1
pkgrel=1
pkgdesc="A strong chess engine written by Tord Romstad, Marco Costalba, Joona Kiiski"
arch=('i686' 'x86_64')
url="http://www.stockfishchess.com/"
license=('GPL3')
makedepends=('unzip')
install=stockfish.install

source=("stockfish-$_bookver-book.zip::http://cl.ly/1V072G372T3Y0h3N2B1g/content"
        "stockfish-$pkgver-linux.zip::http://cl.ly/43170W2W3f2F021b0N42/content"
        search-for-book-in-usr-share.patch)

md5sums=('465ef2bbd44b9a811d705fd102e7b7de'
	 '20e8bb237a5362b1fda2bff35cc5dd01'
         '706b17e76636dd2a4dc99c65e66ca5c0')


build() {
        cd "$srcdir"
        unzip -o "stockfish-$pkgver-linux.zip" || return 1
        unzip -o "stockfish-$_bookver-book.zip" || return 1
        install -D -m644 Book.bin $pkgdir/usr/share/$pkgname/book.bin || return 1
        cd "stockfish-211-ja/src"
        # Change the default book path to a system-wide location
        patch -p1 < ../../search-for-book-in-usr-share.patch || return 1
        if [ "$CARCH" = "i686" ]; then
                ARCH=x86-32
        else
                ARCH=x86-64
        fi
        make ARCH=$ARCH || return 1
        install -D -m755 stockfish $pkgdir/usr/bin/stockfish
}
