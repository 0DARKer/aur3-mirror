# Maintainer: P. Badredin <p dot badredin at gmail dot com>
# Contributor: Justin Blanchard <UncombedCoconut at gmail dot com>

pkgname=stockfish
pkgver=2.0.1
_bookver=2.0.1
pkgrel=1
pkgdesc="A strong chess engine written by Tord Romstad, Marco Costalba, Joona Kiiski"
arch=('i686' 'x86_64')
url="http://www.stockfishchess.com/"
license=('GPL3')
makedepends=('unzip')
install=stockfish.install

source=("stockfish-$_bookver-book.zip::http://cl.ly/1510370L2o2H1F0B471v/content"
        "stockfish-$pkgver-linux.zip::http://cl.ly/2e0A1H2m3R3k3a3J2f2b/content"
        search-for-book-in-usr-share.patch)

md5sums=('6ebd38106e8d986fff5a27f33a6568a8'
	 '9d0ad8bde115adb60bcc82888e39ea11'
         '6ebcfbd9ef0fd6b29a600a3630faf8ee')


build() {
        cd "$srcdir"
        unzip -o "stockfish-$pkgver-linux.zip" || return 1
        unzip -o "stockfish-$_bookver-book.zip" || return 1
        install -D -m644 Book.bin $pkgdir/usr/share/$pkgname/book.bin || return 1
        cd "stockfish-201-linux/src"
        # Change the default book path to a system-wide location
        patch -p1 < ../../search-for-book-in-usr-share.patch || return 1
        if [ "$CARCH" = "i686" ]; then
                ARCH=x86-32
        else
                ARCH=x86-64
        fi
        make ARCH=$ARCH || return 1
        install -D -m755 stockfish $pkgdir/usr/bin/stockfish
}
