# Maintainer: P. Badredin <p dot badredin at gmail dot com>
# Contributor: Justin Blanchard <UncombedCoconut at gmail dot com>

pkgname=stockfish
pkgver=2.1
_bookver=2.0.1
pkgrel=1
pkgdesc="A strong chess engine written by Tord Romstad, Marco Costalba, Joona Kiiski"
arch=('i686' 'x86_64')
url="http://www.stockfishchess.com/"
license=('GPL3')
makedepends=('unzip')
install=stockfish.install

source=("stockfish-$_bookver-book.zip::http://cl.ly/1510370L2o2H1F0B471v/content"
        "stockfish-$pkgver-linux.zip::http://cl.ly/171p032w3C2c2c2q2G1S/content"
        search-for-book-in-usr-share.patch)

md5sums=('6ebd38106e8d986fff5a27f33a6568a8'
	 'bb8e79f39d83555a5812b8d55ef1094e'
         '706b17e76636dd2a4dc99c65e66ca5c0')


build() {
        cd "$srcdir"
        unzip -o "stockfish-$pkgver-linux.zip" || return 1
        unzip -o "stockfish-$_bookver-book.zip" || return 1
        install -D -m644 Book.bin $pkgdir/usr/share/$pkgname/book.bin || return 1
        cd "stockfish-21-ja/src"
        # Change the default book path to a system-wide location
        patch -p1 < ../../search-for-book-in-usr-share.patch || return 1
        if [ "$CARCH" = "i686" ]; then
                ARCH=x86-32
        else
                ARCH=x86-64
        fi
        make ARCH=$ARCH || return 1
        install -D -m755 stockfish $pkgdir/usr/bin/stockfish
}
