pkgname=atlassian-eclipse-connector
pkgver=3.0.7
_pkgver=${pkgver}.v20121218
pkgrel=1
pkgdesc="Allows developers to quickly access JIRA issues, Bamboo builds, Crucible code reviews and FishEye SCM insights without leaving their Eclipse-based IDE."
arch=(i686 x86_64)
url="http://www.atlassian.com/software/ideconnector/eclipse.jsp"
license=("Eclipse Public License, Version 1.0")
depends=(eclipse eclipse-mylyn)
_url="http://update.atlassian.com/atlassian-eclipse-plugin/e3.6"
source=(
    "${_url}/features/com.atlassian.connector.commons_${_pkgver}.jar"
    "${_url}/features/com.atlassian.connector.eclipse_${_pkgver}.jar"
    "${_url}/features/com.atlassian.connector.eclipse.bamboo_${_pkgver}.jar"
    "${_url}/features/com.atlassian.connector.eclipse.commons_${_pkgver}.jar"
    "${_url}/features/com.atlassian.connector.eclipse.crucible_${_pkgver}.jar"
    "${_url}/features/com.atlassian.connector.eclipse.jira_${_pkgver}.jar"
    "${_url}/features/com.atlassian.connector.eclipse.monitor_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.commons_4.0.0.v20121218.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.bamboo.core_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.bamboo.ui_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.branding.ui_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.commons.core_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.commons.ui_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.core_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.crucible.core_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.crucible.ui_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.directclickthrough.ui_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.fisheye.core_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.fisheye.ui_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.help_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.jira.core_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.jira.ui_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.monitor.core_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.monitor.ui_${_pkgver}.jar"
    "${_url}/plugins/com.atlassian.connector.eclipse.ui_${_pkgver}.jar"
    "${_url}/plugins/com.thoughtworks.xstream_1.3.0.v20100826-1640.jar"
    "${_url}/plugins/javax.servlet_2.5.0.v200910301333.jar"
    "${_url}/plugins/org.jdom_jaxen_1.0.0.20081203-1100.jar"
    "${_url}/plugins/org.joda.time_1.6.0.v20081202-0100.jar"
    "${_url}/plugins/org.mortbay.jetty.server_6.1.23.v201004211559.jar"
    "${_url}/plugins/org.mortbay.jetty.util_6.1.23.v201004211559.jar")
noextract=(
    "com.atlassian.connector.commons_${_pkgver}.jar"
    "com.atlassian.connector.eclipse_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.bamboo_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.commons_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.crucible_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.jira_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.monitor_${_pkgver}.jar"
    "com.atlassian.connector.commons_4.0.0.v20121218.jar"
    "com.atlassian.connector.eclipse.bamboo.core_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.bamboo.ui_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.branding.ui_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.commons.core_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.commons.ui_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.crucible.core_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.crucible.ui_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.core_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.directclickthrough.ui_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.fisheye.core_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.fisheye.ui_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.help_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.jira.core_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.jira.ui_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.monitor.core_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.monitor.ui_${_pkgver}.jar"
    "com.atlassian.connector.eclipse.ui_${_pkgver}.jar"
    "com.thoughtworks.xstream_1.3.0.v20100826-1640.jar"
    "javax.servlet_2.5.0.v200910301333.jar"
    "org.jdom_jaxen_1.0.0.20081203-1100.jar"
    "org.joda.time_1.6.0.v20081202-0100.jar"
    "org.mortbay.jetty.server_6.1.23.v201004211559.jar"
    "org.mortbay.jetty.util_6.1.23.v201004211559.jar")

build() {
    _dest=${pkgdir}/usr/share/eclipse/dropins/atlassian-connector/eclipse
    install -dm755 ${_dest}/plugins

    for url in ${source[@]}
    do
        _file="${url##*/}"
        _type="${url%/*}"
        _type="${_type##*/}"

        if [ ${_type} == 'features' ]; then
            install -dm755 ${_dest}/features/${_file/.jar}
            cd ${_dest}/features/${_file/.jar}
            jar xf ${srcdir}/${_file} || return 1
        else
            install -Dm644 ${srcdir}/${_file} ${_dest}/plugins
        fi
    done
}

md5sums=('3fcc7845c765e4be83fb331310d38683'
         '82adff599fd9ee40182d0f76c04e07e4'
         '24c47bb36f4bbcb58cf9d3442a421946'
         '7360f929461f0c2bd4038c8070eae4eb'
         '84ab2655223b91b8686a5a06f7537cd8'
         'e852ba088cc5d460a0471867852d8bcb'
         '3f9f8e265509bc7797dab1f198c7068b'
         'b216d81aeeccf41d8d6cf1686cf43f25'
         'db97333bff00319862452810c2884f32'
         '1611e601c2d325463df1919f430c52af'
         '46056cd3317d469cc7229f55041016c1'
         'f6ab6da6de78732976ef164fff93500a'
         '26f7c9d0c8449cb244eea5598afa999f'
         '84875629102844f728359537ef435f6c'
         'cac167cad248d8c8fe9501810d894871'
         'f367562bdbc6c31c13c584b083fdb266'
         '1a6b6622d4c080c737a9733be4a44c7f'
         '0b64dc59cd0a3df804ab1685b4fc0057'
         '39b277ba40371ae75393e37d2f33febb'
         '6acbfd022d1a0dc2541ae9f724bad7ff'
         '63cf0188e455303c9775035fc58f8284'
         'f2e0b5ffe5878ae4695692874794b23e'
         'bc68576f26a89d7dfdafb5f104d39b0b'
         '2da8374b98d0f7ab073e792e781388c0'
         '053b426122878b62dc6de60bc3a46cde'
         '7845062cd4b10a825f439fe68591f9e3'
         'e46e37400d01a527fab7a22edc74bd2d'
         '519e3449a22d59e73c0d3120cc24ded2'
         '064943ecd49d16838cba23ebac5a2640'
         'e800bdb1e4d56a9fe8a87766fe40738c'
         '54e05281d44ccc038b09b16bd23368e3')

