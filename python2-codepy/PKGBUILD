# Maintainer: Michael Schubert <mschu.dev at gmail>

pkgname=python2-codepy
_pkgname=codepy
pkgver=2012.1.2
pkgrel=2
pkgdesc="A C/C++ metaprogramming toolkit for Python"
arch=('any')
url="http://mathema.tician.de/software/codepy"
license=('MIT')
depends=('python2-cgen')
makedepends=('python2-pytools')
optdepends=('boost-libs: Using generated C++ bindings without CUDA')
source=("http://pypi.python.org/packages/source/c/codepy/$_pkgname-$pkgver.tar.gz"
        "setup.patch")
md5sums=('992482e56aa3f5351a08e4c39572bc3a'
         'c39ce19dd1749009ee8fcf23373e45e1')

build() {
  cd "$srcdir/$_pkgname-$pkgver"
  patch -p0 < ../setup.patch
  python2 setup.py build
}

package() {
  cd "$srcdir/$_pkgname-$pkgver"
  python2 setup.py install --root="$pkgdir/" --skip-build --optimize=1

  pydir=`python2 -c "from distutils.sysconfig import get_python_lib; \
      print get_python_lib()"`
  rm -rf "$pkgdir/$pydir/$_pkgname/cgen"
}
