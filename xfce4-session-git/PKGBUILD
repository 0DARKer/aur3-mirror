# Contributor: Baurzhan Muftakhidinov <baurthefirst@gmail.com>

pkgname=xfce4-session-git
pkgver=20121206
pkgrel=1
pkgdesc="A session manager for Xfce"
arch=('i686' 'x86_64')
license=('GPL2')
url="http://www.xfce.org/"
groups=('xfce4-git')
depends=('libxfce4ui' 'libwnck' 'libsm' 'xorg-iceauth' 'upower' 'xorg-xinit' 'hicolor-icon-theme')
makedepends=('git' 'xfce4-dev-tools-git') #xfce4-dev-tools
replaces=('xfce4-utils' 'xfce4-session' 'xfce4-session-svn')
conflicts=('xfce4-session')
provides=('xfce4-session')
options=('!libtool')
install=xfce4-session-git.install
source=()
md5sums=()

_gitroot="git://git.xfce.org/xfce/xfce4-session"
_gitname="xfce4-session"

build() {
	cd $srcdir
	msg "Getting sources..."

	if [ -d "$srcdir/$_gitname" ] ; then
		cd $_gitname && git pull origin
		msg "The local files are updated."
	else
		git clone $_gitroot
	fi

	msg "GIT checkout done or server timeout"
	msg "Starting build..."

	cd ${srcdir}/xfce4-session

	./autogen.sh --prefix=/usr \
		--sysconfdir=/etc \
		--libexecdir=/usr/lib/xfce4 \
		--localstatedir=/var \
		--disable-static  \
		--disable-debug \
		--enable-legacy-sm \
		--disable-gnome \
		--enable-session-screenshots \
		--disable-libgnome-keyring \
		--enable-maintainer-mode
	make
}

package() {
	cd ${srcdir}/xfce4-session
	make DESTDIR=${pkgdir} install
}

