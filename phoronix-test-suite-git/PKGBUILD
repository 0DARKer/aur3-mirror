# Contributor: DuGi <dugi@irc.pl>
pkgname=phoronix-test-suite-git
pkgver=20091127
pkgrel=1
pkgdesc="The most comprehensive testing and benchmarking platform available for Linux"
arch=('i686' 'x86_64')
license=('gpl')
url="http://www.phoronix-test-suite.com/"
depends=('php')
optdepends=('php-gtk')
conflicts=('phoronix-test-suite')
provides=('phoronix-test-suite')
install=(${pkgname}.install)

_gitname="phoronix-test-suite"
_gitroot="http://www.phorogit.com/repo/${_gitname}.git"

build() {
    cd ${startdir}/src
    msg "Connecting to ${_gitroot} GIT server...."
    if [[ -d ${startdir}/src/${_gitname} ]] ; then
	cd ${_gitname}
        git pull origin || return 1
        msg "The local files are updated."
    else
        git clone ${_gitroot} || return 1
    fi
    msg "GIT checkout done"
    msg "Starting make..."
                                                            
    cd $startdir/src/phoronix-test-suite
  
    install -d $startdir/pkg/usr/bin $startdir/pkg/usr/share/phoronix-test-suite
    sed -e "s/^export PTS_DIR=.*/export PTS_DIR=\/usr\/share\/phoronix-test-suite/g" -i phoronix-test-suite
    install -m755 phoronix-test-suite $startdir/pkg/usr/bin/
    cp -r pts/ $startdir/pkg/usr/share/phoronix-test-suite/
    rm -f $startdir/pkg/usr/share/phoronix-test-suite/pts/etc/scripts/package-build-*
    cp -r pts-core/ $startdir/pkg/usr/share/phoronix-test-suite/
}
