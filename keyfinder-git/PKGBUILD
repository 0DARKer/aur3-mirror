#Maintainer: Lubosz Sarnecki <lubosz@gmail.com> 

_realname=keyfinder
pkgname=$_realname-git
pkgver=20130221
pkgrel=1
pkgdesc="KeyFinder is a tool for estimating the musical key of digital recordings, to aid DJs in harmonic mixing."
arch=('i686' 'x86_64')
url="http://www.ibrahimshaath.co.uk/keyfinder/"
license=('GPL3')
depends=('qt' 'libsamplerate' 'libkeyfinder-git') 
makedepends=('git')
provides=($_realname)
conflicts=($_realname)

_gitname=is_KeyFinder
_gitroot=git://github.com/lubosz/is_KeyFinder.git

build() {
  cd "${srcdir}"

  msg "Connecting to GIT server...."

  if [ -d ${srcdir}/$_gitname ] ; then
    cd $_gitname && git pull origin
    msg "Local repository updated."
  else
    git clone $_gitroot $_gitname
  fi

  msg "GIT checkout done or server timeout."
  msg "Starting make..."

  rm -rf "${srcdir}/${_gitname}-build"
  cp -r "${srcdir}/${_gitname}" "${srcdir}/${_gitname}-build"
  cd "${srcdir}/${_gitname}-build"

  qmake
  make
}

package() {
  cd "${srcdir}/${_gitname}-build"
  make INSTALL_ROOT="${pkgdir}" install
}
