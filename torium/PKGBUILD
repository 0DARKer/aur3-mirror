# Maintainer: archtux <antonio.arias99999 at gmail.com>

pkgname=torium
pkgver=0.4.2
pkgrel=3
pkgdesc="Torium is a free, open source, minimalistic torrent client for Linux."
arch=('i686' 'x86_64')
url="http://bithack.se/projects/torium/"
license=(ISC)
depends=('boost>=1.34' 'gtkmm>=2.4.0' 'libnotify' 'libtorrent-rasterbar>=0.13')
makedepends=('pkgconfig>=0.9')
source=(http://sourceforge.net/projects/torium/files/torium/torium-$pkgver/torium-$pkgver.tar.gz
       'http://www.iconfinder.com/ajax/download/png/?id=30507&s=24')
md5sums=('fa1980cef7e248dbd82526f247541442'
         '6536094be5d9cf7d0eac16ea69a25476')


build() {
  cd $srcdir/$pkgname-$pkgver/src

  #Patches(Disable '-Wdeprecated-declarations' & 'Wwrite-strings' warnings, add boost/lexical_cast header file,
  # add 'string' library, libnotify>0.4 fix(too many arguments), desktop icon for all desktops)
  sed -i '1i#pragma GCC diagnostic ignored "-Wdeprecated-declarations"' treeview.cc
  sed -i '2i#pragma GCC diagnostic ignored "-Wwrite-strings"' treeview.cc
  sed -i '3i#include <boost/lexical_cast.hpp>' treeview.cc
  sed -i '4i#include <string>' treeview.cc
  sed -i 's_"Torium", 0_"Torium"_' treeview.cc
  cd ..
  sed -i '/NotShowIn=KDE;/d' torium.desktop
  sed -i 's_GNOME;GTK;__' torium.desktop 
  sed -i 's_gtk-network_/usr/share/pixmaps/torium.png_' torium.desktop

  ./configure --prefix=/usr
  make DESTDIR=$pkgdir install

  # License ISC
  install -Dm644 COPYING $pkgdir/usr/share/licenses/$pkgname/COPYING

  # Desktop icon
  install -Dm644 $startdir/?id=30507* $pkgdir/usr/share/pixmaps/torium.png
}