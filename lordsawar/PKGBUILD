# Maintainer: Dmitrij D. Czarkoff <czarkoff@gmail.com>
# Contributor: Anton Bazhenov <anton.bazhenov@gmail.com>
# Contributor: Christoph Zeiler <rabyte@gmx.dot.org>
# Contributor: Adrián Chaves Fernández aka Gallaecio <adriyetichaves@gmail.com>

pkgname=lordsawar
pkgver=0.2.0
_subver=-pre1
pkgrel=3
pkgdesc="A free, turn-based strategy game in spirit of Warlords II"
arch=('i686' 'x86_64')
url="http://www.nongnu.org/lordsawar/"
license=('GPL3')
depends=('gtkmm' 'sdl_mixer')
#depends=('gtkmm' 'sdl_mixer' 'gnet' 'libtar')
makedepends=('pkgconfig' 'gettext' 'intltool' 'libtar' 'boost')
#makedepends=('pkgconfig' 'boost' 'gettext' 'intltool')
conflicts=('lordsawar-svn')
changelog="ChangeLog"
source=("http://download.savannah.gnu.org/releases/${pkgname}/${pkgname}-${pkgver}${_subver}.tar.gz"
	"${pkgname}.desktop")
md5sums=('817f5a3272941509e83d7ec53f8e66c1'
         '9b9b571eb0831bd7fa7829c75c9e0c42')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}${_subver}"
  ./configure \
    --prefix=/usr \
    --disable-static \
    --disable-sdltest || return 1
  make || return 1
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}${_subver}"
  make DESTDIR="${pkgdir}/" install || return 1

  install -D -m 0644 "${srcdir}/${pkgname}.desktop" \
			"${pkgdir}/usr/share/applications/${pkgname}.desktop"
  install -D -m 0644 "${srcdir}/${pkgname}-${pkgver}${_subver}/dat/various/castle_icon.png" \
			"${pkgdir}/usr/share/pixmaps/${pkgname}.png"
}

post_install() {
  update-desktop-database -q
}

post_remove() {
  update-desktop-database -q
}
