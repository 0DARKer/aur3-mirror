#Contributor: Lyceuhns <lyceuhns at gmail dot com>

pkgname=pragha-svn
pkgver=123
pkgrel=1
pkgdesc="A lightweight GTK+ music manager"
url="http://pragha.wikispaces.com/"
arch=('i686' 'x86_64')
license=('GPL')
depends=('curl' 'dbus-glib' 'flac' 'gtk2>=2.16' 'libao' 'libcddb' 'libcdio' 'libmad' 'libmodplug' 'libnotify' 'libsndfile' 'libvorbis' 'sqlite3' 'taglib')
makedepends=('autoconf' 'pkgconfig' 'subversion' 'xfce4-dev-tools')
conflicts=('pragha')
provides=('pragha')

source=()
md5sums=()

_svntrunk=http://dissonance.googlecode.com/svn/trunk/
_svnmod=pragha

build() {
  cd ${srcdir}

  if [ -d $_svnmod/.svn ]; then
    (cd $_svnmod && svn up -r $pkgver)
  else
    svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
  fi

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  cp -r $_svnmod $_svnmod-build
  cd $_svnmod-build

  chmod +x autogen.sh
  ./autogen.sh

  ./configure --prefix=/usr
	make || return 1
	make DESTDIR=$startdir/pkg install
	
	install -m 644 data/pragha.desktop ${startdir}/pkg/usr/share/applications
	install -d ${startdir}/pkg/usr/share/pixmaps
	install -m 644 data/pragha.png ${startdir}/pkg/usr/share/pixmaps/
	install -m 644 data/pragha.1 ${startdir}/pkg/usr/share/man/man1/

  rm -rf ${srcdir}/$_svnmod-build
}
