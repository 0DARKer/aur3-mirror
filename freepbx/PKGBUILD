# Maintainer: n3lThon <n3lthon@sapo.pt>
# Submitter: d'Ronin <daronin@2600.com>
# Contributors: judfilm <jud@judfilm.net>

pkgname=freepbx
pkgver=2.10.0beta2
pkgrel=1
pkgdesc="Full-featured PBX web application for Asterisk"
url="http://www.freepbx.org/"
arch=('i686' 'x86_64')
license=('GPL')
depends=('apache' 'asterisk' 'audiofile' 'bison' 'curl' 'lame' 'libtiff' 'libxml2' 'mysql' 'mysql-clients' 'ncurses' 'perl' 'php' 'php-apache' 'php-gd' 'php-pear' 'openssl' 'sox')
makedepends=('unixodbc')
optdepends=('postgresql' 'sqlite3')
install=$pkgname.install
source=(http://mirror.freepbx.org/$pkgname-$pkgver.tar.gz install_amp)
md5sums=('f0a426942b8db13d8aa8b5ecc8fc601a' '07b022030a12a75e10d330fcca90880a')

build() {
	cd $srcdir/$pkgname-$pkgver
	install -D -d -m 755 $pkgdir/usr/src/$pkgname

	cp -r amp_conf $pkgdir/usr/src/$pkgname/
	cp -r buildtools $pkgdir/usr/src/$pkgname/
	cp -r SQL $pkgdir/usr/src/$pkgname/
	cp -r upgrades $pkgdir/usr/src/$pkgname/
	
	install -D -m644 amportal.conf $pkgdir/usr/src/$pkgname/
	install -D -m755 apply_conf.sh $pkgdir/usr/src/$pkgname/
	install -D -m755 $srcdir/install_amp $pkgdir/usr/src/$pkgname/
	install -D -m755 libfreepbx.install.php $pkgdir/usr/src/$pkgname/
	install -D -m755 setup_svn.php $pkgdir/usr/src/$pkgname/
	install -D -m755 start_asterisk $pkgdir/usr/src/$pkgname/
	install -D -m755 update_i18n.sh $pkgdir/usr/src/$pkgname/

	# INSTALL FreePBX INFO FILES
	install -D -m644 CHANGES $pkgdir/usr/share/doc/$pkgname/
	install -D -m644 CONTRIB.txt $pkgdir/usr/share/doc/$pkgname/
	install -D -m644 FAQ $pkgdir/usr/share/doc/$pkgname/
	install -D -m644 sqlite.readme $pkgdir/usr/share/doc/$pkgname/
	install -D -m644 UPGRADE $pkgdir/usr/share/doc/$pkgname/
	install -D -m644 docs/README.directory $pkgdir/usr/share/doc/$pkgname/

	# INSTALL LICENSE
	install -D -m644 LICENSE $pkgdir/usr/share/licenses/$pkgname/
}
