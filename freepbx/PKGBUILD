# Maintainer: d'Ronin <daronin@2600.com>
# Contributors: judfilm <jud@judfilm.net>

pkgname=freepbx
pkgver=2.5.1
pkgrel=2
pkgdesc="Full-featured PBX web application for Asterisk"
url="http://www.freepbx.org/"
arch=('i686' 'x86_64')
license=('GPL')
depends=('alsa-lib' 'speex' 'popt' 'zaptel' 'libvorbis'
'curl' 'mysql' 'asterisk' 'asterisk-addons' 'apache' 'php' 'perl')
makedepends=('postgresql' 'unixodbc' 'sqlite3')
install=($pkgname.install)
source=(http://mirror.freepbx.org/$pkgname-$pkgver.tar.gz
install_amp)
md5sums=('0602d0bec262d06c0cb85a19809352ae'
'9ea6c2b8b0e2513c1319c7ca31b49cdf')

build() {
	cd $srcdir/$pkgname-$pkgver
	install -D -d -m 755 $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel

	cp -r docs $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
	cp -r amp_conf $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
	cp -r buildtools $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
	cp -r SQL $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
	cp -r upgrades $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/

	install -D -m644 LICENSE $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
	install -D -m644 amportal.conf $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
	install -D -m755 apply_conf.sh $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
	install -D -m644 freepbx.pot $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
	install -D -m755 $startdir/install_amp $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
	install -D -m755 libfreepbx.install.php $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
	install -D -m755 setup_svn.php $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
	install -D -m755 update_l10n.sh $pkgdir/usr/src/$pkgname-$pkgver-$pkgrel/
}
