# Maintainer:  danyf90 <daniele.formihelli@gmail.com>
# Contributor: totoloco <totoloco@gmx.com>

pkgname=sigram-bin
_pkgname=sigram
pkgver=0.6
pkgrel=1
pkgdesc="A different telegram client from Sialan.labs"
arch=('i686' 'x86_64')
url="http://labs.sialan.org/projects/sigram"
license=('GPL')
depends=('qt5-base' 'qt5-declarative')
if [[ $CARCH == x86_64 ]]; then
  source=("http://dl.labs.sialan.org/${_pkgname}_$pkgver.0-x64.tar.xz")
  sha512sums=('cec519b3930c9015606069f8f44e6b4ba79a9942ad57c8ee95d33b9020b7b2480f0cf53869c84b208bb891e9a9239c9412960ddbdc68b1cbf65fedbea9cb0a45')
else
  source=("http://dl.labs.sialan.org/${_pkgname}_$pkgver-x32.tar.xz")
  sha512sums=('c196ab17358490918859d5204206bc45d1487347bb91500f3d6ee2ed88fcea453f6113811adc2d1ae9aa6174dfc59943da3b0920ace41dd6985c80a1745b9224')
fi

source+=("$_pkgname.desktop")
sha512sums+=('7fd0c39d9dbab6c0ef973e7c8294a2a7dc77d8519b6c50aef53f0d1771be4b0128f52696528d54c133d98d6b699e31a392ab450a5324463597bf570009c72d6d')

package() {
  cd $srcdir

  install -d $pkgdir/{opt,usr/bin}
  mv $_pkgname $pkgdir/opt/$_pkgname

  ln -s /opt/$_pkgname/Sigram $pkgdir/usr/bin/$_pkgname

  install -Dm644 $srcdir/$_pkgname.desktop $pkgdir/usr/share/applications/$_pkgname.desktop

  # fix undefined symbol: EVP_idea_cbc error
  ln -sf /usr/lib/libcrypto.so.1.0.0 $pkgdir/opt/$_pkgname/libs/libcrypto.so.1.0.0
}