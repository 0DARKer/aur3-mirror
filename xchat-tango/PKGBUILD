# Contributor: Andrea Cimitan <andrea.cimitan@gmail.com>

pkgname=xchat-tango
pkgver=2.8.6
pkgrel=1
pkgdesc="A GTK+ based IRC client, Xchat, with Tango Icons"
arch=('i686' 'x86_64')
url="http://www.xchat.org/"
license=('GPL')
depends=('gtk2>=2.10.9' 'openssl>=0.9.8b' 'dbus-glib>=0.7.2')
makedepends=('tcl' 'perl' 'python')
optdepends=('enchant: for spell checking support')
options=('!libtool')
provides=('xchat')
replaces=('xchat')
conflicts=('xchat')
install=xchat.install
source=(http://www.xchat.org/files/source/${pkgver%.*}/xchat-${pkgver}.tar.bz2 xchat-tango-pack.tar.gz)
md5sums=('1f2670865d43a23a9abc596dde999aca' 'f23201103385f8607f1fefe378366b78')

build() {
  cd ${startdir}/src/xchat-${pkgver}

  # copy tango icons
  cp ${startdir}/src/xchat-tango-pack/pixmaps/*.png ${startdir}/src/xchat-${pkgver}/src/pixmaps/
  cp ${startdir}/src/xchat-tango-pack/xchat/* ${startdir}/src/xchat-${pkgver}/

  # patching for 22x22 tray
  patch -Np0 -i ${startdir}/src/xchat-tango-pack/pixmaps/tray-22x22.diff || 1

  # compile as always
  ./configure --prefix=/usr --sysconfdir=/etc \
              --enable-openssl --enable-dbus \
              --disable-gnome --disable-textfe \
              --enable-ipv6 --enable-shm \
              --enable-spell=static || return 1
  make || return 1
  make DESTDIR=${startdir}/pkg install || return 1

  # use tango icons in hicolor icon theme
  mkdir -p ${startdir}/pkg/usr/share/icons/
  cp -r ${startdir}/src/xchat-tango-pack/hicolor ${startdir}/pkg/usr/share/icons/
}
