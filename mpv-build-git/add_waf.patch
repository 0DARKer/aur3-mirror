--- Makefile	2013-11-24 17:42:59.816165558 +0100
+++ Makefile	2013-11-24 17:41:43.899141812 +0100
@@ -1,6 +1,6 @@
 mpv: ffmpeg libass
 	scripts/mpv-config
-	$(MAKE) -C mpv
+	cd mpv; ./waf build
 
 mpv-config:
 	scripts/mpv-config
@@ -27,18 +27,18 @@
 	$(MAKE) -C ffmpeg_build install
 	#$(MAKE) -C fribidi install
 	$(MAKE) -C libass install
-	$(MAKE) -C mpv
+	cd mpv; ./waf build
 
 install:
-	$(MAKE) -C mpv install
+	cd mpv; ./waf install
 
 uninstall:
-	$(MAKE) -C mpv uninstall
+	cd mpv; ./waf uninstall
 
 clean:
 	-rm -rf ffmpeg_build build_libs
 	#-$(MAKE) -C fribidi distclean
 	-$(MAKE) -C libass distclean
-	-$(MAKE) -C mpv distclean
+	-cd mpv; ./waf distclean
 
 .PHONY: mpv-config mpv ffmpeg-config ffmpeg fribidi-config fribidi libass-config libass noconfig install uninstall clean


--- scripts/mpv-config	2013-11-23 21:57:57.771863993 +0100
+++ scripts/mpv-config	2013-11-23 21:53:18.737354216 +0100
@@ -1,8 +1,15 @@
 #!/bin/sh
 set -e
 
-OPTIONS=""
-
 BUILD="$(pwd)"
+
+if test -f "$BUILD"/mpv_options ; then
+    USER_OPTS=$(cat "$BUILD"/mpv_options)
+fi
+
+OPTIONS=" $USER_OPTS"
+
+echo Using mpv options: $OPTIONS
+
 cd "$BUILD"/mpv
-PKG_CONFIG_PATH="$BUILD"/build_libs/lib/pkgconfig ./configure --extra-cflags=-I"$BUILD"/build_libs/include --extra-ldflags=-L"$BUILD"/build_libs/lib $OPTIONS "$@"
+PKG_CONFIG_PATH="$BUILD"/build_libs/lib/pkgconfig ./waf configure $OPTIONS
