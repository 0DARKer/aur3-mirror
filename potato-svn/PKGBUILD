# Maintainer: reiv3r@gmail.com
pkgname=potato-svn
pkgver=653
pkgrel=2
pkgdesc="Potato is a MUSH/MU* Client for Microsoft Windows, Linux and Mac OS X."
license=('MIT')
url="http://www.potatomushclient.com/"
arch=('x86_64' 'i686')
makedepends=('subversion')
depends=('tcl' 'tk')
source=('potato.png' 'potato.desktop')
provides=('potato')
conflicts=('potato')

md5sums=('1bdfbe82ad98d761101a9581662ac7de'
         '2a8bc5a2d413ccfed269d753d18e647a')


_svntrunk="http://potatomushclient.googlecode.com/svn/trunk"
_svnmod="potato"

build() {
  msg "Starting SVN checkout..."
  cd ${srcdir}
  if [ -d $_svnmod/.svn ]; then
    (cd $_svnmod && svn up -r $pkgver)
  else
    svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
  fi
  msg "Finished."
}

package() {
  install -d -m644 "$pkgdir"/usr/share/{pixmaps,applications}
  install -d -m644 "$pkgdir"/etc/potato
  install -d -m755 "$pkgdir"/usr/bin

  cp -r "$srcdir"/"$_svnmod"/potato.vfs/* "$pkgdir"/etc/potato/

  echo '#!/bin/bash' >> "$pkgdir"/usr/bin/potato
  echo '/etc/potato/main.tcl' >> "$pkgdir"/usr/bin/potato
  chmod +x "$pkgdir"/usr/bin/potato

  install -D -m644 "$startdir"/potato.png "$pkgdir"/usr/share/pixmaps/
  install -D -m644 "$startdir"/potato.desktop "$pkgdir"/usr/share/applications/
}
