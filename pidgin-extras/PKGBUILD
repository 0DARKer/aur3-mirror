# Maintainer: Sam Whited 4096R/54083AE104EA7AD3 <sam@samwhited.com>

pkgname=pidgin-extras
pkgver=2.10.10
pkgrel=1
pkgdesc="Pidgin IM library from source with support for Message Carbons."
arch=('i686' 'x86_64')
url="https://pidgin.im/"
license=('GPL')
options=('!libtool')
depends=('glib2' 'libsasl' 'libxml2' 'libidn' 'nss' 'gnutls' 'meanwhile')
makedepends=('ca-certificates' 'intltool' 'mercurial')
optdepends=('ca-certificates: SSL CA certificates')
conflicts=('pidgin' 'libpurple')
provides=('pidgin', 'libpurple')
INTEGRITY_CHECK=('sha256')

source=(
"https://downloads.sourceforge.net/pidgin/pidgin-${pkgver}.tar.gz"
"carbons.5.patch"
)
sha256sums=(
'f87fefd609fbcdbca537db784a05b7945de10a714a71aac67fdf24b57de6d5a3'
'02bda3f5550b8c10645cb9d00040ec805c5751a3d64170eb3aee695a4dc38536'
)

build(){
  cd "$srcdir/"
	tar -xzf pidgin-${pkgver}.tar.gz
  cd "pidgin-${pkgver}"
	patch -p1 < ../carbons.5.patch
  ./configure \
    --prefix=/usr \
    --sysconfdir=/etc \
    --enable-cyrus-sasl \
    --disable-perl \
    --disable-tcl \
    --disable-tk \
    --with-system-ssl-certs=/etc/ssl/certs
	make
}

package() {
  cd "$srcdir/pidgin-${pkgver}"
  make DESTDIR="$pkgdir" install
}
