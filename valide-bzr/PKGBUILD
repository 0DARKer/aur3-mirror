# Maintainer:: Ravomavain <ravomavain@gmail.com>
pkgname=valide-bzr
pkgver=557
pkgrel=1
pkgdesc="Val(a)IDE is an Integrated Development Environment for the Vala programming language."
arch=('i686' 'x86_64')
url="http://www.valaide.org/"
license=('GPL3')
depends=('gtksourceview2' 'vala' 'libunique' 'bzr' 'gdl')
options=(!emptydirs)

_bzrmod=valide
_bzrtrunk=lp:${_bzrmod}

build() {
   cd ${srcdir}

  msg "Connecting to the server...."

  if [ ! -d ./${_bzrmod} ]; then
    bzr co ${_bzrtrunk} ${_bzrmod}
  else
    bzr up ${_bzrmod}
  fi

  msg "BZR checkout done or server timeout"

  msg "Removing old build directory..."
  rm -rf $srcdir/$_bzrmod-build
  msg "Creating build directory..."
  cp -r $srcdir/$_bzrmod $srcdir/$_bzrmod-build
  cd "$srcdir/$_bzrmod-build"

  #
  # BUILD
  #
  msg "Starting make..."


  ./waf configure --prefix=/usr
  ./waf || return 1
}

package() {
  cd "$srcdir/$_bzrmod-build"

  ./waf install --destdir="$pkgdir"
}

