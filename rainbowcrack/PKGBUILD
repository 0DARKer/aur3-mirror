# Maintainer: SpepS <dreamspepser at yahoo dot it>
# Contributor: Geoffroy Carrier <geoffroy.carrier@koon.fr>
# Contributor: Michal Krenek <mikos@sg1.cz>

pkgname=rainbowcrack
pkgver=1.2
pkgrel=3
pkgdesc="Password cracker based on the faster time-memory trade-off. Additional patches (NTLM, MD2, MD4, RIPEMD160, MySQL and Cisco PIX) included."
arch=('i686' 'x86_64')
url="http://project-rainbowcrack.com/"
license=('custom')
depends=('openssl')
source=("$pkgname-$pkgver-src.zip"
        "http://www.oxid.it/downloads/rc_patch_mysql_pix.zip")
md5sums=('e7e8304caff8f7051916ff484c2f0231'
         '71845ac352ff888a9cfcff6c1ea4184b')

build() {
  cd "$srcdir/$pkgname-$pkgver-src/src"

  # Applying patches
  cp "$srcdir"/*.{h,cpp} "$srcdir/$pkgname-$pkgver-src/src/"
  sed -i "11i#include <stdlib.h>\n#include <string.h>" Public.h

  make -f makefile.linux
}

package() {
  cd "$srcdir/$pkgname-$pkgver-src/src"

  install -d "$pkgdir"/usr/{bin,share/{doc,licenses,}/$pkgname}

  install -Dm 755 rtgen rtdump rtsort rcrack "$pkgdir/usr/bin"
  install -Dm 644 charset.txt "$pkgdir/usr/share/$pkgname"
  install -Dm 644 ../doc/* "$pkgdir/usr/share/doc/$pkgname"
  install -Dm 644 ../disclaimer.txt "$pkgdir/usr/share/licenses/$pkgname/LICENCE"
}
