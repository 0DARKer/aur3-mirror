# Contributor: Eduard Sukharev <kraplax AT mail DOT ru>
pkgname='ufo2000'
pkgver='0.9.1105'
pkgrel='3'
pkgdesc="A free and opensource turn based tactical squad simulation multiplayer game. It is heavily inspired by the famous X-COM: UFO Defense game."
arch=('i686')
url="http://ufo2000.sourceforge.net/"
license=('gpl')
groups=()
depends=('allegro<4.9' dumb-old sdl hawknl expat zlib freetype2 libvorbis)
makedepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=ufo2000.install
source=(http://prdownloads.sourceforge.net/$pkgname/$pkgname-$pkgver-beta-src.bz2?download ufo2000.png ufo2000.desktop makefile.patch)
noextract=()
#generated with 'makepkg -g'
md5sums=('e07ca7c032be0b207a7e97e06df01898'
         'c39fa2f286591497a25e11811ddf8585'
         '4ea21d2eb5983f2f29efa7e3c7c9eb23')
build() {
  cd "$srcdir/"

  #patching makefile since it ignores CFLAGS and sets it from scratch
  patch -p1 < $srcdir/makefile.patch
  # Building
  # consider deleting the export command (if you have your own CFLAGS set to
  # something you're sure of) or modify it to fit your arch type
  export CFLAGS="${CFLAGS} -march=i686" && make || return 1

  #Shortcut
  install -D ufo2000.png $pkgdir/usr/share/pixmaps/ufo2000.png
  install -D ufo2000.desktop $pkgdir/usr/share/applications/ufo2000.desktop

  # Automatic install
  #make DESTDIR="$pkgdir/" no_dumbogg=1 DISTNAME=archlinux install || return 1

  # Manual install
  mkdir -p $pkgdir/usr/bin 
  mkdir -p $pkgdir/opt/$pkgname 
  rm -rf doxygen makefile $pkgname-$pkgver-beta-src.tar.bz2?download 
  mv -f * $pkgdir/opt/$pkgname
  cd $pkgdir/usr/bin
  ln -s ../../opt/$pkgname/$pkgname


  # As stated on the URL below, make install does not work (yet):
  # http://www.xcomufo.com/forums/index.php?showtopic=24202800
}

# vim:set ts=2 sw=2 et:
