## build reinteract to work with python2 on Arch
## 

arch=(i686 x86_64)
pkgname=reinteract-git
pkgver=20110210
pkgrel=1
pkgdesc="system for interactive experimentation with python."
url="http://www.reinteract.org/"
license="gpl"
depends=('pygtk' 'python2-numpy' 'python2-matplotlib' 'sox')
makedepends=('git')
source=()
md5sums=()

_gitroot="git://git.fishsoup.net/reinteract"
_gitname="reinteract"

build() {
	cd "$srcdir"
	msg "Connecting to ${_gitroot} GIT server...."

	if [ -d "$srcdir"/$_gitname ] ; then
    		cd $_gitname && git pull origin
		msg "The local files are updated."
	else
		git clone $_gitroot || return 1
	fi

	msg "GIT checkout done or server timeout"
	msg "Starting make..."
  
  	cd "$srcdir"
  	rm -rf  reinteract.build
  	cp -r  reinteract reinteract.build
  	cd reinteract.build || return 1
  
  	# force config with python2
	PYTHON=/usr/bin/python2 ./autogen.sh
	PYTHON=/usr/bin/python2 ./configure --prefix='/usr'
	make || return 1
}
package() {
  	cd "$srcdir"/reinteract.build 
	make install DESTDIR="$pkgdir" || return 1

	# cruchbang for python2
	sed  -e 's/env python/env python2/' -i "$pkgdir"/usr/bin/${_gitname}
}