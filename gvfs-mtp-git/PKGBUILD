# $Id: PKGBUILD 164365 2012-07-31 19:42:58Z eric $
# Original Package: Jan de Groot <jgc@archlinux.org>
# Maintainer: Lubosz Sarnecki <lubosz@gmail.com>

pkgname=gvfs-mtp-git
conflicts=('gvfs' 'gvfs-smb' 'gvfs-afc' 'gvfs-afp' 'gvfs-gphoto2' 'gvfs-obexftp' 'libmtp-gvfs-git')
provides=('gvfs=1.14.0' 'gvfs-smb' 'gvfs-afc' 'gvfs-afp' 'gvfs-gphoto2' 'gvfs-obexftp')
pkgver=20121118
pkgrel=1
arch=('i686' 'x86_64')
license=('LGPL')
makedepends=('avahi' 'bluez' 'dbus-glib' 'fuse' 'intltool' 'libarchive' 'libcdio' 'libgphoto2' 'libimobiledevice' 'libsoup-gnome' 'smbclient' 'udisks2' 'libmtp-git' 'gtk-doc')
url="http://www.gnome.org"
options=(!libtool)
_gitroot='git://github.com/philipl/gvfs.git'
_gitname='gvfs'

pkgdesc="Userspace virtual filesystem implemented as a pluggable module for gio. With native MTP support."
depends=('avahi' 'dconf' 'fuse' 'libarchive' 'libcdio' 'libsoup-gnome' 'udisks2'  'smbclient' 'libgnome-keyring' 'libimobiledevice' 'dbus-core' 'libgphoto2' 'udev' 'dbus-glib' 'bluez' 'obex-data-server')

install=gvfs.install

build() {
  if [ -d ${srcdir}/$_gitname ]; then
    cd $srcdir/$_gitname
    git pull
  else
    cd $srcdir
    git clone $_gitroot $_gitname
    cd $_gitname
  fi
  
  ./autogen.sh --prefix=/usr --sysconfdir=/etc \
      --localstatedir=/var --disable-static \
      --libexecdir=/usr/lib/gvfs \
      --with-bash-completion-dir=/usr/share/bash-completion/completions
  make
}

package() {
  cd "$srcdir/$_gitname"
  make DESTDIR="$pkgdir" install
}
