# Maintainer: archtux <antonio.arias99999@gmail.com>

pkgname=silicon-empire-git
pkgver=20110424
pkgrel=1
pkgdesc="Set of tools to manage and organize your optical discs like CDs, DVDs and Blu-rays."
arch=('i686' 'x86_64')
url="http://getsilicon.org/"
license=('GPL3')
depends=('fuseiso' 'phonon' 'taglib')
makedepends=('git')
conflicts=('silicon-empire')

_gitname=silicon-empire
_gitroot=git://gitorious.org/silicon/empire.git
 
build() {
  cd $srcdir

  msg "Connecting to GIT server...."

  if [ -d $srcdir/$_gitname ] ; then
    cd $_gitname && git pull --rebase
  else
    git clone $_gitroot
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  cd empire

  # Fix Makefile(qmake-qt4 -> qmake)
  sed -i 's/qmake-qt4/qmake/' Makefile

  make
  
  cd build-linux
  install -Dm755 bin/silicon $pkgdir/usr/bin/silicon 
  cp -R lib/ share/ $pkgdir/usr

  # Desktop icon
  cd $srcdir/empire/src/Files
  install -Dm644 silicon.desktop $pkgdir/usr/share/applications/silicon.desktop
  install -Dm644 icons/silicon_128.png $pkgdir/usr/share/icons/hicolor/128x128/apps/silicon.png
}