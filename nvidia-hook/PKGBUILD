# Maintainer: Alucryd <alucryd at gmail dot com>

pkgname=nvidia-hook
pkgver=2.1
pkgrel=1
pkgdesc="mkinitcpio hook to compile the NVIDIA modules"
url="http://www.nvidia.com/"
arch=('i686' 'x86_64')
license=('GPL3')
depends=('nvidia-source')
install=${pkgname}.install
source=("nvidia")
md5sums=('4309f1a2e7cc01fad8c41646d8676eab')

package() {
  install -m755 -d "${pkgdir}/usr/lib/modprobe.d"
  echo "blacklist nouveau" >> "${pkgdir}/usr/lib/modprobe.d/nvidia.conf"
  install -m755 -d "${pkgdir}/usr/lib/initcpio/install"
  sed -i "s|arch|$CARCH|g" nvidia
  install -m644 "${srcdir}/nvidia" "${pkgdir}/usr/lib/initcpio/install/nvidia"
}
