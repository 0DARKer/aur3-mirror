# Maintainer: Viktor Vidovic <vidovicviktor@googlemail.com>

pkgname=openttd-cargodist
pkgver=g4dd2678f
pkgrel=1
pkgdesc='OpenTTD with passenger and cargo distribution patch'
arch=('i686' 'x86_64')
url='http://wiki.openttd.org/Passenger_and_cargo_distribution'
license=('GPL')
depends=('libpng' 'sdl' 'icu' 'fontconfig' 'lzo2' 'hicolor-icon-theme' 'desktop-file-utils')
install=openttd.install
optdepends=('openttd-opengfx: free graphics' 
            'openttd-opensfx: free soundset')
source=("http://bundles.openttdcoop.org/cargodist/LATEST/openttd-cargodist-g4dd2678f-source.tar.xz")

build() {
  cd ${pkgname}-${pkgver} 

 ./configure \
    --prefix-dir=/usr \
    --binary-name=${pkgname} \
    --binary-dir=bin \
    --data-dir=share/${pkgname} \
    --install-dir=${pkgdir} \
    --doc-dir=share/doc/${pkgname} \
    --menu-name="OpenTTD" \
    --personal-dir=.${pkgname}    

  make
}

package() {
  cd ${pkgname}-${pkgver} 

  make install

#Link opengfx and opensfx files
	cd "${pkgdir}/usr/share/${pkgname}/data/"
	ln -s /usr/share/openttd/data/ogfx1_base.grf ogfx1_base.grf
	ln -s /usr/share/openttd/data/ogfxc_arctic.grf ogfxc_arctic.grf
	ln -s /usr/share/openttd/data/ogfxe_extra.grf ogfxe_extra.grf
	ln -s /usr/share/openttd/data/ogfxh_tropical.grf ogfxh_tropical.grf
	ln -s /usr/share/openttd/data/ogfxi_logos.grf ogfxi_logos.grf
	ln -s /usr/share/openttd/data/ogfxt_toyland.grf ogfxt_toyland.grf
	ln -s /usr/share/openttd/data/opengfx.obg opengfx.obg
	ln -s /usr/share/openttd/data/opensfx.cat opensfx.cat
	ln -s /usr/share/openttd/data/opensfx.obs opensfx.obs
}

md5sums=('5666e665a9a77a7ef30df5e3975004bb')
