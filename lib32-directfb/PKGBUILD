_pkgbasename=directfb
pkgname=lib32-$_pkgbasename
pkgver=1.4.11
pkgrel=1
pkgdesc="A thin library that provides hardware graphics acceleration, input device handling and abstraction, integrated windowing system on top of the Linux Framebuffer Device"
arch=('x86_64')
url="http://www.directfb.org"
license=('LGPL')
depends=('lib32-libjpeg-turbo' 'lib32-libxext' 'lib32-sdl'
		 'lib32-sysfsutils' 'lib32-libpng' 'lib32-freetype2'
		 "$_pkgbasename>=$pkgver")
options=('!libtool')
source=("http://www.directfb.org/downloads/Core/DirectFB-1.4/DirectFB-${pkgver}.tar.gz"
		'directfb-1.4.11-man2html.patch')
md5sums=('94735ccec21120794adcce93a61445d2'
		 'a4195a96bb037c06c99100bc49e132f9')

build() {
  cd "${srcdir}/DirectFB-${pkgver}"
  ./configure --prefix=/usr --sysconfdir=/etc --disable-osx \
  			  --enable-{static,zlib,x11,sdl,video4linux2,voodoo} \
  			  --libdir=/usr/lib32 CC='gcc -m32' CXX='g++ -m32'
  # Patch to solve weird man2html usage was messing up the compilation
  patch -p0 < "${srcdir}/directfb-1.4.11-man2html.patch"
  
  make
} 

package() {
  cd "${srcdir}/DirectFB-${pkgver}"
  make DESTDIR=${pkgdir} install  
  rm -rf ${pkgdir}/usr/{bin,include,share}
}
