# Maintainer: Eric Renfro <erenfro@gmail.com>

pkgname=ha-resourceagent
pkgver=3.9.4
pkgrel=1
pkgdesc="A standardized interface for a cluster resource"
arch=('i686' 'x86_64')
url="http://linux-ha.org/wiki/Resource_Agents"
license=('GPL')
depends=('ha-glue')
source=("https://github.com/ClusterLabs/resource-agents/archive/v${pkgver}.tar.gz")
md5sums=('7a440025fc032e7a6688ac458f6483e0')
build() {
	_CLUSTER_USER=hacluster
	_CLUSTER_GROUP=haclient
	_PREFIX=/usr
	_PREFIXETC=/etc
	_PREFIXINIT=${_PREFIXETC}/rc.d
	_PREFIXVAR=/var
	cd "${srcdir}/resource-agents-${pkgver}"
	./autogen.sh
	./configure \
		--prefix=$_PREFIX 					\
		--localstatedir=${_PREFIXVAR} 		\
		--sysconfdir=${_PREFIXETC}			\
		--with-initdir=${_PREFIXINIT}		
	make || return 1
	make DESTDIR="${pkgdir}" install || return 1

	#cp ${pkgdir}/usr/lib/ocf/lib/heartbeat/ocf-shellfuncs ${pkgdir}/usr/lib/ocf/resource.d/heartbeat/.ocf-shellfuncs
	#python path correction
	for py in `grep -r -l "\#\!\/usr\/bin\/python" ${pkgdir}`;do
		sed -i 's:/usr/bin/python$:/usr/bin/python2:g' ${py}
	done 
	for py in `grep -r -l "\#\!\/usr\/bin\/env python" ${pkgdir}`;do
		sed -i 's:/usr/bin/env python$:/usr/bin/env python2:g' ${py}
	done
	#end python path correction

}
	

