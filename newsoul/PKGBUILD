# Maintainer: Karol "Kenji Takahashi" Wo≈∫niak <kenji.sx>

pkgname=newsoul
pkgver=0.1
pkgrel=1
pkgdesc="Museek+, a daemon/server based Soulseek client, resurrected."
arch=('i686' 'x86_64')
url="https://github.com/KenjiTakahashi/newsoul"
license=('GPL3')
depends=(
    'libxml2'
    'libvorbis'
    'nettle'
    'python2'
)
optdepends=('python2-crypto: other python utils')
makedepends=('tup-git')
provides=('newsoul')
source=("https://github.com/KenjiTakahashi/newsoul/archive/${pkgver}.tar.gz")
md5sums=('72d64f5ff27183085b434d7ba7edfe27')

build() {
    cd ${srcdir}/${pkgname}-${pkgver}

    ./build
}

package() {
    cd ${srcdir}/${pkgname}-${pkgver}

    install -Dm755 src/newsoul ${pkgdir}/usr/bin/newsoul
    install -Dm755 src/nsscan/nsscan ${pkgdir}/usr/bin/nsscan
    install -Dm755 src/config.xml.tmpl ${pkgdir}/usr/share/newsoul/config.xml.tmpl
    install -Dm755 scripts/newsoul@.service ${pkgdir}/usr/lib/systemd/system/newsoul@.service

    install -Dm644 src/newsoul.1 ${pkgdir}/usr/share/man/man1/newsoul.1
    gzip ${pkgdir}/usr/share/man/man1/newsoul.1
    install -Dm644 src/nsscan/nsscan.1 ${pkgdir}/usr/share/man/man1/nsscan.1
    gzip ${pkgdir}/usr/share/man/man1/nsscan.1

    cd python-bindings
    python2 setup.py install --root=${pkgdir}/ --optimize=1

    cd ../python-utils
    python2 setup.py install --root=${pkgdir}/ --optimize=1
}

# vim:set ts=4 sw=4 et:
