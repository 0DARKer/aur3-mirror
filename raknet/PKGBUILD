# Maintainer: Sven-Hendrik Haase <sh@lutzhaase.com>
# Contributor: Robert Hollencamp <rhollencamp@gmail.com>
pkgname=raknet
pkgver=4.022
pkgrel=1
pkgdesc="Cross platform C++ network library"
arch=('i686' 'x86_64')
url="http://www.jenkinssoftware.com/"
license=('custom')
#makedepends=('autoconf')
source=(http://www.jenkinssoftware.com/raknet/downloads/RakNet_PC-${pkgver}.zip 
        license.txt)
md5sums=('740ac081265163c208027653820d8452'
         '6bd636fe028aac184c20b3a50d83cd79')

build() {
  # all of the Linux build system supplied by RakNet are broken
  # we'll make our own lib manually YEAAAAAAAHHHHHHHHH1!!!
  cd ${srcdir}/Source
  msg "Hardcore static library compiling action"
  g++ -O2 -lpthread -c *.cpp
  msg "Hardcore static library archiving action"
  ar rc libraknet.a *.o
  
  msg "Hardcore shared library compiling action"
  g++ -O2 -fPIC -lpthread -shared -o libraknet.so *.cpp
  
  msg "Hardcore installation action"
}

package() {
  cd ${srcdir}/Source
  mkdir -p ${pkgdir}/usr/share/licenses/${pkgname}
  cp ${srcdir}/license.txt ${pkgdir}/usr/share/licenses/${pkgname}/license.txt
  
  mkdir -p ${pkgdir}/usr/lib/
  cp libraknet.* ${pkgdir}/usr/lib/
  
  mkdir -p ${pkgdir}/usr/include/raknet/
  install -m644 *.h ${pkgdir}/usr/include/raknet/
  
  msg "Hardcore cleaning action"
  mkdir -p ${pkgdir}/usr/share/raknet/
  cp -r ../Samples ${pkgdir}/usr/share/raknet/
  find ${pkgdir}/usr/share/raknet/ -iname "*vcproj*" -delete
  find ${pkgdir}/usr/share/raknet/ -exec chmod 644 '{}' \;
  msg "All done, YEAAAAAAAAHHHHHHHHHH1111!!!!"
} 
# vim: ts=2 sw=2
