# Maintainer:  jfperini <@jfperini>
# Contributor: jfperini <@jfperini>

pkgname=telegram-desktop
pkgver=0.5.16
pkgrel=1
pkgdesc="Telegram Desktop messaging app."
arch=('any')
url="https://tdesktop.com"
license=('GPL v3')
depends=('openssl' 'zlib' 'libexif' 'xz')
# optdepends=(
# 'qt5-base' 'libpulse' 'libx11' 'libxcb' 'libogg' 'libgcrypt' 'libasyncns' 'libsndfile' 'libsystemd' 'libXdmcp' 'libXau' 'libdbus' 'json-c'
# 'lzma-sdk: The LZMA SDK provides the libraries you need to develop applications that use LZMA compression.')

if [[ $CARCH == "x86_64" ]]; then
    md5sums=('284dd62c12c631ab38524f9bcfcdf44c' '1330ba39ac54aa1c67c7f6f12db4af20' 'a611bf662680c8e4c6cefff5f81cd07b' 'a34cc6ee7cc6e8c70f1df23f739cdc67')
    source=("$pkgname.tar.xz"::'https://storage.googleapis.com/tlinux/tsetup.'$pkgver'.tar.xz' 'telegram.png' 'telegram' 'telegram.desktop')
    
elif [[ $CARCH == "i686" ]]; then
    md5sums=('f72e6c243c995c27bf4637d5fb0f8d4f' '1330ba39ac54aa1c67c7f6f12db4af20' 'a611bf662680c8e4c6cefff5f81cd07b' 'a34cc6ee7cc6e8c70f1df23f739cdc67')
    source=("$pkgname.tar.xz"::'https://storage.googleapis.com/tlinux32/tsetup32.'$pkgver'.tar.xz' 'telegram.png' 'telegram' 'telegram.desktop')
fi

package() {

    cd "$srcdir/"
    
    msg2 "  -> Extracting files..."
    tar Jxvf  $pkgname.tar.xz -C .
    
    msg2 "  -> Installing program..."
    install -d $pkgdir/{opt/telegram-desktop,usr/bin,,usr/share}
    cp -r "$srcdir/Telegram/"* "$pkgdir/opt/$pkgname/"
    # ln -s "$srcdir/Telegram/Telegram" "$pkgdir/usr/bin/Telegram"
    cp -u "$srcdir/telegram" "$pkgdir/usr/bin"
    
    msg2 "  -> Installing icons..."
    install -Dm644 "$srcdir/telegram.png" "$pkgdir/usr/share/pixmaps/telegram.png"

    msg2 "  -> Installing .desktop file..." 
    install -Dm644 "$srcdir/telegram.desktop" "$pkgdir/usr/share/applications/telegram.desktop"

} 

    
 
