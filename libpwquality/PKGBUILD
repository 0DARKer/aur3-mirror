pkgname=libpwquality
pkgver=1.0.0
pkgrel=1
pkgdesc="A library for password generation and password quality checking"
arch=('i686' 'x86_64')
url="https://fedorahosted.org/libpwquality/"
license=('GPL2')
depends=('python2' 'cracklib' 'pam')
options=('!libtool')
source=("https://fedorahosted.org/releases/l/i/$pkgname/$pkgname-$pkgver.tar.bz2")
backup=('etc/security/pwquality.conf')
sha256sums=('1f2e6171071f37871096c9d73f91ac4f2d35597ba844d07594e080c37b15009c')

build() {

  cd "$srcdir/$pkgname-$pkgver"

  # This build barely "works" without any sed/patch magic:

  export PYTHON=/usr/bin/python2

  LDFLAGS+=" -Wl,--no-undefined"

  ./configure --prefix=/usr \
    --libdir=/lib \
    --disable-static \
    --enable-shared \
    --with-pic \
    --with-pythonsitedir=/usr/lib/python2/site-packages \
    --with-pythonrev=2.7

  make -C src

  cd python
  python2 setup.py build --build-lib=

}

check() {
  cd "$srcdir/$pkgname-$pkgver"
  make check
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir" install
}

# vim:set ts=2 sw=2 et:
