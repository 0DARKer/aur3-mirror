# Maintainer: t3ddy  <t3ddy1988 "at" gmail {dot} com>
# Contributor: moostik <mooostik_at_gmail.com>

pkgname=2mandvd
pkgver=1.8.4
pkgrel=4
pkgdesc="DVD Authoring Maker In Linux Environnement"
url="http://2mandvd.tuxfamily.org/"
license=('GPL')
arch=('i686' 'x86_64')
#install=${pkgname}.install
depends=('qt4' 'sox' 'mplayer' 'mencoder' 'perl' 'netpbm' 'transcode' 'ffmpegthumbnailer' 'dvdauthor' 'mjpegtools' 'ttf-dejavu' 'dvd+rw-tools' 'exif')
optdepends=('xine-ui: to preview the result')
source=(http://download.tuxfamily.org/${pkgname}/2ManDVD-${pkgver}.tar.gz
	${pkgname}.desktop
	${pkgname}.sh)
md5sums=('2e362b6d963b0698ee4911d28865d50d'
         'bd59ad69e6ed089d07adbb1ec3d59d66'
         '0112971f170034aff6efaafb9508b010')

build() {
  cd ${srcdir}/2ManDVD

  qmake-qt4 2ManDVD.pro
  
  sed -i "41s|#ifdef|//#ifdef|" videowrapper.cpp
  sed -i '42i #if LIBAVFORMAT_VERSION_MAJOR >= 53' videowrapper.cpp
  
  make
}

package(){
  cd $srcdir/2ManDVD
  
  sed -i "s|chmod -R 755 /usr/share/2ManDVD|chmod -R 755 \$(INSTALL_ROOT)/usr/share/2ManDVD|" Makefile
  
  make INSTALL_ROOT=${pkgdir} install
}