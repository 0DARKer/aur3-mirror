# Contributor: Madek, crazyelf5
# Maintainer: crazyelf5

pkgname=marlin-bin
pkgver=LATEST
pkgrel=1
arch=('i686' 'x86_64')
_arch=amd64
[ $CARCH = 'i686' ] && _arch=i386
pkgdesc="A sleek and fast GTK3 file manager"
url="https://launchpad.net/marlin"
license=('GPL2' 'GPL3')
depends=('gtk3' 'libgee' 'glib2' 'cairo' 'libnotify' 'gnome-icon-theme' 'varka-bzr' 'libdbusmenu' 'dee' 'dconf')
makedepends=('lynx' 'wget' 'libarchive')
optdepends=('extended-actions-bzr: Plugins integration [AUR]'
            'egtk-bzr: Elementary GTK Theme [AUR]'
            'marlin-dropbox-plugin-bzr: Dropbox integration [AUR]')
conflicts=('marlin-bzr')
install=marlin-bin.install
source=()
md5sums=()

build() {
  wget $(lynx -dump http://ppa.launchpad.net/marlin-devs/marlin-daily/ubuntu/pool/main/m/marlin | \
  grep -o "http:.*" | grep oneiric | grep $_arch | tail -1)
  bsdtar -xf *.deb data.tar.xz
  bsdtar -xf data.tar.xz -C "${pkgdir}"
  if [ ! -f /usr/bin/unity ]; then
    wget $(lynx -dump http://archive.ubuntu.com/ubuntu/pool/main/libu/libunity/ | \
    grep -o "http:.*" | grep $_arch | tail -1)
    bsdtar -xf libunity*.deb data.tar.gz
    bsdtar -xf data.tar.gz
    mv usr/lib/libunity* "${pkgdir}/usr/lib"
  fi
}
