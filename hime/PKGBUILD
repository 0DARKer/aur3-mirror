# Maintainer: b4283

pkgname=hime
pkgver=0.9
pkgrel=3
pkgdesc="HIME is a new(revised) input method forked from gcin."
arch=(i686 x86_64)
url="http://hime.luna.com.tw"
license=('LGPL 2.1')
depends=(gtk2 libxtst)
makedepends=()
optdepends=('qt: support for qt4 input method'
            'gtk3: support for gtk3 input method'
            'anthy: support for anthy input method'
            'libchewing: support for chewing input method')
options=()
install=install
source=("http://hime.luna.com.tw/${pkgname}-${pkgver}.tar.xz" qt.patch)

md5sums=('3c70fb0138b61402b7f2215dc14a6d9d'
         '877612cd1fed3a0003ebbb9f3f361fd1')

build() {
  cd "$srcdir/$pkgname-$pkgver"

  patch -p1 < ../qt.patch

  # somehow qt3 doesn't work
  ./configure --prefix=/usr --use_qt3=N

  sed -i '18s|.*|\t/usr/bin/moc $< -o moc_hime-qt.cpp|' qt4-im/Makefile

  # unused qt3 string replacement
  #sed -i '15s|.*|\t/opt/qt/bin/moc $< -o $<_moc.cpp|' qt-im/Makefile

  make
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir/" install
}

# vim:set ts=2 sw=2 et:
