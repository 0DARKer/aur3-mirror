# Libguestfs: Installer: Arch
# Contributor: Xiao-Long Chen <chenxiaolong@cxl.epac.to>
# Maintainer: Nikos Skalkotos <skalkoto (at) Gmail.com>
# 
# special thanks go to Evaggelos Balaskas < ebalaskas _AT_ ebalaskas _DOT_ gr >
# for all the help

pkgname=libguestfs
pkgver=1.20.1
pkgrel=1
pkgdesc="Access and modify virtual machine disk image"
arch=("i686" "x86_64")
url="http://libguestfs.org"
license=("GPL2" "LGPL2.1")
backup=("etc/libguestfs-tools.conf" "etc/php.d/guestfs_php.ini")
depends=("qemu"
         "febootstrap>=3.21"
         "augeas"
         "hivex>=1.3.2"
         "libconfig"
         "libvirt")
makedepends=("qemu"
             "pcre"
             "fuse"
             "cdrkit"
             "libvirt"
             "libconfig"
             "libxml2"
             "gperf"
#             "java-environment"
             "python2"
             "perl"
             "perl-string-shellquote"
             "perl-libintl-perl"
             "perl-sys-virt"
             "ocaml-findlib"
             "ocaml"
             "lua"
             "ghc"
             "ruby"
             "erlang"
             "gjs"
             "php")
optdepends=("python2: Python bindings"
            "perl: Perl Bindings"
            "perl-sys-virt: Sys-Virt tools"
            "ocaml: Ocaml libs"
            "ruby: Ruby Bindings"
            "gjs: Javascript Bindings for GNOME"
            "php: PHP bindings"
            "erlang: Erlang Bindings"
            "ghc: Haskell Bindings"
            "lua: Lua Bindings")
provides=("guestfish=${pkgver}")
options=()
source=("http://libguestfs.org/download/${pkgver%.*}-stable/${pkgname}-${pkgver}.tar.gz")
sha512sums=('c1d80f0aa976369a604a7ecf474689fc9e7ec9a713534ecafdb9461c3b1c4e3874666a64a545691ca8197b8bc8a8c601efdaaa8cbf8c98ed1b928208d320ae95')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"


  ./configure \
    PYTHON=python2 \
    --prefix=/usr \
    --libdir=/usr/lib \
    --mandir=/usr/share/man \
    --sysconfdir=/etc \
    --disable-probes \
    --without-java

  make -j3
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  make DESTDIR="${pkgdir}" install
}
