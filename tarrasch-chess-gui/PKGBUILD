# Maintainer: scorici <scorici AT yahoo DOT com>
pkgname=tarrasch-chess-gui
pkgver=2.01ar
pkgrel=1
pkgdesc="The Tarrasch Chess GUI"
arch=(any)
url="http://www.triplehappy.com"
license=('freeware' 'open-source')
depends=('wine')
makedepends=('unzip')
source=("$url/downloads/portable-tarrasch-v2.01ar.zip"
"https://bitbucket.org/billforsternz/$pkgname/raw/e1ebb5379372f7d3264c61c9fec3993cff128095/tarrasch.ico")
md5sums=('70fe4ab1815fca8bab5cfbe68383c842'
         'b0ce4ab2350c049bcba827225ca9fe63')
package() {
mkdir -p $pkgdir/usr/bin $pkgdir/usr/share/$pkgname $pkgdir/usr/share/applications
unzip -q $startdir/portable-tarrasch-v2.01ar.zip -d $pkgdir/usr/share/$pkgname
cp $startdir/tarrasch.ico $pkgdir/usr/share/$pkgname/$pkgname.ico
echo "
[Desktop Entry]
Version=1.0
Name=$pkgdesc
Comment=Play chess against engines, analyze and edit games.
Exec=$pkgname
Icon=/usr/share/$pkgname/$pkgname.ico
Categories=Game;BoardGame;
Type=Application
Terminal=false
StartupNotify=false
" > $pkgdir/usr/share/applications/$pkgname.desktop
echo "#!/bin/bash
if [ ! -d ~/.$pkgname ]; then
	mkdir ~/.$pkgname
fi
if [ ! -f ~/.$pkgname/Tarrasch.ini ]; then
	touch ~/.$pkgname/Tarrasch.ini
fi
ln -sv /usr/share/$pkgname/Engines ~/.$pkgname
ln -sv /usr/share/$pkgname/book.pgn ~/.$pkgname
ln -sv /usr/share/$pkgname/Tarrasch.exe ~/.$pkgname
cd ~/.$pkgname
wine Tarrasch.exe
exit"> $pkgdir/usr/bin/$pkgname
find "$pkgdir"/usr -type f -exec chmod 644 "{}" \;
find "$pkgdir"/usr -type d -exec chmod 755 "{}" \;
chmod +x $pkgdir/usr/bin/$pkgname
}
