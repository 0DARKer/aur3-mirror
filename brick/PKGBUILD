# Maintainer: Andrew Krasichkov <buglloc _ at _ yandex _ dot _ru>

pkgname=brick
pkgver=0.1.18.29.9
pkgrel=1
pkgdesc="Unofficial Bitrix24 messenger client."
arch=('i686' 'x86_64')
url="https://github.com/buglloc/brick"
license=("MIT")
depends=("alsa-lib" "desktop-file-utils" "gconf" "libxtst" "libxss" "xdg-utils")
optdepends=()
conflicts=("brick-git" "brick-unity")
makedepends=("git" "p7zip" "cmake")
install=${pkgname}.install
source=("https://launchpad.net/~buglloc/+archive/ubuntu/brick/+files/brick_${pkgver}.orig.tar.gz")
md5sums=("4a61c80a727381686771a876e37d1aa8")


build() {
  cd ${srcdir}

  mkdir -p brick/Release
  if [ $CARCH == "x86_64" ];
  then
    cp -arf cef/64/* brick/Release
  else
    cp -arf cef/32/* brick/Release
  fi

  mkdir -p out
  cd out
  cmake -DCMAKE_INSTALL_PREFIX=${pkgdir} ../brick
  make
}

package() {
  cd ${srcdir}/out
  make install
  install -dm755 "${pkgdir}/usr/bin"
  rm -f "${pkgdir}/usr/bin/brick"
  ln -s /opt/brick/brick "${pkgdir}/usr/bin/brick"
}
