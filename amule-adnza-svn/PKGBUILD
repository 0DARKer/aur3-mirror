# Mainteiner: ntia89
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: erm67
# Contributor: ntia89

pkgname=amule-adnza-svn
pkgver=288
pkgrel=1
pkgdesc='aMule patched for Fastweb Network (Italy) by Adunanza forum - SVN'
url='http://www.adunanza.net/'
license=('GPL')
arch=('i686' 'x86_64')
depends=('wxgtk' 'gd' 'geoip' 'libupnp' 'crypto++')
makedepends=('subversion' 'cvs' 'perl')
conflicts=('amule' 'amule-adnza')
provides=('amule')
source=()
md5sums=()

_svntrunk=https://amule-adunanza.svn.sourceforge.net/svnroot/amule-adunanza/branches/mrhyde_again/
_svnmod=mrhyde_again

build() {
  cd ${srcdir}

  if [ -d ${_svnmod}/.svn ]; then
    (cd ${_svnmod} && svn up -r ${pkgver})
  else
    svn co ${_svntrunk} --config-dir ./ -r ${pkgver} ${_svnmod}
  fi

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  rm -rf "${srcdir}/${_svnmod}-build"
  cp -r ${_svnmod} ${_svnmod}-build
  cd ${_svnmod}-build

  ./autogen.sh
  ./configure --prefix=/usr \
    --mandir=/usr/share/man \
    
    #--enable-upnp \
	#--enable-geoip \
	#--enable-cas \
	#--enable-wxcas \
	#--enable-amule-daemon \
	#--enable-amulecmd \
	#--enable-webserver \
	#--enable-amule-gui \
	#--enable-alc \
	#--enable-alcc \
	
	--disable-debug \
    --enable-optimize \
    --enable-profile \
    --disable-upnp
  make
}

package() {
  cd ${srcdir}/${_svnmod}-build
  make DESTDIR=${pkgdir} install
}
