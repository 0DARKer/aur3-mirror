# Maintainer: Adam Hani Schakaki (krzd) <krzd@krzd.net>

_pkg=gnome-settings-daemon
pkgname=gnome-settings-daemon-dev
pkgver=2.91.9
pkgrel=1
pkgdesc='The GNOME Settings daemon'
arch=('i686' 'x86_64')
license=('GPL')
depends=('libgnomekbd-dev' 'gnome-desktop-3.0' 'libnotify-dev' 'hicolor-icon-theme' 'libgnome-data' 'libpulse' 'libcanberra' 'gtk3>=2.99.3')
makedepends=('intltool' 'gstreamer0.10-base>=0.10.30')
options=('!emptydirs' '!libtool')
provides=("${_pkg}=${pkgver}")
conflicts=("${_pkg}")
install=gnome-settings-daemon-dev.install
url='http://www.gnome.org'
source=("http://ftp.gnome.org/pub/gnome/sources/${_pkg}/2.91/${_pkg}-${pkgver}.tar.bz2")
sha256sums=(`wget ${source/.t*}.sha256sum -qO - | grep tar.bz2 | cut -d " " -f1`)

build() {
  cd "${_pkg}-${pkgver}"
  libtoolize --force
  aclocal
  autoconf
  automake
  ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var \
      --libexecdir=/usr/bin --disable-static --enable-pulse
  make
}

package() {
  cd "${_pkg}-${pkgver}"
  make DESTDIR="${pkgdir}" GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1 install

  install -d -m755 "${pkgdir}/usr/share/gconf/schemas"
  gconf-merge-schema "${pkgdir}/usr/share/gconf/schemas/${_pkg}.schemas" --domain ${_pkg} ${pkgdir}/etc/gconf/schemas/*.schemas
  rm -f ${pkgdir}/etc/gconf/schemas/*.schemas
}

