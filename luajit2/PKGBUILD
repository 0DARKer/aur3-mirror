# Contributor: Anders Bergh <anders1@gmail.com>
# Contributor: Andrzej Giniewicz <gginiu@gmail.com>
pkgname=luajit2
pkgver=2.0.0_beta5
pkgrel=3
pkgdesc="A Just-In-Time Compiler for Lua"
arch=(i686 x86_64)
url="http://luajit.org"
license=('MIT')
source=(http://luajit.org/download/LuaJIT-${pkgver/_/-}.tar.gz
        http://luajit.org/download/beta5_hotfix1.patch
        lua_root.patch)
md5sums=('7e0dfa03a140148149a1021d4ffd5c57'
         '8e29c60be31a5bb7cb3efba581ee40d5'
         'c8da9c6790e20a12a0e2496f438d9dc3')

build() {
  cd "$srcdir"/LuaJIT-${pkgver/_/-}
  patch -p0 < ../lua_root.patch
  patch -p1 < ../beta5_hotfix1.patch

  make
  make install DESTDIR="$pkgdir" PREFIX=/usr
  ln -sf luajit-${pkgver/_/-} "$pkgdir"/usr/bin/luajit2

  install -Dm644 "$srcdir/LuaJIT-${pkgver/_/-}/COPYRIGHT" "$pkgdir/usr/share/licenses/$pkgname/COPYRIGHT"
} 
