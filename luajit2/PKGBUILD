# Contributor: Anders Bergh <anders1@gmail.com>
# Contributor: Andrzej Giniewicz <gginiu@gmail.com>
# Maintainer: Linus Sj√∂gren <thelinx@unreliablepollution.net>
_VER=2.0.0_beta8
pkgname=luajit2
pkgver=${_VER}_hotfix1
pkgrel=1
pkgdesc="A Just-In-Time Compiler for Lua"
arch=(i686 x86_64)
url="http://luajit.org"
license=('MIT')
source=(http://luajit.org/download/LuaJIT-${_VER/_/-}.tar.gz
        http://luajit.org/download/beta8_hotfix1.patch
        lua_root.patch)
md5sums=('f0748a73ae268d49b1d01f56c4fe3e61'
         '98dde4bbaf4ca427c1fe679ac8caa0d5'
         'c8da9c6790e20a12a0e2496f438d9dc3')

build() {
  cd "$srcdir"/LuaJIT-${_VER/_/-}
  patch -p0 < ../lua_root.patch
  patch -p1 < ../beta8_hotfix1.patch

  make
  make install DESTDIR="$pkgdir" PREFIX=/usr
  ln -sf luajit-${_VER/_/-} "$pkgdir"/usr/bin/luajit2

  install -Dm644 "$srcdir/LuaJIT-${_VER/_/-}/COPYRIGHT" "$pkgdir/usr/share/licenses/$pkgname/COPYRIGHT"
}
