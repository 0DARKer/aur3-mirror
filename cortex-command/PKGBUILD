# Contributor: N30N <archlinux@alunamation.com>

pkgname="cortex-command"
pkgver=1
pkgrel=0.24
pkgdesc="Dynamic 2D pixel graphics coupled with an extremely detailed physics \
engine makes for replayable and emergent gameplay."
url="http://www.cortexcommand.com/"
license=("custom" "GPL" "LGPL2.1" "LGPL3")
arch=("i686" "x86_64")
depends=("curl" "libogg" "openal" "libvorbis")
makedepends=("unzip")
if [ ${CARCH} == "x86_64" ]; then
	source=("http://**************.cloudfront.net/cortex_command-amd64-installer-build24.bin" \
		"${pkgname}.desktop" \
		"${pkgname}.sh")
	md5sums=("0dcced32c70e3830b4da30c07761a71a" \
		"3f227c037969d75cd596f861ef08fcd2" \
		"da4f01d5f4ece59eb0b3ac9020ab943f")
else
	source=("http://**************.cloudfront.net/cortex_command-i386-installer-build24.bin" \
		"${pkgname}.desktop" \
		"${pkgname}.sh")
	md5sums=("33eb71b1545fb2487c0431a58ddf83a5" \
		"3f227c037969d75cd596f861ef08fcd2" \
		"da4f01d5f4ece59eb0b3ac9020ab943f")
fi

build() {
	if [ ${CARCH} == "x86_64" ]; then
		unzip -qqo cortex_command-amd64-installer-build24.bin || return 0
	else
		unzip -qqo cortex_command-i386-installer-build24.bin || return 0
	fi
}

package() {
	cd data/cortex_command_linux

	install -d "${pkgdir}/usr/bin" \
		"${pkgdir}/usr/share/applications" \
		"${pkgdir}/usr/share/licenses/${pkgname}" \
		"${pkgdir}/opt/CortexCommand/libs"

	install -m755 CortexCommand.bin \
		"${pkgdir}/opt/CortexCommand"
	install -m644 {CortexCommand.png,Credits.txt,readme.txt} \
		"${pkgdir}/opt/CortexCommand"
	install -m755 libs/* "${pkgdir}/opt/CortexCommand/libs"
	install -m644 license.txt \
		"${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
	install -m644 "${srcdir}/${source[1]}" \
		"${pkgdir}/usr/share/applications/${source[1]}"
	install -m755 "${srcdir}/${source[2]}" \
		"${pkgdir}/usr/bin/CortexCommand"

	find *.rte -type f | while read file; do
		install -Dm644 "${file}" "${pkgdir}/opt/CortexCommand/${file}"
	done
}

# vim: set noet ff=unix:
