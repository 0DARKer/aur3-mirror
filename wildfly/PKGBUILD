# Maintainer: Dominik Pieper <pieperd88 (at) gmail (dot) com>

pkgname=wildfly
pkgver=8.0.0.Alpha1
pkgrel=1
pkgdesc='Java EE 7 Application Server'
arch=('any')
url='http://www.wildfly.org'
license=('LGPL')
depends=('java-environment')
makedepends=('java-environment>=7')
_location=usr/share

backup=(
        etc/profile.d/${pkgname}.sh
        ${_location}/wildfly/standalone/configuration/standalone.xml
        ${_location}/wildfly/bin/standalone.conf
        ${_location}/wildfly/bin/domain.conf
        ${_location}/wildfly/standalone/configuration/mgmt-users.properties
        ${_location}/wildfly/domain/configuration/mgmt-users.properties
        ${_location}/wildfly/domain/configuration/domain.xml
        ${_location}/wildfly/domain/configuration/mgmt-users.properties
        ${_location}/wildfly/domain/configuration/logging.properties
        ${_location}/wildfly/standalone/configuration/logging.properties
        )

install=${pkgname}.install

source=(http://download.jboss.org/wildfly/${pkgver}/wildfly-${pkgver}.zip
        wildfly.service
        wildfly.sh
        systemd-wrapper.sh
        wildfly.install)

md5sums=('220b246c08a66192b9466f9ac93f1693'
         '15d1ee926b7d90625e0623a1ff7c8e13'
         '6cdfd412fc20efb0be1aee306d08addc'
         '6d058cee19f80e58da1ee1795493acc4'
         '2163e07b2a29aeaaa75428dcf2a7b23e')

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  rm -f bin/*.{bat,exe}
  install -dm755 ${pkgdir}/${_pkgloc}
  cp -R ${srcdir}/${pkgname}-${pkgver} ${pkgdir}/${_pkgloc}/${pkgname}
  install -Dm755 ${srcdir}/wildfly.service ${pkgdir}/usr/lib/systemd/system/wildfly.service
  install -Dm755 ${srcdir}/wildfly.sh ${pkgdir}/etc/profile.d/wildfly.sh
  install -Dm755 ${srcdir}/systemd-wrapper.sh ${pkgdir}/${_pkgloc}/wildfly/bin/systemd-wrapper.sh
}
