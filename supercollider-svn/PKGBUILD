# Maintainer: Arch Linux Pro Audio <archaudio-devel@archaudio.org>
# Contributor: hm_b <hb@uiae.de>
pkgname=supercollider-svn
pkgver=10168
pkgrel=1
pkgdesc="An environment and programming language for real time audio synthesis and algorithmic composition."
url="http://supercollider.sourceforge.net/"
arch=('i686' 'x86_64')
license=('GPL')
depends=('jack' 'fftw' 'avahi')
makedepends=('subversion' 'libsndfile>=1.0' 'emacs' 'vim' 'gedit' 'icu' 'gcc>=3.0' 'pkgconfig>=0.14.0' 'scons>=0.96' 'alsa-lib')
#optdepends=('emacs' 'vim' 'ruby' 'gedit')
conflicts=('supercollider')
provides=('supercollider')

source=()
md5sums=()

_svntrunk=https://supercollider.svn.sourceforge.net/svnroot/supercollider/trunk
_svnmod=SuperCollider3

build() {
  cd $srcdir
  msg "PLEASE NOTE: SuperCollider has moved to git! Use supercollider-git (http://aur.archlinux.org/packages.php?ID=42513) instead!"
  if [ -d $_svnmod/.svn ]; then
    (cd $_svnmod && svn up)
  else
    svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
  fi

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  cp -r $_svnmod $_svnmod-build
  cd $_svnmod-build/common
  
  scons PREFIX=/usr SCED=yes DEVELOPMENT=yes READLINE=yes || return 1
  scons DESTDIR=$pkgdir/ install || return 1

  scons -C ../editors/scvim PREFIX=$pkgdir/usr VIMFILE_DIR=/usr/share/vim/addons install-system || return 1
  msg "PLEASE NOTE: SuperCollider has moved to git! Use supercollider-git (http://aur.archlinux.org/packages.php?ID=42513) instead!"
  rm -rf $srcdir/$_svnmod-build
}
# vim:syntax=sh
