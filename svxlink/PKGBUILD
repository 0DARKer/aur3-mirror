# Maintainer: Carsten Feuls (DL1CAF) 'Der Techniker' <dl1caf@vfdb.org>
# Contributer: Carsten Feuls (DL1CAF) 'Der Techniker' <dl1caf@vfdb.org>
# Contributer: Amateurfunk Station der Hochschule Niederrhein (DF0FN) <df0fn@hs-niederrhein.de>
pkgname=('svxlink')
pkgver="13.03"
pkgrel=1
arch=('i686' 'x86_64')
url="http://sourceforge.net/projects/${pkgname}/"
license=('GPL')
source=("http://downloads.sourceforge.net/project/${pkgname}/${pkgname}/13.03/${pkgname}-${pkgver}.tar.gz"
	"AsyncCppDnsLookupWorker.patch"
	"etc_default_svxlink"
	"svxlink.service")
sha256sums=('638d239d94d120a8efd1b4f1f5456f8e1a2f2e24893dbd40db89a750634e58ea'
	    '4154abaf87deec51dea132bc98652d520fece9c852a19da205aadb44765c4052'
	    'ed577031496f454a1e19b091bac8985bcf49e7dc56675afa293715590e9e4a29'
	    '9d9799feddbc9aa8a51b3bac1adf9963c19441a10708a96e68d0ece8856edb5a')
depends=('alsa-utils' 'alsa-lib' 'libsigcpp1.2' 'gsm' 'libgcrypt' 'popt' 'tcl' 'speex')
pkgdesc="Echolink Software to provide Ham Radio Voip Operations"
optdepends=('sounds-en-US-heather: provides speech sound files in medium quality'
            'sounds-en-US-heather-16k: provides speech sound files in high quality'
            'sounds-heather-r1898: provides an old version of speech sound files from heather'
            'sounds-mary-r1826: provides an old verson of speech sound files from mary')
backup=('etc/svxlink/svxlink.conf'
	'etc/svxlink/TclVoiceMail.conf'
	'etc/svxlink/remotetrx.conf'
	'etc/svxlink/svxlink.d/ModuleDtmfRepeater.conf'
	'etc/svxlink/svxlink.d/ModuleEchoLink.conf'
	'etc/svxlink/svxlink.d/ModuleHelp.conf'
	'etc/svxlink/svxlink.d/ModuleMetarInfo.conf'
	'etc/svxlink/svxlink.d/ModuleParrot.conf'
	'etc/svxlink/svxlink.d/ModulePropagationMonitor.conf'
	'etc/svxlink/svxlink.d/ModuleSelCallEnc.conf'
	'etc/svxlink/svxlink.d/ModuleTclVoiceMail.conf'
	'etc/default/svxlink')
install=svxlink.install

package(){
  cd "${srcdir}/${pkgname}-${pkgver}/"
  patch -p1 -i ${srcdir}/AsyncCppDnsLookupWorker.patch async/cpp/AsyncCppDnsLookupWorker.cpp
  make
  make DESTDIR="${pkgdir}" install
  # This Directory's is not used in Arch Linux
  rm -rf "${pkgdir}/etc/security"
  rm -rf "${pkgdir}/etc/init.d"
  rm -rf "${pkgdir}/etc/sysconfig"
  
  mkdir -p "${pkgdir}/etc/default"
  mkdir -p "${pkgdir}/usr/lib/systemd/system"
  cp ${srcdir}/etc_default_svxlink ${pkgdir}/etc/default/svxlink
  # svxlink systemd service file
  cp ${srcdir}/svxlink.service ${pkgdir}/usr/lib/systemd/system
}


