# Maintainer: Lukas Jirkovsky <l.jirkovsky@gmail.com>
# Contributor: Tomasz Binasiewicz <tomasz.binasiewicz@gmail.com>
pkgname=nucleo
pkgver=0.7.6
pkgrel=3
pkgdesc="Toolkit for exploring new uses of video and new human-computer interaction techniques"
arch=('i686' 'x86_64')
license=('GPL')
url="http://www.lri.fr/~roussel/projects/nucleo/"
depends=('libexif' 'gnutls' 'mesa' 'python2')
optdepends=('ffmpeg' 'gd' 'qt' 'avahi')
options=(!libtool)
source=(http://insitu.lri.fr/metisse/download/$pkgname/$pkgname-$pkgver.tar.bz2 \
        libpng1.4_fix.diff)
md5sums=('175e601ec8555b9f463ae4f57e7b5570'
         '84d80a907be7ba5f5a30491487f77c5b')

build() {
  cd "$srcdir"/$pkgname-$pkgver

  # fix compilation with libpng 1.4
  patch -Np1 < "$srcdir"/libpng1.4_fix.diff || true

  ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var \
    --with-x

  make
}

package() {
  cd "$srcdir"/$pkgname-$pkgver
  make DESTDIR="$pkgdir" install

  # fix python script
  sed -i 's|^#!.*|&2|' "$pkgdir"/usr/bin/nBundle
}
