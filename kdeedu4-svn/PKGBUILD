# Contributor: Lawrence Lee <valheru@facticius.net>
pkgname=kdeedu4-svn
pkgver=1219715
pkgrel=1
pkgdesc="Educational programs for KDE4"
arch=('i686' 'x86_64')
url="http://www.kde.org"
license=('GPL')
makedepends=('cmake' 'subversion')
depends=('kdelibs4-git' 'kdebase4-runtime-git' 'libspectre' 'avogadro' 'boost-libs' 
	 'python2' 'libindi' 'gpsd' 'kdebindings-python' 'gsl' 'libqalculate')
makedepends=('ocaml' 'facile' 'eigen' 'cfitsio'  'openbabel' 'boost' 'r' 
	     'docbook-xsl' 'cmake' 'subversion')
provides=(kdeedu)
conflicts=(kdeedu)

_svntrunk=svn://anonsvn.kde.org/home/kde/trunk/KDE/kdeedu
_svnmod=kdeedu

build() {
. /etc/profile.d/kde-git.sh
  cd $srcdir
if [ -d $_svnmod/.svn ]; then
   (cd $_svnmod && svn up)
else
   svn co $_svntrunk $_svnmod
fi

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  mkdir $_svnmod-build
  cd $_svnmod-build
  cmake $startdir/src/$_svnmod -DCMAKE_BUILD_TYPE=debugfull \
		-DCMAKE_SKIP_RPATH=OFF \
		-DCMAKE_INSTALL_PREFIX=/opt/kde4
  make
}

package() {
  cd ${srcdir}/$_svnmod-build
  make DESTDIR=${pkgdir} install
  sed -i 's|#!/usr/bin/env python|#!/usr/bin/env python2|' ${pkgdir}/opt/kde4/bin/pykig.py
  rm -r $srcdir/$_svnmod-build
}