# Maintainer: Simone Sclavi 'Ito' <darkhado@gmail.com>

pkgname=rt3572usb-wusb600nv2
pkgver=2.5.0.0
pkgrel=4
pkgdesc='Linksys WUSB600Nv2 wireless adapter driver'
arch=('i686' 'x86_64')
url='http://www.ralinktech.com/support.php?s=2'
license=('GPL' 'GPL3' 'custom:ralink-firmware')
#source=(http://dl.dropbox.com/u/7141888/2010_1215_RT3572_Linux_STA_v${pkgver}.DPO.bz2)
source=(http://www.ralinktech.com//download.php?t=U0wyRnpjMlYwY3k4eU1ERXdMekV5THpNeEwyUnZkMjVzYjJGa05qVTFOREF6TURNME55NWllakk5UFQweU1ERXdYekV5TVRWZlVsUXpOVGN5WDB4cGJuVjRYMU5VUVY5Mk1pNDFMakF1TUM1RVVFOD1D
        patch.config
        patch.wusb600nv2
        rt2870-firmware-update.pl)

md5sums=('2dab4f87392e4610fe020e13431f0026'
         '405bb4acfcca2372a5317a2c69d153ea'
         '88a73f32b6246860d43f2dc70f7fcbb9'
         '5dde2f8330cdf7b6b6a0dab563d8e15b')
depends=('linux-firmware' 'perl' 'perl-libwww' 'perl-archive-zip')
makedepends=('kernel26-headers')
install=rt3572usb-wusb600nv2.install

build() {
    cd 2010_1215_RT3572_Linux_STA_v${pkgver}.DPO/os/linux
    patch -Np0 -i ../../../../patch.config 
    cd ../../common/
    patch -Np0 -i ../../../patch.wusb600nv2
    cd ..
    make
}

package() {
   install -D -m 755 rt2870-firmware-update.pl ${pkgdir}/usr/bin/rt2870-firmware-update
   cd 2010_1215_RT3572_Linux_STA_v${pkgver}.DPO
   install -D -m 755 os/linux/rt3572sta.ko ${pkgdir}/lib/modules/$(uname -r)/kernel/drivers/net/wireless/rt3572sta.ko
   install -D -m 644 RT2870STA.dat ${pkgdir}/etc/Wireless/RT2870STA/RT2870STA.dat
   install -D -m 644 RT2870STACard.dat ${pkgdir}/etc/Wireless/RT2870STA/RT2870STACard.dat
   install -D -m 644 LICENSE\ ralink-GPL.txt ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE.ralink-firmware.txt
   
}

