# Maintainer: Alessandro Pazzaglia <jackdroido at gmail dot com>

pkgname=lximediaserver-svn
pkgver=1173
pkgrel=1
pkgdesc="A lightweight VLC based transcoding DLNA server"
arch=('i686' 'x86_64')
url="http://sourceforge.net/projects/lximedia/"
license=('GPL3')
depends=('vlc')
makedepends=('subversion' 'cmake')
options=('!buildflags')

_svntrunk="http://svn.code.sf.net/p/lximedia/code/trunk"
_svnmod="lximedia-svn"

build() {
    cd "$srcdir"

    msg "Starting SVN checkout ..."

    if [ -d $_svnmod/.svn ]
    then
        cd $_svnmod && svn up -r $pkgver
    else
        svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
    fi

    rm -rf "$srcdir/$_svnmod-build"
    cp -r "$srcdir/$_svnmod" "$srcdir/$_svnmod-build"

    msg "Starting make ..."

    cd "$srcdir/$_svnmod-build"
    cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_BUILD_TYPE=Debug .
    make
}

package() {
    cd "$srcdir/$_svnmod-build"
    make DESTDIR="$pkgdir/" install
}
