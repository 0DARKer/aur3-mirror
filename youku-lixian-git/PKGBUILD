# Maintainer: Sascha Weaver <wzyboies@gmail.com>

pkgname=youku-lixian-git
pkgver=20121118
pkgrel=1
pkgdesc="Python script for Youku and other video websites."
arch=('any')
url="https://github.com/iambus/youku-lixian"
license=('MIT')
depends=("python2")
makedepends=('git')

_gitname="youku-lixian"
_gitroot="https://github.com/iambus/youku-lixian.git"

_insdir="/opt/$_gitname"

build() {
    cd $srcdir
    msg "Connecting to the GIT server...."

    if [ -d $_gitname ]; then
        cd $_gitname && git pull origin && cd ..
        msg "The local files are updated."
    else
        git clone $_gitroot $_gitname
    fi

    msg "GIT checkout done"

    mkdir -p "$pkgdir/$_insdir"
    mkdir -p "$pkgdir/usr/share/licenses/$pkgname"
    cp -rf "$_gitname/"* "$pkgdir/$_insdir"
    cd "$pkgdir/$_insdir"
    mv LICENSE "$pkgdir/usr/share/licenses/$pkgname"
    # python2 fix
    sed -i '1s!^.*$!#\!/usr/bin/python2!' {acfun,bilibili,cntv,flv_join,iask,ifeng,iqiyi,ku6,mp4_join,pptv,qq,sohu,tudou,video_lixian,w56,yinyuetai,youku}.py

    mkdir -p "$pkgdir/usr/bin"
    # symbolic link
    ln -s "$_insdir/video_lixian.py" $pkgdir/usr/bin/vlx
}
