# Mantainer: Simone Sclavi <darkhado@gmail.com>
pkgname=lexmark-inkjet-legacy
pkgver=1.0_1
pkgrel=1
pkgdesc='Inkjet drivers for Lexmark printers & multifunction'
arch=('x86_64')
url="http://www.lexmark.com"
license=('custom')
depends=('cups' 'java-environment')
makedepends=('dpkg')
source=("http://downloads.lexmark.com/downloads/cpd/$pkgname-${pkgver/_/-}.amd64.deb.sh.tar.gz")
md5sums=('90d67439b0d8570659a5df1692702525')
install=lx.install

package() {
    ./$pkgname-${pkgver/_/-}.amd64.deb.sh --noexec --target lexmark-printer-drivers
    cd lexmark-printer-drivers
    tar xf instarchive_all --lzma
    dpkg -x ./$pkgname-${pkgver/_/-}.amd64.deb lexmark-inkjet-legacy
    dpkg -x lexmark-legacy-wsu-${pkgver/_/-}.amd64.deb lexmark-inkjet-legacy
    cd lexmark-inkjet-legacy/usr/local/lexmark/legacy/etc/
    mkdir -p $pkgdir/usr/share/cups/model/Lexmark
    cp *.ppd $pkgdir/usr/share/cups/model/Lexmark
    cd ../../..
    mkdir -p $pkgdir/usr/local/lexmark
    cp -a lexmark $pkgdir/usr/local
    cd lexmark/legacy/bin
    install -Dm755 lxhcp $pkgdir/usr/lib/cups/backend/lxhcp
    mkdir -p $pkgdir/usr/bin
    ln -s /usr/local/lexmark/legacy/bin/.scripts/lxtoolbox $pkgdir/usr/bin/lxtoolbox
    chown -R root:root $pkgdir/usr
}



