--- 043_ubuntu_menu_proxy.patch	2014-04-03 18:21:58.889426916 +0900
+++ 043_ubuntu_menu_proxy.patch	2014-04-03 19:51:52.901729540 +0900
@@ -160,25 +160,6 @@
  static gint
  gtk_menu_bar_draw (GtkWidget *widget,
  		   cairo_t   *cr)
-@@ -737,8 +814,16 @@
- 	    {
- 	      GtkMenuShell *menu_shell = GTK_MENU_SHELL (menubars->data);
- 
--              _gtk_menu_shell_set_keyboard_mode (menu_shell, TRUE);
--	      gtk_menu_shell_select_first (menu_shell, FALSE);
-+              if (ubuntu_gtk_menu_shell_activate_first (GTK_MENU_SHELL (menu_shell), FALSE))
-+                {
-+                  //g_print ("send activate to remote!\n");
-+                }
-+              else
-+                {
-+                  _gtk_menu_shell_set_keyboard_mode (menu_shell, TRUE);
-+                  gtk_menu_shell_select_first (menu_shell, FALSE);
-+                  gtk_menu_shell_select_first (menu_shell, FALSE);
-+                }
- 	      
- 	      g_list_free (menubars);
- 	      
 @@ -805,6 +890,16 @@
      add_to_window (GTK_WINDOW (toplevel), menubar);
  }
@@ -233,18 +214,18 @@
 --- a/gtk/gtkmenushell.c
 +++ b/gtk/gtkmenushell.c
 @@ -46,6 +46,7 @@
+ #include "gtkmenubar.h"
  #include "gtkmenuitemprivate.h"
  #include "gtkmenushellprivate.h"
- #include "gtkmenuprivate.h"
 +#include "ubuntumenuproxy.h"
  #include "gtkmnemonichash.h"
  #include "gtkwindow.h"
- #include "gtkprivate.h"
+ #include "gtkwindowprivate.h"
 @@ -472,6 +473,7 @@
-                                       GtkMenuShellPrivate);
-   menu_shell->priv = priv;
-   priv->take_focus = TRUE;
-+  priv->proxy = ubuntu_menu_proxy_get ();
+ {
+   menu_shell->priv = gtk_menu_shell_get_instance_private (menu_shell);
+   menu_shell->priv->take_focus = TRUE;
++  menu_shell->priv->proxy = ubuntu_menu_proxy_get ();
  }
  
  static void
@@ -333,7 +314,7 @@
  #include <gtk/gtkmnemonichash.h>
  #include <gtk/gtkkeyhash.h>
 +#include "ubuntumenuproxy.h"
- 
+ #include <gtk/gtkmenutracker.h>
  
  G_BEGIN_DECLS
 @@ -52,6 +53,8 @@
@@ -345,23 +326,6 @@
  };
  
  void        _gtk_menu_shell_select_last      (GtkMenuShell *menu_shell,
-Index: b/gtk/gtk.symbols
-===================================================================
---- a/gtk/gtk.symbols
-+++ b/gtk/gtk.symbols
-@@ -3954,3 +3954,12 @@
- gtk_window_unmaximize
- gtk_window_unstick
- gtk_wrap_mode_get_type
-+ubuntu_gtk_menu_shell_activate_mnemonic
-+ubuntu_gtk_menu_shell_activate_first
-+ubuntu_menu_proxy_activate_menu
-+ubuntu_menu_proxy_get_type
-+ubuntu_menu_proxy_get
-+ubuntu_menu_proxy_insert
-+ubuntu_menu_proxy_module_get_type
-+ubuntu_menu_proxy_module_get
-+ubuntu_menu_proxy_show_local
 Index: b/gtk/gtkwindow.c
 ===================================================================
 --- a/gtk/gtkwindow.c
