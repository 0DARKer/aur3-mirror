# Contributor : max.bra <max dot bra at alice dot it>
# Maintainer : max.bra <max dot bra at alice dot it>

pkgname=cardapio
_pkgrev=716
pkgver=0.9.173
pkgrel=1
pkgdesc="An alternative Gnome menu, launcher, and much more!"
arch=('any')
url="https://launchpad.net/cardapio"
license=('GPL3')
depends=('pyxdg' 'xdg-user-dirs' 'dbus-python' 'gnome-python-desktop' 'python-keybinder' 'python-simplejson' 'gnome-control-center' 'tk')
makedepends=('bzr')
optdepends=('gnome-panel: for applet-mode use'
            'tracker: search capability'
            'alacarte: menu editing'
            'docky: docky integration'
            'awn: awn integration')
source=(arch_and_python_stuff.patch)
md5sums=('4eb2116d87efe9694b63a152892bbcdd')

build() {
  cd "${srcdir}"
  msg "Downloading source...."
  bzr clone lp:$pkgname -r $_pkgrev || return 1

  msg "Arch and Python2 adjustments..."
  patch -p1 < arch_and_python_stuff.patch
}

package() {
  msg "Building cardapio...."
  cd "${srcdir}/${pkgname}/${pkgname}"
  make DESTDIR="'${pkgdir}'" install || return 1

  ln -s "/usr/lib/cardapio/cardapio" "$pkgdir/usr/bin/"
  ln -s "/usr/lib/cardapio/cardapio-gnome-panel-applet" "$pkgdir/usr/bin/"

  msg "Building cardapio-docky...."
  cd "${srcdir}/${pkgname}/${pkgname}-docky"
  make DESTDIR="'${pkgdir}'" install || return 1

  msg "Building cardapio-awn...."
  cd "${srcdir}/${pkgname}/${pkgname}-awn"
  make DESTDIR="'${pkgdir}'" install || return 1

  msg "Cleaning package...."
  rm "${pkgdir}"/usr/share/locale/cardapio.pot || return 1
}

