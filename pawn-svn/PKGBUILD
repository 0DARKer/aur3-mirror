# Maintainer: perlawk
pkgname=pawn-svn
pkgver=4.0.4825
pkgrel=1
pkgdesc="pawn is a simple, typeless, 32-bit extension language with a C-like syntax. A pawn "source" program is compiled to a binary file for optimal execution speed."
arch=(i686 x86_64)
url="http://www.compuphase.com/pawn/pawn.htm"
license=('Apache V.2')
groups=()
depends=()
makedepends=('subversion')
provides=()
conflicts=()
replaces=()
backup=()
options=('!strip')
install=pawn.install
source=()
noextract=()
md5sums=()

_svntrunk=http://pawnscript.googlecode.com/svn/trunk/ 
_svnmod=pawnscript-read-only

build() {
  cd "$srcdir"
  msg "Connecting to SVN server...."

  if [[ -d "$_svnmod/.svn" ]]; then
    (cd "$_svnmod" )
  else
    svn co "$_svntrunk" "$_svnmod"
    #svn checkout http://pawnscript.googlecode.com/svn/trunk/ pawnscript-read-only
  fi

  msg "SVN checkout done or server timeout"
  msg "Starting build..."

  rm -rf "$srcdir/$_svnmod-build"
  svn export "$srcdir/$_svnmod" "$srcdir/$_svnmod-build"
  cd "$srcdir/$_svnmod-build"
  mkdir -p build
  cd build
  cmake ../
  make -j4
}

package() {
  cd "$srcdir/$_svnmod-build/build"
  mkdir -p $pkgdir/usr/{lib/pawn/bin,share/doc/pawn/doc}
  cp am*so pawncc pawndisasm pawnrun $pkgdir/usr/lib/pawn/bin 
  cd ..
  cp -a include $pkgdir/usr/lib/pawn/
  cp doc/*pdf -t $pkgdir/usr/share/doc/pawn/doc/
  cp -a examples  $pkgdir/usr/share/doc/pawn/
}

# vim:set ts=2 sw=2 et:
