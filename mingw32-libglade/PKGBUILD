# Maintainer: Ondrej Jirman <megous@megous.com>

pkgname=mingw32-libglade
pkgver=2.6.2
pkgrel=1
arch=(i686)
pkgdesc="Allows you to load glade interface files in a program at runtime (mingw32)"
depends=(mingw32-gtk2)
makedepends=(mingw32-gcc)
options=(!strip)
license=('LGPL')
url="http://www.jamesh.id.au/software/libglade/"
source=(http://ftp.gnome.org/pub/gnome/sources/libglade/2.6/libglade-${pkgver}.tar.bz2)
md5sums=('da4f9d1c6cd1337f6ef5e2db768d8557')

build()
{
  cd $startdir/src/libglade-$pkgver

  export CFLAGS="-O2 -mms-bitfields"
  export PKG_CONFIG_PATH="/usr/i486-mingw32/lib/pkgconfig/"

  ./configure \
    --prefix=/usr/i486-mingw32 \
    --host=i486-mingw32 \
    --build=$CHOST \
    || exit 1

  make || exit 1
  mkdir -p $startdir/pkg/usr/i486-mingw32/lib
  make install DESTDIR=$startdir/pkg || exit 1

  cd $startdir/pkg
  find . -name '*.a' -o -name '*.dll' -o -name '*.exe' \
    | xargs -rtl1 i486-mingw32-strip -g
  
  rm -rf usr/i486-mingw32/share/gtk-doc
}
