# Maintainer: Clemens Brunner <clemens dot brunner at tugraz dot at>
pkgname=sigviewer
pkgver=0.5.1
pkgrel=2
pkgdesc="An application to view and annotate biosignals."
arch=('i686' 'x86_64')
url="http://sigviewer.sourceforge.net/"
license=('GPL')
depends=('qt' 'zlib')
makedepends=('unzip')
source=($pkgname-$pkgver.zip::https://sourceforge.net/projects/$pkgname/files/$pkgver/$pkgname-$pkgver-r553-src.zip/download libbiosig.tar.gz::https://sourceforge.net/projects/biosig/files/BioSig%20for%20C_C%2B%2B/src/biosig4c%2B%2B-1.4.2.src.tar.gz/download biosig.patch sigviewer.patch sigviewer.desktop sigviewer128.png)
noextract=($pkgname-$pkgver.zip)
md5sums=('4f374640204a90dac4dd666901b616e6' 'c8128acb44dd9f386d25056fa1186d02' 'c2fde7a052ce89dfdc35c48ff0aa6b66' 'e4f2463bad2b173c4812bb9b0c70c125' '7d088320d5f901f256f5b1d6631e34ae' '238eeb7bb4b3e6d47b3d576aae3060ff')

build() {
  cd $srcdir
  patch biosig4c++-1.4.2/Makefile < biosig.patch
  cd biosig4c++-1.4.2
  make libbiosig.a
  cd ..

  unzip $pkgname-$pkgver.zip
  patch $pkgname-$pkgver-r553-src/src/src.pro < sigviewer.patch
  cp biosig4c++-1.4.2/libbiosig.a $pkgname-$pkgver-r553-src/extern/lib/
  cp biosig4c++-1.4.2/biosig.h $pkgname-$pkgver-r553-src/extern/include/
  cd $pkgname-$pkgver-r553-src
  qmake
  make
}

package() {
    cd "$pkgdir"
    mkdir -p usr/bin
    mkdir -p usr/share/applications
    mkdir -p usr/share/pixmaps
    cp "$srcdir/$pkgname-$pkgver-r553-src/bin/release/sigviewer" "$pkgdir/usr/bin"
    cp "$srcdir/sigviewer.desktop" "$pkgdir/usr/share/applications"
    cp "$srcdir/sigviewer128.png" "$pkgdir/usr/share/pixmaps"
}