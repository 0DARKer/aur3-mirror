--- miniupnpd-1.8.20130426/Makefile.linux.orig	2013-05-01 07:33:25.051541770 -0400
+++ miniupnpd-1.8.20130426/Makefile.linux	2013-05-02 07:38:30.829391963 -0400
@@ -54,6 +54,25 @@ NETFILTEROBJS = netfilter/iptcrdr.o netf
 
 ALLOBJS = $(BASEOBJS) $(LNXOBJS) $(NETFILTEROBJS)
 
+PCFILE_FOUND := $(shell pkg-config --exists libiptc; echo $$?)
+
+ifeq (${PCFILE_FOUND},0)
+
+IPTABLESVERSION := $(shell pkg-config --modversion libiptc)
+IPTABLESVERSION1 := $(shell echo $(IPTABLESVERSION) | cut -d. -f1 )
+IPTABLESVERSION2 := $(shell echo $(IPTABLESVERSION) | cut -d. -f2 )
+IPTABLESVERSION3 := $(shell echo $(IPTABLESVERSION) | cut -d. -f3 )
+# test if iptables version >= 1.4.3
+TEST := $(shell [ \( \( $(IPTABLESVERSION1) -ge 1 \) -a \( $(IPTABLESVERSION2) -ge 4 \) \) -a \( $(IPTABLESVERSION3) -ge 3 \) ] && echo 1 )
+ifeq ($(TEST), 1)
+CFLAGS += -DIPTABLES_143
+endif
+
+CFLAGS += $(shell pkg-config --cflags libiptc)
+LIBS   += $(shell pkg-config --libs libiptc)
+
+else
+
 ifeq "$(wildcard /etc/gentoo-release )" ""
 LIBS ?= -liptc
 else # gentoo
@@ -115,6 +134,7 @@ LIBS := $(LIBS) -lip6tc
 endif # ($(TESTIP6TC), 1)
 endif #Â ($(TEST), 1)
 endif # ifdef IPTABLESPATH
+endif # ifdef PCFILE_FOUND
 
 LIBS += -lnfnetlink
 
--- miniupnpd-1.8.20130426/genconfig.sh.orig	2013-05-02 06:45:23.385864139 -0400
+++ miniupnpd-1.8.20130426/genconfig.sh	2013-05-02 06:51:32.178487229 -0400
@@ -232,6 +232,10 @@ case $OS_NAME in
 				Gentoo)
 					OS_URL=http://www.gentoo.org/
 					;;
+				arch)
+					OS_URL=http://www.archlinux.org
+					OS_VERSION=`uname -r`
+					;;
 			esac
 		fi
 		echo "#define USE_IFACEWATCHER 1" >> ${CONFIGFILE}
