# Maintainer: Jaroslav Lichtblau <dragonlord@aur.archlinux.org>
# Contributor: Christoph Zeiler <archNOSPAM_at_moonblade.dot.org>

pkgname=mudlet
pkgver=1.1.1
pkgrel=1
pkgdesc="A modern MUD client with a graphical user inteface and built in Lua scripting"
arch=('i686' 'x86_64')
url="http://sourceforge.net/projects/mudlet/"
license=('GPL')
depends=('lua' 'qscintilla' 'qt')
makedepends=('cmake')
source=(http://downloads.sourceforge.net/project/$pkgname/$pkgname-$pkgver-src.tar.gz)
md5sums=('0710ec2c9c146633ef8b659a1183b612')

build() {
  cd ${srcdir}/${pkgname}

  cmake -DCMAKE_INSTALL_PREFIX=/usr .
  make || return 1
  make DESTDIR=${pkgdir} install

#remove from bad location
  rm ${pkgdir}/usr/bin/{LuaGlobal.lua,mudlet_documentation.html} || return 1

#copy to correct location
  cp -Rv ${pkgdir}/usr/local/* ${pkgdir}/usr || return 1
  rm -rf ${pkgdir}/usr/local || return 1

#.desktop file and icon
  install -D -m644 ${srcdir}/${pkgname}/${pkgname}.desktop \
    ${pkgdir}/usr/share/applications/${pkgname}.desktop || return 1
  install -D -m644 ${srcdir}/${pkgname}/${pkgname}.png \
    ${pkgdir}/usr/share/pixmaps/${pkgname}.png || return 1
}
