# Contributor: Vitaliy Berdinskikh ur6lad[at]i.ua

pkgname=unixcw
pkgver=2.3
pkgrel=3
pkgdesc="CW tutor and generator program suite"
arch=('i686' 'x86_64')
url="ftp://metalab.unc.edu/pub/Linux/apps/ham/morse/!INDEX.html"
license=('GPL')
depends=('qt3')
makedepends=('pkgconfig')
source=(ftp://metalab.unc.edu/pub/Linux/apps/ham/morse/$pkgname-$pkgver.tgz
        $pkgname $pkgname.desktop $pkgname.png)

build() {
	cd $srcdir/$pkgname-$pkgver
	
	# if ! [ -e /opt/qt/lib/libqt.so ]; then
		# touch $startdir/tada
	# fi
		   
	# mkdir  /tmp/unixcw_qt
	# ln  -s /opt/qt/include     /tmp/unixcw_qt/include
	# ln  -s /opt/qt/bin         /tmp/unixcw_qt/bin
	# ln  -s /opt/qt/lib         /tmp/unixcw_qt/lib
	# export QTDIR=/tmp/unixcw_qt
					 
	./configure --prefix=/usr
					
	sed -i -e "s:lqt:lqt-mt:" $srcdir/$pkgname-$pkgver/src/xcwcp/Makefile
					   
	# make all || return 1
	make || return 1
	make prefix=$pkgdir/usr install
						   
	# rm -r /tmp/unixcw_qt/
							 
	# if [ -e $startdir/tada ]; then
		# mkdir -p $pkgdir/opt/qt/lib &&
		# cd $pkgdir/opt/qt/lib &&
		# ln -sf libqt-mt.so libqt.so &&
		# rm $startdir/tada
	# fi
													 
	cd $pkgdir/usr/man/man1
	ln -sf xcwcp.1.gz unixcw.1.gz
	mkdir -p $pkgdir/usr/share/man
	mv $pkgdir/usr/man $pkgdir/usr/share
															   
	cd $srcdir
	install -D -m755 $pkgname $pkgdir/usr/bin/$pkgname
	install -D -m644 $pkgname.desktop $pkgdir/usr/share/applications/$pkgname.desktop
	install -D -m644 $pkgname.png $pkgdir/usr/share/pixmaps/$pkgname.png
}                                                  
# earlier versions of unixcw MUST BE removed prior to compilation
md5sums=('f02e81ab719caa039c85615331c8860b'
         '3f6168a6c81c550dc78006202f959db3'
         'c910885403df79061793fbceb047ca47'
         'f7f81dcf7a1bba55bf8cde70d59d8ed5')
sha256sums=('124c60c6c7ef596a7c96c94a0e76204c7d986373564121155f0f206ad71f30a0'
            'f23fdc2c7346abd26b8acc8961eff599f08e6905a6cef2b0e402d86c6a9a1714'
            '4c7baa9af46d3cc109fd988614a1b6064e68455a1ab1d58e1ed42d10e3b21161'
            'be1d10724873ae84fec6f580792e5ce9fe2dbfc3e75e2bde14f6893391a63ff1')
