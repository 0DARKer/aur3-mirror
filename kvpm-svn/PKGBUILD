# Maintainer: laloch <laloch@atlas.cz>
pkgname=kvpm-svn
pkgver=553
pkgrel=1
pkgdesc='KDE Volume and Partition Manager'
url='http://kvpm.sourceforge.net'
arch=('i686' 'x86_64')
license=('GPL3')
depends=('util-linux-ng' 'parted' 'kdelibs' 'kdebase-runtime' 'lvm2>=2.02.73' 'udev')
makedepends=('cmake' 'automoc4')
conflicts=('kvpm')
provides=('kvpm')
source=()
md5sums=()

_svntrunk='https://kvpm.svn.sourceforge.net/svnroot/kvpm/trunk/kvpm'
_svnmod='kvpm'

build() {
  cd ${srcdir}

  if [ -d ${_svnmod} ]; then
    (cd ${_svnmod} && svn up -r ${pkgver})
  else
    svn co ${_svntrunk} -r ${pkgver} ${_svnmod}
  fi

  msg 'SVN checkout done or server timeout'
  msg 'Starting make...'

  cd ${_svnmod}
  cmake \
    -DCMAKE_INSTALL_PREFIX=`kde4-config --prefix` \
    -DCMAKE_BUILD_TYPE=Release
  make || return 1
  make DESTDIR=${pkgdir} install || return 1
}
