# Maintainer: Dan Serban

pkgname=dupeguru-se-bin
pkgver=3.1.0
pkgrel=2
pkgdesc="Find duplicate files on your computer"
arch=(i686 x86_64)
url=http://www.hardcoded.net/dupeguru/
license=(custom:Fairware)
depends=(python pyqt sip) # Python 3 !!!
_filearch="i386"
[ "$CARCH" == "x86_64" ] && _filearch="amd64"
source=("http://download.hardcoded.net/dupeguru-se_${pkgver}_${_filearch}.deb")
_32bit_md5sum="ef80cb23ca19f257214bd5bb7b774d5e"
_64bit_md5sum="25c94e8b376e871e3424a94bc8fa545a"
md5sums=${_32bit_md5sum}
[ "$CARCH" == "x86_64" ] && md5sums=${_64bit_md5sum}

build()
{
  ar -xv "dupeguru-se_${pkgver}_${_filearch}.deb"
  bsdtar -xvf data.tar.gz
  rm usr/local/share/dupeguru_se/sip.so
  cd usr/local/share/dupeguru_se
  rm -rf PyQt4
  mkdir -p "$pkgdir/usr/bin"
  cd "$srcdir/usr"
  mv share "$pkgdir/usr/"
  cd local/share
  mv dupeguru_se "$pkgdir/usr/share/"
  sed -i 's|#!/usr/bin/env python3.1|#!/usr/bin/python|' "$pkgdir/usr/share/dupeguru_se/run.py"
  USRBINFILE="$pkgdir/usr/bin/dupeguru_se"
  echo "#!/bin/bash" > "$USRBINFILE"
  echo "cd /usr/share/dupeguru_se" >> "$USRBINFILE"
  echo "python run.py" >> "$USRBINFILE"
  chmod +x "$USRBINFILE"
}
