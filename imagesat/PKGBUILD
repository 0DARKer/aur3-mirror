# Maintainer: Chipster Julien <julien dot chipster @ archlinux dot fr>
pkgname=imagesat
url="https://github.com/Chipsterjulien/imagesat"
pkgver=0.3
pkgrel=6
pkgdesc="Daemon that can download satellite images"
arch=('any')
license=('GPL')
depends=(python python3-imaging python-requests python-yaml)
source=($pkgname-$pkgver.tar.gz)
md5sums=('2cbf2b7560645e60501f7f03e01f2f0d')
install=imagesat.install

build()
{
 echo "nothing to do"
 # nothing to do
}
package()
{
  # Create directories
	
  cd "$srcdir/$pkgname-$pkgver"
  mkdir -p "$pkgdir/etc"
  mkdir -p "$pkgdir/usr/bin"
  mkdir -p "$pkgdir/usr/lib/systemd/system"
  mkdir -p "$pkgdir/var/log/imagesat"
  
  # Create group and imagesat user
  
  getent group imagesat &>/dev/null || groupadd -r -g 464 imagesat >/dev/null
  getent passwd imagesat &>/dev/null || useradd -r -u 464 -g imagesat -d /tmp -s /bin/bash >/dev/null imagesat
  
  # Copy
  
  cp -a imagesat.py "$pkgdir/usr/bin/imagesat"
  cp -a imagesat_example.conf "$pkgdir/etc"
  cp -a system_d "$pkgdir/usr/lib/systemd/system/imagesat.service"

  # Fixing right
  
  chmod 644 "$pkgdir/etc/imagesat_example.conf"
  chmod 755 "$pkgdir/var/log/imagesat"
  chmod 755 "$pkgdir/usr/bin/imagesat"
}
