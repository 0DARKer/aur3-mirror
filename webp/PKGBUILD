# Maintainer: Jakub Schmidtke <sjakub-at-gmail.com>

pkgname=webp
pkgver=0.0.5
pkgrel=1
pkgdesc="WebP - a method of lossy compression that can be used on photographic images"
arch=('i686' 'x86_64')
url="http://code.google.com/p/webp"
license=('unknown')
depends=('libvpx' 'libjpeg' 'libpng')
makedepends=('make' 'gcc')
source=(http://webp.googlecode.com/files/webp-leptonica-${pkgver}.tar.gz)
md5sums=('da695d17be466156825b6ee799136042')

build() {
  cd "${srcdir}/webp/leptonlib-1.066"
  ./configure --prefix /usr 
  make || return 1
  cd "${srcdir}/webp/libwebp/"
  ./configure --prefix /usr
  sed -i "s|-L/usr/local/lib|-L${srcdir}/webp/leptonlib-1.066/src|" src/Makefile
  sed -i "s|-I\${includedir}/liblept|-I${srcdir}/webp/leptonlib-1.066/src|" src/Makefile
  sed -i 's|-llept -ljpeg|-llept -lgif -ljpeg|' src/Makefile

  make || return 1
}

package() {
  mkdir -p "${pkgdir}/usr/bin"
  rm -f "${pkgdir}/usr/bin/webpconv"
  cp "${srcdir}/webp/libwebp/src/webpconv" "${pkgdir}/usr/bin/"
}

# vim:set ts=2 sw=2 et:
