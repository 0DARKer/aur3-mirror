# Maintainer: Dan Serban

pkgname=audio-recorder-from-deb
pkgver=0.4.4
pkgrel=5
pkgdesc="Record audio from your soundcard and microphone"
arch=(i686 x86_64)
url=https://launchpad.net/audio-recorder
license=(GPLv3)
depends=(dbus-core glib2 glibc atk cairo dbus-glib fontconfig freetype2 gconf gdk-pixbuf2 gnome-media gstreamer0.10 gstreamer0.10-base gstreamer0.10-base-plugins gstreamer0.10-good-plugins gstreamer0.10-bad-plugins gstreamer0.10-ugly-plugins gtk2 libpng12 libpulse libxml2 pango)
conflicts=('audio-recorder-bzr')
provides=('audio-recorder')
_filearch=i386
[ "${CARCH}" = "x86_64" ] && _filearch=amd64
_audio_recorder_deb_ver=natty
_libappindicator1_pkg_ver=0.3.0
_libappindicator1_deb_ver=0ubuntu1
_libindicator3_pkg_ver=0.3.22
_libindicator3_deb_ver=0ubuntu1
_libdbusmenu_glib3_pkg_ver=0.4.3
_libdbusmenu_glib3_deb_ver=0ubuntu3
_libdbusmenu_gtk3_pkg_ver=0.4.3
_libdbusmenu_gtk3_deb_ver=0ubuntu3
_libgnome_media0_pkg_ver=2.32.0
_libgnome_media0_deb_ver=0ubuntu7

build()
{
  wget "http://ppa.launchpad.net/osmoma/audio-recorder/ubuntu/pool/main/a/audio-recorder/audio-recorder_${pkgver}~${_audio_recorder_deb_ver}_${_filearch}.deb"
  wget "http://archive.ubuntu.com/ubuntu/pool/main/liba/libappindicator/libappindicator1_${_libappindicator1_pkg_ver}-${_libappindicator1_deb_ver}_${_filearch}.deb"
  wget "http://archive.ubuntu.com/ubuntu/pool/main/libi/libindicator/libindicator3_${_libindicator3_pkg_ver}-${_libindicator3_deb_ver}_${_filearch}.deb"
  wget "http://archive.ubuntu.com/ubuntu/pool/main/libd/libdbusmenu/libdbusmenu-glib3_${_libdbusmenu_glib3_pkg_ver}-${_libdbusmenu_glib3_deb_ver}_${_filearch}.deb"
  wget "http://archive.ubuntu.com/ubuntu/pool/main/libd/libdbusmenu/libdbusmenu-gtk3_${_libdbusmenu_gtk3_pkg_ver}-${_libdbusmenu_gtk3_deb_ver}_${_filearch}.deb"
  wget "http://archive.ubuntu.com/ubuntu/pool/main/g/gnome-media/libgnome-media0_${_libgnome_media0_pkg_ver}-${_libgnome_media0_deb_ver}_${_filearch}.deb"
  cd "${pkgdir}"
  bsdtar -xvf "${srcdir}/audio-recorder_${pkgver}~${_audio_recorder_deb_ver}_${_filearch}.deb" data.tar.gz
  bsdtar -xvf data.tar.gz
  rm data.tar.gz
  bsdtar -xvf "${srcdir}/libappindicator1_${_libappindicator1_pkg_ver}-${_libappindicator1_deb_ver}_${_filearch}.deb" data.tar.gz
  bsdtar -xvf data.tar.gz usr/lib/libappindicator.so.1.0.0
  rm data.tar.gz
  bsdtar -xvf "${srcdir}/libindicator3_${_libindicator3_pkg_ver}-${_libindicator3_deb_ver}_${_filearch}.deb" data.tar.gz
  bsdtar -xvf data.tar.gz usr/lib/libindicator.so.3.0.0
  rm data.tar.gz
  bsdtar -xvf "${srcdir}/libdbusmenu-glib3_${_libdbusmenu_glib3_pkg_ver}-${_libdbusmenu_glib3_deb_ver}_${_filearch}.deb" data.tar.gz
  bsdtar -xvf data.tar.gz usr/lib/libdbusmenu-glib.so.3.0.14
  rm data.tar.gz
  bsdtar -xvf "${srcdir}/libdbusmenu-gtk3_${_libdbusmenu_gtk3_pkg_ver}-${_libdbusmenu_gtk3_deb_ver}_${_filearch}.deb" data.tar.gz
  bsdtar -xvf data.tar.gz usr/lib/libdbusmenu-gtk.so.3.0.14
  rm data.tar.gz
  bsdtar -xvf "${srcdir}/libgnome-media0_${_libgnome_media0_pkg_ver}-${_libgnome_media0_deb_ver}_${_filearch}.deb" data.tar.gz
  bsdtar -xvf data.tar.gz usr/lib/libgnome-media-profiles.so.0.0.0
  rm data.tar.gz
  cd usr/lib
  mv libappindicator.so.1.0.0 libappindicator.so.1
  mv libindicator.so.3.0.0 libindicator.so.3
  mv libdbusmenu-glib.so.3.0.14 libdbusmenu-glib.so.3
  mv libdbusmenu-gtk.so.3.0.14 libdbusmenu-gtk.so.3
  mv libgnome-media-profiles.so.0.0.0 libgnome-media-profiles.so.0
}
