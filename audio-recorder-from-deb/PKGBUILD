# Maintainer: Dan Serban

pkgname=audio-recorder-from-deb
pkgver=0.4.4
pkgrel=2
pkgdesc="Record audio from your soundcard and microphone"
arch=(i686 x86_64)
url=https://launchpad.net/audio-recorder
license=(GPLv3)
depends=(dbus-core glib2 glibc atk cairo dbus-glib fontconfig freetype2 gconf gdk-pixbuf2 gnome-media gstreamer0.10 gstreamer0.10-base gstreamer0.10-base-plugins gstreamer0.10-good-plugins gstreamer0.10-bad-plugins gstreamer0.10-ugly-plugins gtk2 libpng12 libpulse libxml2 pango pulseaudio pulseaudio-alsa)
conflicts=('audio-recorder-bzr')
_filearch=i386
[ "${CARCH}" == "x86_64" ] && _filearch=amd64
_libgnome_media0_ubu_ver=2.32.0-0ubuntu7
_audio_recorder_ubu_ver=0.4.4~maverick

build()
{
  # --- libgnome-media0 ---
  _url_prefix="http://archive.ubuntu.com/ubuntu/pool/main"
  _file="libgnome-media0_${_libgnome_media0_ubu_ver}_${_filearch}.deb"
  wget "${_url_prefix}/g/gnome-media/${_file}"
  bsdtar -xf "${_file}" data.tar.gz
  bsdtar -xf data.tar.gz usr/lib/libgnome-media-profiles.so.0.0.0
  rm data.tar.gz
  mv usr/lib/libgnome-media-profiles.so.0.0.0 usr/lib/libgnome-media-profiles.so.0

  # --- audio-recorder ---
  _url_prefix="http://ppa.launchpad.net/osmoma/audio-recorder/ubuntu/pool/main"
  _file="audio-recorder_${_audio_recorder_ubu_ver}_${_filearch}.deb"
  wget "${_url_prefix}/a/audio-recorder/${_file}"
  bsdtar -xf "${_file}" data.tar.gz
  bsdtar -xf data.tar.gz
  rm data.tar.gz
}

package()
{
  mv usr "${pkgdir}"/
}

