# Maintainer: Yannic Arnoux <kianby@gmail.com>

pkgname=chive
pkgver=1.2
pkgrel=3
pkgdesc="Chive is a next generation MySQL database management tool. It aims to be an alternative to phpMyAdmin."
arch=('any')
license=('GPL')
depends=('php')
url="http://www.chive-project.com/"
source=("https://launchpad.net/chive/1.1/1.2/+download/chive_1.2.tar.gz")
noextract=(chive_1.2.tar.gz)
 
sha512sums=('9e24a9d253fb6070d313fa14a0d075e29c938c06ca12a47f704475618b36ad35f46d38e24a91009137702af48726403e94a5e3e9486e83ffc83b252f64405853')

package() {
  mkdir -p $srcdir/chive
  cd $srcdir/chive
  bsdtar xf ../../chive_1.2.tar.gz || return $?
  mkdir -p $pkgdir/usr/share/webapps
  mkdir -p $pkgdir/etc/webapps/chive

  # Apache configuration
  cat > $pkgdir/etc/webapps/chive/apache.example.conf <<EOF
  <VirtualHost *:80>
    DocumentRoot "/usr/share/webapps"
    ServerAdmin root@localhost
    ErrorLog "/var/log/httpd/127.0.0.1-error_log"
    CustomLog "/var/log/httpd/127.0.0.1-access_log" common
    <Directory /usr/share/webapps/chive>
	AllowOverride All
	Options FollowSymlinks
	Order allow,deny
	Allow from all
	php_admin_value open_basedir "/srv/:/tmp/:/usr/share/webapps/:/etc/webapps:/usr/share/pear/"
    </Directory>
  </VirtualHost>
EOF

  mv chive $pkgdir/usr/share/webapps/.
}

