# Maintainer: Manalishi <manalishi at freenet dot de>
# Contributor: Hervé Cauwelier <herve ¤ oursours.net>
pkgname=plowshare-svn
_pkgname="${pkgname%-*}"
pkgver=1347
pkgrel=2
pkgdesc="A command-line downloader/uploader for file-sharing websites"
arch=('any')
url="http://code.google.com/p/plowshare/"
license=('GPL3')
makedepends=('subversion')
depends=('bash' 'curl' 'recode' 'imagemagick' 'tesseract' 'spidermonkey')
optdepends=('aview')
provides=("${_pkgname}")
conflicts=("${_pkgname}")

_svnmod="${_pkgname}"
_svntrunk="http://plowshare.googlecode.com/svn/trunk"

build() {
  cd "${srcdir}/"

  if [ -d "${_svnmod}" ]; then
    msg "Updating local SVN repository."
    (cd "${_svnmod}" && svn up)
    msg "SVN update done or server timeout."
  else
    msg "Checking out SVN repository."
    svn co "${_svntrunk}" "${_svnmod}"
    msg "SVN checkout done or server timeout."
  fi

  msg "Starting make process."

  rm -rf "${_svnmod}-build/"
  cp -r "${_svnmod}" "${_svnmod}-build/"
}

package()
{
  cd "${srcdir}/${_svnmod}-build"
  DESTDIR="${pkgdir}" PREFIX=/usr bash setup.sh install || return 1
}
