# Maintainer: Luis Sarmiento <lgsarmientop@unal.edu.co>

pkgname=upak
pkgver=10.6.8
pkgrel=1
pkgdesc="HRIBF Data Acquisition and analysis."
url="http://www.phy.ornl.gov/local/computer/daq/daqsupport.shtml"
arch=('x86_64')
license=('unknown')
depends=('libx11' 'gcc-libs-multilib')
optdepends=()
makedepends=('gcc-fortran>=4.2')
conflicts=()
replaces=()
backup=()
install=''
source=("ftp://ftp.phy.ornl.gov/pub/${pkgname}/${pkgname}-src.tgz"
	"Makefile_64bits_intel.patch"
	"signal.patch")
md5sums=('ec781ebb093a50edd19618ad041f926e'
         '49f2694e9fa8e2970daf884477bde72f'
         '0ec4685767e7f7a98e2d798331f3f7fe')

build() {
##tamper with the code
	 cd "${srcdir}/${pkgname}"
	 patch -Np2 < ${srcdir}/Makefile_64bits_intel.patch
	 
	 cd "${srcdir}/${pkgname}/Dscanorlib"
	 patch -Np3 < ${srcdir}/signal.patch

##compile
        INSTALL_DIRECTORY=${pkgdir}/usr/bin
        mkdir -p ${INSTALL_DIRECTORY}
	cd "${srcdir}/${pkgname}"
	make clean
	make INSTALL_DIR=${INSTALL_DIRECTORY} all
}

package() {
	  DOCDIR=/usr/share/doc/${pkgname}
          [ -d ${pkgdir}${DOCDIR} ] || install -dm755 ${pkgdir}${DOCDIR}
	  cd "${srcdir}/${pkgname}"
	  install -m644 Dreadme/*.doc   ${pkgdir}${DOCDIR}
	  install -m644 Dreadme/README-Apr07   ${pkgdir}${DOCDIR}
	  install -m644 Dreadme/readme.tex    ${pkgdir}${DOCDIR}/readme.txt 
	  install -m644 Dreadme/dvd.tex    ${pkgdir}${DOCDIR}/dvd.txt 
}
