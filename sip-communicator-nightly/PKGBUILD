# SIP-Communicator: Installer: Arch
# Contributor: Xavion <Xavion (dot) 0 (at) Gmail (dot) com>
# Contributor: atommix aka Aleks Lifey <Aleks.Lifey@gmail.com>


realname=sip-communicator
pkgname=${realname}-nightly
relver=1.0
devver=alpha3
buildver=2743
pkgver=${relver}.${devver}.${buildver}
pkgrel=1
pkgdesc="An audio/video SIP VoIP phone and instant messenger written in Java"
arch=("i686" "x86_64")
url="http://www.${realname}.org/"
license=("GPL")
provides=("${realname}")
depends=("java-runtime")
makedepends=("apache-ant")
conflicts=("${realname}" "${realname}-svn")
options=(!emptydirs)
source=(http://${realname}.org/download/nightly-builds/src/${realname}-src-${relver}-${devver}-nightly.build.${buildver}.zip)

build() {
	cd ${srcdir}/${realname}

	# Build
	/usr/share/java/apache-ant/bin/ant rebuild || return 1

	install -D ${srcdir}/${realname}/resources/install/debian/${realname}.sh.tmpl $pkgdir/usr/bin/${realname} || return 1
	install -Dd ${srcdir}/${realname}/lib/bundle $pkgdir/usr/lib/${realname}/lib/bundle || return 1
	install -D ${srcdir}/${realname}/lib/bundle/*.* $pkgdir/usr/lib/${realname}/lib/bundle/ || return 1
	install -D ${srcdir}/${realname}/lib/*.* $pkgdir/usr/lib/${realname}/lib/ || return 1
	install -Dd ${srcdir}/${realname}/lib/native $pkgdir/usr/lib/${realname}/lib/native || return 1

	if [[ `uname -m` = "x86_64" ]]; then
		install -D ${srcdir}/${realname}/lib/native/linux-64/*.* $pkgdir/usr/lib/${realname}/lib/native/
	else
		install -D ${srcdir}/${realname}/lib/native/linux/*.* $pkgdir/usr/lib/${realname}/lib/native/
	fi

	install -Dd ${srcdir}/${realname}/sc-bundles $pkgdir/usr/lib/${realname}/sc-bundles || return 1
	install -D ${srcdir}/${realname}/sc-bundles/*.* $pkgdir/usr/lib/${realname}/sc-bundles/ || return 1
	install -D ${srcdir}/${realname}/lib/os-specific/linux/jdic_stub.jar $pkgdir/usr/lib/${realname}/lib/ || return 1
	cp -r ${srcdir}/${realname}/sc-bundles/os-specific/linux/ $pkgdir/usr/lib/${realname}/sc-bundles/ || return 1

	mkdir -p $pkgdir/usr/share/pixmaps
	cp ${srcdir}/${realname}/resources/install/debian/${realname}.svg $pkgdir/usr/share/pixmaps/${realname}.svg

	cp ${srcdir}/${realname}/resources/install/debian/${realname}-16.xpm $pkgdir/usr/share/pixmaps/${realname}-16.xpm

	cp ${srcdir}/${realname}/resources/install/debian/${realname}-32.xpm $pkgdir/usr/share/pixmaps/${realname}-32.svg

	mkdir -p $pkgdir/usr/share/applications
	cp ${srcdir}/${realname}/resources/install/debian/${realname}.desktop $pkgdir/usr/share/applications/

	#rm -rf ${srcdir}/${realname}
}

sha1sums=('709b350025b1632836a9209ddd8b197dd46790d2')
