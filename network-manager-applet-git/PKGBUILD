# Contributor: kasa <biuta.jr@gmail.com>

pkgname=network-manager-applet-git
pkgver=20110105
pkgrel=1
pkgdesc="GNOME frontends to NetWorkmanager"
arch=(i686 x86_64)
license=('GPL')
url="http://www.gnome.org/projects/NetworkManager/"
makedepends=('git' 'pkgconfig' 'perlxml')
depends=('gtk3' 'networkmanager-git' 'libglade' 'gnome-keyring' 'polkit-gnome' 'notification-daemon' 'libnotify' 'hicolor-icon-theme')
provides=('network-manager-applet=0.8.2')
conflicts=('network-manager-applet-svn' 'network-manager-applet')
options=('!libtool')
install=network-manager-applet.install
source=()
md5sums=()

_gitroot="git://git.gnome.org/network-manager-applet"
_gitname="network-manager-applet"

build() {
  cd ${srcdir}
  
  msg "Connecting to git.gnome.org GIT server...."

  if [ -d ${srcdir}/$_gitname ] ; then
	  cd $_gitname && git pull origin
	  msg "The local files are updated."
  else
	  git clone $_gitroot
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  cp -r ${srcdir}/$_gitname ${srcdir}/$_gitname-build
  cd ${srcdir}/$_gitname-build
 
  ./autogen.sh --prefix=/usr --sysconfdir=/etc \
              --localstatedir=/var || return 1
  make || return 1
  make DESTDIR="${pkgdir}" install || return 1

  rm -fr ${srcdir}/${_gitname}-build
}
