#Maintainer: Pietro Bonfa' <bonfus ( at ) gmail.com>
 
pkgname=gdis-cvs
pkgver=20110524 
pkgrel=1
pkgdesc="GDIS is a scientific visualization program for the display, manipulation, and analysis of isolated molecules and periodic structures."
arch=('i686' 'x86_64')
url="http://gdis.sourceforge.net/"
license=('GPL')
provides=('gdis')
conflicts=('gdis')
depends=('gtk2' 'gtkglext')
options=('!libtool')
makedepends=('cvs' 'perl')
source=('makefile' 'gdis.sh')
md5sums=('75672b1f8aab349a12dcc8bd257e8722'
         '2cfe2282636b18174688c5ad2b428385')

_cvsroot=":pserver:anonymous@gdis.cvs.sourceforge.net:/cvsroot/gdis"
_cvsmod="gdis"

build() {
  cd "$srcdir"
  msg "Connecting to $_cvsmod.sourceforge.net CVS server...."
  if [ -d $_cvsmod/CVS ]; then
    cd $_cvsmod
    cvs -z3 update -d
  else
    cvs -z3 -d $_cvsroot co -D $pkgver -f $_cvsmod
    cd $_cvsmod
  fi

  msg "CVS checkout done or server timeout"
  msg "Starting make..."

  rm -rf "$srcdir/$_cvsmod-build"
  cp -r "$srcdir/$_cvsmod" "$srcdir/$_cvsmod-build"
  cp "$srcdir/makefile" "$srcdir/$_cvsmod-build"
  cd "$srcdir/$_cvsmod-build"
  

  make || return 1
  
  mkdir -p $pkgdir/opt/gdis
  mkdir -p $pkgdir/usr/bin
  
  cp gdis $pkgdir/opt/gdis
  cp gdis.elements $pkgdir/opt/gdis
  cp gdis.library $pkgdir/opt/gdis
  cp gdis.manual $pkgdir/opt/gdis
  
  cp $srcdir/gdis.sh $pkgdir/usr/bin/gdis
}
