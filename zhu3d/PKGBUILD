pkgname=zhu3d
pkgver=4.2.2
pkgrel=1
pkgdesc="View, animate, and solve up to three functions in 3D-space in an interactive manner"
arch=('i686' 'x86_64')
url="http://www.kde-apps.org/content/show.php?content=43071"
license=('GPL3')
depends=('libgl' 'qt>=4.4.0')
options=('docs')
source=(http://downloads.sourceforge.net/sourceforge/zhu3d/zhu3d-$pkgver.tar.gz \
        zhu3d.desktop)

build() {
  cd $srcdir/$pkgname-$pkgver/
  # Redefine the locations of the default directories
  sed -e 's|SYSDIR=|SYSDIR=/usr/share/zhu3d/system|g; s|DOCDIR=|DOCDIR=/usr/share/zhu3d/doc|g' \
      -e 's|WORKDIR=|WORKDIR=/usr/share/zhu3d/work|g; s|TEXDIR=|TEXDIR=/usr/share/zhu3d/work/textures|g' \
      -i zhu3d.pri

  /usr/bin/qmake
  make || return 1

  # Install data files
  mkdir -p $pkgdir/usr/share/zhu3d
  mv {system,work,doc} $pkgdir/usr/share/zhu3d/

  # Install binary
  install -D -m755 zhu3d $pkgdir/usr/bin/zhu3d

  # Install shortcut
  install -D -m644 ../zhu3d.desktop $pkgdir/usr/share/applications/zhu3d.desktop

  # Fix file permissions
  find $pkgdir/usr/share/zhu3d -type f -exec chmod 644 "{}" +
}

md5sums=('a37c23ea8b548f05f342486f711e45ba'
         'a777070dc97958071cd4e9917397f13e')
