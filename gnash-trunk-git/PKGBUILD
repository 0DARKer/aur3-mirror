# Contributor: Carlos Sanchez <cargabsj175@vegnux.org.ve>
# Maintainer for Parabola GNU/Linux: Omar Botta <omarbotta@gnulinuxlibre.net>
# Contributor: Frederic Bezies <fredbezies@gmail.com>
#
# Based on work made by Carlos Sanchez
#
pkgname=gnash-trunk-git
pkgver=20110126
pkgrel=1
pkgdesc="Gnash is the GNU SWF Player based on GameSWF. Development version based on git"
arch=('i686' 'x86_64')
url="http://www.gnu.org/software/gnash/"
license=('GPLv3+')
makedepends=('git' 'automake' 'autoconf' 'gettext' 'libtool')
depends=('agg' 'atk' 'libxml2' 'curl' 'ffmpeg' 'boost' 'pango' 'libxi' 'gstreamer0.10' 'gstreamer0.10-base' 'gstreamer0.10-ffmpeg' 'gstreamer0.10-base-plugins' 'gstreamer0.10-good-plugins' 'gstreamer0.10-bad-plugins' 'gstreamer0.10-ugly-plugins')
provides=(gnash-common gnash-gtk)
conflicts=(gnash-common gnash-gtk gnash-trunk-bzr)
replaces=(gnash-common gnash-gtk)
#md5sums=('8fdf50aaf01d00ccd9d5aed84abe25ca')

_gitroot='git://git.sv.gnu.org/gnash.git'
_gitname='gnash'

build() {
	cd ${srcdir}

	msg 'Connecting to GIT server...'

	if [ -d ${_gitname} ]; then
		rm -rf ${_gitname}
	fi
  git clone --depth 1 ${_gitroot}

	msg 'GIT checkout done or server timeout.'

  cd ${_gitname}
  
	msg 'Generating necessary files...'

chmod +x autogen.sh
./autogen.sh
./configure --prefix=/usr \
--enable-renderer=agg \
--enable-gui=gtk \
--enable-sound=sdl \
--enable-media=gst \
--with-plugindir=/usr/lib/mozilla/plugins \
--disable-kparts3 \
--disable-kparts4 \
--disable-cygnal || return 1

make || return 1

make DESTDIR="$pkgdir" install || return 1
make DESTDIR="$pkgdir" install-plugins || return 1
}
