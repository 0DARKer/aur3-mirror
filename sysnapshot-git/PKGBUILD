# Maintainer: Sandy Marko Knauer <knamarksan@gmail.com>

pkgname=sysnapshot-git
pkgver=0.0.1.66.g422ac94
_pkgver=0.0.1
pkgrel=1
pkgdesc='backup tool written in ruby'
arch=('any')
license=('GPL2')
url='http://knasan.wordpress.com/'
makedepends=('git')
provides=('sysnapshot')
source=('git://github.com/knasan/sysnapshot.git')
depends=('ruby')
optdepends=('rsync')
sha256sums=('SKIP')
_gitname='sysnapshot'

pkgver() {
  cd "$srcdir/$_gitname"
  echo "$_pkgver.$(git rev-list --count HEAD).g$(git describe --always)"
}

package() {
  cd "$srcdir/$_gitname"

  mkdir -p "$pkgdir/usr/bin/"
  mkdir -p "$pkgdir/usr/lib/sysnapshot"
  mkdir -p "$pkgdir/etc/sysnapshot/"

  install -m754 bin/sysnapshot "$pkgdir/usr/bin/"
  install -m644 lib/sysnapshot/*.rb "$pkgdir/usr/lib/sysnapshot"
  install -m644 etc/sysnapshot/sysnapshot.* "$pkgdir/etc/sysnapshot/"
}

