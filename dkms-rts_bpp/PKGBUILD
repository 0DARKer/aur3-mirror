# Maintainer: coudu <coudu@wanadoo.fr>

pkgname=dkms-rts_bpp
_pkgname=rts_bpp
pkgver=1.1
pkgrel=4
pkgdesc="A kernel module for Realtek Card Reader RTL8411 Device 5289, dkms version"
url="http://www.realtek.com.tw"
license=("GPL")
arch=('i686' 'x86_64')
provides=('rts_bpp')
conflicts=('rts_bpp')
depends=('dkms')
source=("https://bugs.launchpad.net/ubuntu/+source/udisks/+bug/971876/+attachment/2991730/+files/${_pkgname}.tar.bz2" 'remove_bad_target_lun_message.patch' 'dkms.conf.in' "81-udisks-udisks2-${_pkgname}.rules")
md5sums=('85990e67ce6a10ae501ffeab4cb0b813'
         '0e5279887fb5a39e4bca3f32974547fc'
         '56d2fb0184d7eb17cec3d553b870d185'
         'de474149395ced22085c33325ae078c2')
install=${pkgname}.install

build() {
	cd ${srcdir}/${_pkgname}
	patch -i ../remove_bad_target_lun_message.patch
}

package() {
	install -dm755 "${pkgdir}/usr/lib/udev/rules.d/"
        install -D -m644 ${srcdir}/81-udisks-udisks2-${_pkgname}.rules "${pkgdir}/usr/lib/udev/rules.d/"
        install -dm755 "${pkgdir}/usr/src/${_pkgname}-${pkgver}/"
        cp -a ${srcdir}/${_pkgname}/*  ${pkgdir}/usr/src/${_pkgname}-${pkgver}
        sed "s/#MODULE_VERSION#/${pkgver}/" "${srcdir}/dkms.conf.in" > "${pkgdir}/usr/src/${_pkgname}-${pkgver}/dkms.conf"
}

