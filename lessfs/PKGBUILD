# Maintainer:  Hubert Kario <kario@wit.edu.pl>

pkgname=lessfs
pkgver=1.3.3.9
pkgrel=2
pkgdesc="High performance inline data deduplicating file system for FUSE"
arch=('i686' 'x86_64')
license=('GPL')
url="http://www.lessfs.com/"

makedepends=('gcc' 'make' 'fuse' 'tokyocabinet' 'mhash' 'openssl')
depends=('tokyocabinet' 'mhash' 'openssl')
optdepends=('hamsterdb: alternative database to tokyo cabinet')
#conflicts=("$_pkgname")
#provides=("$_pkgname=$pkgver")

source=(http://sourceforge.net/projects/lessfs/files/lessfs/lessfs-$pkgver/lessfs-$pkgver.tar.gz/download)
sha1sums=('d17857820b2cdb45701c869ecfee0218e012b69c')

build() {
	cd "$pkgname-$pkgver"
	./configure --with-crypto --prefix=/usr || return 1
	make || return 1
	make prefix="$pkgdir/usr" install || return 1
        mkdir -p "$pkgdir/etc/lessfs"
        install -m 644 -D etc/lessfs.cfg-hamsterdb $pkgdir/etc/lessfs/sample.cfg-hamsterdb
        install -m 644 -D etc/lessfs.cfg-tokyocabinet $pkgdir/etc/lessfs/sample.cfg-tokyocabinet
        install -m 644 -D etc/lessfs.cfg $pkgdir/etc/lessfs/sample.cfg
        mkdir -p "$pkgdir/usr/share/doc/lessfs"
        install -m 644 -D FAQ README README.replication README.file_io README.crypto README.performance_or_suffer ChangeLog "$pkgdir/usr/share/doc/lessfs"
}
