# Maintainer: Kosta Welke <kosta@fillibach.de>
# I wrote this PKGBUILD as it's needed by forked-daapd, I could not find the 
# original url (domain seems abandoned). But it's mirrored by forked-daapd,
# so I put that as the url.
pkgname=forked-daapd
pkgver=0.12
pkgrel=1
pkgdesc="forked-daapd is an iTunes-compatible media server, originally intended as a rewrite of Firefly Media Server (mt-daapd)."
arch=('i686' 'x86_64')
url="http://www.jblache.org/projects/daapd/"
license=('GPL')
groups=()
depends=(pkg-config avahi sqlite3 ffmpeg confuse libevent mxml libgcrypt zlib libunistring flac taglib libplist libantlr3c libavl-for-forked-daapd)
makedepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=(etc/forked-daapd.conf etc/avahi/services/forked-daapd.service)
options=()
install=forked-daapd.install
changelog=
source=(http://alioth.debian.org/~jblache/forked-daapd/$pkgname-$pkgver.tar.gz forked-daapd.install forked-daapd forked-daapd.service)
noextract=()
md5sums=('0e826b11d3036f5bf02b82c21b71ef7d'
         '9c8bf7589119045c20e951ab56d3e3b8'
         '04bfd583f7cd73c9c3fd166c3bc49cf6'
         'c01fde6f40880fed6092c0830a5f232e')
sha1sums=('b5b6827b38f356b3b081b5b408cbdc919a5ae49c'
          'a21a31d23469c36b3001e4ba3c8cedfb1ec97c9a'
          'e0f42d8e98d3395a72b3b2b42b04aab84200e84a'
          'a6f3c5ee05365481caaa569fe15ca34ffe4dc847')
sha256sums=('54e4a445b80647973f99fc1ba1db1ec2090b0116951a8c8d434b1e7d4514b8ea'
            '963afb3c79468f718cfe0e93c9b6fe365df918d1a3bc7faa36bec8c1c6496f1c'
            'b5b5cbb5108b00ee1db63cd580c010862d48c50c24324035ee242e21b4b3e9b8'
            '0efc8aac56d2b3a70d74c90a72595f3b685a30ee94a278880cd0cc4db35fa113')
sha384sums=('c109319e58a674b5b6a97d58abd21359109824ad08b62dda9d74acac952305faa2a4e4742cdaeeb50aeecf3737ac4a4c'
            '673f62a43d3c200d00bf832a801d895ee8a023ffbff9f59cc4aa8a1a5ffa70addd68b2be90db0807b15708380d198111'
            'f3c28005de6a67917d0054a12352fe03b15774275994c6ee2f3d37d727fc207785e27a068d68a5e031400f5fb4540304'
            '36bdb6cfc389572f7f34658307b68f31d79ba9a5827eeee60c43f042f3d75d90c9d76e90840258e57e59c5c4d8d47d52')
sha512sums=('d6ed0727ffd7e2a041a9b0b008cfb0fc4506b335a11ab79afb0c3397601365ca4b98579b7e6b54e2ca5b254defc36cd7a7726fe40a127a0c605ce2e15e591e10'
            '25b631071001ce726dfc4684bd5c7e8c8fcfddf952de139b8277ce2cbdd49d3f4a6b8d2f22e68674849ff4bb3cd345402e64c86423d4dfca595478eb46076f19'
            '068e6768be3e83e046566948f226d6e27521a98d32861e8ee4a8c7eea7dac03c267eff8934db03690f4bf8eabd1c4609b2424cad8e147e80c08f07f8fd74c5a1'
            '70da9a199ac821736ea6cd33455c14cf32ab5bc4b401dc31179dc6029c36fcb543810d0041f309fdcfd7be84d7d1f921b63a70993ad89b6f0c1ea06e51859dfb')

build() {
  cd "$srcdir/$pkgname-$pkgver"

  ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var --enable-flac --enable-musepack --enable-itunes
  make
}

package() {
  cd "$srcdir/$pkgname-$pkgver"

  install -D -m0755 $srcdir/forked-daapd $pkgdir/etc/rc.d/forked-daapd || return 1
  install -D -m0755 $srcdir/forked-daapd.service $pkgdir/etc/avahi/services/forked-daapd.service || return 1
  make DESTDIR="$pkgdir/" install
}
