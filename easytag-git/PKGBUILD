# $Id: PKGBUILD 71340 2010-03-06 18:44:25Z andrea $
# Maintainer: Kevin Piche <kevin@archlinux.org>
# Contributor: Aaron Griffin <aaron@archlinux.org>
# Contributor: dorphell <dorphell@archlinux.org>

pkgname=easytag-git
pkgver=20100715
pkgrel=1
pkgdesc="Utility for viewing, editing and writing ID3 tags of your MP3 files - git version with patches"
arch=('i686' 'x86_64')
license=('GPL')
url="http://easytag.sourceforge.net/"
depends=('git' 'id3lib' 'libid3tag' 'gtk2' 'libvorbis' 'flac' 'libmp4v2' 'speex' 'wavpack')
conflicts=('easytag')
install=${pkgname}.install

_gitroot="http://github.com/stsquad/easytag.git"
_gitname="easytag"


build() {
  
  cd ${srcdir}
  msg "Connecting to GIT server...."

  if [ -d "${srcdir}/${_gitname}" ] ; then
    cd ${_gitname} && git pull --rebase
  else
    git clone ${_gitroot}
    cd ${_gitname}
  fi

    
msg "GIT checkout done or server timeout"
  msg "Starting make..."

  ./configure --prefix=/usr
  make || return 1
}

package() {
  cd ${srcdir}/${_gitname}
  make DESTDIR=${pkgdir} install

  # Remove directory mimetype
  sed '/^MimeType=/ s@;x-directory/normal;@;@' \
    -i ${pkgdir}/usr/share/applications/easytag.desktop
}
