# Contributor: Thomas Aynaud <taynaud at gmail dot com>
# Contributor: moostik <mooostik_at_gmail.com>
# Maintainer: Alexey Stukalov <astukalov at gmail.com>

pkgname=tulip
pkgver=4.2.0
pkgrel=1
pkgdesc="An information visualization framework dedicated to the analysis and visualization of relational data"
arch=('i686' 'x86_64')
url="http://www.tulip-software.org"
license=('LGPL')
depends=('python2' 'qt4' 'libxml2' 'glew' 'freetype2' 'doxygen' 'libxml2' 'qtwebkit' 'ftgl')
optdepends=('python-sphinx: generates docucentation for python bindings')
makedepends=('cmake')
source=("http://downloads.sourceforge.net/project/auber/${pkgname}/${pkgname}-${pkgver}/${pkgname}-${pkgver}_src.tar.gz"
	"${pkgname}.profile")
md5sums=('b5c2f593cf7ef61bbe14b10058eccb65'
         'fa35918a3844ba4cbf494ac5ce8007f7')

build() {
  cd "${srcdir}/${pkgname}"
  mkdir -p build
  cd build
  
  QT_ROOT=/usr/lib/qt4 cmake .. \
  	-DCMAKE_BUILD_TYPE=Release \
  	-DCMAKE_SKIP_RPATH=ON \
  	-DCMAKE_INSTALL_PREFIX="${pkgdir}/opt/${pkgname}" \
  	-DQT_MOC_EXECUTABLE=/usr/lib/qt4/bin/moc
  make
}

package() {
  cd "${srcdir}/${pkgname}/build"
  make install
  # strip ${pkgdir} from tulip-config
  sed -i -e "s!${pkgdir}!!g" ${pkgdir}/opt/tulip/bin/tulip-config
  # shell profile for running tulip
  install -D "${srcdir}/${pkgname}.profile" "${pkgdir}/etc/profile.d/${pkgname}.sh"
}

