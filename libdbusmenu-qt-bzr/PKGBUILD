pkgname=libdbusmenu-qt-bzr
pkgver=207
pkgrel=1
pkgdesc="A library that provides a Qt implementation of the DBusMenu spec"
arch=('i686' 'x86_64')
url="https://launchpad.net/libdbusmenu-qt"
license=('GPL')
depends=('qt')
makedepends=('cmake' 'bzr' 'doxygen')

_bzrtrunk=lp:libdbusmenu-qt
_bzrmod=libdbusmenu-qt

build() {
  cd ${srcdir}

  msg "Connecting to the server...."

  if [ ! -d ./${_bzrmod} ]; then
    bzr co ${_bzrtrunk} ${_bzrmod}
  else
    bzr up ${_bzrmod}
  fi

  msg "BZR checkout done or server timeout"
  msg "Starting make..."
  if [[ -d ${srcdir}/build ]]; then
       msg "Cleaning the previous build directory..."
       rm -rf ${srcdir}/build
  fi
  mkdir $srcdir/build
  cd $srcdir/build
  cmake $startdir/src/${_bzrmod} -DCMAKE_BUILD_TYPE=debugfull -DCMAKE_INSTALL_PREFIX=/opt/kde4
  make
}

package() { 
  cd ${srcdir}/build
  make DESTDIR="${pkgdir}" install
}