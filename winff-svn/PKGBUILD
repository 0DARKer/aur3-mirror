pkgname=winff-svn
pkgver=449
pkgrel=1
pkgdesc="WinFF is a GUI to the command line video converter FFmpeg"
arch=('i686' 'x86_64')
url="http://code.google.com/p/winff/"
license=('GPL3')
depends=('ffmpeg' 'gtk2')
makedepends=('svn' 'lazarus')
source=(winff.desktop)
md5sums=(8ebcd86fdcd5ffaefe793a98a4c5b8bc)

_svntrunk="http://winff.googlecode.com/svn/trunk/"
_svnmod="winff"

build() {
 cd $srcdir

msg "Connecting to $_svntrunk SVN server...."
if [ -d $_svnmod/.svn ]; then
   (cd $_svnmod && svn up)
else
   svn co $_svntrunk $_svnmod
fi
  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  cp -r $_svnmod/\ winff\ --username\ bggmtt/ $_svnmod-build/
  
  cd $_svnmod-build/

lazbuild winff.lpr --ws=gtk2 

install -Dm 755 "$srcdir/$_svnmod-build/winff" "$pkgdir/usr/bin/winff"
install -Dm 644 "$srcdir/$_svnmod-build/presets.xml" "$pkgdir/usr/share/winff/presets.xml"
install -d "${pkgdir}/usr/share/winff/languages/"
install -Dm 644 languages/* "$pkgdir/usr/share/winff/languages/"
install -Dm 644 "$srcdir/winff.desktop" "$pkgdir/usr/share/applications/winff.desktop"
install -Dm 644 "$srcdir/$_svnmod-build/winff-icons/32x32/winff.png" "$pkgdir/usr/share/pixmaps/winff.png"

rm -r $srcdir/$_svnmod-build/
}