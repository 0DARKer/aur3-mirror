# Maintainer: Milos Pejovic (pejovic@gmail.com)

pkgname=tvtime-alsa
pkgver=1.0.2
pkgrel=2
pkgdesc="tvtime with ALSA patches from Fedora 11"
depends=('gcc-libs' 'libpng' 'libxml2' 'freetype2' 'libxss' 'libxinerama' 'libxv' 'libsm' 'libxxf86vm')
makedepends=('libxt' 'v4l-utils')
source=(http://downloads.sourceforge.net/tvtime/tvtime-$pkgver.tar.gz
		    tvtime-1.0.1-fsbadval.patch
        tvtime-1.0.1-gcc4.1.patch
        tvtime-1.0.1-header.patch
        tvtime-1.0.2-alsamixer2.patch
        tvtime-1.0.2-alsamixer.patch
        tvtime-1.0.2-localedef.patch)
url='http://tvtime.sourceforge.net/'
provides=('tvtime')
conflicts=('tvtime')
arch=('i686' 'x86_64')
license=('GPL')
build() {
		cd $startdir/src/tvtime-$pkgver
		
		patch -Np1 -i ${startdir}/tvtime-1.0.1-gcc4.1.patch
		patch -Np1 -i ${startdir}/tvtime-1.0.1-header.patch
		patch -Np1 -i ${startdir}/tvtime-1.0.1-fsbadval.patch
		patch -Np1 -i ${startdir}/tvtime-1.0.2-alsamixer.patch
		patch -Np1 -i ${startdir}/tvtime-1.0.2-localedef.patch
		patch -Np1 -i ${startdir}/tvtime-1.0.2-alsamixer2.patch
		sed -i '1,1i#include <zlib.h>' src/pngoutput.c
		sed -i -e "s/tvtime.png/tvtime/" docs/net-tvtime.desktop
		autoreconf -i
		./configure --prefix=/usr --mandir=/usr/share/man --localstatedir=/var --sysconfdir=/etc
		make
		make DESTDIR=$startdir/pkg install
		install -D -m644 docs/html/default.tvtime.xml $pkgdir/usr/share/tvtime/default.tvtime.xml
}
md5sums=('4b3d03afe61be239b08b5e522cd8afed'
         '788ef21672417c2e4226299c0c9e0ced'
         'd23c366d0047bbac305e1376aa2ee8d3'
         '4373c01c146ff3ef62e9d5e7e30325f3'
         'd20144be365598abce0c873d10aff4a2'
         '7b734a5b1b8b847953eb8357e895ed54'
         '3f761e8332df387334092be5f3befd86')

