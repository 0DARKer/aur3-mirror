#! /bin/bash
# Contributor: Jorge Barroso <jorge.barroso.11@gmail.com>
# Maintainer: Jorge Barroso <jorge.barroso.11@gmail.com>
pkgname=mozilla-searchplugins
pkgver=1.3
pkgrel=3
pkgdesc="System-wide OpenSearch plugins common for Mozilla based browsers."
arch=('any')
license=('MPL' 'GPL' 'LGPL')
url="https://parabolagnulinux.org/"
source=(
  duckduckgo-html.xml
  duckduckgo-lite.xml
  internet-archive.xml
  jamendo-en.xml.in
  jamendo.ico::http://www.jamendo.com/favicon.ico
  parabola-packages.xml
  parabola-wiki-en.xml
  seeks-search.xml::http://www.seeks.fr/opensearch.xml
  yacybluebox.xml::http://yacy.dyndns.org:8000/opensearchdescription.xml
  wikipedia-en.xml::https://en.wikipedia.org/w/opensearch_desc.php
)

build() {
  cd "$srcdir"
  sed "s,@icon@,$(base64 -w0 < jamendo.ico)," < jamendo-en.xml.in > jamendo-en.xml || return 1
}

package() {
  install -m755 -d                "${pkgdir}/usr/lib/mozilla/searchplugins"
  install -m644 "${srcdir}"/*.xml "${pkgdir}/usr/lib/mozilla/searchplugins"
}

sha512sums=('3cf3cc61bc52e8f094f4f95ec1276edba6d9958f5af4fbb65f2593bb1f35024593b7dae545141119267fb116a2ac2f69ebaaabfb3809007696dc3ef9fc1944c7'
            'e3b86022676879b5e20051681d10b1daa3d67ba2e4223e07b9c827a54b151747935c759f8be98169c70b882ec94f35274d3cb11433427019858d40a29ea49089'
            '331a27a6fefd498052725d95501725d89a199a99d4436759748aa82fa3281ca90679bf1d2814214d4f5bb06d0b37491f266a616bb80ef513837fa0861698cdb7'
            '18d15d964a072bf4bf15ee31611bc831cd91fe2dbf0ba5e5ef682ab5572301c3fb7273865758de9acd718cbfa911686df70650415d5bc87287eab15f5773b260'
            '3542c7429d05653b7f51406dcdd085511f7b6a59accbd1c4559280b67fd9f32d1af826c8660355ab66337aafd5c65da44a5fc53acb72090c7c60e35b6a1ba5ee'
            '1ce4aeda73684aa53cd6aee3c4f9c5a2ae430922fe92d53737ef9ba4c280c319f36353fe794ccbe402ecae27d9d76ad510f92b77ed507b0b607f2d7268c20538'
            '5a0d500a85d01c58e9b2aedc582502d3cd7f8776fdd1100878734f90504836c060e2257011e1527bd26a03923e3888113e67be6bf93b16f8f69cbd8c857185a7'
            '6cf69ce416006f16528f6115a3bab692c057831d61a95c502de2da01f013b005b7228b5fad59021e73c6d274a869e628ddc75c4c59d2adb7966128deb78940a3'
            '433f97c4f8010c2bebdabe09d37a3cb1d97dee1b7347d82c2227130ca05f063ee0127f281bb30d1de7f17fa6f56f1d0458aab3730b4319c4743aa9b1a5d8baed'
            '418fd21bd4f49c459d8a25ef535c7b4437a5efc8d309ab64012b908c80fe28f0845f1fa2024450444105bb484b5cb19b81e29fd5a06eee868f6a67114482303d')