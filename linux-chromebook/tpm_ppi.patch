diff --git a/drivers/char/tpm/tpm_ppi.c b/drivers/char/tpm/tpm_ppi.c
index b3ea223585bd..fc3892bf2044 100644
--- a/drivers/char/tpm/tpm_ppi.c
+++ b/drivers/char/tpm/tpm_ppi.c
@@ -24,6 +24,7 @@ static const u8 tpm_ppi_uuid[] = {
 
 static char tpm_ppi_version[PPI_VERSION_LEN + 1];
 static acpi_handle tpm_ppi_handle;
+static bool tpm_ppi_sysfs_registered;
 
 static acpi_status ppi_callback(acpi_handle handle, u32 level, void *context,
 				void **return_value)
@@ -325,16 +326,24 @@ static struct attribute_group ppi_attr_grp = {
 
 int tpm_add_ppi(struct kobject *parent)
 {
+	int ret = 0;
+
 	/* Cache TPM ACPI handle and version string */
 	acpi_walk_namespace(ACPI_TYPE_DEVICE, ACPI_ROOT_OBJECT, ACPI_UINT32_MAX,
 			    ppi_callback, NULL, NULL, &tpm_ppi_handle);
-	if (tpm_ppi_handle == NULL)
-		return -ENODEV;
+	if (tpm_ppi_handle) {
+		ret = sysfs_create_group(parent, &ppi_attr_grp);
+		if (ret == 0)
+			tpm_ppi_sysfs_registered = true;
+	}
 
-	return sysfs_create_group(parent, &ppi_attr_grp);
+	return  ret;
 }
 
 void tpm_remove_ppi(struct kobject *parent)
 {
-	sysfs_remove_group(parent, &ppi_attr_grp);
+	if (tpm_ppi_sysfs_registered) {
+		sysfs_remove_group(parent, &ppi_attr_grp);
+		tpm_ppi_sysfs_registered = false;
+	}
 }
