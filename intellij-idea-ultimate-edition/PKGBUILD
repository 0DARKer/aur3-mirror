# Maintainer: Urs Wolfer <uwolfer @ fwo.ch>
pkgname=intellij-idea-ultimate-edition
pkgver=10.0.2
_buildver=103.72
pkgrel=1
pkgdesc="An intelligent Java IDE intensely focused on developer productivity."
arch=('i686' 'x86_64')
#arch=('any') #not anymore because of fsnotifier
url="http://www.jetbrains.com/idea/"
backup=("usr/share/${pkgname}/bin/idea.vmoptions")
license=('Comercial')
depends=('jdk')
#source=(http://download.jetbrains.com/idea/ideaIU-$_buildver.tar.gz \
source=(http://download.jetbrains.com/idea/ideaIU-$pkgver.tar.gz \
        "http://git.jetbrains.org/?p=idea/community.git;a=blob_plain;f=native/fsNotifier/linux/fsnotifier" \
        "http://git.jetbrains.org/?p=idea/community.git;a=blob_plain;f=native/fsNotifier/linux/fsnotifier64" \
        intellijidea.sh \
        intellijidea.desktop
)
md5sums=('f495681b731423718ced92de210271d8'
         '74edf2bdebd283e9feff2d1ead5179e0'
         '2d6a6ce01f82cbf70273df7ddfb9e925'
         '4b365004088c3b433a563822e313e0c2'
         '04d718e59843e4635a820ffea3fbf0f1'
)

if [ "$CARCH" = "i686" ]; then
    _fsnotifier="fsnotifier"
  elif [ "$CARCH" = "x86_64" ]; then
    _fsnotifier="fsnotifier64"  
fi

build() {
  cd "$srcdir"

  install -d -m755 $pkgdir/usr/{bin,share}
  cp -a "idea-IU-$_buildver" "$pkgdir/usr/share/$pkgname"
  chown -R 0:0 $pkgdir/usr/share/$pkgname
  find $pkgdir/usr/share/$pkgname -type d -exec chmod 0755 {} ';'
  find $pkgdir/usr/share/$pkgname -type f -exec chmod 0644 {} ';'

  cp "$srcdir"/$_fsnotifier "$pkgdir"/usr/share/$pkgname/bin/fsnotifier

  chmod +x $pkgdir/usr/share/$pkgname/bin/idea.sh
  chmod +x "$pkgdir"/usr/share/$pkgname/bin/fsnotifier

  install -D -m755 $srcdir/intellijidea.sh $pkgdir/usr/bin/$pkgname
  install -D -m644 $srcdir/intellijidea.desktop $pkgdir/usr/share/applications/$pkgname.desktop
  install -D -m644 $srcdir/idea-IU-$_buildver/bin/idea32.png $pkgdir/usr/share/pixmaps/$pkgname.png
  install -D -m644 $srcdir/idea-IU-$_buildver/license/IDEA_license.txt $pkgdir/usr/share/licenses/$pkgname/LICENSE.txt
}

# vim:set ts=2 sw=2 et:
