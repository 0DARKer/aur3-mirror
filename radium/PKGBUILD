# Maintainer: speps <speps dot aur dot archlinux dot org>

pkgname=radium
pkgver=1.9.30
pkgrel=1
pkgdesc="A graphical music editor and a next generation tracker."
arch=('i686' 'x86_64')
url="http://users.notam02.no/~kjetism/radium/"
license=('GPL')
depends=('calf-kxstudio-git' 'liblrdf' 'libxaw' 'qt4')
source=("http://archive.notam02.no/arkiv/src/$pkgname-$pkgver.tar.gz"
        "$pkgname-qt4.patch::https://github.com/kmatheussen/radium/commit/9d7df573506b898694322e7bad5d056fda8a574d.patch")
md5sums=('39eb2b1d467a5740c8857c5d55795e37'
         'db32edbe748b9ac81fbc5018fa4d6453')

prepare() {
  cd "$srcdir/$pkgname-$pkgver"
  patch -i ../${source[1]/::*}
}

build() {
  cd "$srcdir/$pkgname-$pkgver"
  make packages
  BUILDTYPE=RELEASE ./build_linux.sh -j7
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make PREFIX=/usr DESTDIR="$pkgdir/" install

  # python2 fix
  sed -i "s|\#\!.*python|&2|" `grep -rl "\#\!.*python" .`
}
