# $Id$
# Contributor: Mathieu Clabaut <mathieu.clabaut@gmail.com>

pkgname=perl-html-wikiconverter
pkgver=0.63
pkgrel=1
pkgdesc="Perl/CPAN Module HTML-WikiConverter"
arch=("i686" "x86_64")
url="http://search.cpan.org/~diberri/HTML-WikiConverter-$pkgver"
license=()
makedepends=("perl")
depends=("perl-html-tagset" "perl-html-element-extended" "perl-html-tree"
"perl-class-data-inheritable" "perl-params-validate" "perl-uri" "perl-css")
source=("http://search.cpan.org/CPAN/authors/id/D/DI/DIBERRI/HTML-WikiConverter-$pkgver.tar.gz"
"http://search.cpan.org/CPAN/authors/id/D/DI/DIBERRI/HTML-WikiConverter-MediaWiki-0.55.tar.gz"
"http://search.cpan.org/CPAN/authors/id/D/DI/DIBERRI/HTML-WikiConverter-MoinMoin-0.53.tar.gz"
"http://search.cpan.org/CPAN/authors/id/D/DI/DIBERRI/HTML-WikiConverter-Confluence-0.01.tar.gz"
"http://search.cpan.org/CPAN/authors/id/D/DI/DIBERRI/HTML-WikiConverter-TikiWiki-0.50.tar.gz"


)
md5sums=('342bf3629c137b1b67db6573dba0d103'
         'c461f128ab4c7bd4a95033e54aac9e04'
         '266cdd9b758b940e437270b7e6019eb0'
         'd2966e02d336401d184d4f2685999c37'
         '25fa2d275319aa0e00aff52ddc2f26ec')


build() {
  cd $startdir/src/HTML-WikiConverter-$pkgver
  
  eval `perl -V:archname`
  /usr/bin/perl Makefile.PL \
  INSTALLARCHLIB=/usr/lib/perl5/current/${archname} \
  INSTALLSITELIB=/usr/lib/perl5/site_perl/current \
  INSTALLSITESCRIPT=/usr/bin \
  INSTALLVENDORSCRIPT=/usr/bin \
  INSTALLSITEARCH=/usr/lib/perl5/site_perl/current/${archname} || return 1
  make || return 1
  make DESTDIR=$startdir/pkg install || return 1

  cd $startdir/src/HTML-WikiConverter-MediaWiki-0.55
  /usr/bin/perl Makefile.PL \
  INSTALLARCHLIB=/usr/lib/perl5/current/${archname} \
  INSTALLSITELIB=/usr/lib/perl5/site_perl/current \
  INSTALLSITESCRIPT=/usr/bin \
  INSTALLVENDORSCRIPT=/usr/bin \
  INSTALLSITEARCH=/usr/lib/perl5/site_perl/current/${archname} || return 1
  make || return 1
  make DESTDIR=$startdir/pkg install || return 1

  cd $startdir/src/HTML-WikiConverter-MoinMoin-0.53
  /usr/bin/perl Makefile.PL \
  INSTALLARCHLIB=/usr/lib/perl5/current/${archname} \
  INSTALLSITELIB=/usr/lib/perl5/site_perl/current \
  INSTALLSITESCRIPT=/usr/bin \
  INSTALLVENDORSCRIPT=/usr/bin \
  INSTALLSITEARCH=/usr/lib/perl5/site_perl/current/${archname} || return 1
  make || return 1
  make DESTDIR=$startdir/pkg install || return 1

  cd $startdir/src/HTML-WikiConverter-Confluence-0.01
  /usr/bin/perl Makefile.PL \
  INSTALLARCHLIB=/usr/lib/perl5/current/${archname} \
  INSTALLSITELIB=/usr/lib/perl5/site_perl/current \
  INSTALLSITESCRIPT=/usr/bin \
  INSTALLVENDORSCRIPT=/usr/bin \
  INSTALLSITEARCH=/usr/lib/perl5/site_perl/current/${archname} || return 1
  make || return 1
  make DESTDIR=$startdir/pkg install || return 1

  cd $startdir/src/HTML-WikiConverter-TikiWiki-0.50
  /usr/bin/perl Makefile.PL \
  INSTALLARCHLIB=/usr/lib/perl5/current/${archname} \
  INSTALLSITELIB=/usr/lib/perl5/site_perl/current \
  INSTALLSITESCRIPT=/usr/bin \
  INSTALLVENDORSCRIPT=/usr/bin \
  INSTALLSITEARCH=/usr/lib/perl5/site_perl/current/${archname} || return 1
  make || return 1
  make DESTDIR=$startdir/pkg install || return 1


  /usr/bin/find $startdir/pkg -name '.packlist' -exec rm  '{}' \; && \
  /usr/bin/find $startdir/pkg -name 'perllocal.pod' -exec rm  '{}' \; && \
  /usr/bin/find $startdir/pkg -depth -type d -empty -exec rmdir '{}' \;

}
