# Maintainer: josephgbr <rafael.f.f1@gmail.com>

pkgname=teeworlds-monster   
pkgver=0.6.2.20130712
pkgrel=1
pkgdesc="A customized server with bad monsters"
arch=('x86_64' 'i686')
url="https://www.teeworlds.com/forum/viewtopic.php?id=10413"
license=('custom') # free/opensource
if [[ $CARCH == i686 ]]; then
    depends=(teeworlds)
    source=("teeworlds-monster_srv-${pkgver}-32bit::http://goo.gl/xRoou")
    md5sums=('88dad314f6510ad26762824510536a5e')
elif [[ $CARCH == x86_64 ]]; then
    depends=(teeworlds lib32-gcc-libs)
    source=("teeworlds-monster_srv-${pkgver}-64bit::http://goo.gl/Q30c8")
    md5sums=('05d645fe0e63cf6cf1b1d5db77f8df00')
fi
source+=(server.sh.in monster-srv.cfg ctf5_easy.map ctf5_monster.map ktm5.map monster-rain.map monster-world.map)
md5sums=('512e9b676a77238c2c4622681794f442'
         '529146a3b13993770fa414f66c67fa26'
         '0d8a00d037d2274e424c4e40fedc7a43'
         'd4e7a5f167fc96fb4b1755eb72ce705c'
         'cf1b721bd7b75797c331f75b68937ccd'
         '10def7d461d6bb8a83e3bca10e2a002d'
         '237079fe2b633bc8b2e447e5183a407f'
         'c56f4adaeccaab7557840b48c19da013')

package() {
  install -Dm755 teeworlds-monster_srv-${pkgver}-* "$pkgdir"/usr/share/$pkgname/teeworlds_srv
  
  install -Dm644 monster-srv.cfg "$pkgdir"/usr/share/$pkgname/server.cfg
  install -Dm755 "$srcdir"/server.sh.in "$pkgdir"/usr/bin/${pkgname}_srv
  sed -i "s/@MODNAME@/$pkgname/" "$pkgdir"/usr/bin/${pkgname}_srv
  
  install -dm755  $pkgdir/usr/share/teeworlds/data/maps/
  for map in ctf5_easy.map ctf5_monster.map ktm5.map monster-rain.map monster-world.map; do
    install -Dm644 $map "$pkgdir/usr/share/teeworlds/data/maps/"
  done
}
