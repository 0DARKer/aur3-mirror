# Maintainer: Kyle Keen <keenerd@gmail.com>
pkgname=primerl
pkgver=1.8a
pkgrel=2
pkgdesc="A sci-fi roguelike, based on ZAPM."
arch=('i686' 'x86_64')
url="http://arcywidmo.republika.pl/prime/"
license=('GPL')
depends=('ncurses' 'gcc-libs')
makedepends=()
source=(http://arcywidmo.republika.pl/prime/$pkgver/prime_src-$pkgver.tar.bz2 launcher build_fix.patch)
md5sums=('67c5b5e0cc170d9acf565210e87065f9'
         '2fda0d47622a0c17fb0edf336a734053'
         'bd269392d0fe5ea4133807a9c1a4dcf6')

build()
{
  cd "$srcdir"
  patch -p0 < build_fix.patch
  cd "PRIME"
  make
}

package()
{
  cd "$srcdir/PRIME/build/prime"
  mkdir -p "$pkgdir/opt/primerl"
  cp -r * "$pkgdir/opt/primerl"
  install -D "$srcdir/launcher" "$pkgdir/usr/bin/$pkgname"

  cd "$pkgdir/opt/primerl/"
  touch config.txt
  chown -R root:games user config.txt
  chmod 775 user
  chmod 664 user/*
  chmod 664 config.txt 
}
