# Maintainer: M0Rf30
# Contributor: Leo von Klenze <leo@devel.von-klenze.de>
pkgname=cloud9-git
pkgver=9384.5b62a7c
pkgrel=1
pkgdesc="Cloud9 IDE - Your code anywhere, anytime. Open Source Javascript Cloud9 IDE"
arch=('i686' 'x86_64')
url="https://github.com/ajaxorg/cloud9"
license=('GPLv3')
depends=(nodejs chromium)
makedepends=('git')
provides=(cloud9)
conflicts=(cloud9)
source=(cloud9::git+https://github.com/ajaxorg/cloud9.git
	cloud9.sh
	cloud9.desktop
	cloud9.png)
install=cloud9.install

build(){
  cd cloud9
  
  npm install
  cd node_modules/ace; make clean build; cd ../..
  cd node_modules/packager && rm -rf node_modules && sm install && cd ../..
  make
}

package(){
  cd cloud9
  
  #Create folder for user cloud9
  install -dm755 $pkgdir/var/lib/cloud9
  cp -r * $pkgdir/var/lib/cloud9/
  cd $pkgdir/var/lib/cloud9/
  
  chown 419:419 -R $pkgdir/var/lib/cloud9
  
  install -vDm755  $srcdir/cloud9.sh $pkgdir/usr/bin/cloud9
  install -vDm644 $srcdir/cloud9.desktop $pkgdir/usr/share/applications/cloud9.desktop
  install -vDm644 $srcdir/cloud9.png $pkgdir/usr/share/pixmaps/cloud9.png
}

pkgver() {
  cd cloud9
  echo $(git rev-list --count master).$(git rev-parse --short master)
}

md5sums=('SKIP'
         '54e427005c9845cf9d5393c3df48203d'
         '5982f046d81679c9a248a52fd87ab93f'
         'd936da7ccd2bc783afa8d196cc674b86')
