# Maintainer: Patrick Palka <patrick@parcs.ath.cx>
# Development: http://closure.ath.cx/aur-dev

pkgname=clean
pkgver=2.3
pkgrel=3
pkgdesc="A pure and lazy function programming language"
arch=('x86_64' 'i686')
url="http://wiki.clean.cs.ru.nl/Clean"
license=('LGPL')
if [ "$CARCH" = "x86_64" ]; then
    _suffix=_64
    md5sums=('f17ba9ce37e640f65541e0e6f5bfb63b')
else
    md5sums=('739adcb4655b72859727bea07314a507')
fi
source=("http://clean.cs.ru.nl/download/Clean23/linux/${pkgname}${pkgver}${_suffix}.tar.gz")

package() {
    cd clean
    make INSTALL_DIR="${pkgdir}/opt/clean" io
    bin/patch_bin "${pkgdir}/opt/clean/bin/clm" CLEANLIB /opt/clean/lib/exe
    bin/patch_bin "${pkgdir}/opt/clean/bin/clm" CLEANILIB /opt/clean/lib
    bin/patch_bin "${pkgdir}/opt/clean/bin/clm" CLEANPATH /opt/clean/lib/StdEnv
    mkdir -p "${pkgdir}/usr/share/man/man1"
    ln -s ../../../../opt/clean/man/man1/clm.1.gz "${pkgdir}/usr/share/man/man1"
    mkdir -p "${pkgdir}/usr/bin"
    ln -s ../../opt/clean/bin/{clm,htoclean} "${pkgdir}/usr/bin"
    install -vDm644 CleanLicenseConditions.txt \
        "${pkgdir}/usr/share/licenses/clean/LICENSE"
}
