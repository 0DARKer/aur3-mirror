# Maintainer: Jérémy Anger <angerj.dev@gmail.com>

pkgname=drystal-git
pkgver=257.6e9cad9
pkgrel=1
pkgdesc="2D game engine"
arch=('i686' 'x86_64')
url="http://trac.kidanger.net/drystal"
license=('unknow')
depends=('sdl2' 'mesa' 'openal')
makedepends=('git' 'cmake' 'make')
conflicts=()
provides=(drystal)

source=('git+http://git.kidanger.net/drystal.git')
md5sums=('SKIP')
#_gitroot='http://git.kidanger.net/drystal.git'
_gitname=drystal

pkgver() {
  cd "$srcdir/$_gitname"
  echo "$(git rev-list --count HEAD).$(git rev-parse --short HEAD)"
}

prepare() {
	cd "$srcdir/$_gitname"

	git submodule init
	git submodule update
}

build() {
	cd "$srcdir/$_gitname"

	test -d build-native || mkdir build-native
	cd build-native
	cmake ..
	make
	cd ..
}

package() {
	cd "$srcdir/$_gitname"
	sh install.sh $pkgdir
}
