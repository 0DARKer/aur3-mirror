# Maintainer: archtux <antonio dot arias99999 at gmail dot com>

pkgname=comicmaster-git
pkgver=20130303
pkgrel=1
pkgdesc="cbr/cbz reader for comics."
url="http://comicmaster.sourceforge.net/Intro.html"
arch=('i686' 'x86_64')
license=('GPL2')
depends=('qt4')
makedepends=('cmake' 'git')
conflicts=('comicmaster')

_gitroot=git://comicmaster.git.sourceforge.net/gitroot/comicmaster/comicmaster
_gitname=comicmaster

build() {
  cd $srcdir

  msg "Connecting to GIT server...."

  if [ -d $srcdir/$_gitname ] ; then
    cd $_gitname && git pull --rebase
  else
    git clone $_gitroot
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  cd comicmaster

  # Fix Build Type
  sed -i 's|CMAKE_BUILD_TYPE Debug|CMAKE_BUILD_TYPE release|' CMakeLists.txt
  
  cmake . -DCMAKE_INSTALL_PREFIX=/usr
  make
  make DESTDIR=$pkgdir install
}