# -*- shell-script -*-
#
# Contributor: Adrian C. <anrxc..sysphere.org>

basename=vlc
pkgname=vlc-mini
pkgver=1.1.8
pkgrel=1
pkgdesc="A MPEG, VCD, DVD and DivX player with minimal dependencies"
arch=("i686" "x86_64")
url="http://www.videolan.org/vlc/"
license=("GPL2")
depends=("libmad" "ffmpeg" "fribidi" "sysfsutils" "qt"
         "libdvdread" "libxml2" "libraw1394" "a52dec" "x264"
         "libmpeg2" "libv4l" "libavc1394" "live-media" "libxcb"
         "flac" "faad2")
makedepends=("pkgconfig" "live-media")
optdepends=("libdvdcss" "libnotify")
provides=("vlc")
conflicts=("vlc")
options=("!libtool")
install="${pkgname}.install"
source=("http://download.videolan.org/pub/videolan/${basename}/${pkgver}/${basename}-${pkgver}.tar.bz2")
md5sums=("c0065ec11b6fd12167cd440cbe0ef0d9")


build() {
  cd "${srcdir}/${basename}-${pkgver}"

# Source code build
  sed -i -e 's:truetype/freefont:TTF:g' modules/misc/freetype.c
  ./configure --prefix=/usr \
              --enable-loader --enable-live555 --with-live555-tree=/usr/lib/live \
              --enable-optimize-memory --enable-optimizations \
              --enable-sout --enable-dv --enable-dvdread --enable-vcd \
              --enable-libass --enable-mad --enable-qt4 --enable-vlc \
              --enable-a52 --enable-flac --enable-httpd --enable-realrtsp \
              --enable-vorbis --enable-ogg --enable-theora --enable-snapshot \
              --enable-xvideo --enable-xcb --enable-freetype --enable-fribidi \
              --enable-fontconfig --enable-libxml2 --enable-alsa --enable-screen \
              --enable-libmpeg2 --enable-faad --enable-vlm --enable-v4l --enable-v4l2 \
              --enable-avcodec --enable-avformat --enable-x264 \
              --disable-nls --disable-rpath --disable-dbus --disable-mtp \
              --disable-dbus-control --disable-telepathy --disable-debug \
              --disable-gprof --disable-cprof --disable-run-as-root \
              --disable-coverage --disable-switcher --disable-shout \
              --disable-lua --disable-libproxy --disable-dvdnav --disable-oss \
              --disable-libcddb --disable-growl --disable-notify \
              --disable-taglib --disable-dc1394 --disable-pvr --disable-gnomevfs \
              --disable-dshow --disable-bda --disable-opencv --disable-smb \
              --disable-vcdx --disable-dvb --disable-libtar --disable-dca \
              --disable-mkv --disable-mod --disable-mpc --disable-wma-fixed \
              --disable-gme --disable-id3tag --disable-swscale --disable-shine \
              --disable-postproc --disable-png --disable-fluidsynth \
              --disable-twolame --disable-quicktime --disable-real \
              --disable-dirac --disable-schroedinger --disable-opengl \
              --disable-zvbi --disable-telx --disable-asademux --disable-tiger \
              --disable-kate --disable-glx --disable-tremor --disable-speex \
              --disable-sdl-image --disable-svg --disable-sdl \
              --disable-hd1000v --disable-directx --disable-fb \
              --disable-svgalib --disable-directfb --disable-ggi --disable-activex \
              --disable-aa --disable-caca --disable-wingdi --disable-mozilla \
              --disable-pulse --disable-portaudio --disable-omapfb \
              --disable-waveout --disable-macosx-audio --disable-hd1000a \
              --disable-jack --disable-cyberlink --disable-upnp \
              --disable-skins2 --disable-fbosd --disable-visual \
              --disable-macosx --disable-ncurses --disable-xosd \
              --disable-goom --disable-atmo --disable-bonjour --disable-lirc \
              --disable-libgcrypt --disable-gnutls --disable-remoteosd \
              --disable-update-check --disable-loader
  CFLAGS="-fPIC"
  make
  make DESTDIR=${pkgdir}/ install

# Install icons
  for res in 16 32 48 128; do
    install -D -m644 ${srcdir}/vlc-${pkgver}/share/icons/${res}x${res}/vlc.png \
        ${pkgdir}/usr/share/icons/hicolor/${res}x${res}/apps/vlc.png
  done
}
