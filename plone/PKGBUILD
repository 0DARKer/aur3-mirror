# Contributor: Benjamin Hedrich <phpogo@gmx.net> 
# Maintainer: Ben Reedy <thebenj88 *AT* gmail *DOT* com>

pkgname=plone
pkgver=4.3.3
pkgrel=1
pkgdesc="A powerful, flexible Content Management solution that is easy to install, use and extend"
arch=('any')
license=('GPL2')
url="http://www.plone.org/"
depends=('python2')
makedepends=('freetype2')
conflicts=('plone-beta')
install=plone.install
source=(http://launchpad.net/plone/4.3/$pkgver/+download/Plone-$pkgver-UnifiedInstaller.tgz
        plone-standalone.service
        plone.install)
sha256sums=('5473b4386febd656f28e259efa4cb9cc6b8b8b5f7bc67d04977bdbe3615569a9'
            'cd32df8ff1dfb176e7827228fb9eb251053a7b5440717492a4a4e558e57dc33e'
            'bf521e000d6d04413178f4a6c4b7b25ce49850e7f986436f82ba364be5200ea0')
    
package() {
    # Link needed for plone to build correctly
    mkdir -p "$pkgdir"/usr/include
    ln -s /usr/include/freetype2 "$pkgdir"/usr/include/freetype

    install -Dm644 "$srcdir"/plone-standalone.service \
        "${pkgdir}"/usr/lib/systemd/system/plone-standalone.service

    mkdir -p "$pkgdir"/opt/plone
    cp -r Plone-$pkgver-UnifiedInstaller "$pkgdir"/opt/Plone-$pkgver-UnifiedInstaller
}
