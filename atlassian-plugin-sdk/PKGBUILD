# Contributor: Leo von Klenze <leo.vonklenze@tngtech.com> 
pkgname="atlassian-plugin-sdk"
pkgver=3.5.2
pkgrel=2
pkgdesc="Atlassian Plugin SDK for Developing Plugins for Atlassian Products"
arch=('i686' 'x86_64')
url="http://confluence.atlassian.com/x/rwWzDQ"
license=('Apache License 2.0')
source=("https://maven.atlassian.com/public/com/atlassian/amps/atlassian-plugin-sdk/$pkgver/atlassian-plugin-sdk-$pkgver.tar.gz")
md5sums=('7c3ac63fa96f11c6e167fb4aede212e1')

build()
{
	cd "$pkgdir"
	mkdir -p opt/atlassian/plugin-sdk

	cp -r "$srcdir"/atlassian-plugin-sdk-$pkgver/* opt/atlassian/plugin-sdk
	# remove executable flag
#	find opt/atlassian/plugin-sdk -type f -exec chmod -x {} \;
	
	# add executable flag to bin directories
#	chmod +x opt/atlassian/plugin-sdk/bin/*
#	chmod +x opt/atlassian/plugin-sdk/apache-maven/bin/*

	# remove executable flag from .bat in bin
#	chmod -x opt/atlassian/plugin-sdk/bin/*.bat
	chmod -x opt/atlassian/plugin-sdk/apache-maven/bin/*.bat
#	chmod -x opt/atlassian/plugin-sdk/apache-maven/bin/m2.conf

	# add executable flag for every user
	chmod -R +X opt/atlassian/plugin-sdk

	# update PATH
	mkdir -p etc/profile.d
	echo 'export PATH=$PATH:/opt/atlassian/plugin-sdk/bin' > etc/profile.d/atlassian-plugin-sdk.sh
	echo 'setenv PATH ${PATH}:/opt/atlassian/plugin-sdk/bin' > etc/profile.d/atlassian-plugin-sdk.csh
	chmod +x etc/profile.d/*
}

