# Contributor: Christopher Heien <chris.h.heien@gmail.com>
pkgname="talend-studio"
altname="TalendOpenStudio"
pkgver="4.1.0"
_build="r49467"
pkgrel=1
pkgdesc="Data and Information Quality suite."
arch=("i686 x86_64")
url=("http://www.talend.com")
license=("GPL2")
depends=("gtk2" "glib2")
optdepends=('talend-profiler: data profiling suite')
source=("http://downloads.sourceforge.net/project/talend-studio/Talend%20Open%20Studio/${pkgver}/TOS-All-${_build}-V${pkgver}.zip"
	"OpenStudio32bit.desktop"
	"OpenStudio64bit.desktop")
sha1sums=("1182cacd951fa7b7f4f2a843a677af37c3639770"
	  "529b00fdc26aff1cc44994971010eaf0487b6f22"
	  "5e4278986aab089793d561d07de965d7c6524a64")

build(){
	
    mkdir -p $pkgdir/opt/talend $pkgdir/usr/bin $pkgdir/usr/share/applications || return 1
    
    mv $srcdir/TOS-All-${_build}-V${pkgver} $pkgdir/opt/talend/$altname || return 1
    cd $pkgdir/opt/talend/$altname
    
    #remove all non-Linux arch
    rm -rf  *macosx* && \
    rm -rf *solaris* && \
    rm -rf *gtk-ppc* && \
    rm -rf *win32* || return 1

    ln -s /opt/talend/$altname/$altname-linux-gtk-x86 $pkgdir/usr/bin || return 1
    ln -s /opt/talend/$altname/$altname-linux-gtk-x86_64 $pkgdir/usr/bin || return 1.    

    chmod +x $pkgdir/opt/talend/$altname/$altname-linux-gtk-x86 || return 1
    chmod +x $pkgdir/opt/talend/$altname/$altname-linux-gtk-x86_64 || return 1

    install --mode=0755 $srcdir/OpenStudio32bit.desktop $pkgdir/usr/share/applications/OpenStudio32bit.desktop || return 1
    install --mode=0755 $srcdir/OpenStudio64bit.desktop $pkgdir/usr/share/applications/OpenStudio64bit.desktop || return 1
}
