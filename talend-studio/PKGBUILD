# Contributor: Christopher Heien <chris.h.heien@gmail.com>
# Maintainer: Christopher Heien <chris.h.heien@gmail.com>
pkgname="talend-studio"
_altname="TalendOpenStudio"
pkgver="4.1.2"
_build="r53616"
pkgrel=1
pkgdesc="Data and Information Quality suite."
arch=("i686 x86_64")
url=("http://www.talend.com")
license=("GPL2")
depends=("gtk2" "glib2")
optdepends=('talend-profiler: data profiling suite')
options=("!strip")
source=("http://downloads.sourceforge.net/project/talend-studio/Talend%20Open%20Studio/${pkgver}/TOS-All-${_build}-V${pkgver}.zip"
	"OpenStudio32bit.desktop"
	"OpenStudio64bit.desktop")
sha1sums=("79faa720de3b1c56f4d1dc8f9807032c292cb818"
	  "51f2d454ab9b7f1a3b15e8c096ee8ce1da130a83"
	  "e9514580e0a4cc2846fbb96a3bcc91da4d84041b")

build(){
	
    mkdir -p $pkgdir/opt/talend $pkgdir/usr/bin $pkgdir/usr/share/applications || return 1
    
    mv $srcdir/TOS-All-${_build}-V${pkgver} $pkgdir/opt/talend/$_altname || return 1
    cd $pkgdir/opt/talend/$_altname
    
    #remove all non-Linux arch
    rm -rf  *macosx* && \
    rm -rf *solaris* && \
    rm -rf *gtk-ppc* && \
    rm -rf *win32* || return 1

    ln -s /opt/talend/$_altname/$_altname-linux-gtk-x86 $pkgdir/usr/bin || return 1
    ln -s /opt/talend/$_altname/$_altname-linux-gtk-x86_64 $pkgdir/usr/bin || return 1    

    chmod +x $pkgdir/opt/talend/$_altname/$_altname-linux-gtk-x86 || return 1
    chmod +x $pkgdir/opt/talend/$_altname/$_altname-linux-gtk-x86_64 || return 1

    install --mode=0755 $srcdir/OpenStudio32bit.desktop $pkgdir/usr/share/applications/OpenStudio32bit.desktop || return 1
    install --mode=0755 $srcdir/OpenStudio64bit.desktop $pkgdir/usr/share/applications/OpenStudio64bit.desktop || return 1
}
