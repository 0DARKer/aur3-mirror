pkgname=megatunix-git
pkgver=20100629
pkgrel=1
pkgdesc="MegaTunix Tuning software"
arch=("i686")
url="http://megatunix.sourceforge.net/"
license=('GPL')
depends=('libtool' 'intltool' 'gcc' 'gtkglext' 'flex' 'bison' 'glade' 'libglade' 'git' 'make' 'automake' 'gdb')
replaces=('megatunix-cvs')

_gitroot="http://github.com/djandruczyk/MegaTunix.git"
_gitname="MegaTunix"

source=()
md5sums=()

build() {
    cd ${srcdir}
    msg "Connecting to GIT server...."

    if [ -d "${_gitname}" ] ; then
        cd ${_gitname} 
        git pull --rebase
    else
        git clone ${_gitroot}
        cd ${_gitname}
    fi

    msg "GIT checkout done.\n Most recent activity:"
    git log -3 --color | cat
    sleep 15
    msg "Starting make..."

    cd ..
    cp -r $_gitname $_gitname-build
    cd $_gitname-build

    ./autogen.sh --enable-debug --prefix=/usr &&
    make || return 1
    make DESTDIR=${pkgdir} install || return 1


    rm -r $srcdir/$_gitname-build
}
