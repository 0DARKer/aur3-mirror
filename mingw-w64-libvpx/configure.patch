diff -ru libvpx-1.2.0/build/make/configure.sh patched/build/make/configure.sh
--- libvpx-1.2.0/build/make/configure.sh	2013-05-10 16:03:44.000000000 +0200
+++ patched/build/make/configure.sh	2013-07-06 10:25:27.761836724 +0200
@@ -1070,10 +1070,12 @@
             win32)
                 add_asflags -f win32
                 enabled debug && add_asflags -g cv8
+                add_ldflags "-Wl,-no-undefined"
             ;;
             win64)
                 add_asflags -f x64
                 enabled debug && add_asflags -g cv8
+                add_ldflags "-Wl,-no-undefined"
             ;;
             linux*|solaris*)
                 add_asflags -f elf${bits}
diff -ru libvpx-1.2.0/build/make/Makefile patched/build/make/Makefile
--- libvpx-1.2.0/build/make/Makefile	2013-05-10 16:03:44.000000000 +0200
+++ patched/build/make/Makefile	2013-07-06 10:56:04.502112074 +0200
@@ -253,6 +253,7 @@
 	$(if $(quiet),@echo "    [LD] $$@")
 	$(qexec)$$(LD) -shared $$(LDFLAGS) \
             -Wl,--no-undefined -Wl,-soname,$$(SONAME) \
+            -Wl,-out-implib,libvpx.dll.a \
             -Wl,--version-script,$$(SO_VERSION_SCRIPT) -o $$@ \
             $$(filter %.o,$$?) $$(extralibs)
 endef
@@ -320,7 +321,7 @@
 .libs: $(LIBS)
 	@touch $@
 $(foreach lib,$(filter %_g.a,$(LIBS)),$(eval $(call archive_template,$(lib))))
-$(foreach lib,$(filter %so.$(VERSION_MAJOR).$(VERSION_MINOR).$(VERSION_PATCH),$(LIBS)),$(eval $(call so_template,$(lib))))
+$(foreach lib,$(filter %dll.$(VERSION_MAJOR).$(VERSION_MINOR).$(VERSION_PATCH),$(LIBS)),$(eval $(call so_template,$(lib))))
 
 INSTALL-LIBS=$(call cond_enabled,CONFIG_INSTALL_LIBS,INSTALL-LIBS)
 ifeq ($(MAKECMDGOALS),dist)
diff -ru libvpx-1.2.0/configure patched/configure
--- libvpx-1.2.0/configure	2013-05-10 16:03:44.000000000 +0200
+++ patched/configure	2013-07-06 10:25:27.761836724 +0200
@@ -452,18 +452,18 @@
 }
 
 process_detect() {
-    if enabled shared; then
+    #if enabled shared; then
         # Can only build shared libs on a subset of platforms. Doing this check
         # here rather than at option parse time because the target auto-detect
         # magic happens after the command line has been parsed.
-        if ! enabled linux; then
-            if enabled gnu; then
-                echo "--enable-shared is only supported on ELF; assuming this is OK"
-            else
-                die "--enable-shared only supported on ELF for now"
-            fi
-        fi
-    fi
+        #if ! enabled linux; then
+        #    if enabled gnu; then
+        #        echo "--enable-shared is only supported on ELF; assuming this is OK"
+        #    else
+        #        die "--enable-shared only supported on ELF for now"
+        #    fi
+        #fi
+    #fi
     if [ -z "$CC" ]; then
         echo "Bypassing toolchain for environment detection."
         enable external_build
diff -ru libvpx-1.2.0/libs.mk patched/libs.mk
--- libvpx-1.2.0/libs.mk	2013-05-10 16:03:44.000000000 +0200
+++ patched/libs.mk	2013-07-06 10:51:51.938647192 +0200
@@ -181,16 +181,16 @@
 $(BUILD_PFX)libvpx_g.a: $(LIBVPX_OBJS)
 
 BUILD_LIBVPX_SO         := $(if $(BUILD_LIBVPX),$(CONFIG_SHARED))
-LIBVPX_SO               := libvpx.so.$(VERSION_MAJOR).$(VERSION_MINOR).$(VERSION_PATCH)
+LIBVPX_SO               := libvpx.dll.$(VERSION_MAJOR).$(VERSION_MINOR).$(VERSION_PATCH)
 LIBS-$(BUILD_LIBVPX_SO) += $(BUILD_PFX)$(LIBVPX_SO)\
                            $(notdir $(LIBVPX_SO_SYMLINKS))
 $(BUILD_PFX)$(LIBVPX_SO): $(LIBVPX_OBJS) libvpx.ver
 $(BUILD_PFX)$(LIBVPX_SO): extralibs += -lm
-$(BUILD_PFX)$(LIBVPX_SO): SONAME = libvpx.so.$(VERSION_MAJOR)
+$(BUILD_PFX)$(LIBVPX_SO): SONAME = libvpx.dll.$(VERSION_MAJOR)
 $(BUILD_PFX)$(LIBVPX_SO): SO_VERSION_SCRIPT = libvpx.ver
 LIBVPX_SO_SYMLINKS      := $(addprefix $(LIBSUBDIR)/, \
-                             libvpx.so libvpx.so.$(VERSION_MAJOR) \
-                             libvpx.so.$(VERSION_MAJOR).$(VERSION_MINOR))
+                             libvpx.dll libvpx.dll.$(VERSION_MAJOR) \
+                             libvpx.dll.$(VERSION_MAJOR).$(VERSION_MINOR))
 
 libvpx.ver: $(call enabled,CODEC_EXPORTS)
 	@echo "    [CREATE] $@"
@@ -214,6 +214,7 @@
 
 INSTALL-LIBS-$(CONFIG_SHARED) += $(LIBVPX_SO_SYMLINKS)
 INSTALL-LIBS-$(CONFIG_SHARED) += $(LIBSUBDIR)/$(LIBVPX_SO)
+INSTALL-LIBS-$(CONFIG_SHARED) += $(LIBSUBDIR)/libvpx.dll.a
 
 LIBS-$(BUILD_LIBVPX) += vpx.pc
 vpx.pc: config.mk libs.mk
@@ -421,7 +422,7 @@
 INSTALL-SRCS-$(CONFIG_CODEC_SRCS) += $(LIBVPX_TEST_SRCS)
 
 CODEC_LIB=$(if $(CONFIG_DEBUG_LIBS),vpx_g,vpx)
-CODEC_LIB_SUF=$(if $(CONFIG_SHARED),.so,.a)
+CODEC_LIB_SUF=$(if $(CONFIG_SHARED),.dll,.a)
 $(foreach bin,$(LIBVPX_TEST_BINS),\
     $(if $(BUILD_LIBVPX),$(eval $(bin): \
         lib$(CODEC_LIB)$(CODEC_LIB_SUF) libgtest.a ))\
