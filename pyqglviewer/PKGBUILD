# Maintainer: Gianluca Montecchi <gian@grys.it>
# Contributor: Geoffroy Carrier <geoffroy.carrier@aur.archlinux.org>
# Contributor: Dmitriy Morozov <archlinux@foxcub.org>
# Contributor: Larry Hajali <larryhaja [at] gmail [dot] com>

pkgname=pyqglviewer
_pkgname=libQGLViewer
_pglname=PyQGLViewer
_pkgver=2.3.9
pkgver=0.9.1
pkgrel=1
pkgdesc="Python binding for libQGLViewer C++ library"
url="http://pyqglviewer.gforge.inria.fr/wiki/doku.php"
depends=('qt' 'python2' 'python-opengl')
makedepends=('patch' 'python2')
arch=('i686' 'x86_64')
license=('GPL2' 'GPL3' 'custom')
source=(http://www.libqglviewer.com/src/${_pkgname}-${_pkgver}.tar.gz
				https://gforge.inria.fr/frs/download.php/28212/$_pglname-$pkgver.zip)
md5sums=('a882cb3a8da4ee904a33b46ebb44f905'
				'a7638c5fb619aa8b3c0fdc59068f0a3e')

build() 
{
		cd $srcdir/${_pkgname}-$_pkgver
		# dos2unix?
		patch -p0 < $srcdir/$_pglname-$pkgver/src/$_pkgname-$_pkgver-py.patch
		cd QGLViewer
		qmake
		make
		make install INSTALL_ROOT="$pkgdir"

		# Install license.
		cd $srcdir/${_pkgname}-$_pkgver
		install -d -m 0755 "${pkgdir}"/usr/share/licenses/$_pkgname/ || return 1
		install -m 0644 LICENCE GPL_EXCEPTION "${pkgdir}"/usr/share/licenses/$_pkgname/ || return 1

		# PyQGLViewer
		cd $srcdir/$_pglname-$pkgver
		python2 configure.py -Q ../$_pkgname-$pkgver
		make
		make install DESTDIR=$pkgdir
}
