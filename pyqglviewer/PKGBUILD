# Maintainer: Gianluca Montecchi <gian@grys.it>
# Contributor: Geoffroy Carrier <geoffroy.carrier@aur.archlinux.org>
# Contributor: Dmitriy Morozov <archlinux@foxcub.org>
# Contributor: Larry Hajali <larryhaja [at] gmail [dot] com>

pkgname=pyqglviewer
_pkgname=libQGLViewer
_pglname=PyQGLViewer
_pqglversion=0.9.1
pkgver=2.3.9
pkgrel=2
pkgdesc="C++ library based on Qt that eases the creation of OpenGL 3D viewers"
url="http://www.libqglviewer.com/"
depends=('qt' 'python2' 'python-opengl')
makedepends=('patch' 'python2')
arch=('i686' 'x86_64')
license=('GPL2' 'GPL3' 'custom')
source=(http://www.libqglviewer.com/src/${_pkgname}-${pkgver}.tar.gz
				https://gforge.inria.fr/frs/download.php/28212/$_pglname-$_pqglversion.zip)
md5sums=('a882cb3a8da4ee904a33b46ebb44f905'
				'a7638c5fb619aa8b3c0fdc59068f0a3e')

build() 
{
		cd $srcdir/${_pkgname}-$pkgver
		# dos2unix?
		patch -p0 < $srcdir/$_pglname-$_pqglversion/src/$_pkgname-$pkgver-py.patch
		cd QGLViewer
		qmake
		make
		make install INSTALL_ROOT="$pkgdir"

		# Install license.
		cd $srcdir/${_pkgname}-$pkgver
		install -d -m 0755 "${pkgdir}"/usr/share/licenses/$pkgname/ || return 1
		install -m 0644 LICENCE GPL_EXCEPTION "${pkgdir}"/usr/share/licenses/$pkgname/ || return 1

		# PyQGLViewer
		cd $srcdir/$_pglname-$_pqglversion
		python2 configure.py -Q ../$_pkgname-$pkgver
		make
		make install DESTDIR=$pkgdir
}
