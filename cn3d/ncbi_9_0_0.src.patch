diff -ur ./src/ncbi_cxx--9_0_0/src.orig/app/cn3d/cn3d_app.cpp ./src/ncbi_cxx--9_0_0/src/app/cn3d/cn3d_app.cpp
--- ./src/ncbi_cxx--9_0_0/src.orig/app/cn3d/cn3d_app.cpp	2008-06-10 18:53:25.000000000 +0200
+++ ./src/ncbi_cxx--9_0_0/src/app/cn3d/cn3d_app.cpp	2012-12-20 01:33:31.168107391 +0100
@@ -286,7 +286,8 @@
     SetUpWorkingDirectories(argv[0]);
 
     // read dictionary
-    wxString dictFile = wxString(GetDataDir().c_str()) + "bstdt.val";
+    /*wxString dictFile = wxString(GetDataDir().c_str()) + "bstdt.val";*/
+    wxString dictFile = wxString("/usr/share/cn3d/data/bstdt.val");
     LoadStandardDictionary(dictFile.c_str());
 
     // set up registry and favorite styles (must be done before structure window creation)
diff -ur ./src/ncbi_cxx--9_0_0/src.orig/app/cn3d/cn3d_png.cpp ./src/ncbi_cxx--9_0_0/src/app/cn3d/cn3d_png.cpp
--- ./src/ncbi_cxx--9_0_0/src.orig/app/cn3d/cn3d_png.cpp	2007-05-04 19:18:18.000000000 +0200
+++ ./src/ncbi_cxx--9_0_0/src/app/cn3d/cn3d_png.cpp	2012-12-19 23:51:55.763895646 +0100
@@ -56,6 +56,7 @@
 #endif
 
 #include <png.h>
+#include <zlib.h>
 
 #include "remove_header_conflicts.hpp"
 
@@ -668,7 +669,7 @@
         if (!png_ptr) throw "can't create PNG write structure";
         info_ptr = png_create_info_struct(png_ptr);
         if (!info_ptr) throw "can't create PNG info structure";
-        if (setjmp(png_ptr->jmpbuf)) throw "setjmp failed";
+        if (setjmp(png_jmpbuf(png_ptr))) throw "setjmp failed";
         png_init_io(png_ptr, out);
 
         // sets callback that's called by PNG after each written row
diff -ur ./src/ncbi_cxx--9_0_0/src.orig/app/cn3d/cn3d_tools.cpp ./src/ncbi_cxx--9_0_0/src/app/cn3d/cn3d_tools.cpp
--- ./src/ncbi_cxx--9_0_0/src.orig/app/cn3d/cn3d_tools.cpp	2011-07-22 16:10:51.000000000 +0200
+++ ./src/ncbi_cxx--9_0_0/src/app/cn3d/cn3d_tools.cpp	2012-12-20 01:46:02.350606503 +0100
@@ -355,8 +355,8 @@
     // find or create preferences folder
     wxString localDir;
     wxSplitPath((wxFileConfig::GetLocalFileName("unused")).c_str(), &localDir, NULL, NULL);
-    wxString prefsDirLocal = localDir + wxFILE_SEP_PATH + "Cn3D_User";
-    wxString prefsDirProg = wxString(programDir.c_str()) + wxFILE_SEP_PATH + "Cn3D_User";
+    wxString prefsDirLocal = localDir + wxFILE_SEP_PATH + ".cn3d";
+    wxString prefsDirProg = wxString(programDir.c_str()) + wxFILE_SEP_PATH + ".cn3d";
     if (wxDirExists(prefsDirLocal))
         prefsDir = prefsDirLocal.c_str();
     else if (wxDirExists(prefsDirProg))
diff -ur ./src/ncbi_cxx--9_0_0/src.orig/app/cn3d/structure_window.cpp ./src/ncbi_cxx--9_0_0/src/app/cn3d/structure_window.cpp
--- ./src/ncbi_cxx--9_0_0/src.orig/app/cn3d/structure_window.cpp	2010-08-03 17:25:02.000000000 +0200
+++ ./src/ncbi_cxx--9_0_0/src/app/cn3d/structure_window.cpp	2012-12-19 23:51:55.767229022 +0100
@@ -527,7 +527,7 @@
 #ifdef __WXMAC__
             path = wxString(GetProgramDir().c_str()) + "../Resources/cn3d_commands.htb";
 #else
-            path = wxString(GetProgramDir().c_str()) + "cn3d_commands.htb";
+            path = wxString("/usr/share/cn3d/cn3d_commands.htb");
 #endif
             if (!helpController->AddBook(path))
                 ERRORMSG("Can't load help book at " << path.c_str());
diff -ur ./src/ncbi_cxx--9_0_0/src.orig/app/Makefile.in ./src/ncbi_cxx--9_0_0/src/app/Makefile.in
--- ./src/ncbi_cxx--9_0_0/src.orig/app/Makefile.in	2012-05-08 19:58:01.000000000 +0200
+++ ./src/ncbi_cxx--9_0_0/src/app/Makefile.in	2012-12-19 23:51:55.767229022 +0100
@@ -9,7 +9,7 @@
            agpconvert id2_fetch agp_validate objextract lds_indexer \
            bdb_env_keeper nw_aligner speedtest idmapper formatguess \
            multireader read_blast_result splign hfilter \
-           annotwriter compart streamtest
+           annotwriter compart streamtest cn3d
 
 EXPENDABLE_SUB_PROJ = split_cache wig2table netcache
 
diff -ur ./src/ncbi_cxx--9_0_0/src.orig/connect/ncbi_gnutls.c ./src/ncbi_cxx--9_0_0/src/connect/ncbi_gnutls.c
--- ./src/ncbi_cxx--9_0_0/src.orig/connect/ncbi_gnutls.c	2012-01-21 01:28:17.000000000 +0100
+++ ./src/ncbi_cxx--9_0_0/src/connect/ncbi_gnutls.c	2012-12-19 23:51:55.767229022 +0100
@@ -112,7 +112,7 @@
     0
 };
 static const int kGnuTlsCompPrio[] = {
-    GNUTLS_COMP_LZO,
+    /*GNUTLS_COMP_LZO,*/
     GNUTLS_COMP_ZLIB,
     GNUTLS_COMP_NULL,
     0
diff -ur ./src/ncbi_cxx--9_0_0/src.orig/db/bdb/bdb_env.cpp ./src/ncbi_cxx--9_0_0/src/db/bdb/bdb_env.cpp
--- ./src/ncbi_cxx--9_0_0/src.orig/db/bdb/bdb_env.cpp	2011-08-18 20:28:26.000000000 +0200
+++ ./src/ncbi_cxx--9_0_0/src/db/bdb/bdb_env.cpp	2012-12-19 23:51:55.767229022 +0100
@@ -896,11 +896,11 @@
         ;
 
         int max_write;
-#if (DB_VERSION_MAJOR == 4  &&  DB_VERSION_MINOR >= 6)
+/* #if (DB_VERSION_MAJOR == 4  &&  DB_VERSION_MINOR >= 6) */
         db_timeout_t max_write_sleep;
-#else
+/*#else
         int max_write_sleep;
-#endif
+#endif */
         ret =
             m_Env->get_mp_max_write(m_Env, &max_write, &max_write_sleep);
         BDB_CHECK(ret, "DB_ENV::get_mp_max_write");
diff -ur ./src/ncbi_cxx--9_0_0/src.orig/sra/sdk/libs/kns/url-fetcher-curl.c ./src/ncbi_cxx--9_0_0/src/sra/sdk/libs/kns/url-fetcher-curl.c
--- ./src/ncbi_cxx--9_0_0/src.orig/sra/sdk/libs/kns/url-fetcher-curl.c	2012-01-09 20:24:24.000000000 +0100
+++ ./src/ncbi_cxx--9_0_0/src/sra/sdk/libs/kns/url-fetcher-curl.c	2012-12-19 23:51:55.767229022 +0100
@@ -38,7 +38,7 @@
 #include <string.h>
 
 #include <curl/curl.h>
-#include <curl/types.h>
+/*#include <curl/types.h>*/
 #include <curl/easy.h>
 
 /*--------------------------------------------------------------------------
diff -ur ./src/ncbi_cxx--9_0_0/src.orig/sra/sdk/tools/refseq-load/refseq-load.c ./src/ncbi_cxx--9_0_0/src/sra/sdk/tools/refseq-load/refseq-load.c
--- ./src/ncbi_cxx--9_0_0/src.orig/sra/sdk/tools/refseq-load/refseq-load.c	2012-01-09 20:24:24.000000000 +0100
+++ ./src/ncbi_cxx--9_0_0/src/sra/sdk/tools/refseq-load/refseq-load.c	2012-12-19 23:51:55.767229022 +0100
@@ -41,7 +41,7 @@
 #include <sysalloc.h>
 
 #include <curl/curl.h>
-#include <curl/types.h>
+/*#include <curl/types.h>*/
 #include <curl/easy.h>
 
 #include <stdlib.h>
