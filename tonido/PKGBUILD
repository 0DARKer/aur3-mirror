# Maintainer: Dan Serban

pkgname=tonido
pkgver=latest
pkgrel=1
pkgdesc="A software and service that can make files and media in your computer available anywhere through a web browser"
url=http://www.tonido.com/
license=(unknown:freeware)
arch=(i686)
depends=(atk cairo fontconfig freetype2 gcc-libs gdk-pixbuf2 glib2 glibc gtk2 libjpeg6 libnotify1-bin libpng12 libvorbis libx11 ncurses openssl098 pango taglib zlib)

build()
{
  wget -O TonidoSetup_i686.deb http://www.tonido.com/download.php?TonidoSetup_i686.deb
  bsdtar -xf TonidoSetup_i686.deb data.tar.gz
  bsdtar -xf data.tar.gz
  rm data.tar.gz
  cd "${srcdir}"/usr/local
  mv tonido "${srcdir}"/usr/share/
  cd "${srcdir}"/usr
  rmdir local
  cd "${srcdir}"
  mv usr "${pkgdir}"/
  mkdir -p "${pkgdir}"/usr/bin
  USRBINFILE="${pkgdir}"/usr/bin/tonido
  echo '#!/bin/bash' > "${USRBINFILE}"
  echo 'cd /usr/share/tonido' >> "${USRBINFILE}"
  echo 'export LD_LIBRARY_PATH=".:${LD_LIBRARY_PATH}"' >> "${USRBINFILE}"
  echo './tonidogtk 1>/dev/null 2>/dev/null' >> "${USRBINFILE}"
  chmod +x "${USRBINFILE}"
  DESKTOPFILE="${pkgdir}"/usr/share/applications/tonido.desktop
  echo "[Desktop Entry]" > "${DESKTOPFILE}"
  echo "Name=Tonido" >> "${DESKTOPFILE}"
  echo "Comment=Tonido" >> "${DESKTOPFILE}"
  echo "Exec=spideroak" >> "${DESKTOPFILE}"
  echo "Terminal=tonido" >> "${DESKTOPFILE}"
  echo "Type=Application" >> "${DESKTOPFILE}"
  echo "Categories=Network;" >> "${DESKTOPFILE}"
}

