# Contributor: Dan Serban

pkgname=tonido
pkgver=LATEST
pkgrel=1
pkgdesc="A software and service that can make files and media in your computer available anywhere through a web browser"
url=http://www.tonido.com/
license=(unknown)
arch=(i686)
depends=(atk cairo fontconfig freetype2 gcc-libs gdk-pixbuf2 glib2 glibc gtk2 libjpeg6 libpng12 libvorbis libx11 ncurses openssl-compatibility pango taglib zlib)

build()
{
  wget -O TonidoSetup_i686.deb http://www.tonido.com/download.php?TonidoSetup_i686.deb
  ar -xv TonidoSetup_i686.deb
  bsdtar -xvf data.tar.gz
  cd "$srcdir/usr/local"
  mv tonido "$srcdir/usr/share/"
  cd "$srcdir/usr"
  rmdir local
  cd "$srcdir"
  mv usr "$pkgdir/"
  wget http://archive.ubuntu.com/ubuntu/pool/main/libn/libnotify/libnotify1_0.5.0-2ubuntu1_i386.deb
  rm data.tar.gz
  ar -xv libnotify1_0.5.0-2ubuntu1_i386.deb
  bsdtar -xvf data.tar.gz
  cd "$srcdir/usr/lib"
  mv lib* "$pkgdir/usr/share/tonido/"
  mkdir -p "$pkgdir/usr/bin"
  echo "#!/bin/bash" > $pkgdir/usr/bin/tonido
  echo "cd /usr/share/tonido" >> $pkgdir/usr/bin/tonido
  echo "export LD_LIBRARY_PATH=." >> $pkgdir/usr/bin/tonido
  echo "./tonidogtk 2> /dev/null 1>&2" >> $pkgdir/usr/bin/tonido
  chmod +x "$pkgdir/usr/bin/tonido"
}
