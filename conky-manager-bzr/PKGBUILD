# Maintainer: Josip Ponjavic <josipponjavic at gmail dot com>

pkgname=conky-manager-bzr
pkgver=58
pkgrel=1
pkgdesc="Simple tool for managing conky scripts"
arch=('i686' 'x86_64')
url=http://teejeetech.blogspot.in/
license=('GPL3')
depends=(conky gdk-pixbuf2 gtk3 glib2 libgee python2-wnck p7zip rsync)
makedepends=(bzr vala)
conflicts=(conky-manager)
install=$pkgname.install
md5sums=('SKIP')

_bzrbranch=lp:~teejee2008/conky-manager/trunk
_bzrmod=$pkgname

build() {
  cd $srcdir
  msg "Connecting to the server...."
    
  if [ -d $_bzrmod ]; then
    cd $_bzrmod && bzr pull $_bzrbranch -r $pkgver && cd ..
    msg "The local files are updated."
  else
    bzr branch $_bzrbranch $_bzrmod -r $pkgver
  fi

  msg "BZR checkout done or server timeout"
  msg "Starting make..."

  [ -d ./${_bzrmod}-build ] && rm -rf ./${_bzrmod}-build
  cp -r ./${_bzrmod} ./${_bzrmod}-build
  cd ./${_bzrmod}-build

  make
}

package() {
  cd "$srcdir/$_bzrmod-build"

  make DESTDIR="$pkgdir" install
}
