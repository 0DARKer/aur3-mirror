# Maintainer: Elovsky Valentin (evvsoft@gmail.com)
# Contributor: Shalygin Konstantin (kostya@opentech.ru)

pkgname='ivideon-server'
pkgver='3.5.2'
pkgrel='337'
pkgdesc='Ivideon Server (with QT5 GUI)'
arch=('i686' 'x86_64')
url=('http://ivideon.ru/')
license=('freeware')
depends=('ivideon-server-headless' 'qt5-base' 'qt5-svg' 'qt5-script' 'libsndfile' 'libxcb' 'libsm' 'gksu')
conflicts=('ivideon-video-server-nogui' 'ivideon-video-server')
rel='9740db6b144d'

if [[ "$CARCH" == "i686" ]]; then
  source+=("http://packages.ivideon.com/ubuntu/pool/non-free/i/ivideon-video-server/ivideon-video-server_${pkgver}-${pkgrel}~${rel}_i386.deb")
  sha256sums+=('ea5f4d9d9c27e63b675c329d5574da85f8de75cecf8eff4cc674ec1f9365a7be')
fi

if [[ "$CARCH" == "x86_64" ]]; then
  source+=("http://packages.ivideon.com/ubuntu/pool/non-free/i/ivideon-video-server/ivideon-video-server_${pkgver}-${pkgrel}~${rel}_amd64.deb")
  sha256sums+=('8449b088edc37f83d63fe77467842176bfd7a5eeaf46dca0506ea5b5b3f0d717')
fi

build() {
  cd "$srcdir"
  bsdtar xf "$srcdir/data.tar.gz"
}

package() {
  cp -dpr --no-preserve=ownership "$srcdir/opt" "$pkgdir"
  cp -dpr --no-preserve=ownership "$srcdir/usr" "$pkgdir"
}
