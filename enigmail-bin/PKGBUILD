# Maintainer: Michael Duell <mail@akurei.me> PGP-Key: 6EE23EBE
pkgname=enigmail-bin
_pkg_main_ver=1.3
pkgver=${_pkg_main_ver}
pkgrel=3
pkgdesc="The Mozilla Thunderbird GnuPG encryption plugin for both 32 and 64 bit systems. Binary version."
arch=('i686' 'x86_64')
url="http://www.mozilla-enigmail.org/"
license=('MPL')
_tb_min_ver="6.0"
depends=('thunderbird>=${_tb_min_ver}')
makedepends=('unzip')
provides=('enigmail')
conflicts=('enigmail' 'enigmail-cvs')
replaces=('enigmail-64-bin')
options=(!strip)
install='enigmail-bin.install'
source=(http://www.mozilla-enigmail.org/download/release/${_pkg_main_ver}/enigmail-${pkgver}-tb+sm.xpi)
noextract=(enigmail-${pkgver}-tb+sm.xpi)
_tb_version=$(LANG=C pacman -Qi thunderbird|grep Version|cut -f 2 -d ":"|cut -f 2 -d " "|cut -f 1 -d -)

build() {
  cd "$srcdir/"
  unzip -q *.xpi
  _eid=$(grep "<em:id>" install.rdf | head -n 1 |cut -f 2 -d \>|cut -f 1 -d \<)
  mkdir -p "${pkgdir}/usr/lib/thunderbird-${_tb_version}/extensions/"
  unzip -q -d "${pkgdir}/usr/lib/thunderbird-${_tb_version}/extensions/${_eid}" *.xpi
}


# vim:set ts=2 sw=2 et:
sha512sums=('33ea281931a4eb41ebc7f482a23f56aa4704f2fbee17ae8c48b7c36eaa3c65712f4be980645d710d0aff0fae031b776961fb32c63f772c4fbd5a026da6e7dd5c')
