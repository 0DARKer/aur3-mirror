# Maintainer: Sara <sfauzia at comcast dot net>

pkgname=minmad-git
pkgver=20111115
pkgrel=1
pkgdesc="A minimal mp3 player using libmad"
arch=('i686' 'x86_64')
url="http://repo.or.cz/w/minmad.git"
license=('GPL')
depends=('libmad')
optdepends=('oss: alternative sound backend')
makedepends=('git')
provides=('minmad')
conflicts=('minmad')
source=('minmad.1')
md5sums=('5741b98c32667a8c360bc95b08c01b86')

_gitroot=git://repo.or.cz/minmad.git 
_gitname=minmad

build(){
    cd "${srcdir}"
    msg "Connecting to GIT server...."
    
    if [[ -d ${_gitname} ]]; then
        cd "${_gitname}"
        git pull origin
        msg "The local files are updated."
    else
        git clone "${_gitroot}" -b alsa
        cd "${_gitname}"
    fi
    msg "Checkout done or server timeout"
    rm -rf "${srcdir}/${_gitname}-build"
    git clone "${srcdir}/${_gitname}" "${srcdir}/${_gitname}-build"
    cd "${srcdir}/${_gitname}-build"

    msg "Starting make..."
    make
}

package(){
    install -Dm755 "${srcdir}/${_gitname}-build/${_gitname}" "${pkgdir}/usr/bin/${_gitname}"
    # Install man page
    install -Dm644 ${srcdir}/${_gitname}.1 "$pkgdir/usr/share/man/man1/${_gitname}.1"
}
