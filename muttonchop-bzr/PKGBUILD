# Maintainer: timttmy <marshall\\dot//cleave\\at//tiscali\\dot//co\\dot//uk>

pkgname=muttonchop-bzr
pkgver=116
pkgrel=1
pkgdesc='MuttonChop is a media player designed to be controlled through a web interface or by a JSON API'
arch=('i686' 'x86_64')
url='http://www.jezra.net/projects/muttonchop'
license=('GPL3')

makedepends=('bzr' 'vala' 'gtk3' 'glib' 'json-glib' 'sqlite3' 'gstreamer0.10-ffmpeg' 'gstreamer0.10-good-plugins' 'gstreamer0.10-bad-plugins' 'gstreamer0.10-ugly-plugins' 'libgee' 'libxml2' 'gvfs')
provides=(muttonchop)
source=('muttonchop.conf')
md5sums=('e384f91da94f18c778ddd7c7a0dee264')
install=muttonchop.install
_bzrtrunk=lp:muttonchop
_bzrmod=muttonchop


build() {
  cd $srcdir
  msg "Connecting to launchpad..."


if [ ! -d ./${_bzrmod} ]; then
bzr co ${_bzrtrunk} ${_bzrmod} -r ${pkgver}
else
bzr up ${_bzrmod}
fi

msg "BZR checkout done or server timeout"
msg "Starting make..."


cd $srcdir/$_bzrmod
./build || return 1
mkdir -p "$pkgdir/usr/bin/"
mkdir -p "$pkgdir/etc/"
mkdir -p "$pkgdir/srv/http/muttonchop/"
cp $srcdir/$_bzrmod/muttonchop "$pkgdir/usr/bin/muttonchop" || return 1
cp $startdir/muttonchop.conf "$pkgdir/etc/muttonchop.conf" || return 1
cp -r $srcdir/$_bzrmod/public "$pkgdir/srv/http/muttonchop" || return 1
}
