# Maintainer: Serge Zirukin <ftrvxmtrx@gmail.com>
# Contributor: Sergei Lebedev <superbobry@gmail.com>
# Contributor: Justin Davis <jrcd 83 at gmail>

pkgname=ocaml-yojson
_oname=yojson
pkgver=1.0.3
pkgrel=2
pkgdesc='An optimized parsing and printing library for JSON'
arch=('i686' 'x86_64')
options=('!strip')
license=('BSD')
depends=('ocaml' 'ocaml-easy-format' 'ocaml-biniou')
makedepends=('ocaml-findlib' 'cppo')
url='http://martin.jambon.free.fr/yojson.html'
source=("http://martin.jambon.free.fr/${_oname}-${pkgver}.tar.gz")
md5sums=('9f19c943c9527e18ca624b5cefd79750')

_extdir="${srcdir}/${_oname}-${pkgver}"
_destdir="${pkgdir}/usr/lib/ocaml"

build() {
  cd "$_extdir"
  make all doc
}

package() {
  cd "$_extdir"
  mkdir -p "${pkgdir}/usr/bin" "$_destdir"
  OCAMLFIND_DESTDIR="$_destdir" make install BINDIR="${pkgdir}/usr/bin"
  install -d -m 0755 "${pkgdir}/usr/share/doc/$pkgname"
  install -t "${pkgdir}/usr/share/doc/$pkgname" doc/*
}
