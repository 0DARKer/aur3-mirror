# Maintainer: Bersam Karbasion <bersam.k at gmail dot com>

pkgname=prozgui
pkgbranch=2.0
pkgver=2.0.5beta
pkgrel=1
pkgdesc="ProZilla download accelerator graphic user interface"
arch=('i686' 'x86_64')
url="http://prozilla.genesys.ro"
license=('GPL')
depends=('prozilla')
makedepends=('intltool' 'vala')
source=($pkgname-$pkgver.tar.bz2 $pkgname-$pkgver-autoconf.diff $pkgname-$pkgver-gettext.diff $pkgname-$pkgver-include.diff $pkgname-$pkgver-locale.diff $pkgname-$pkgver-oldmacros.diff $pkgname-$pkgver-qualification.diff $pkgname-$pkgver-strcpy.diff $pkgname-2.0.5beta_remove-redefinitions.patch $pkgname-gcc4.diff $pkgname-retval.diff)
md5sums=('b501ecce2844d411ba39be761027ac4e' '4805a41fff0bfa2735dae95bdd8ede16' 'bfee390129782042e1e5a12353d7df67' '5a1f9949d4e70026c82c59bc8cc65159' '34b0092fb695fedc046d0b0740f087bf' '66d31c8bf7d4b481b3ae1078366900a8' 'd152dad62e876597daccf7f3c6021847' 'e07ddeccb8a56d8a5701c3ddaf777b2b' 'afa38b99c2f52593bbaa52557dbd6ded' '5dbf1b08cc2dca3bf6c27c8c02b1a12b' '6385fae37eff99e3880a944f5deec696')

build() {
  export CFLAGS="$RPM_OPT_FLAGS" 
  export CXXFLAGS="$RPM_OPT_FLAGS"
  cd "$srcdir/$pkgname-$pkgver/"
  patch -p0 < $srcdir/$pkgname-$pkgver-autoconf.diff
  patch -p1 < $srcdir/$pkgname-$pkgver-gettext.diff
  patch -p2 < $srcdir/$pkgname-$pkgver-strcpy.diff
  patch -p3 < $srcdir/$pkgname-$pkgver-include.diff
  patch -p4 < $srcdir/$pkgname-$pkgver-oldmacros.diff
  patch -p5 < $srcdir/$pkgname-retval.diff
  patch -p6 < $srcdir/$pkgname-gcc4.diff
  patch -p7 < $srcdir/$pkgname-$pkgver-qualification.diff
  patch -p8 < $srcdir/$pkgname-$pkgver-locale.diff
  patch -p9 < $srcdir/$pkgname-2.0.5beta_remove-redefinitions.patch



  ./configure --prefix=/usr --mandir=/usr/share/man --with-fltk-libs="$FLTK_PREFIX/%{_lib}" --with-fltk-includes="$FLTK_PREFIX/include" --enable-shared --disable-static || return 1
  make CFLAGS="-Wall -ggdb -D_REENTRANT $RPM_OPT_FLAGS" CXXFLAGS="-I$FLTK_PREFIX/include $RPM_OPT_FLAGS"|| return 1
  make DESTDIR="$pkgdir" install || return 1
  rm -rf $srcdir
}
