# Contributor: Calimero <calimeroteknik@free.fr>

pkgname=nouveau-drm-snapshot
pkgver=20090824
pkgrel=1
pkgdesc="Nouveau DRM module from snapshot"
url="http://nouveau.freedesktop.org"
license=('GPL')
arch=('x86_64' 'i686')
depends=('glibc' 'kernel26>=2.6.31')
makedepends=('git' 'gcc' 'autoconf' 'automake' 'kernel-headers' 'wget')
conflicts=('nouveau-drm' 'nouveau-drm-git')
replaces=('nouveau-drm')
provides=('nouveau-drm' 'nouveau-drm-git')
backup=()
install=

build() {
  cd ${srcdir}
  rm -rf *

 msg "Downloading snapshot...." && echo ""
  wget http://people.freedesktop.org/~pq/nouveau-drm/master-compat.tar.gz || return 1

 msg "Extracting sources..."
  tar xf master-compat.tar.gz || return 1

 msg "Starting make..." && echo ""
  cd master-compat/nouveau || return 1
  make LINUXDIR=/lib/modules/2.6.31-git/build || return 1
  make LINUXDIR=/lib/modules/2.6.31-git/build INSTALL_MOD_PATH="${startdir}/pkg" install || return 1
}
