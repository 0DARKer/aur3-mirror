# Maintainer: Peter Ivanov <ivanovp@gmail.com>

pkgname=papilio-designlab
pkgver=0.2.0
pkgrel=2
pkgdesc="It is an IDE specially designed to get you up and running quickly with Soft Processors on the Papilio FPGA boards"
arch=('x86_64' 'i686')
url="http://forum.gadgetfactory.net/index.php?/files/file/236-papilio-designlab-ide/"
license=('GPL')
groups=()
options=(!strip)
depends=('java-runtime')
_bits=32
[ $CARCH = x86_64 ] && _bits=64
source=("DesignLab-020-linux${_bits}.tgz::http://www.gadgetfactory.net/download/DesignLab/DesignLab-020-linux${_bits}.tgz" 'designlab' 'designlab.desktop' 'designlab.png')
install=papilio-designlab.install
[ $CARCH = i686 ] && md5sums=('231e4527d8b683adf43c6d1163162498')
[ $CARCH = x86_64 ] && md5sums=('50aa2621c3ca79f2d7982bf304df7de3')
md5sums+=('95b470f30b17b790c95f983f20fc71f1'
         'a4d2f7a5a0508106664d158e51f7e034'
         '7e27108f30b6a253abf907f0b96c56b3')


build() {
  echo "Nothing to build..."
}

package() {
  cd "$srcdir/DesignLab-020"
  mkdir -p $pkgdir/usr/share/papilio-designlab
  cp -ax * $pkgdir/usr/share/papilio-designlab
  # Correcting permissions
  msg "Correction permissions..."
  find $pkgdir/usr/share/papilio-designlab -type d -print0|xargs -0 chmod 755
  find $pkgdir/usr/share/papilio-designlab/hardware/tools/zpu -type f -print0|xargs -0 chmod 755
#  if test "$CARCH" == x86_64; then
#      echo "64-bit serial library is used..."
#      cp -ax ./lib/librxtxSerial64.so $pkgdir/usr/share/papilio-designlab-ide/lib/librxtxSerial.so
#  fi
  cd "$srcdir"
  install -D -m755 designlab "${pkgdir}/usr/bin/designlab"
  install -D -m644 designlab.desktop "${pkgdir}/usr/share/applications/designlab.desktop"
  install -D -m644 designlab.png "${pkgdir}/usr/share/pixmaps/designlab.png"
}
