# QScintilla (Dev): Installer: Arch
# Contributor: Chris Giles <Chris.G.27 (at) Gmail.com>

pkgname=qscintilla-py3-dev
realname=QScintilla
filename=qscintilla
pkgver=2.3.3
libver=5.0.2
pkgdate=20090305
pkgrel=1
pkgdesc="A port to Qt4 of Neil Hodgson's Scintilla C++ editor class.  This is the latest development snapshot."
arch=('any')
url="http://www.riverbankcomputing.co.uk/${filename}/"
license=('GPL3')
provides=('qscintilla=2.3.3')
depends=('qt>=4.5')
conflicts=('qscintilla' 'qscintilla2')
replaces=('qscintilla2')
options=(!emptydirs)

source=(http://riverbankcomputing.com/static/Downloads/${realname}2/${realname}-gpl-${pkgver}-snapshot-${pkgdate}.tar.gz)
md5sums=('1497959c4a48a8dff68785e967bc3a7e')

build() {
	cd ${srcdir}/${realname}-gpl-${pkgver}-snapshot-${pkgdate}/Qt4

	qmake ${filename}.pro || return 1
	sed -i 's|$(MOVE) $(TARGET)|$(COPY) $(TARGET)|g' Makefile || return 1
	make || return 1
	make INSTALL_ROOT=${pkgdir} install || return 1

	cd ../designer-Qt4

	# Qt4 designer ${filename}2 plugin
	mkdir -p ${pkgdir}/usr/lib/qt/plugins/designer

	echo "INCPATH += ../Qt4" >> designer.pro || return 1
	sed -i "s|LIBS.*|LIBS += -L../Qt4 -l${filename}2|g" designer.pro || return 1
	qmake designer.pro || return 1
	make || return 1
	cp lib${filename}plugin.so ${pkgdir}/usr/lib/qt/plugins/designer/
}
