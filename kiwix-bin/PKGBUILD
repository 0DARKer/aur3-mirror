# Maintainer: Felipe Hommen <felibank at gmail dot com>
pkgname=kiwix-bin
pkgver=0.9_beta5
pkgrel=1
pkgdesc="Offline reader for Web content. It's especially intended to make Wikipedia available offline."
arch=('i686' 'x86_64')
url="http://www.kiwix.org"
license=('GPL3')
[[ "$CARCH" == 'x86_64' ]] && depends=('rpcbind' 'lib32-glibc' 'lib32-gtk2' 'lib32-alsa-lib' 'lib32-libxt' 'lib32-libcanberra' 'lib32-sqlite3' 'java-environment') && _usrlib='lib32'
[[ "$CARCH" == 'i686' ]] && depends=('rpcbind' 'gtk2' 'alsa-lib' 'libxt' 'libcanberra' 'sqlite3' 'java-environment') && _usrlib='lib'
provides=('kiwix')
conflicts=('kiwix')
install='kiwix.install'
source=('http://downloads.sourceforge.net/project/kiwix/0.9_beta5/kiwix-0.9-beta5-linux.tar.bz2' 'http://upload.wikimedia.org/wikipedia/commons/1/14/Kiwix_icon.svg' 'kiwix.desktop')
md5sums=('de1428e9de90554b292cf54e7c2dc99d' 'dc63c41a229505145313d5a208b163ba' '305148b6e66396dc26bc7d7f2d92f7cb')

#build() {
#}

package() {
	mkdir -p ${pkgdir}/usr/${_usrlib}
	mkdir -p ${pkgdir}/usr/bin
	cp -R -d ${srcdir}/kiwix ${pkgdir}/usr/${_usrlib}/
	find ${pkgdir}/usr/${_usrlib}/kiwix -type d -exec chmod a+rx {} \;  # Some source directories don't have proper permisions
	ln -f -s /usr/${_usrlib}/kiwix/kiwix ${pkgdir}/usr/bin/kiwix
	chmod a+r ${pkgdir}/usr/${_usrlib}/kiwix/bin/xapian-compact  # This file wasn't readable
	install -D -m644 ${srcdir}/Kiwix_icon.svg ${pkgdir}/usr/share/pixmaps/kiwix.svg
	install -D -m644 ${srcdir}/kiwix.desktop ${pkgdir}/usr/share/applications/kiwix.desktop
}
