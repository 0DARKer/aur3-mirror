# Contributor: taylorchu <taylorchu@gmail.com>
pkgname=fcitx-chewing-git
pkgver=2013040221
pkgrel=1
pkgdesc="Fcitx Wrapper for libchewing"
arch=('i686' 'x86_64')
url="https://github.com/fcitx/fcitx-chewing"
license=(GPLv2)
depends=('fcitx' 'libchewing')
makedepends=('git' 'cmake' 'gettext' 'coreutils' 'sh')
provides=('fcitx-chewing')
conflicts=('fcitx-chewing')

_gitname=fcitx-chewing

_gitroot=https://github.com/fcitx/fcitx-chewing
_gitbranch=master

build(){
    cd "$srcdir"
    msg "Connecting to GIT server..."
    if [[ -d "$_gitname" ]] ; then
        cd "$_gitname" && git pull origin
        msg "The local files are updated."
    else
        git clone --depth 1 "$_gitroot" "$_gitname"
    fi
    msg "GIT checkout done or server timeout"

    msg "Creating make environment..."
    mkdir -p "$srcdir/$_gitname-build"

    msg "Starting make..."
    cd "$srcdir/$_gitname-build"
    cmake "../$_gitname" -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_BUILD_TYPE=Release
    make
}

package() {
    cd "$srcdir/$_gitname-build"
    make DESTDIR="$pkgdir" install
}
