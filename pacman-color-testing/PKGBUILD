# Maintainer: Det <nimetonmaili at gmail a-dot com>
# Based on the original pacman-color

_pkgbase=pacman
pkgname=pacman-color-testing
pkgver=3.4.3
pkgrel=1
pkgdesc="A command-line frontend for libalpm (aka pacman) with a color patch - prefers [testing]"
arch=('i686' 'x86_64')
url="http://www.archlinux.org/pacman/"
license=('GPL')
depends=('pacman>=3.4' 'pacman<3.5')
# depends=("pacman=${pkgver}")
conflicts=('pacman-color')
backup=(etc/pacman.d/color.conf)
source=(ftp://ftp.archlinux.org/other/pacman/pacman-${pkgver}.tar.gz
        ${pkgname}.patch
        color.conf)
# md5sums=(`wget ${source/pacman-*}md5sums -qO - | grep ${pkgver} | cut -d " " -f1`
md5sums=('3656a4a05346e28bafa5342879fa278a'
         '0fdc99d21d72c0a36429e43e215708f8'
         'fd5087a5f6cf95ca0175ddb9fd257505')

build() {
  cd ${_pkgbase}-${pkgver}
  patch -Np1 -i ../${pkgname}.patch
  ./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var --disable-doc
  make
}

package() {
  # install the binary
  install -Dm755 ${_pkgbase}-${pkgver}/src/${_pkgbase}/.libs/${_pkgbase} \
                 "${pkgdir}/usr/bin/pacman-color"

  # install color.conf
  install -Dm644 ../color.conf "${pkgdir}/etc/${_pkgbase}.d/color.conf"
}
