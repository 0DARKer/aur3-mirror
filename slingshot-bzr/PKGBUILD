#Contributor: Flamelab <panosfilip@gmail.com>

pkgname=slingshot-bzr
pkgver=6
pkgrel=2
pkgdesc="An application launcher by the Elementary project"
arch=('i686' 'x86_64')
url="https://launchpad.net/slingshot-launcher"
license=('GPL')
depends=('glib2' 'libgee')
makedepends=('bzr' 'intltool' 'vala-git' 'libwnck')
options=('!libtool' '!emptydirs')
install=${pkgname}.install

_bzrtrunk=lp:~mbarvian/slingshot-launcher/slingshot
_bzrmod=slingshot

build() {

  msg "Connecting to the server...."

        cd ${srcdir}
        if [ -d "${srcdir}/${_bzrmod}" ] ; then
                cd ${_bzrmod} && bzr up
                msg "The local files are updated."
        else
                bzr checkout ${_bzrtrunk}
        fi

  msg "BZR checkout done or server timeout"
  msg "Starting make..."

  cd ${srcdir}/${_bzrmod}

  valac --pkg gtk+-2.0 --pkg unique-1.0 \
        --pkg libwnck-1.0 --Xcc='-DWNCK_I_KNOW_THIS_IS_UNSTABLE' \
        --pkg gee-1.0 slingshot.vala frontend/widgets/*.vala frontend/*.vala
  
}

package() {
	
  cd ${srcdir}/${_bzrmod}
  install -Dm755 slingshot ${pkgdir}/usr/bin/slingshot

}
