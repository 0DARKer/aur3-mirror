# Wally: Installer: Arch
# Contributor: Zbyszek Tokarczyk <ztokarczyk (at) Gmail.com>

pkgname=wally
pkgver=2.4.1
_pkgdirver=2.4.1
pkgrel=1
pkgdesc="A Qt4 wallpaper changer for the major DEs using online image libraries"
arch=("i686" "x86_64")
url="http://www.becrux.com/index.php?page=projects&name=${pkgname}"
license=("GPL")
depends=("qt" "libexif")
makedepends=("cmake")
options=(!emptydirs)
source=(http://www.becrux.com/pages/projects/${pkgname}/${pkgname}-${pkgver}.tar.gz)

build() {
	cd ${srcdir}/${pkgname}-${_pkgdirver}

	# Build
	
	cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr || return 1
        
	# Temporary aid for wrong cmake script
	make || echo "Moving .qm files to correct location..."
	mv *.qm ./build/
        echo "Returning to build..."
        
	make || return 1
	make DESTDIR=${pkgdir} install || return 1

	# Desktop
	# It seems that desktop file is missing in this release
	#install -D ${startdir}/extra/${pkgname}.desktop ${pkgdir}/usr/share/applications/${pkgname}.desktop
}

md5sums=('276ac316b3f4b64ad848d4752420b1d6')
