# Maintainer: Harley Laue <losinggeneration@gmail.com>
# Contributer: agapito <agapitofrndez@ozu.es>

pkgname=yabause-qt
_pkgname=yabause
pkgver=0.9.11
pkgrel=4
pkgdesc='A Sega Saturn emulator with QT interface.'
url='http://yabause.org/'
license=('GPL')
arch=('i686' 'x86_64')
depends=('sdl' 'qt' 'freeglut')
conflicts=('yabause')
provides=('yabause')
source=("http://downloads.sourceforge.net/${_pkgname}/${_pkgname}-${pkgver}.tar.gz")
md5sums=('b0c70080b07db3b709f252b9988701b5')

build() {
  cd "${srcdir}/${_pkgname}-${pkgver}"
  ./autogen.sh

  # Fix some defines in Yabause for package name and version
  sed -i "s/\(#define SETTINGS_H\)/\1\n#include \"QtYabause.h\"/" src/qt/Settings.h
  sed -i "s/\(#define QTYABAUSE_H\)/\1\n#define PACKAGE \"${pkgname%-qt}\"/" src/qt/QtYabause.h
  sed -i "s/\(#define QTYABAUSE_H\)/\1\n#define VERSION \"${pkgver}\"/" src/qt/QtYabause.h

  ./configure --with-port=qt --without-gtk --prefix=/usr
  make
}

package() {
  cd "${srcdir}/${_pkgname}-${pkgver}"
  make DESTDIR="${pkgdir}" install
}
