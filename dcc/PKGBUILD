# Maintainer: John Lane <archlinux at jelmail dot com>
# Previously: Contributor: Nathan Owe <ndowens.aur at gmail dot com>

pkgname=dcc
pkgver=1.3.154
pkgrel=1
pkgdesc="Distributed Checksum Clearinghouse spam tool"
url="http://www.rhyolite.com/anti-spam/dcc/"
arch=('i686' 'x86_64')
license="custom"
depends=('sh')
source=(http://www.rhyolite.com/anti-spam/dcc/source/old/$pkgname-$pkgver.tar.Z \
	http://www.rhyolite.com/dcc/LICENSE)
md5sums=('4c60f03970de81322cbaa3d0e19a2707'
         '7c26cc25f89254455e219d8b195e2cb1')


build() {
  cd $srcdir/$pkgname-$pkgver
  ./configure --with-installroot=${pkgdir} \
  --mandir=/usr/share/man --homedir=/opt/dcc \
  --bindir=/usr/bin --libexecdir=/usr/lib/dcc
  make
}

package() {
  cd $srcdir/$pkgname-$pkgver
  make DESTDIR=${pkgdir}/ install
  install -d $pkgdir/usr/share/licenses/$pkgname
  install -Dm644 $srcdir/LICENSE $pkgdir/usr/share/licenses/$pkgname/LICENSE
  
  #Fix file permissions
  find $pkgdir/ -group bin -exec chgrp root {} \;
  find $pkgdir/ -user bin -exec chown root {} \;
  find $pkgdir/opt/dcc -type f -exec chmod 644 {} \;
  chmod 755 $pkgdir/opt/dcc/log	
    

}

