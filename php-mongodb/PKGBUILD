# Maintainer: David Roheim <david dot roheim at gmail dot com>
pkgname=php-mongodb
pkgver=1.2.10
pkgrel=1
pkgdesc="PHP driver for MongoDB"
arch=('i686' 'x86_64')
url="http://www.mongodb.org/"
license=('APACHE')
depends=('php')
optdepends=('mongodb: The MongoDB database')
makedepends=()
source=(
    "https://github.com/mongodb/mongo-php-driver/tarball/${pkgver}"
    'mongo.ini'
    'LICENSE'
)
sha256sums=(
    'd07e641f864c41bf57566f360869716dec74a348b7ef273981daee8cc2f12c9b'
    'b706dbe3ce81a0a1b66f16ee30cb6cb83c1520bc01785942364c182d6fb621f5'
    '5438d7dbf3eda57124e444c2f7446f0a3342c784d0e45f5c9e3561bb6d196aa8'
)
_gitcommit=97394b8

build() {
    cd ${srcdir}
    rm ${pkgver}
    mv ../${pkgver} ../mongodb-mongo-php-driver-${pkgver}.tar.gz
    ln -s ../mongodb-mongo-php-driver-${pkgver}.tar.gz
    mv mongodb-mongo-php-driver-${_gitcommit} ${pkgname}
    cd ${pkgname}
    phpize
    ./configure
    make
}

package() {
    install -D -m755 "${srcdir}/${pkgname}/modules/mongo.so" "${pkgdir}/usr/lib/php/modules/mongo.so"
    install -D -m644 mongo.ini "${pkgdir}/etc/php/conf.d/mongo.ini"
    install -D -m644 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
