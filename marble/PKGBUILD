 # Contributor: mangus <mangus[_at_]deprecated.it>
### requires only Qt as a dependency. 
###The only drawback is that Marble-Qt doesn't provide the whole functionality of Marble 
###  (e.g. the settings dialog or automatic map download via "GHNS")
pkgname=marble
pkgver=1.2.0
_kver=4.7.1
pkgrel=4
pkgdesc="A generic geographical map widget - qt version"
arch=('i686' 'x86_64')
url="http://edu.kde.org/marble"
license=('LGPL')
depends=('qt' 'openssl')
makedepends=('cmake' 'gpsd')
optdepends=("gpsd: GPS daemon and library to support USB/serial GPS devices")
source=(http://download.kde.org/stable/${_kver}/src/marble-${_kver}.tar.bz2
	gpsd3.patch)
md5sums=('c51019621e91c53b1ded13eb2cfc76c0'
         '67a919933afe7469856cdacc0362a38d')
install=marble.install
conflicts=('kdeedu-marble')

build() {
  cd  ${srcdir}/${pkgname}-${_kver}
  patch -p1 -i ${srcdir}/gpsd3.patch

  if [[ -d ${srcdir}/build ]]; then
    msg "Cleaning the previous build directory..."
    rm -rf ${srcdir}/build 
  fi
  mkdir ${srcdir}/build
  cd ${srcdir}/build
  cmake ${srcdir}/${pkgname}-${_kver} -DCMAKE_INSTALL_PREFIX=/usr  \
			-DCMAKE_BUILD_TYPE=Release -DQTONLY=ON
  make
}
package() {
  cd ${srcdir}/build
  make DESTDIR=${pkgdir} install
}

