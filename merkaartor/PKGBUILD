# Maintainer: Gaetan Bisson <bisson@archlinux.org>
# Contributor: Michael Kanis <mkanis gmx de>
# Contributor: Paulo Freire <paulofreire gmail com>
# Contributor: Brice Maron <brice bmaron net>

pkgname=merkaartor
pkgver=0.18.0
pkgrel=1
pkgdesc='OpenStreetMap editor'
url='http://merkaartor.be/'
arch=('i686' 'x86_64')
license=('GPL2')
makedepends=('boost')
depends=('qtwebkit' 'exiv2')
optdepends=('gpsd' 'desktop-file-utils' 'gtk-update-icon-cache')
source=("http://merkaartor.be/attachments/download/292/merkaartor-0.18.0.tar.bz2"  "build.patch")
sha1sums=('0ac5bf27369065cf33ab472ac54781c306270f09' 'ee04b98b021b34e273248c3eeb9f5b8d5f3eccad' )
install=install

build() {
	cd "${srcdir}/${pkgname}-${pkgver}"
  patch -Np1 -i ../build.patch
	echo 'QMAKE_MOC = $$QMAKE_MOC -DBOOST_TT_HAS_OPERATOR_HPP_INCLUDED' >> src/src.pro
	lrelease src/src.pro
	qmake Merkaartor.pro \
		PREFIX="/usr" \
		GEOIMAGE=1 \
		NODEBUG=1 \
		RELEASE=1 \

	make
}

package() {
	cd "${srcdir}/${pkgname}-${pkgver}"
	make INSTALL_ROOT="${pkgdir}" install
}
