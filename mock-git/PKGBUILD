# Maintainer: Thomas Dziedzic < gostrc at gmail >

pkgname=mock-git
pkgver=20110222
pkgrel=1
pkgdesc='A simple chroot build environment manager for building RPMs.'
url='https://fedorahosted.org/mock/'
arch=('i686' 'x86_64')
license=('GPL')
depends=('python2')
makedepends=('git')

_gitroot='git://git.fedorahosted.org/git/mock.git'
_gitname='mock'

build() {
  if [ -d ${_gitname} ] ; then
    cd ${_gitname}
    git pull origin
  else
    git clone ${_gitroot}
    cd ${_gitname}
  fi

  export PYTHON=python2

  ./autogen.sh

  ./configure \
    --prefix=/usr

  make
}

package() {
  cd ${_gitname}

  make DESTDIR=${pkgdir} install

  # fix incorrect shebang
  sed -i 's_#!/usr/bin/python_&2_' ${pkgdir}/usr/sbin/mock
}
