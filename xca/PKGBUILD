# Contributor: Andrea Zucchelli <zukka77@gmail.com>

pkgname=xca
pkgver=0.9.3
pkgrel=2
pkgdesc="graphical user interface to OpenSSL, RSA/DSA public keys, certificates, signing requests and revokation lists"
arch=('i686' 'x86_64')
url="http://www.hohnstaedt.de/xca.html"
license=('BSD')
depends=('qt4' 'libltdl' 'shared-mime-info')
makedepends=('linuxdoc-tools')
source=("http://downloads.sourceforge.net/sourceforge/xca/$pkgname-$pkgver.tar.gz" "http://sourceforge.net/p/xca/patches/14/attachment/0001-Fix-for-openssl-1.0.1i.patch") 

md5sums=('5e08cf8a93f023b1b3836c203bd0a694' '2fec910afb336f60bade070d825d0e07')

build ()
{
#cd $startdir/src/$pkgname-$pkgver
cd $srcdir/$pkgname-$pkgver
#Thaks to PreparationH67
patch -Np1 -i ../0001-Fix-for-openssl-1.0.1i.patch
#export QTDIR='/usr'
#CFLAGS="-I$QTDIR/include/Qt" 
prefix=/usr CFLAGS=-fPIC ./configure 
sed -i  -r 's/(^LDFLAGS.*$)/LDFLAGS='"'"'-lstdc++'"'"'/' Local.mak
#sed -i  -r 's/(^UIC.*$)/UIC=\/usr\/bin\/uic-qt4/' Local.mak
#sed -i  -r 's/(^MOC.*$)/MOC=\/usr\/bin\/moc-qt4/' Local.mak
#sed -i  -r 's/(^RCC.*$)/RCC=\/usr\/bin\/rcc-qt4/' Local.mak
#sed -i  -r 's/(^LRELEASE.*$)/LRELEASE=\/usr\/bin\/lrelease-qt4/' Local.mak
sed -i  -r 's/(^mandir.*$)/mandir=share\/man/' doc/Makefile
make || return 1
}

package(){
cd "$srcdir/$pkgname-$pkgver"
make install destdir=$pkgdir || return 1
#make install destdir=$startdir/pkg || return 1
install -D -m644 COPYRIGHT $pkgdir/usr/share/licenses/$pkgname/COPYRIGHT
}

install=xca.install
