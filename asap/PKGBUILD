# $Id: PKGBUILD,v 0.1 2012/11/17 23:34:36 wh Exp $
# Contributor nisk1 <esqueleto_bajo@outlook.com>

# Uncomment any of below lines to build additional plugins:
# _build_vlc="yes"
# _build_gstreamer="yes"

pkgname=asap
pkgver=3.1.2
pkgrel=1
pkgdesc="ASAP - library"
url="http://asap.sourceforge.net"
arch=('i686 x86_64')
license=('GPL')
source=("http://downloads.sourceforge.net/asap/${pkgname}-${pkgver}.tar.gz")
md5sums=('e911ff717ef6cd3e0989b67a37cdf019')

# _vlc
if [[ "$_build_vlc" = "yes" ]]; then 
  makedepends+=('vlc')
fi

if [[ "$_build_gstreamer" = "yes" ]]; then 
  makedepends+=('gstreamer')
fi

build() {
	cd $startdir/src/$pkgname-$pkgver/

	make	
# asapconv
	mkdir -p $startdir/pkg/usr/bin
	install asapconv $startdir/pkg/usr/bin/asapconv
# asap library
	mkdir -p $startdir/pkg/usr/{include,lib}
	install -m 644 asap.h $startdir/pkg/usr/include/asap.h
	install -m 644 libasap.a $startdir/pkg/usr/lib/libasap.a

# VLC
	if [[ "$_build_vlc" = "yes" ]]; then 		
		make asap-vlc
		mkdir -p $startdir/pkg/usr/lib/vlc/plugins/demux
		install -m 644 libasap_plugin.so $startdir/pkg/usr/lib/vlc/plugins/demux/libasap_plugin.so
	fi
# gstreamer	
	if [[ "$_build_gstreamer" = "yes" ]]; then 
		make asap-gstreamer
		mkdir -p $startdir/pkg/usr/lib/gstreamer-0.10
		install -m 644 libgstasapdec.so $startdir/pkg/usr/lib/gstreamer-0.10/libgstasapdec.so
	fi
}
