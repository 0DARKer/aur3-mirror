# Maintainer: Thomas Jost <schnouki@schnouki.net>
pkgname=python-tlslite
pkgver=0.3.8
pkgrel=2
pkgdesc="SSL/TLS support for Python, with numerous options."
arch=('any')
url="http://trevp.net/tlslite/"
license=('custom:public domain')
depends=('python2')
optdepends=(
    'pycrypto: fast ciphers and fast RSA operations'
    'gmpy: fast RSA and SRP operations'
)
source=(http://trevp.net/tlslite/tlslite-${pkgver}.tar.gz)
md5sums=('5e1c19500e30fc7580939c18b435f937')
sha1sums=('56e1a5af611a17e3a59d797922bbf0e9cb13d321')

build() {
  cd ${srcdir}/tlslite-${pkgver}

  python2 setup.py build
}

package() {
  cd ${srcdir}/tlslite-${pkgver}
  python2 setup.py install --root=${pkgdir}
  
  # Patch to use python2
  find $pkgdir -type f \( -name '*.py' -or -executable \) -exec \
    sed -i -e "s|#![ ]*/usr/bin/python$|#!/usr/bin/python2|" \
           -e "s|#![ ]*/usr/bin/env python$|#!/usr/bin/env python2|" \
    \{\} +
}
