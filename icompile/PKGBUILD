# Contributor: Alexander Rødseth <rodseth@gmail.com>
pkgname=icompile
pkgver=0.5.7
pkgrel=1
_pyver=2.7
pkgdesc="Zero-configuration build system"
arch=('any')
url="http://ice.sourceforge.net"
license=('BSD')
depends=('python2')
source=("http://kent.dl.sourceforge.net/sourceforge/ice/$pkgname-$pkgver.tar.gz")
md5sums=('c0b0d9c6cac98ec758666658ce8be286')

build() {
  cd "$srcdir"
  # Fix to use python 2 instead of python 3
  sed -i 's:bin/env python:bin/env python2:' "$pkgname"
  # Fix flag that does not work on the latest version of gcc that comes with Arch
  sed -i "s:state.compilerOptions.append('-fpmath=sse'):pass:" "$pkgname"
  mkdir -p "$pkgdir/usr/lib/python$_pyver/site-packages"
  cp -r ice "$pkgdir/usr/lib/python$_pyver/site-packages/"
  install -Dm644 manual.html "$pkgdir/usr/share/doc/$pkgname/manual.html"
  install -Dm755 $pkgname "$pkgdir/usr/bin/$pkgname"
  mkdir -p "$pkgdir/usr/share/licenses/$pkgname"
  touch "$pkgdir/usr/share/licenses/$pkgname/BSD"
}

# vim:set ts=2 sw=2 et:
