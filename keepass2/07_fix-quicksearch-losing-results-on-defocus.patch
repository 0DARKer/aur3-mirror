From: Julian Taylor <jtaylor.debian@googlemail.com>
Date: Mon, 18 Apr 2011 19:44:53 +0200
Subject: fix quicksearch losing results on defocus

Applied-Upstream: 2.16
---
 KeePass/Forms/MainForm.cs |   10 ++++------
 1 files changed, 4 insertions(+), 6 deletions(-)

diff --git a/KeePass/Forms/MainForm.cs b/KeePass/Forms/MainForm.cs
index 441f06a..ee82a9f 100644
--- a/KeePass/Forms/MainForm.cs
+++ b/KeePass/Forms/MainForm.cs
@@ -999,6 +999,7 @@ namespace KeePass.Forms
 		private void OnQuickFindSelectedIndexChanged(object sender, EventArgs e)
 		{
 			if(m_bBlockQuickFind) return;
+			m_bBlockQuickFind = true;
 
 			string strSearch = m_tbQuickFind.Text; // Text, not selected index!
 			string strGroupName = KPRes.SearchGroupName + " (\"" + strSearch + "\" ";
@@ -1031,12 +1032,9 @@ namespace KeePass.Forms
 
 			m_tbQuickFind.Items.Insert(0, strSearch);
 
-			if(bDoSetText)
-			{
-				m_bBlockQuickFind = true;
-				m_tbQuickFind.Text = strSearch;
-				m_bBlockQuickFind = false;
-			}
+			if(bDoSetText) m_tbQuickFind.Text = strSearch;
+
+			m_bBlockQuickFind = false;
 		}
 
 		private void OnQuickFindKeyDown(object sender, KeyEventArgs e)
-- 
