# Maintainer: rtfreedman  (rob<d0t>til<d0t>freedman<aT>googlemail<d0t>com

pkgname=argotlunar-git
pkgver=20130402
pkgrel=1
pkgdesc="Realtime Granulator VST Plugin."
arch=(i686 x86_64)
url="http://argotlunar.info/"
license=('GPL2')
depends=()
makedepends=('git' 'steinberg-vst24')
optdepends=('ttf-bitstream-vera')
source=('juce_VST_Wrapper.patch'
		'Makefile.patch'
		'presets.bank'
		'argotlunar2-reference.pdf')

_gitroot=https://github.com/mourednik/argotlunar
_gitname=argotlunar

build() {
  cd "$srcdir"
  msg "Connecting to GIT server...."

  if [[ -d "$_gitname" ]]; then
    cd "$_gitname" && git pull origin
    msg "The local files are updated."
  else
    git clone "$_gitroot" "$_gitname"
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting build..."

  rm -rf "$srcdir/$_gitname-build"
  git clone "$srcdir/$_gitname" "$srcdir/$_gitname-build"
  
  cd "$srcdir/$_gitname-build"
  patch -p1 -i "$srcdir/Makefile.patch"
  patch -p1 -i "$srcdir/juce_VST_Wrapper.patch"
  
  cd Builds/Linux
  make
}

package() {
  cd "$srcdir/$_gitname-build"
  install -D -m755 Builds/Linux/build/argotlunar.so "$pkgdir/usr/lib/vst/argotlunar.so"
  install -D -m644 "$srcdir/presets.bank" "$pkgdir/usr/lib/vst/presets.bank"
  install -D -m644 "$srcdir/argotlunar2-reference.pdf"  "$pkgdir/usr/share/doc/$pkgname/argotlunar2-reference.pdf"
}

# vim:set ts=2 sw=2 et:
md5sums=('c923454e447396296025e9ab881d43a6'
         '4f86cd0056023c24cdb5858092fa2566'
         '746ea1e061470dda9a4499ba92fe647d'
         '94bc49bd07e2d3eccac696b13c63e2e9')
