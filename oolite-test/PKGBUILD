# Maintainer: Lone_Wolf <lonewolf@xs4all.nl>
pkgname=oolite-test
pkgver=1.74.2
pkgrel=1
pkgdesc="A space-sim based on the classic Elite"
arch=('any')
url="http://oolite-linux.berlios.de"
license=('GPL')
groups=()
depends=('gnustep-gui' 'sdl_mixer' 'mesa' 'libpng' 'espeak')
makedepends=('gcc-objc' 'subversion' 'gnustep-make')
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=oolite.install
source=(oolite)
noextract=()
md5sums=('653a862453d74f64c3d206656c6291e8')

_svntrunk=http://svn.berlios.de/svnroot/repos/oolite-linux/branches/1.74-maintenance/
_svnmod=oolite-test

build() {
    cd $srcdir
    if [ -d $_svnmod/.svn ]; then
	(cd $_svnmod && svn up -r 3712)
    else
	svn co $_svntrunk --config-dir ./ -r 3712 $_svnmod
    fi
    msg "SVN checkout done or server timeout"
    msg "Starting make..."
    rm -rf "$srcdir/$_svnmod-build"
    cp -r "$srcdir/$_svnmod" "$srcdir/$_svnmod-build"
    cd "$srcdir/$_svnmod-build"
# setting up directories
    mkdir -p $pkgdir/usr/bin
    mkdir -p $pkgdir/usr/share/{oolite.app,applications,pixmaps}
# compile
    source /opt/GNUstep/System/Library/Makefiles/GNUstep.sh
    make -f Makefile release || return 1
    cp -r oolite.app/* $pkgdir/usr/share/oolite.app/
# copy short instructions
    install -D -m 644 $srcdir/oolite-test-build/deps/Linux-deps/PLAYING.TXT $pkgdir/usr/share/oolite.app/playing.txt
#install shellscript and icon
    install -D -m755 $srcdir/oolite $pkgdir/usr/bin/oolite
    install -D -m644 $srcdir/oolite-test-build/installers/FreeDesktop/oolite-icon.png $pkgdir/usr/share/pixmaps/oolite-icon.png
# copy .desktop file
#    cd FreeDesktop
#    cp oolite.desktop oolite.desktop.org
#    sed 's;Icon=oolite-icon.png;Icon=oolite;' <oolite.desktop.org >oolite.desktop
    install -D -m644 $srcdir/oolite-test-build/installers/FreeDesktop/oolite.desktop $pkgdir/usr/share/applications/oolite.desktop
}
packaging() {
true
}
# vim:set ts=2 sw=2 et:
