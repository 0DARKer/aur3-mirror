# Maintainer: Moritz Lipp <mlq@pwmt.org>

pkgname=omnikey_cardman_5x2x
pkgver=4.0.5
pkgrel=2
pkgdesc="Driver for OMNIKEY Cardman 3x21, 5x2x, 6x2x, Smart@Key, Smart@Link"
arch=('i686' 'x86_64')
  [ "$CARCH" = "i686" ]   && _arch=_i686
  [ "$CARCH" = "x86_64" ] && _arch=_x86_64
url="http://www.hidglobal.com"
depends=('libusb>=1.0.8' 'pcsclite>1.5.5')
source=(http://www.hidglobal.com/sites/hidglobal.com/files/drivers/ifdokccid_linux$_arch-$pkgver.tar.gz)
[ "$CARCH" = "i686" ] && md5sums=('da9a3257e1f55f26947b67d9d2a24023')
[ "$CARCH" = "x86_64" ] && md5sums=('060003f1a6740dfa9ab4bef314257828')
license=('unknown')

build() {
  cd $srcdir/ifdokccid_linux$_arch-$pkgver

  mkdir -p $pkgdir/usr/lib/pcsc/drivers
  cp -r ifdokccid_linux$_arch-$pkgver.bundle $pkgdir/usr/lib/pcsc/drivers

  mkdir -p $pkgdir/etc
  cp omnikey.ini $pkgdir/etc

  mkdir -p $pkgdir/etc/udev/rules.d
  cp z98_omnikey.rules $pkgdir/etc/udev/rules.d

  mkdir -p $pkgdir/lib/udev
  cp ok_pcscd_hotplug.sh $pkgdir/lib/udev
}
