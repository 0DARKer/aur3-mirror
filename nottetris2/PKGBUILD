# Contributor: Wido <widomaker2k7 [at] gmail [dot] com>
# Maintainer: andy123 < ajs [at] online [dot] de >

pkgname=nottetris2
pkgver=1
pkgrel=6
pkgdesc="Basically it's a little like tetris except with a twist."
arch=('any')
url="http://stabyourself.net/nottetris2/"
license=('MIT')
depends=('love')
makedepends=('unzip')
_gamepkg="${pkgname}-linux.zip"
source=(${pkgname}.sh ${pkgname}.desktop ${_gamepkg}.sha1)
sha1sums=('ce355842a0d404af46ed75132618ba3eec996369'
          'd745399c1d55c35e83b103126fcf291e46e0b160'
          '797924ae8e044ae5346e133dc6cd3f7eba6618ab')

package() {
	cd $srcdir
	wget -qq -O/dev/null http://stabyourself.net/nottetris2/ --keep-session-cookies --save-cookies temp.cookie
	wget --header="Host: stabyourself.net" \
		--header="User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:8.0.1) Gecko/20100101 Firefox/8.0.1" \
		--header="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8" \
		--header="Accept-Language: en-us,en;q=0.5" \
		--header="Accept-Encoding: gzip, deflate" \
		--header="Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7" \
		--header="Referer: http://stabyourself.net/nottetris2/" \
		--load-cookies temp.cookie \
		--header="DNT: 1" --header="Connection: keep-alive" \
		"http://stabyourself.net/dl.php?file=nottetris2/${_gamepkg}" -cO"${_gamepkg}"
	sha1sum -c ${_gamepkg}.sha1 || return 1
	unzip -o ${srcdir}/${_gamepkg} -d $srcdir/${pkgname}

	# Install Data
	install -D -m755 "${srcdir}/${pkgname}/Not Tetris 2.love" "${pkgdir}/usr/share/games/${pkgname}/${pkgname}.love"
	install -D -m644 "${srcdir}/${pkgname}/Not Readme.txt" "$pkgdir/usr/share/games/${pkgname}/readme"

	# Install Launcher
	install -D -m755 "${srcdir}/${pkgname}.sh" "${pkgdir}/usr/bin/${pkgname}"

	# Install Desktop
	install -D -m644 "${srcdir}/${pkgname}.desktop" "${pkgdir}/usr/share/applications/${pkgname}.desktop"
}
