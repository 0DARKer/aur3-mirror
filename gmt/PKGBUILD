# Contributor: Benjamin Sick

pkgname=gmt
pkgver=4.5.5
pkgrel=2
pkgdesc="Generic Mapping Tools: Collection of tools for manipulating geographic and Cartesian data sets, and generating EPS maps."
arch=(i686 x86_64)
url="http://gmt.soest.hawaii.edu/"
license=('GPL')
depends=('netcdf')
makedepends=('xorg-server')
provides=()
install=gmt.install
source=(ftp://ftp.soest.hawaii.edu/gmt/GMT${pkgver}'_'src.tar.bz2 
        ftp://ftp.soest.hawaii.edu/gmt/GMT${pkgver}'_'share.tar.bz2
        ftp://ftp.soest.hawaii.edu/gmt/GMT${pkgver}'_'suppl.tar.bz2
        ftp://ftp.soest.hawaii.edu/gmt/GMT${pkgver}'_'triangle.tar.bz2
        ftp://ftp.soest.hawaii.edu/gmt/GSHHS'_'coast.tar.bz2)
md5sums=('051554f98bff57365eebab2d227e3285'
         '55b9142fb8ad3e17a49542f42b36d923'
         '38e01e420876bfe3cafe60b207c91de6'
         '36a4788e72aa3dc557a256bca14f79a0'
         '1f84a99effe96e12fb60f31fa3cf35bb')

build() {
  cd $startdir/src/GMT$pkgver
  mv -f ../share/coast share/ # move coastline files
  ./configure --prefix=/usr --enable-triangle --disable-octave \
              --disable-mex --enable-eps \
              --mandir=$startdir/pkg/usr/share/man \
              --enable-netcdf=/usr \
              --datarootdir=$startdir/pkg/usr/share/gmt
  make || return 1
  make prefix=$startdir/pkg/usr install-gmt || return 1
  make prefix=$startdir/pkg/usr \
    datarootdir=$startdir/pkg/usr/share/gmt install-man || return 1
  make prefix=$startdir/pkg/usr \
    datarootdir=$startdir/pkg/usr/share/gmt install-data || return 1
  make prefix=$startdir/pkg/usr \
    datarootdir=$startdir/pkg/usr/share/gmt install-suppl || return 1

  install src/README.TRIANGLE -Dm644 \
    ${pkgdir}/usr/share/licenses/$pkgname/README.TRIANGLE
  mkdir -p $startdir/pkg/etc/profile.d
  echo "# GMT environment variable" > $startdir/pkg/etc/profile.d/gmt.sh
  echo "export GMTHOME=/usr/share/gmt" >> $startdir/pkg/etc/profile.d/gmt.sh
  echo "export GMT_SHAREDIR=/usr/share/gmt" >> \
    $startdir/pkg/etc/profile.d/gmt.sh
  chmod 755 $startdir/pkg/etc/profile.d/gmt.sh
}

# vim:set ts=2 sw=2 et:
