# Contributor: Benjamin Sick

pkgname=gmt
pkgver=4.5.6
pkgrel=1
pkgdesc="Generic Mapping Tools: Collection of tools for manipulating geographic and Cartesian data sets, and generating EPS maps."
arch=(i686 x86_64)
url="http://gmt.soest.hawaii.edu/"
license=('GPL')
depends=('netcdf' 'libxaw')
provides=()
install=gmt.install
source=(ftp://ftp.soest.hawaii.edu/gmt/GMT${pkgver}'_'src.tar.bz2 
        ftp://ftp.soest.hawaii.edu/gmt/GMT${pkgver}'_'share.tar.bz2
        ftp://ftp.soest.hawaii.edu/gmt/GMT${pkgver}'_'suppl.tar.bz2
        ftp://ftp.soest.hawaii.edu/gmt/GMT${pkgver}'_'triangle.tar.bz2
        ftp://ftp.soest.hawaii.edu/gmt/GSHHS'_'coast.tar.bz2)
md5sums=('79cdb798b48c0411483d9b1c60944163'
         '9b29e35a0c939345ae593dc6487c8b00'
         '1519e3fdfd337a852d53f5ce819ac3cc'
         '1812713d2e65edea2cabdc35b5867321'
         '68a3f9eb6605c17b3369b6f6f5e94549')

build() {
  cd $startdir/src/GMT$pkgver
  mv -f ../share/coast share/ # move coastline files
  ./configure --prefix=/usr --enable-triangle --disable-octave \
              --disable-mex --enable-eps \
              --mandir=$startdir/pkg/usr/share/man \
              --enable-netcdf=/usr \
              --datarootdir=$startdir/pkg/usr/share/gmt
  make || return 1
  make prefix=$startdir/pkg/usr install-gmt || return 1
  make prefix=$startdir/pkg/usr \
    datarootdir=$startdir/pkg/usr/share/gmt install-man || return 1
  make prefix=$startdir/pkg/usr \
    datarootdir=$startdir/pkg/usr/share/gmt install-data || return 1
  make prefix=$startdir/pkg/usr \
    datarootdir=$startdir/pkg/usr/share/gmt install-suppl || return 1

  install src/README.TRIANGLE -Dm644 \
    ${pkgdir}/usr/share/licenses/$pkgname/README.TRIANGLE
  mkdir -p $startdir/pkg/etc/profile.d
  echo "# GMT environment variable" > $startdir/pkg/etc/profile.d/gmt.sh
  echo "export GMTHOME=/usr/share/gmt" >> $startdir/pkg/etc/profile.d/gmt.sh
  echo "export GMT_SHAREDIR=/usr/share/gmt" >> \
    $startdir/pkg/etc/profile.d/gmt.sh
  chmod 755 $startdir/pkg/etc/profile.d/gmt.sh
}

# vim:set ts=2 sw=2 et:
