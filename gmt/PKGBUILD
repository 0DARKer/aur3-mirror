# Contributor: Benjamin Sick

pkgname=gmt
pkgver=4.5.7
pkgrel=1
pkgdesc="Generic Mapping Tools: Collection of tools for manipulating geographic and Cartesian data sets, and generating EPS maps."
arch=(i686 x86_64)
url="http://gmt.soest.hawaii.edu/"
license=('GPL')
depends=('netcdf' 'libxaw' 'gdal')
provides=()
install=gmt.install
source=(ftp://ftp.soest.hawaii.edu/gmt/${pkgname}-${pkgver}.tar.bz2)
md5sums=('fc8a4a546ff8572c225aa7bdb56bbdf8')

build() {
  cd $startdir/src/GMT$pkgver
  ./configure --prefix=/usr --enable-triangle --disable-octave \
              --disable-mex --enable-eps --enable-gdal \
              --mandir=$startdir/pkg/usr/share/man \
              --enable-netcdf=/usr \
              --datarootdir=$startdir/pkg/usr/share/gmt
  export MAKEFLAGS="-j1"
  make || return 1
  make prefix=$startdir/pkg/usr install-gmt || return 1
  make prefix=$startdir/pkg/usr \
    datarootdir=$startdir/pkg/usr/share/gmt install-man || return 1
  make prefix=$startdir/pkg/usr \
    datarootdir=$startdir/pkg/usr/share/gmt install-data || return 1
  make prefix=$startdir/pkg/usr \
    datarootdir=$startdir/pkg/usr/share/gmt install-suppl || return 1

  sed -i $pkgdir/usr/bin/GMT -e "s%$startdir/pkg%%"
  mkdir -p $startdir/pkg/etc/profile.d
  echo "# GMT environment variable" > $startdir/pkg/etc/profile.d/gmt.sh
  echo "export GMTHOME=/usr/share/gmt" >> $startdir/pkg/etc/profile.d/gmt.sh
  echo "export GMT_SHAREDIR=/usr/share/gmt" >> \
    $startdir/pkg/etc/profile.d/gmt.sh
  chmod 755 $startdir/pkg/etc/profile.d/gmt.sh
}

# vim:set ts=2 sw=2 et:
