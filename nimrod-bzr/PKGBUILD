# Maintainer: Sven-Hendrik Haase <sh@lutzhaase.com>
arch=('i686' 'x86_64')
pkgname=nimrod-bzr
pkgver=23
pkgrel=1
pkgdesc="A new statically typed, imperative programming language, that supports procedural, object oriented, functional and generic programming styles while remaining simple and efficient."
url="http://force7.de/nimrod/"
license=("GPL")
depends=('')
makedepends=('bzr')
provides=('nimrod')
conflicts=('nimrod')
source=()
md5sums=()
#install=nimrod.install

_bzrtrunk=lp:nimrod
_bzrmod=nimrod

build() {
  cd ${srcdir}

  msg "Connecting to the server...."

  bzr branch ${_bzrtrunk} -q -r ${pkgver}

  msg "BZR checkout done or server timeout"
  msg "Starting make..."

  [ -d ./${_bzrmod}-build ] && rm -rf ./${_bzrmod}-build
  cp -r ./${_bzrmod} ./${_bzrmod}-build
  cd ./${_bzrmod}-build

  msg "Starting make..."

  make || return 1
  install -dm755 ${pkgdir}/usr/bin
  cd ${pkgdir}/usr/bin
  ln -s /opt/nimrod/bin/nimrod . 
  ln -s /opt/nimrod/bin/nim . 

  install -dm755 ${pkgdir}/opt
  cp -a ${srcdir}/${_bzrmod}-build ${pkgdir}/opt/nimrod
}
