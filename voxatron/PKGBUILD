# Maintainer: Zachary A. Jones <JazzplayerL9@gmail.com>

pkgname=voxatron
pkgver=0.1.3
pkgrel=1
pkgdesc="Voxatron is an action/adventure game set in a world completely made of tiny cubes that can be blasted to smithereens"
url="http://www.lexaloffle.com/voxatron.php"
license=('custom: "commercial"')
arch=('i686' 'x86_64')
makedepends=()
options=(!strip)
source=("${pkgname}.desktop" "vox-exec")
md5sums=('83e260fa9c4380ee87d6723b33bc243f'
		 'bb84f6fcd7cdb18eb417173a6f58e00e')
_gamepkg="${pkgname}_${pkgver}_i386.tar.gz"
build() {
   cd ${srcdir}
   msg "You need a full copy of this game in order to install it"
   msg "Searching for ${_gamepkg} in dir: \"$startdir\""
   pkgpath=$startdir
   if [[ ! -f "$startdir/${_gamepkg}" ]]; then
       error "Game package not found, please type absolute path to ${_gamepkg} (/home/joe):"
       read pkgpath
       if [[ ! -f "${pkgpath}/${_gamepkg}" ]]; then
           error "Unable to find game package." && return 1
       fi
   fi
    msg "Found game package, installing..."

        ln -fs ${pkgpath}/${_gamepkg} . || return 1
        tar zxvf ${pkgpath}/${_gamepkg} || return 1
		install -d ${pkgdir}/opt/${pkgname}
        cp -R ${srcdir}/${pkgname}/* ${pkgdir}/opt/${pkgname}/
}

package(){
  cd ${srcdir}

  # create Launcher
  install -d ${pkgdir}/usr/bin/
  install -D -m755 ${srcdir}/vox-exec ${pkgdir}/usr/bin/voxatron
  # Install Desktop
  install -D -m644 ${srcdir}/${pkgname}.desktop \
        ${pkgdir}/usr/share/applications/${pkgname}.desktop
  # Install license
  install -Dm 644 ${pkgdir}/opt/${pkgname}/license.txt ${pkgdir}/usr/share/licenses/${pkgname}/license
}
