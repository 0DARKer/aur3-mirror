# Maintainer: BenObiWan <benobiwan @t gmail dot com>
# Contributor: Sam101 <zoetrem@gmail.com>
# Contributor: BenObiWan <benobiwan @t gmail dot com>
pkgname=zsxd
pkgver=1.2
pkgrel=1
pkgdesc="Un jeu amateur Zelda humoristique libre et gratuit inspirÃ© de Zelda en 2D."
arch=('i686' 'x86_64')
url="http://www.zelda-solarus.com/"
license=('GPL/custom')
groups=
provides=('zsxd')
depends=('lua' 'sdl' 'sdl_image' 'sdl_ttf' 'physfs' 'openal' 'libvorbis' 'libmodplug')
makedepends=('cmake' 'gcc' 'zip')
conflicts=()
replaces=()
backup=()
source=(http://www.zelda-solarus.com/downloads/zsxd/zsxd-1.2-src.tar.gz
        http://www.zelda-solarus.com/downloads/zsxd/archlinux/0001-remove-unused-variables-in-scale2x.patch)
md5sums=('0b532c75b57d9490afde03e770bc1cf3'
	 'e5b4d6feaf5a72fc2c3a8a9c1a0a42b0')
 
build() {
  cd ${srcdir}/${pkgname}-${pkgver}
  mkdir -p ${pkgdir}/usr/share/games/zsxd
  patch -Np1 -i ${srcdir}/0001-remove-unused-variables-in-scale2x.patch

  cmake -D CMAKE_INSTALL_PREFIX=${srcdir}/${pkgname}-${pkgver} -D DATAPATH=${srcdir}/${pkgname}-${pkgver}/quests/zsxd .
  make || return 1
  make install

  cp ${srcdir}/${pkgname}-${pkgver}/bin/solarus $pkgdir/usr/share/games/zsxd/solarus
  cp ${srcdir}/${pkgname}-${pkgver}/quests/zsxd/data/data.solarus ${pkgdir}/usr/share/games/zsxd/data.solarus

  mkdir -p ${pkgdir}/usr/bin
  echo -e "#!/bin/bash\n/usr/share/games/zsxd/solarus -datapath=/usr/share/games/zsxd" > ${pkgdir}/usr/bin/zsxd

  chmod 755 ${pkgdir}/usr/bin/zsxd
}
