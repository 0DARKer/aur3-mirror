# Maintainer: MacCyber <jonas at electrosheep dot org>
pkgname=phoenixviewer
pkgver=1.5.2.1050
pkgrel=1
pkgdesc="Second Life is a 3-D virtual world entirely built and owned by its residents. Phoenix is alternative viewer for secondlife (native 32bit)"
url="http://www.phoenixviewer.com"
license=('GPL')
depends=('openal' 'gnome-vfs' 'gtk2' 'libpng' 'dbus-glib' 'libidn' 'sdl' 'mesa')
optdepends=('gstreamer0.10: For video support - may need good, bad and ugly plugins')
[ "$CARCH" = "x86_64" ] && depends=('lib32-gtk2' 'lib32-libpng' 'lib32-openal' 'lib32-dbus-glib' 'lib32-gnome-vfs' 'lib32-libidn' 'lib32-sdl' 'lib32-mesa')
[ "$CARCH" = "x86_64" ] && optdepends=('lib32-nvidia-utils: GL support for NVIDIA drivers')
arch=('i686' 'x86_64')
#conflicts=('')
install=phoenixviewer.install
source=("http://downloads.phoenixviewer.com/Linux/PhoenixViewer-i686-${pkgver}.tar.bz2" 'phoenixviewer.install' 'phoenixviewer.desktop' 'phoenixviewer.launcher')
md5sums=('9b9b5dc030aa0a5757b2efe70b56aba0' '6f22c49887fa60783bf95cbd91567b6d' '3859c662e1a2fedd5a112b2c8380a4bf' '3393afa33667f88783df215c8a1004bd')

build() {
    cd $srcdir;

    # Rename Data Directory
    mv PhoenixViewer-i686-${pkgver}/ phoenixviewer

    # Install Desktop File
    install -D -m644 $srcdir/phoenixviewer.desktop \
        $pkgdir/usr/share/applications/phoenixviewer.desktop

    # Install Icon File
    install -D -m644 $srcdir/phoenixviewer/phoenix_icon.png \
        $pkgdir/usr/share/pixmaps/phoenix_icon.png

    # Install Launcher
    install -D -m755 $srcdir/phoenixviewer.launcher \
        $pkgdir/usr/bin/phoenixviewer

    # Move Data to Destination Directory
    install -d $pkgdir/opt/
    mv phoenixviewer/ $pkgdir/opt/

    # Change Permissions of files to root:games
    chown -R root:games $pkgdir/opt/phoenixviewer
    chmod -R g+r $pkgdir/opt/phoenixviewer

    # Make Binary Group-Executable
    chmod g+x $pkgdir/opt/phoenixviewer/snowglobe
}
