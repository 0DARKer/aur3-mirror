# Maintainer: yannsen <ynnsen@gmail.com>
pkgname=guymager
pkgver=0.5.2
pkgrel=1
pkgdesc="A forensic imager for media acquisition"
arch=('i686' 'x86_64')
url="http://guymager.sourceforge.net/"
license=('GPL')
depends=('libewf' 'libguytools')
makedepends=('subversion')
source=(http://downloads.sourceforge.net/project/$pkgname/$pkgname/LatestSource/$pkgname-$pkgver.tar.gz \
'main.cpp.patch' 'common.h.patch' 'config.cpp.patch' 'threadwrite.cpp.patch' 'guymager.pro.patch' \
'compileinfo.sh.patch')
md5sums=('99e60c7f034d836775388cf9bdb299c6'
         '5ff0e489bc07796511a53fd74cd173fe'
         '931efa1b079466f36ec9d9cdded65291'
         'a625395bd22689ca36e53a7db012ae8d'
         'a81b15bf273b87c6d661e5418112a124'
         '2ef0f769dea0bdd43c53fda08bebd8d6'
         'cb856de867c67d01983e77604649c94f')

build() {
  cd $srcdir/$pkgname-$pkgver
  patch -Np0 < $srcdir/guymager.pro.patch || return 1
  qmake guymager.pro || return 1
  patch -Np0 < $srcdir/main.cpp.patch || return 1
  patch -Np0 < $srcdir/common.h.patch || return 1
  patch -Np0 < $srcdir/config.cpp.patch || return 1
  patch -Np0 < $srcdir/threadwrite.cpp.patch || return 1
  patch -Np0 < $srcdir/compileinfo.sh.patch || return 1
  make || return 1
  lrelease guymager.pro || return 1
  install -d $pkgdir/etc/guymager/
  install -m755 $srcdir/$pkgname-$pkgver/guymager.cfg $pkgdir/etc/guymager/
  install -d $pkgdir/usr/bin
  install -m755 $srcdir/$pkgname-$pkgver/guymager $pkgdir/usr/bin
  install -d $pkgdir/usr/share/guymager/
  install -m755 $srcdir/$pkgname-$pkgver/splash.png $pkgdir/usr/share/guymager/
  cp $srcdir/$pkgname-$pkgver/guymager_*.qm $pkgdir/usr/share/guymager/
}

