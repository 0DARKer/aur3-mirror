# Contributor: Massimiliano Torromeo <massimiliano.torromeo@gmail.com>
# Maintainer: Alexander Boyko <brdcom@ya.ru>
pkgname=activemq
pkgver=5.4.2
pkgrel=1
pkgdesc="Popular and powerful open source messaging and Integration Patterns provider"
arch=('x86_64')
url="http://activemq.apache.org"
license=('Apache 2.0')
depends=('java-runtime' 'lsb-release')
conflicts=('apache-activemq')
source=(ftp://bgbilling.ru/pub/bgbilling/activemq/linux/apache-${pkgname}-${pkgver}.tgz
	activemq.defaults
	service
	profile.sh
	profile.csh)
options=(!strip)
install=install

md5sums=('cb732e4c0e64bc35b7d0088c078b1719'
         '88f59d0add2393edb80b2c911e8aebed'
         '4455718ac80d6cb38ff5baf6db12bea5'
         '4c934209808f54d70ef8314bc2966657'
         'a36634b281a3e8ce5a6ed5b85828bca2')

build() {
	install -dm0755 "$pkgdir/opt"
	install -dm0755 "$pkgdir/etc/default"
	install -dm0755 "$pkgdir/etc/profile.d/"
	install -dm0755 "$pkgdir/usr/lib/systemd/system"
	install -D -m0644 "$srcdir/activemq.defaults" "$pkgdir/etc/default/activemq"
	install -D -m0755 "$srcdir/profile.sh" "$pkgdir/etc/profile.d/activemq.sh"
	install -D -m0755 "$srcdir/profile.csh" "$pkgdir/etc/profile.d/activemq.csh"
	install -D -m0644 "$srcdir/service" "$pkgdir/usr/lib/systemd/system/activemq.service"
	mv "$srcdir/apache-$pkgname-$pkgver" "$pkgdir/opt/activemq"
	
	ln -s /opt/activemq/bin/linux-x86-64 "$pkgdir/opt/activemq/bin/linux"

	rm -rf "$pkgdir/opt/activemq/bin/macosx"
}
