#Maintainer: Nicola Bignami <nicola@kernel-panic.dnsdojo.net>

pkgname=('foomatic-db-foo2zjs')
arch=('i686' 'x86_64')
_snapdate=20120406
_relver=4.0.15
_foomatic_db_pkgrel=1
pkgver=${_relver}_${_snapdate}
pkgrel=1
makedepends=()
license=('GPL' 'custom')
depends=('perl' 'libxml2')
optdepends=('foo2zjs')
replaces=('foomatic-db-ppd' 'foomatic-db-hpijs' 'foomatic-db')
conflicts=('foomatic-db-ppd' 'foomatic-db-hpijs' 'foomatic-db')
provides=('foomatic-db-hpijs' 'foomatic-db')
source=(http://mirrors.kernel.org/archlinux/extra/os/${CARCH}/foomatic-db-1:${pkgver}-${_foomatic_db_pkgrel}-${CARCH}.pkg.tar.xz)
url="http://www.linuxprinting.org/foomatic.html"
if [ x$CARCH == x"x86_64" ]; then
    md5sums=('5b796f413ce0a6a8a55d4603d10ea937')
else
    md5sums=('668fe2fb84e4ec78a356b5f495ae69e8')
fi
pkgdesc="Foomatic - The collected knowledge about printers, drivers, and driver options in XML files, used by foomatic-db-engine to generate PPD files. Rebuilded for use with foo2zjs"

build() {
    cd ${srcdir}/
    cp -Rp $(echo * | sed -e 's|.PKGINFO||' -e "s/foomatic-db-${pkgver}-${_foomatic_db_pkgrel}-${CARCH}.pkg.tar.gz//") ${pkgdir}/
    # foo2zjs gives us something different
    rm ${pkgdir}/usr/share/foomatic/db/source/driver/foo2hiperc.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/driver/foo2hp.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/driver/foo2lava.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/driver/foo2oak-z1.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/driver/foo2oak.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/driver/foo2qpdl.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/driver/foo2slx.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/driver/foo2xqx.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/driver/foo2zjs.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/HP-LaserJet_M1005_MFP.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/HP-LaserJet_1022n.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/HP-LaserJet_1022nw.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/Minolta-magicolor_2200_DL.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/Minolta-magicolor_2300_DL.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/Minolta-magicolor_2430_DL.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/KONICA_MINOLTA-magicolor_2430_DL.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/KONICA_MINOLTA-magicolor_2480_MF.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/KONICA_MINOLTA-magicolor_2490_MF.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/KONICA_MINOLTA-magicolor_2530_DL.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/Kyocera-KM-1635.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/Kyocera-KM-2035.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/Xerox-Phaser_6110.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/Xerox-Phaser_6115MFP.xml
    rm ${pkgdir}/usr/share/foomatic/db/source/printer/Samsung-CLP-310.xml
}
