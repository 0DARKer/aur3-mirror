# Maintainer:  dryes <joswiseman@gmail>

pkgname=newsmangler
pkgver=20101206
pkgrel=1
pkgdesc="NNTP binary poster with mulitple connection support."
url=('http://github.com/madcowfred')
arch=('any')
license=('Custom')
depends=('par2cmdline' 'python2' 'python-yenc')
optdepends=('mysql' 'postgresql' 'sqlite')
makedepends=('git')
install=('newsmangler.install')

_gitroot=git://github.com/madcowfred/newsmangler.git
_gitname=newsmangler

build()
{
	if [ ! -d $srcdir/newsmangler ]; then git clone git://github.com/madcowfred/newsmangler.git; else cd $srcdir/newsmangler && git pull origin; fi

	rm -rf $srcdir/$pkgname/.git $srcdir/$pkgname/.gitignore
	mkdir -p $pkgdir/opt && mv $srcdir/$pkgname $pkgdir/opt || return 1

	find $pkgdir/opt/newsmangler -type d -exec chmod 755 {} \;
	find $pkgdir/opt/newsmangler -type f -exec chmod 644 {} \;
	for _py in $pkgdir/opt/newsmangler/leecher.py $pkgdir/opt/newsmangler/poster.py; do sed -i 's/usr\/bin\/env python/usr\/bin\/python2/' $_py; done
	chmod +x $pkgdir/opt/newsmangler/leecher.py $pkgdir/opt/newsmangler/poster.py
}

