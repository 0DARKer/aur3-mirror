# Contributor: Andrew Fischer <andrew_at_lightningtoads.com>

pkgname=exodusii
pkgver=4.98
pkgrel=1
pkgdesc="EXODUS II is a model format developed to store and retrieve transient data for finite element analyses."
arch=('i686' 'x86_64')
license=("BSD")
url="http://sourceforge.net/projects/exodusii"
depends=('cmake' 'netcdf')
source=("http://downloads.sourceforge.net/sourceforge/exodusii/$pkgname-$pkgver.tar.gz")
md5sums=('4480e641d6ada58f5d8ecb7172e76791')

build() {
  cd $srcdir/$pkgname-$pkgver || return 1

  patch -p0 < $startdir/cbind-CMakeLists.patch

  _kernelver=$(eval 'uname -r')

  mkdir -p build-$_kernelver && cd build-$_kernelver || return 1

  cmake \
    -DCMAKE_INSTALL_PREFIX:PATH=/usr \
    -DCMAKE_BUILD_TYPE:STRING=Release \
    -DNETCDF_DIR:PATH=/usr \
    -DBUILD_SHARED_LIBS:BOOL=ON \
    -DNETCDF_LIBRARY:PATH=/usr/lib \
    ..

  make || return 1
  make DESTDIR=$pkgdir install || return 1
}
