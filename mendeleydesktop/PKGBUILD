# Maintainer: Dan Serban
# Contributor: Alexandre Guimaraes --- <alexandre.cortes yahoo.fr>
# Contributor: Peter Lewis --- <pete muddygoat.org>
# Contributor: Christopher Schwaab --- <christopher.schwaab gmail>

pkgname=mendeleydesktop
pkgver=0.9.9.2
pkgrel=6
pkgdesc="Academic software for managing and sharing research papers (desktop client)"
url=http://www.mendeley.com/
arch=(i686 x86_64)
depends=(libpng12 openssl-compatibility qt sqlite3)
license=(custom:mendeley_eula)
_filearch=i486
md5sums=('b7c56d77261b8d6c42fdf0b121ff82de')
[ "${CARCH}" == "x86_64" ] && _filearch=x86_64 && md5sums=('b76c7da409aecc2dc964e2e16c0a5d8a')
source=("http://www.mendeley.com/downloads/linux/${pkgname}-${pkgver}-linux-${_filearch}.tar.bz2")

build()
{
  cd mendeleydesktop-0.9.9.2-linux-${_filearch}
  rm lib/libQt*
  mv share/mendeleydesktop .
  mkdir -p "${pkgdir}"/usr
  mv share "${pkgdir}"/usr/
  mkdir -p "${pkgdir}"/usr/share/mendeleydesktop/share
  mv lib "${pkgdir}"/usr/share/mendeleydesktop/
  mv mendeleydesktop "${pkgdir}"/usr/share/mendeleydesktop/share/
  mkdir -p "${pkgdir}"/usr/bin
  USRBINFILE="${pkgdir}"/usr/bin/mendeleydesktop
  echo '#!/bin/bash' > "${USRBINFILE}"
  echo 'export LD_LIBRARY_PATH="/usr/share/mendeleydesktop/lib:${LD_LIBRARY_PATH}"' >> "${USRBINFILE}"
  echo "/usr/share/mendeleydesktop/lib/mendeleydesktop/libexec/mendeleydesktop.${_filearch}" >> "${USRBINFILE}"
  chmod +x "${USRBINFILE}"
}

