# Maintainer: wido <widomaker2k7@gmail.com>

pkgname=revengeofthetitans-hib
_pkgname=revengeofthetitans
pkgver=3
pkgrel=2
pkgdesc="Construct and command your ground defences in a series of increasingly massive battles across the solar system, in our frenetic arcade mash-up of Real Time Strategy and Tower Defence! (Humble Indie Bunble Version)"
arch=('i686' 'x86_64')
url='http://www.puppygames.net/revenge-of-the-titans/'
license=('custom: "shareware"')
depends=('openjdk6' 'openal')
conflicts=(revengeofthetitans)
[ "$CARCH" = "i686"   ] && ARCH=i386
[ "$CARCH" = "x86_64" ] && ARCH=amd64
_gamepkg="RevengeOfTheTitans-HIB-$ARCH-$pkgver.tar.gz"
source=("revenge.sh" "revenge.desktop")
md5sums=('fa1e576e658c368a14e9a67dce32fe2c' '91eed374cc3e3251202304961a85fb4c')
[ "$CARCH" = "x86_64" ] && md5sums=('fa1e576e658c368a14e9a67dce32fe2c' '91eed374cc3e3251202304961a85fb4c')

package() {
    cd ${srcdir}
  msg "You need a full copy of this game in order to install it"
  msg "Searching for \"${_gamepkg}\" in dir: $(readlink -f `pwd`/..)"
    pkgpath=$startdir
    if [[ ! -f "$startdir/${_gamepkg}" ]]; then
       error "Game package not found, please type absolute path to ${_gamepkg} (/home/joe):"
       read pkgpath
       if [[ ! -f "${pkgpath}/${_gamepkg}" ]]; then
           error "Unable to find game package." && return 1
       fi
    fi
  msg "Found game package, installing..."

  ln -fs ${pkgpath}/${_gamepkg} . || return 1
  tar xzf ${srcdir}/${_gamepkg} || return 1

# Create Destination Directory
    install -d -m 755 $pkgdir/opt/RevengeOfTheTitans
    install -d -m 755 $pkgdir/usr/bin
    install -d -m 755 $pkgdir/usr/share/pixmaps

# Install Game Launcher
    install -D -m 755 ${srcdir}/${_pkgname}/revenge.sh $pkgdir/opt/RevengeOfTheTitans/revenge.sh
    install -D -m 755 ${srcdir}/revenge.sh $pkgdir/usr/bin/revenge

# Install the data
    install -m 644 ${srcdir}/${_pkgname}/*.{jar,png} $pkgdir/opt/RevengeOfTheTitans/

# Install the data
    install -m 755 ${srcdir}/${_pkgname}/*.so $pkgdir/opt/RevengeOfTheTitans/

# Install Icon
    ln -s $pkgdir/opt/RevengeOfTheTitans/revenge.png $pkgdir/usr/share/pixmaps/Revenge.png

# Install Launcher
    install -D -m 644 $srcdir/revenge.desktop $pkgdir/usr/share/applications/revenge.desktop
}
