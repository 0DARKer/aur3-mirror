# Maintainer : Daniel Neve the.mephit@googlemail.com
pkgname=confirmaccount-mediawiki-ext
pkgver=1.49
pkgrel=2
pkgdesc="A MediaWiki Extension for restricting new user accounts"
arch=('any')
url="http://www.mediawiki.org/wiki/Extension:ConfirmAccount"
license=("GPL")
depends=('mediawiki>=1.15.2')
md5sums=('7916f4df91c024b247cae26e456e4dde')
install=confirmaccount.install
source=(http://upload.wikimedia.org/ext-dist/ConfirmAccount-trunk-r67659.tar.gz)

build() {
	cd $srcdir
	install -d -m0755 $pkgdir/srv/http/mediawiki/extensions || return 1
	mv ConfirmAccount $pkgdir/srv/http/mediawiki/extensions || return 1
	
	# Set permissions
	chmod -R 0644 $pkgdir/srv/http/mediawiki/extensions/ConfirmAccount || return 1
	
	# Re-add x bit to folders
	chmod -R 0744 $pkgdir/srv/http/mediawiki/extensions/ConfirmAccount || return 1
	chmod 0744 $pkgdir/srv/http/mediawiki/extensions/ConfirmAccount/archives || return 1
	chmod 0744 $pkgdir/srv/http/mediawiki/extensions/ConfirmAccount/postgres || return 1
	
	# Set it to be owned by the web user
	chown -R http: $pkgdir/srv/http/mediawiki/extensions/ConfirmAccount || return 1
}
