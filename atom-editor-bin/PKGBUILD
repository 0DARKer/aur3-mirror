# Maintainer: Tom Bu <tom.bu AT members.fsf.org>
# Contributer: John Reese <john@noswap.com>
# Upstream URL: https://github.com/atom/atom

pkgname=atom-editor-bin
pkgver=0.108.0_git20140703
_pkgver="0.108.0~git20140703"
pkgrel=3
pkgdesc="Text editor from Github - Precompiled binary from WebUpd8"
arch=('i686' 'x86_64')
url="https://github.com/atom/atom"
license=('MIT')
options=(!strip)
depends=('alsa-lib' 'gconf' 'gtk2' 'libgcrypt15' 'libgnome-keyring' 'libnotify' 'libudev.so.0' 'libxtst' 'nodejs' 'nss' 'python2')
conflicts=('atom-editor' 'atom-editor-git')

if [ "${CARCH}" = "x86_64" ]; then
  md5sums=('dc5a1cfd2ab8bddcfbd74b10071ef2f7'
           '6ec229d7f9d4a71d0f080e1efa9177d8')
  _carch=_amd64
  _arch=64
elif [ "${CARCH}" = "i686" ]; then
  md5sums=('282d112f41d468c3190fb77f4e2708b9'
           '6ec229d7f9d4a71d0f080e1efa9177d8')
  _carch=_i386
  _arch=32
fi

source=("https://launchpad.net/~webupd8team/+archive/atom/+files/atom_${_pkgver}~webupd8~saucy0${_carch}.deb"
        "atom.desktop" )

package() {
	bsdtar xf data.tar.gz
	cd opt/atom
	bsdtar xf "atom-linux${_arch}-${_pkgver}.tar.xz"
	rm "atom-linux${_arch}-${_pkgver}.tar.xz"
	cd ${srcdir}
	chmod -R g-w usr opt
	mv usr ${pkgdir}
	mv opt ${pkgdir}
	install -Dm755 ${srcdir}/atom.desktop ${pkgdir}/usr/share/applications/atom.desktop
  cd ${pkgdir}
  install -d usr/share/pixmaps/
  ln -s opt/atom/resources/app/resources/atom.png usr/share/pixmaps/
}

# vim:set ts=2 sw=2 et:
