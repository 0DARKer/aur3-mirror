# Maintainer: Daniel Wallace<daniel.wallace at gatech dot edu>
pkgname=mememaker
pkgver=20120320
pkgrel=9
pkgdesc="create memes from the command line, including the posibility to create split memes now with all options available from the command line"
arch=('any')
url="http://www.reddit.com/r/ScriptSwap/comments/r1oxf/bash_meme_maker_script_creates_meme_in_terminal/"
license=('GPL')
depends=('curl' 'imagemagick')
provides=('mememaker')
install=mememaker.install
source=(http://199.91.154.105/6bebbufb6ibg/25o01ck42w0ccdc/mememaker.zip\
        mememaker.install
        splitmeme-patch.diff)

build(){
  cd $srcdir
  patch -p0 < splitmeme-patch.diff
  sed -i 's/.\/list.txt/\/usr\/share\/mememaker\/list.txt/g' $pkgname.sh
  sed -i 's/\"\$meme/\/tmp\/\"\$meme/g' $pkgname.sh
  sed -i 's/\"\$2/\/tmp\/\"\$2/g' $pkgname.sh
  sed -i 's/\"\$3/\/tmp\/\"\$3/g' $pkgname.sh
  sed -i 's/.\/memes/\/usr\/share\/mememaker\/memes/g' $pkgname.sh
  sed -i 's/.\/meme.jpg/\/tmp\/meme.jpg/g' $pkgname.sh
  sed -i 's/\ meme.jpg/\ \/tmp\/meme.jpg/g' $pkgname.sh
  sed -i 's/\ out.png/\ \/tmp\/out.png/g' $pkgname.sh
  sed -i 's/caption/label/g' $pkgname.sh
  sed -n 's/^apikey=/&/w imgurrc' < $pkgname.sh
  sed -i 's/apikey=/imgur\ /' imgurrc 
  sed -i 's/\"//g' imgurrc
  sed -i '/apikey=/ c\apikey='"\"$\(awk \'\/imgur\/ \{print \$2\}\' \/etc\/imgurrc \)\""'' $pkgname.sh
}

package() {
  cd $srcdir
  install -D list.txt $pkgdir/usr/share/mememaker/list.txt
  cp -dpr --no-preserve=ownership memes $pkgdir/usr/share/mememaker/memes/
  install -Dm755 $pkgname.sh $pkgdir/usr/bin/$pkgname
  install -D imgurrc $pkgdir/etc/imgurrc
}

# vim:set ts=2 sw=2 et:
md5sums=('31010fd0580f444b6c64c72135970fcf'
         '87c8994149218d13d1d00b4fb76d35c6'
         '8267113c0fb983af8aa916e9dd047f57')
