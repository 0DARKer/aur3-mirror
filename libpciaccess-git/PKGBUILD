# Contributor Jonathan <eyeswide@gmail.com>
# Maintainer: Matt Parnell /ilikenwf <parwok@gmail.com>

arch=('i686' 'x86_64')
pkgname=libpciaccess-git
pkgver=20080811
pkgrel=1
pkgdesc="Generic pci access library for x"
url="http://gitweb.freedesktop.org/?p=xorg/lib/libpciaccess.git"
license="bsd"
depends=('glibc')
makedepends=('git')
provides=('libpciaccess')
conflicts=('libpciaccess')
source=()
md5sums=()

_gitroot="git://anongit.freedesktop.org/xorg/lib/libpciaccess.git"
_gitname="libpciaccess"

build() {
	cd $startdir/src
	msg "Connecting to git.freedesktop.org GIT server...."

        if [ -d $startdir/src/$_gitname ] ; then
		cd $_gitname && git-pull origin
		msg "The local files are updated."
	else
		git clone $_gitroot
	fi
	msg "GIT checkout done or server timeout"
        msg "Starting make..."

	cp -r $startdir/src/$_gitname $startdir/src/$_gitname-build
	cd $startdir/src/$_gitname-build

	./autogen.sh --host=${CHOST} --prefix=/usr || return 1
	make || return 1
	make DESTDIR=$startdir/pkg install
	find $startdir/pkg -type f -name '*.la' -exec rm {} \;
 } 


