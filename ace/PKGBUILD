# Contributor: DaNiMoTh <jjdanimoth@gmail.com>
# Contributor: Andrea Scarpino <bash.lnx@gmail.com>
# Maintainer: Gereon Schomber

pkgname=ace
pkgver=6.0.1
pkgrel=1
pkgdesc="Provides abstractions for sockets,demultiplexing loops"
url="http://www.cs.wustl.edu/~schmidt/ACE.html"
license=('custom')
arch=('i686' 'x86_64')
depends=('openssl' 'gcc')
options=(!libtool)
source=(http://download.dre.vanderbilt.edu/previous_versions/ACE-${pkgver}.tar.bz2
        license.txt)

build() {
#  export LDFLAGS="${LDFLAGS//-Wl,--as-needed}"
  cd $srcdir/ACE_wrappers
  sed -i.bak -e 's/SSL_METHOD/const SSL_METHOD/g' configure || return 1
  install -d objdir
  cd objdir
  ../configure --prefix=/usr --disable-ace-examples
  ## use this if the configure scipt hangs at "checking mutex timeouts" 
  # ../configure --prefix=/usr --disable-pthreads --disable-ace-examples
  make || return 1
}
package() {
  cd $srcdir/ACE_wrappers/objdir
  make install DESTDIR=$pkgdir
  rm -rf $pkgdir/home
  cd $srcdir/ACE_wrappers/ace
  install -m 644 Svc_Conf_Token_Table.h Unbounded_Set_Ex.h \
   Unbounded_Set_Ex.inl Unbounded_Set_Ex.cpp $pkgdir/usr/include/ace
}
sha1sums=('ac8841677c2a313b334e701bb7d905d1634afe93'
          'b21054d0aa546fabe4bb0c2769401314d4a5bfe3')
