#Mantainer: M0Rf30
pkgname=wolfsp-git
pkgver=35.5d33633
pkgrel=1
pkgdesc="Return to Castle Wolfenstein Single Player (Justin Crawford fork)"
arch=('i686' 'x86_64')
url="https://github.com/Justasic/RTCW-SP"
license=('GPL3')
depends=('sdl_sound' 'libxxf86vm' 'mesa')
makedepends=('git' 'make' 'libxxf86dga' 'cmake')
source=('wolfsp::git://github.com/Justasic/RTCW-SP.git'
	'wolfsp.launcher' 'wolfsp.png' 'wolfsp.desktop'
	"http://ederabbcaserta.it/rtcw/sp_pak2.pk3"
	"http://ederabbcaserta.it/rtcw/sp_pak3.pk3")
install='wolfsp-git.install'

build() {
  cd wolfsp
  mkdir release && cd release
#  unset CFLAGS
  cmake ../. -DCMAKE_BUILD_TYPE=Release
  make
}

package(){
  cd wolfsp
  cd release
  make DESTDIR=$pkgdir install
    
  # Move Data to Package Directory
    mv $srcdir/sp_pak* $pkgdir/opt/wolfsp/main
  
  # Install Launcher Script (Single Player Client)
    install -D -m 755 $srcdir/wolfsp.launcher \
        $pkgdir/usr/bin/wolfsp
  
  # Install Desktop File (Single Player)
    install -D -m 644 $srcdir/wolfsp.desktop \
        $pkgdir/usr/share/applications/wolfsp.desktop

  # Install Icon File (Single Player)
    install -D -m 644 $srcdir/wolfsp.png \
        $pkgdir/usr/share/pixmaps/wolfsp.png

  rm -rf "$srcdir/$_gitname-build"
} 

pkgver() {
  cd wolfsp
  echo $(git rev-list --count master).$(git rev-parse --short master)
}

md5sums=('SKIP'
         '81ff046200847bcb29189eb91f753533'
         'bf26dc4c10d4bbfbd0c7a052a00c3cdf'
         'a1827afc1e7653fb4ba53b1a8aa939e1'
         '330b272d5261fe19fcf3c3fbc943c7f3'
         'cf25d6731ed29c80303febbb177aa585')
