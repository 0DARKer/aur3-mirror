# Maintainer: Olivier EBLE <olivier.eble at gmail com>
# Contributor: Laszlo Papp <djszapi2 at gmail com>
pkgname=libftd2xx
pkgver=1.0.4
pkgrel=1
pkgdesc="Library that allows a direct access to a USB FTDI2XX chip based device"
arch=('i686' 'x86_64')
url="http://www.ftdichip.com/"
license=('GPL')
depends=('libusb>=1.0.8')
if [ "$CARCH" = "x86_64" ]; then
	depends=("${depends[@]}" 'lib32-glibc' 'lib32-libusb>=1.0.8')
else
	depends=("${depends[@]}" 'glibc')
fi
options=(!strip)
install=libftd2xx.install
source=(http://www.ftdichip.com/Drivers/D2XX/Linux/${pkgname}${pkgver}.tar.gz
	55-ft2232.rules)
md5sums=('348bc4e27783cba67d0a8bf80ab280c4'
	 '51861263902e6220c17d8241030fec29')

package() {
  cd "${srcdir}/${pkgname}${pkgver}"
  install -d "${pkgdir}/usr/local/lib"
  install -d ${pkgdir}/usr/{lib,include}
  if [ "$CARCH" = "x86_64" ]; then
	cd build/x86_64
  else
	cd build/i386
  fi
  
  install -Dm755 ${pkgname}.so.${pkgver} ${pkgdir}/usr/lib/${pkgname}.so.${pkgver}
  ln -sf /usr/lib/${pkgname}.so.${pkgver} ${pkgdir}/usr/lib/${pkgname}.so
  
  install -Dm644 ${pkgname}.a ${pkgdir}/usr/lib/${pkgname}.a
  
  cd ../..
  install -m644 {ftd2xx,WinTypes}.h ${pkgdir}/usr/include/
  install -D -m755 ${srcdir}/55-ft2232.rules ${pkgdir}/etc/udev/rules.d/55-ft2232.rules
}
