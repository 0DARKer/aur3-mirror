# Maintainer: Gianfranco 'Gianfrix' Micoli <gianfrix.mg@gmail.com>

pkgname=libdbusmenu
pkgver=0.3.98
pkgrel=2
_ubuntupkgrel=1
pkgdesc="A small little library that was created by pulling out some common code out of indicator-applet. (Canonical Ayatana Project)"
arch=('i686' 'x86_64')
url="https://launchpad.net/dbusmenu"
license=('GPL')
depends=('glib2' 'dbus-glib' 'libxml2' 'json-glib' 'gtk2')
makedepends=('intltool' 'gnome-common' 'gnome-doc-utils')
source=(http://archive.ubuntu.com/ubuntu/pool/main/libd/libdbusmenu/libdbusmenu_${pkgver}.orig.tar.gz
http://archive.ubuntu.com/ubuntu/pool/main/libd/libdbusmenu/libdbusmenu_${pkgver}-0ubuntu${_ubuntupkgrel}.diff.gz
Dbusmenu-Glib-0.2.gir
Dbusmenu-Glib-0.2.vapi
DbusmenuGtk-0.2.gir
DbusmenuGtk-0.2.vapi
Dbusmenu-0.4.gir
Dbusmenu-0.4.vapi)
md5sums=('9d2e4e3ed617fdaa056f7e2d6cac62e4'
         '12789a71a7dc34d7c2d18471a31bf5ea'
         '1c2f4f0648fba407934d5696cc212398'
         '40ae00d26cda9b781a561befe6276c80'
         'd7c40fa2bcd6706f8e211a8ba883e44a'
         '91e976da3435bb888db813df5626e137'
         'a3dd900ba3e77b1e8cd5905b65dfb504'
         'be8c6615270eb38dfe4f48045e4ecc91')

build() {
  cd "$srcdir"/$pkgname-$pkgver
  patch -Np1 -i ../libdbusmenu_${pkgver}-0ubuntu${_ubuntupkgrel}.diff
  ./configure --prefix=/usr --disable-static --enable-introspection=no
  make
}

package()
{
  cd "$srcdir"/$pkgname-$pkgver
  make DESTDIR="$pkgdir/" install
 
  install -d $pkgdir/usr/share/gir-1.0/
  install -d $pkgdir/usr/share/vala/vapi/
  install ../Dbusmenu-Glib-0.2.gir $pkgdir/usr/share/gir-1.0/
  install ../DbusmenuGtk-0.2.gir $pkgdir/usr/share/gir-1.0/
  install ../Dbusmenu-0.4.gir $pkgdir/usr/share/gir-1.0/
  install ../Dbusmenu-Glib-0.2.vapi $pkgdir/usr/share/vala/vapi/
  install ../DbusmenuGtk-0.2.vapi $pkgdir/usr/share/vala/vapi/
  install ../Dbusmenu-0.4.vapi $pkgdir/usr/share/vala/vapi/
}
