# Maintainer: Gianfranco 'Gianfrix' Micoli <gianfrix.mg@gmail.com>
# Contributor: L42y <423300@gmail.com>
pkgname=libdbusmenu
pkgver=0.4.90
pkgrel=1
_ubuntupkgrel=3
pkgdesc="A small little library that was created by pulling out some common code out of indicator-applet. (Canonical Ayatana Project)"
arch=('i686' 'x86_64')
url="https://launchpad.net/dbusmenu"
license=('GPL')
depends=('glib2' 'dbus-glib' 'libxml2' 'json-glib-git' 'gtk2')
makedepends=('intltool' 'gnome-doc-utils')
source=(http://archive.ubuntu.com/ubuntu/pool/main/libd/libdbusmenu/libdbusmenu_${pkgver}.orig.tar.gz
        http://archive.ubuntu.com/ubuntu/pool/main/libd/libdbusmenu/libdbusmenu_${pkgver}-0ubuntu${_ubuntupkgrel}.diff.gz
	    Dbusmenu-Glib-0.2.gir
	    Dbusmenu-Glib-0.2.vapi
	    DbusmenuGtk-0.2.gir
	    DbusmenuGtk-0.2.vapi
	    Dbusmenu-0.4.gir
	    Dbusmenu-0.4.vapi)
md5sums=('281e61ae1a62b1dbbc7a690700de616c'
         'ea91cb63bb6fe2c474f501191d28e2c0'
         '1c2f4f0648fba407934d5696cc212398'
         '40ae00d26cda9b781a561befe6276c80'
         'd7c40fa2bcd6706f8e211a8ba883e44a'
         '91e976da3435bb888db813df5626e137'
         'a3dd900ba3e77b1e8cd5905b65dfb504'
         'be8c6615270eb38dfe4f48045e4ecc91')

build() {
  cd "$srcdir"/$pkgname-$pkgver
  patch -Np1 -i ../libdbusmenu_${pkgver}-0ubuntu${_ubuntupkgrel}.diff
  ./configure --prefix=/usr --disable-static --enable-introspection=no
  make
}

package() {
  cd "$srcdir"/$pkgname-$pkgver
  make DESTDIR="$pkgdir/" install
 
  install -d $pkgdir/usr/share/gir-1.0/
  install -d $pkgdir/usr/share/vala/vapi/
  install ../Dbusmenu-Glib-0.2.gir $pkgdir/usr/share/gir-1.0/
  install ../DbusmenuGtk-0.2.gir $pkgdir/usr/share/gir-1.0/
  install ../Dbusmenu-0.4.gir $pkgdir/usr/share/gir-1.0/
  install ../Dbusmenu-Glib-0.2.vapi $pkgdir/usr/share/vala/vapi/
  install ../DbusmenuGtk-0.2.vapi $pkgdir/usr/share/vala/vapi/
  install ../Dbusmenu-0.4.vapi $pkgdir/usr/share/vala/vapi/
}
