# Maintainer: archtux <antonio.arias99999@gmail.com>

pkgname=motogt
pkgver=20101127
pkgrel=1
pkgdesc="MotoGT is a 2D top-viewed game where you drive a MotoGP bike"
arch=('i686' 'x86_64')
url="http://motogt.sourceforge.net/"
license=('GPL2')
depends=('sfml')
source=(http://prdownloads.sourceforge.net/motogt/MotoGT-$pkgver.zip)
md5sums=('983d99cddb4e5d8a46e68cd081249667')

build() {
  cd $srcdir/MotoGT

  # Compilation
  make

  # Installation
  mkdir -p $pkgdir/usr/share/MotoGT
  install -Dm755 MotoGT.bin $pkgdir/usr/share/MotoGT/MotoGT.bin
  cp -R data/ data_low/ $pkgdir/usr/share/MotoGT

  # Write permissions
  chmod 4511 -R $pkgdir/usr/share/MotoGT

  # Start file
  mkdir -p $pkgdir/usr/bin
  install -Dm755 $startdir/MotoGT_start $pkgdir/usr/bin/MotoGT_start

  # Symlinks sfml library 1.5 -> 1.6
  mkdir -p $pkgdir/usr/lib
  ln -s "/usr/lib/libsfml-audio.so.1.6" "$pkgdir/usr/lib/libsfml-audio.so.1.5"
  ln -s "/usr/lib/libsfml-graphics.so.1.6" "$pkgdir/usr/lib/libsfml-graphics.so.1.5"
  ln -s "/usr/lib/libsfml-system.so.1.6" "$pkgdir/usr/lib/libsfml-system.so.1.5"
  ln -s "/usr/lib/libsfml-window.so.1.6" "$pkgdir/usr/lib/libsfml-window.so.1.5"

  # Desktop icon
  install -Dm644 ./data/bikes/01/thumbnail.png $pkgdir/usr/share/pixmaps/MotoGT.png
  install -Dm644 $startdir/MotoGT.desktop $pkgdir/usr/share/applications/MotoGT.desktop
}