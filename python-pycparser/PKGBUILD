# Maintainer: Alexander RÃ¸dseth <rodseth@gmail.com>
# Contributor: lang2 <wenzhi.liang@gmail.com>

pkgname=python-pycparser
pkgver=2.09.1
pkgrel=1
pkgdesc='C parser and AST generator written in Python'
url='https://bitbucket.org/eliben/pycparser'
makedepends=('mercurial')
depends=('python' 'python-ply')
conflicts=('pycparser')
replaces=('pycparser')
arch=('x86_64' 'i686')
license=('BSD')
_hgname='pycparser'
_hgroot="https://bitbucket.org/eliben/$_hgname/"

build() {
  cd "$srcdir"

  msg "Connecting to Mercurial server...."
  if [ -d $_hgname ] ; then
    cd "$_hgname" && hg pull
    msg "The local files are updated."
  else
    hg clone "$_hgroot"
  fi
  msg "Mercurial checkout done or server timeout"
  msg "Building package..."
  cd "$srcdir"
  cp -r "$_hgname" "$_hgname-build"
  cd "$_hgname-build"

  python setup.py build
}

package() {
  cd "$srcdir/$_hgname-build"

  python setup.py install --root="$pkgdir" --optimize=1
  install -Dm644 LICENSE \
    "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}

# vim:set ts=2 sw=2 et:
