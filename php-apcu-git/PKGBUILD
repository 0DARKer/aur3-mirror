# Maintainer: Leonard de Ruijter <leonard@aur.archlinux.org>
# Contributor: Iwan Timmer <irtimmer at gmail dot com>

pkgname=php-apcu-git
pkgver=GIT
pkgrel=1
arch=('i686' 'x86_64')
pkgdesc='A free, open, and robust framework for caching'
url='http://github.com/krakjoe/apcu'
provides=('php-apcu')
conflicts=('php-apcu')
depends=('php')
license=('PHP')
source=($pkgname::git://github.com/krakjoe/apcu.git)
backup=('etc/php/conf.d/apcu.ini')
md5sums=('SKIP')

pkgver() {
  cd $pkgname
  # Use the tag of the last commit
  git describe --always | sed 's|-|.|g'
}

build() {
	cd $srcdir/$pkgname
	phpize
	./configure --prefix=/usr
	make
}

package() {
	cd $srcdir/$pkgname
	make INSTALL_ROOT=$pkgdir install
	echo ';extension=apcu.so' > apcu.ini
	install -D -m644 apcu.ini $pkgdir/etc/php/conf.d/apcu.ini
	install -D -m644 apc.php $pkgdir/usr/share/php-apcu/apc.php
	install -D -m644 INSTALL $pkgdir/usr/share/doc/php-apcu/install.txt
}
