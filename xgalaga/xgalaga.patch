# fix path to the scores file
diff -ur xgalaga-2.0.34.orig/configure xgalaga-2.0.34/configure
--- xgalaga-2.0.34.orig/configure	2012-08-25 14:33:21.719678164 +0100
+++ xgalaga-2.0.34/configure	2012-08-25 14:34:52.861087634 +0100
@@ -1894,7 +1894,7 @@
 
 
 cat >> confdefs.h <<EOF
-#define SCOREFILE "$prefix/scores"
+#define SCOREFILE "/var/lib/xgalaga/scores"
 EOF
 
 cat >> confdefs.h <<EOF
diff -ur xgalaga-2.0.34.orig/data.c xgalaga-2.0.34/data.c
--- xgalaga-2.0.34.orig/data.c	2012-08-25 14:33:21.723011541 +0100
+++ xgalaga-2.0.34/data.c	2012-08-25 14:34:24.757319526 +0100
@@ -6,7 +6,6 @@
 #include "images.h"
 #include "defs.h"
 #include "data.h"
-#include "struct.h"
 
 int buttonDown = 0;
 
diff -ur xgalaga-2.0.34.orig/data.h xgalaga-2.0.34/data.h
--- xgalaga-2.0.34.orig/data.h	2012-08-25 14:33:21.729678304 +0100
+++ xgalaga-2.0.34/data.h	2012-08-25 14:34:24.757319526 +0100
@@ -1,4 +1,5 @@
 #include "Wlib.h"
+#include "struct.h"
 
 extern W_Window gal, baseWin;
 
diff -ur xgalaga-2.0.34.orig/explosions.c xgalaga-2.0.34/explosions.c
--- xgalaga-2.0.34.orig/explosions.c	2012-08-25 14:33:21.723011541 +0100
+++ xgalaga-2.0.34/explosions.c	2012-08-25 14:34:24.760652963 +0100
@@ -8,7 +8,6 @@
 #include <stdlib.h>
 #include "Wlib.h"
 #include "images.h"
-#include "struct.h"
 #include "data.h"
 #include "proto.h"
 #include "sound.h"
diff -ur xgalaga-2.0.34.orig/highscore.c xgalaga-2.0.34/highscore.c
--- xgalaga-2.0.34.orig/highscore.c	2012-08-25 14:33:21.729678304 +0100
+++ xgalaga-2.0.34/highscore.c	2012-08-25 14:34:24.760652963 +0100
@@ -27,7 +27,6 @@
 
 #include "Wlib.h"
 #include "defs.h"
-#include "struct.h"
 #include "proto.h"
 #include "data.h"
 
diff -ur xgalaga-2.0.34.orig/libsprite/data.c xgalaga-2.0.34/libsprite/data.c
--- xgalaga-2.0.34.orig/libsprite/data.c	2012-08-25 14:33:21.726344921 +0100
+++ xgalaga-2.0.34/libsprite/data.c	2012-08-25 14:34:24.763986371 +0100
@@ -17,7 +17,6 @@
 
 #include "Wlib.h"
 #include "data.h"
-#include "struct.h"
 
 int	nplanes=3;
 int	xpmORplanes = 4;
@@ -61,7 +60,7 @@
 /* GC used for drawing the borders [BDyess] */
 GC borderGC;
 int     controlkey = 0;
-#define	BillsScrewyAltMask	(Mod1Mask|Mod2Mask|Mod3Mask|Mod4Mask|Mod5Mask)
+unsigned BillsScrewyAltMask = Mod1Mask|Mod2Mask|Mod3Mask|Mod4Mask|Mod5Mask;
 int     altkey = 0;
 int     W_FastClear = 0;
 #ifdef CONTINUOUS_MOUSE
@@ -79,7 +78,7 @@
 W_Color W_White = WHITE, W_Black = BLACK, W_Red = RED, W_Green = GREEN;
 W_Color W_Yellow = YELLOW, W_Cyan = CYAN, W_Grey = LIGHT_GREY, W_DarkGrey = DARK_GREY;
 int     W_Textwidth, W_Textheight, W_BigTextwidth, W_BigTextheight;
-char   *strdup();
+/*char   *strdup(); */
 
 int     W_in_message = 0;	/* jfy -- for Jerry's warp message hack */
 
diff -ur xgalaga-2.0.34.orig/libsprite/data.h xgalaga-2.0.34/libsprite/data.h
--- xgalaga-2.0.34.orig/libsprite/data.h	2012-08-25 14:33:21.729678304 +0100
+++ xgalaga-2.0.34/libsprite/data.h	2012-08-25 14:34:24.763986371 +0100
@@ -20,6 +20,7 @@
 
 #include "Wlib.h"
 #include "defs.h"
+#include "struct.h"
 
 extern int	nplanes;
 extern int	xpmORplanes ;
@@ -88,4 +89,6 @@
 
 extern int useBuffered;
 
+extern unsigned BillsScrewyAltMask;
+
 #endif /* _data_h_ */
# fix warning about missing font
diff -ur xgalaga-2.0.34.orig/libsprite/defs.h xgalaga-2.0.34/libsprite/defs.h
--- xgalaga-2.0.34.orig/libsprite/defs.h	2012-08-25 14:33:21.726344921 +0100
+++ xgalaga-2.0.34/libsprite/defs.h	2012-08-25 14:34:58.944514918 +0100
@@ -59,7 +59,7 @@
 #define BOLD_FONT2	"-*-clean-bold-r-normal--10-100-75-75-c-60-*"
 #define ITALIC_FONT	"6x10"
 #define ITALIC_FONT2	"-*-clean-bold-r-normal--10-100-75-75-c-60-*"
-#define BIG_FONT	"-adobe-helvetica-bold-r-normal--34-*-*-*-*-*-*-*"
+#define BIG_FONT	"-*-*-bold-r-normal--34-*-*-*-*-*-*-*"
 #define IND_FONT        "-*-clean-bold-r-normal--10-100-75-75-c-60-*"
 
 #define FONTS 4
@@ -106,7 +106,4 @@
 }
 #endif		/* ABORT_ON_ERROR */
 
-#define	BillsScrewyAltMask	(Mod1Mask|Mod2Mask|Mod3Mask|Mod4Mask|Mod5Mask)
-
-
 #endif /* _defs_h_ */
diff -ur xgalaga-2.0.34.orig/libsprite/init.c xgalaga-2.0.34/libsprite/init.c
--- xgalaga-2.0.34.orig/libsprite/init.c	2012-08-25 14:33:21.726344921 +0100
+++ xgalaga-2.0.34/libsprite/init.c	2012-08-25 14:34:11.840453246 +0100
@@ -326,6 +326,36 @@
     XSetForeground(W_Display, maskGC, 0);
 }
 
+/* Any of Mod1 through Mod5 that are generated by XK_Num_Lock or
+ * XK_Scroll_Lock are excluded from BillsScrewyAltMask.
+ */
+static void
+GetAltMask()
+{
+    XModifierKeymap *m;
+    int     i, j;
+    KeySym  k;
+
+    m = XGetModifierMapping(W_Display);
+    if (m == NULL) {
+        printf("Not enough memory\n");
+        exit(1);
+    }
+
+    for (i = 3; i < 8; i++) {
+        for (j = 0; j < m->max_keypermod; j++) {
+            k = XKeycodeToKeysym(W_Display,
+                m->modifiermap [i*m->max_keypermod + j], 0);
+            if (k == XK_Num_Lock || k == XK_Scroll_Lock) {
+                BillsScrewyAltMask &= ~(1 << i);
+                break;
+            }
+        }
+    }
+
+    XFreeModifiermap(m);
+}
+
 void
 W_Initialize(str)
     char   *str;
@@ -362,6 +392,7 @@
 */
     GetFonts();
     GetColors();
+    GetAltMask();
 
     backColor = W_Black;
 }
diff -ur xgalaga-2.0.34.orig/main.c xgalaga-2.0.34/main.c
--- xgalaga-2.0.34.orig/main.c	2012-08-25 14:33:21.733011692 +0100
+++ xgalaga-2.0.34/main.c	2012-08-25 14:34:24.763986371 +0100
@@ -17,7 +17,6 @@
 #include "data.h"
 #include "images.h"
 #include "defs.h"
-#include "struct.h"
 #include "paths.h"
 #include "proto.h"
 #include "sound.h"
diff -ur xgalaga-2.0.34.orig/Makefile.in xgalaga-2.0.34/Makefile.in
--- xgalaga-2.0.34.orig/Makefile.in	2012-08-25 14:33:21.726344921 +0100
+++ xgalaga-2.0.34/Makefile.in	2012-08-25 14:34:41.497577326 +0100
@@ -10,6 +10,7 @@
 
 prefix = @prefix@
 exec_prefix = @exec_prefix@
+scoredir = @scoredir@
 bindir = $(exec_prefix)
 libdir = $(prefix)/lib
 infodir = $(prefix)/info
@@ -20,7 +21,7 @@
 SOUNDOBJS = @SOUNDSERVER@.o
 SOUNDSRCS = @SOUNDSERVER@.c
 
-SOUNDDEFS = -DSOUNDSERVER=\"@prefix@/@SOUNDSERVER@\"
+SOUNDDEFS = -DSOUNDSERVER=\"@exec_prefix@/@SOUNDSERVER@\"
 
 RM = rm -f
 CC = @CC@
@@ -45,14 +46,16 @@
 install: all
 	./mkinstalldirs $(bindir)
 	./mkinstalldirs $(prefix)
+	./mkinstalldirs $(scoredir)
 	$(INSTALL) $(TARGET) $(bindir)/$(TARGET)
-	$(INSTALL) $(SOUNDSRV) $(prefix)/$(SOUNDSRV)
+	$(INSTALL) $(SOUNDSRV) $(bindir)/$(SOUNDSRV)
 	./mkinstalldirs $(prefix)/sounds
 	./mkinstalldirs $(prefix)/levels
 	for i in levels/*.xgl; do $(INSTALL) $$i $(prefix)/$$i ; done
 	for i in sounds/*.raw; do $(INSTALL) $$i $(prefix)/$$i ; done
-	touch $(prefix)/scores
-	chmod 666 $(prefix)/scores
+	touch $(scoredir)/scores
+	chmod 664 $(scoredir)/scores
+	chgrp games $(scoredir)/scores
 
 subdirs:
 	for i in $(SUBDIRS); do cd $$i ; make ; done
diff -ur xgalaga-2.0.34.orig/paths.c xgalaga-2.0.34/paths.c
--- xgalaga-2.0.34.orig/paths.c	2012-08-25 14:33:21.726344921 +0100
+++ xgalaga-2.0.34/paths.c	2012-08-25 14:34:24.767319837 +0100
@@ -3,7 +3,6 @@
 #include "copyright.h"
 #include <config.h>
 
-#include "struct.h"
 #include "defs.h"
 #include "paths.h"
 #include "data.h"
diff -ur xgalaga-2.0.34.orig/prize.c xgalaga-2.0.34/prize.c
--- xgalaga-2.0.34.orig/prize.c	2012-08-25 14:33:21.723011541 +0100
+++ xgalaga-2.0.34/prize.c	2012-08-25 14:34:24.767319837 +0100
@@ -6,7 +6,6 @@
 #include <stdlib.h>
 #include "Wlib.h"
 #include "images.h"
-#include "struct.h"
 #include "data.h"
 #include "defs.h"
 #include "proto.h"
diff -ur xgalaga-2.0.34.orig/score.c xgalaga-2.0.34/score.c
--- xgalaga-2.0.34.orig/score.c	2012-08-25 14:33:21.726344921 +0100
+++ xgalaga-2.0.34/score.c	2012-08-25 14:34:24.767319837 +0100
@@ -8,7 +8,6 @@
 #include "images.h"
 #include "data.h"
 #include "defs.h"
-#include "struct.h"
 #include "proto.h"
 
 char scorestr[40] = "Score: 0000000", shipstr[4] ="";
diff -ur xgalaga-2.0.34.orig/title.c xgalaga-2.0.34/title.c
--- xgalaga-2.0.34.orig/title.c	2012-08-25 14:33:21.726344921 +0100
+++ xgalaga-2.0.34/title.c	2012-08-25 14:34:24.767319837 +0100
@@ -8,7 +8,6 @@
 #include "defs.h"
 #include "images.h"
 #include "data.h"
-#include "struct.h"
 #include "proto.h"
 
 W_Image *pauseImage, *titleImage;
