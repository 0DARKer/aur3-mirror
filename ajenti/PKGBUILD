# Maintainer: Shanto
# Contributor: vbPadre <vbpadre@gmail.com>

pkgname=ajenti
pkgver=0.5
pkgrel=12
holdver=$pkgver
pkgdesc="An easy server administration frontend like webmin."
arch=('any')
url="http://ajenti.org/"
license=('LGPL')
depends=('python2' 'python-lxml' 'twisted' 'python2-pyopenssl' 'python2-feedparser')
makedepends=('git' 'python2' 'python2-distribute')
optdepends=()
provides=('ajenti')
install=('ajenti.install')
source=('ajenti.arch.patch')
md5sums=('2acc2dbd940ddcd6baf8a9ccbd0b1973')

gitroot=git://github.com/Eugeny/ajenti.git
gitname=ajenti

build() {
	cd "$srcdir"
	msg "Connecting to GIT server...."

	rm -rf "$gitname"
	git clone -n "$gitroot"
	cd "$gitname"
	git checkout "$pkgver-$pkgrel"

	msg "GIT checkout done or server timeout"
}

package() {
	find "$srcdir/$gitname" -name '*.py' -exec sed -i 's|#!/usr/bin/env python|#!/usr/bin/python2|' "{}" \;
	patch -p 1 -i "$srcdir/ajenti.arch.patch" -d "$srcdir/$gitname"
	cd "$srcdir/$gitname"
	python2 setup.py install --root "$pkgdir"
}
