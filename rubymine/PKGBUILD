# Maintainer: Ernie Brodeur <ebrodeur@ujami.net>
pkgname=rubymine
pkgver=3.1.1
pkgrel=1
pkgdesc="A commerical Ruby/Rails IDE.  Has support for evaluation license and opensource project licenses."
arch=('i686' 'x86_64')
url="http://www.jetbrains.com/ruby/"
license=('custom')  # I need to adjust this since it technically has four licenses depending on the intended usage.
depends=('java-runtime')
optdepends=('gtk2') # probably more opts I need to research as well.
source=("http://download.jetbrains.com/ruby/${pkgname}-${pkgver}.tar.gz")
md5sums=('a9eccf520c77d8fd01f0f2276bb9b29f')

package() {
	# install the rubymine /usr/lib 
	mkdir -p "${pkgdir}/usr/lib/${pkgname}-${pkgver}"
	cp -R ${pkgname}-${pkgver} "${pkgdir}/usr/lib/"
	ln -s "${pkgdir}/usr/lib/${pkgname}-${pkgver}" "${pkgdir}/usr/lib/${pkgname}" 
	# install a link to startup.
	mkdir -p "${pkgdir}/usr/bin" 

	ln -s "${pkgdir}/usr/lib/${pkgname}-${pkgver}/bin/rubymine.sh" "${pkgdir}/usr/bin/mine" 

	### Copy the licenses and the help files over
	# internally, this is duplicating about ten files as they will exist in two places.
	# considering the entire package size is well over 50megabytes, a few extra duplicated
	# files don't mean enough to strain them out.
	mkdir -p "${pkgdir}/usr/share/doc/${pkgname}-${pkgver}"
	cp -R "${pkgname}-${pkgver}/help" "${pkgdir}/usr/share/doc/${pkgname}-${pkgver}"
	mkdir -p "${pkgdir}/usr/share/licenses/${pkgname}/"
	cp -R "${pkgname}-${pkgver}/license" "${pkgdir}/usr/share/licenses/${pkgname}/"

 	### Setup a desktop icon in the menu.
	# move the desktop icon into the desired location, I believe this is /usr/share/applications but
	# I have not researched it.
	mkdir -p "${pkgdir}/usr/share/applications/"
	cp ../RubyMine.desktop "${pkgdir}/usr/share/applications/" 
}

