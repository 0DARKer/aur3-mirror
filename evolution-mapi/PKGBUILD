# Maintainer: ngoonee <ngoonee.talk@gmail.com>
# Contributor: Adam Russell <adamlr6+arch@gmail.com>
pkgname=evolution-mapi
pkgver=0.32.2
_gnomever=0.32
pkgrel=1
pkgdesc="MAPI plugin for evolution."
arch=('i686' 'x86_64')
url="http://www.go-evolution.org"
license=('GPL3')
depends=('evolution>=0.32.0' 'openchange=0.10-3')
options=(!makeflags)
source=(http://ftp.gnome.org/pub/gnome/sources/evolution-mapi/$_gnomever/${pkgname}-${pkgver}.tar.gz)
_prefix="/opt/samba4"
md5sums=('534bd6a98aa71ffb83f437bd14ecd5e3')

build() {
	cd ${srcdir}/${pkgname}-${pkgver}

	export PKG_CONFIG_PATH=${_prefix}/samba/lib/pkgconfig:$PKG_CONFIG_PATH
	export PKG_CONFIG_PATH=${_prefix}/lib/pkgconfig:$PKG_CONFIG_PATH

	export CFLAGS="-DHAVE_MEMCTX_ON_CAST_SPROPVALUE -DHAVE_MEMCTX_ON_CAST_MAPI_SPROPVALUE ${CFLAGS}"
	./configure --prefix=${_prefix}
	unset CFLAGS

	make || return 1
}

package() {
	cd ${srcdir}/${pkgname}-${pkgver}

	make DESTDIR="$pkgdir/" install
}
