# Maintainer: joaolvcm <joaolvcm at gmail dot com>
# Submitter: peace4all <markspost at rocketmail dot com>
pkgname=unified-remote-server
pkgver=3.0.11.563
pkgrel=2
pkgdesc="Unified Remote Server"
arch=('i686' 'x86_64' 'armv6h')
url="http://www.unifiedremote.com/"
depends=('libxext' 'libx11')
license=('freeware')
install=$pkgname.install
source=("urserver-${pkgver}.deb::http://www.unifiedremote.com/downloads/server/linux-x86/563/urserver-3.0.11.563.deb")
md5sums=('7bd0b939738a5f940afd0314e18117c6')

if test "$CARCH" == x86_64; then
	source=("urserver-${pkgver}.deb::http://www.unifiedremote.com/downloads/server/linux-x64/563/urserver-3.0.11.563.deb")
	md5sums=('7bd0b939738a5f940afd0314e18117c6')
fi
if test "$CARCH" == armv6h; then
        source=("urserver-${pkgver}.deb::http://www.unifiedremote.com/downloads/server/linux-rpi/349/urserver-3.0.11.349.deb")
        md5sums=('c82e2935ae5a1b5872f4e02771c97535')
fi


package() {
	cd ${srcdir}

	# decompress data
	tar zxf data.tar.gz

	# fix and revert desktop file to old behaviour
	sed -i -e '9,24d;26d' $(find . -name 'urserver.desktop')

	# install folders
	mkdir -p ${pkgdir}/{opt,usr}
	cp -r {opt,usr} "${pkgdir}/"

	# clean up permissions
	find "${pkgdir}" -type d | xargs -I {} chmod -R 755 "{}"
	find "${pkgdir}" -type f | xargs -I {} chmod -R 644 "{}"
	chmod 755 "${pkgdir}/opt/urserver/urserver"
}

