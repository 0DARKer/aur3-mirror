# Contributor: Sharn <go__cart91@hotmail.com>

pkgname=wicd-bzr-experimental
pkgver=344
pkgrel=1
pkgdesc="Wired and wireless network manager which aims to provide a simple interface to connect to networks with a wide variety of settings. Experimental 1.6 branch - has wicd-curses cli ui"
arch=('i686' 'x86_64')
url="http://wicd.sourceforge.net/"
license=('GPL')
depends=('dbus-python' 'pygtk' 'dhclient' 'ethtool' 'wpa_supplicant' 'python-urwid')
makedepends=('bzr')
provides=('wicd')
conflicts=('wicd' 'wicd-svn' 'wicd-bzr')
replaces=('wicd' 'wicd-svn' 'wicd-bzr')
install=wicd.install
source=()
md5sums=()

_bzrtrunk=lp:wicd/1.6
_bzrmod=1.6

build() {
  cd ${srcdir}

  msg "Connecting to the server...."

  bzr branch ${_bzrtrunk} -q -r ${pkgver}

  msg "BZR checkout done or server timeout"
  msg "Starting make..."

  if [ -d ./${_bzrmod}-build ]; then
    rm -rf ./${_bzrmod}-build
  fi
  cp -r ./${_bzrmod} ./${_bzrmod}-build
  cd ./${_bzrmod}-build

  msg "Starting make..."

  install -d -m 755 $pkgdir/etc
  touch $pkgdir/etc/arch-release

  # Configure & install
  python setup.py configure || return 1
  #python setup.py get_translations
  python setup.py install --root ${startdir}/pkg/ || return 1


  # Add custom rc.d script
  cd ${startdir}
  install -D -m755 wicd-daemon pkg/etc/rc.d/wicd

  # Add missing directories and delete useless one
  rm -r ${startdir}/pkg/usr/share/autostart
  rm $pkgdir/etc/arch-release

}
