# Maintainer: Vinilox <vinilox@vinilox.eu>
# Contributor: Vinilox <vinilox@vinilox.eu>
pkgname=zsdx
pkgver=1.0
pkgrel=1
pkgdesc="A free Zelda fan game that looks like old Zelda games"
arch=('i686' 'x86_64')
url="http://www.zelda-solarus.com"
license=('GPL')
depends=('lua' 'sdl' 'sdl_image' 'sdl_ttf' 'physfs' 'openal' 'libsndfile')
makedepends=('cmake' 'gcc' 'zip')
conflicts=(zsdxdemo-en zsdxdemo-de zsdxdemo-fr)
replaces=(zsdxdemo-en zsdxdemo-de zsdxdemo-fr)
source=(http://www.zelda-solarus.com/downloads/zsdx/zsdx-1.0-src.tar.gz)
md5sums=('ba5eb89f7983c4d937741608cd51ec16')
 
build() {
  cd $srcdir/zsdx-1.0
  mkdir -p $pkgdir/usr/share/games/zsdx

  #mkdir -p $srcdir/zsdx-1.0/include/lua5.1
  #ln -s /usr/include/lua.hpp $srcdir/zsdx-1.0/include/lua5.1/lua.hpp
  #mkdir $srcdir/zsdx-1.0/libraries
  #ln -s /usr/lib/liblua.so.5.1 $srcdir/zsdx-1.0/libraries/liblua5.1.so
  
  #export LIBRARY_PATH="$srcdir/zsdx-1.0/libraries"
  cmake -D CMAKE_INSTALL_PREFIX=$srcdir/zsdx-1.0 .
  make || return 1
  make install

  cp $srcdir/zsdx-1.0/bin/zsdx $pkgdir/usr/share/games/zsdx

  mkdir -p $pkgdir/usr/bin
  echo "/usr/share/games/zsdx/zsdx -datapath=/usr/share/games/zsdx" > $pkgdir/usr/bin/zsdx
  chmod 755 $pkgdir/usr/bin/zsdx
}

