# Author: Martin Minka <martin dot minka at gmail dot com>
pkgname=xtbackup
pkgver=0.8.0
asdkver=1.6.2
pkgrel=1
pkgdesc="PHP backup script/library with special drivers for MySQL, Amazon RDS and Amazon S3."
arch=('any')
url="http://k2s.github.io/xtbackup/"
license=('UNLICENSE')
depends=('php' 'php-sqlite')
source=("https://github.com/k2s/xtbackup/archive/v${pkgver}.tar.gz" "https://github.com/amazonwebservices/aws-sdk-for-php/archive/${asdkver}.tar.gz")
md5sums=('e25164f2144c04ec2ba0e104a4943853'
         '50d7bb884e960aea0d27776a2ea9388d')
build() {
  cd "$srcdir/xtbackup-${pkgver}"
  cp -r "$srcdir/aws-sdk-for-php-${asdkver}/"* "$srcdir/xtbackup-${pkgver}/lib/AWSSDKforPHP/"
  rm -f xtbackup.iml
  rm -f .gitignore
  rm -f .gitmodules
  #rm -f lib/AWSSDKforPHP/.gitignore
}
package() {
  install -d "$pkgdir/usr/share/xtbackup/"
  cp -r "$srcdir/xtbackup-${pkgver}/"* "$pkgdir/usr/share/xtbackup/"
  chmod +x "$pkgdir/usr/share/xtbackup/xtbackup.sh"  
  install -d "$pkgdir/usr/bin/"
  ln -s "$pkgdir/usr/share/xtbackup/xtbackup.sh" "$pkgdir/usr/bin/xtbackup"
}
