# Maintainer: Jack L. Frost <fbt@fleshless.org>
pkgname=scron-git
pkgver=r95.4086be6
pkgrel=1
pkgdesc="Suckless cron daemon"
arch=( 'i686' 'x86_64' )
url="http://git.2f30.org/scron/"
license=( 'MIT/X' )
#groups=()
#depends=()
makedepends=( 'git' )
provides=( 'cron' )
conflicts=( 'cron' )
#replaces=()
backup=( 'etc/crontab' )
options=( 'strip' )
#install=
source=( 'git://git.2f30.org/scron' )
noextract=()
md5sums=('SKIP')

#_gitroot=GITURL
_gitname=scron

pkgver() {
  cd "$srcdir/$_gitname"
  printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

build() {
  cd "$srcdir"
  msg "Connecting to GIT server...."

  if [[ -d "$_gitname" ]]; then
    cd "$_gitname" && git pull origin
    msg "The local files are updated."
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting build..."

  rm -rf "$srcdir/$_gitname-build"
  git clone "$srcdir/$_gitname" "$srcdir/$_gitname-build"
  cd "$srcdir/$_gitname-build"

  #
  # BUILD HERE
  #
  make
}

package() {
  cd "$srcdir/$_gitname-build"
  make DESTDIR="$pkgdir/" install
}

# vim:set ts=2 sw=2 et:
