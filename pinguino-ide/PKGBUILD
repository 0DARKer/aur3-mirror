# Maintainer: Yeison Cardona <yeison.eng@gmail.com>

pkgname=pinguino-ide
_github_account=PinguinoIDE
pkgver=11.0
pkgrel=2
pkgdesc="Open source integrated development enviroment for Piguino boards"
arch=('x86_64')
url="http://www.pinguino.cc/"
license=('GPL')
groups=()
depends=('git' 'python2' 'python2-pyside' 'lib32-gcc-libs' 'lib32-zlib')
makedepends=()
optdepends=('gcc' 'sdcc' 'python2-pyserial' 'python2-pyusb')
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
changelog=

#source=(${pkgname}::git://github.com//pinguino-ide.git#branch=master) 
#source=(${pkgname}::git://github.com/YeisonEng/git-PKGBUILD-test.git#branch=master) 
_gitroot=git://github.com/${_github_account}/${pkgname}

noextract=()
md5sums=('SKIP')

package() {

  cd ${srcdir}
  # if exist ${pkgname} then pull else clone
  msg "Connecting to GIT server...."
  if [ -d ${pkgname} ] ; then
    cd ${pkgname}
    git checkout *
    git pull origin
    msg "The local files are updated."
  else
    git clone ${_gitroot} ${pkgname} --depth=1
  fi
  msg "GIT clone done or server timeout."

  
  cd ${startdir}
  # move clone/pull files
  install -m755 -d ${pkgdir}/opt/
  mv -v ${srcdir}/${pkgname} ${pkgdir}/opt/
  

  cd ${srcdir}
  # write .desktop
  rm -f pinguino_ide.desktop
  echo "[Desktop Entry]
Version=1.0
Type=Application
Name=Pinguino IDE 11.0
Comment=Open source integrated development enviroment for Piguino boards.
Icon=/opt/pinguino-ide/qtgui/resources/art/windowIcon.svg
Exec=python2 /opt/pinguino.py
Path=/opt/pinguino-ide
Terminal=false
StartupNotify=false
Categories=Debugger;Development;Electronics;Engineering" >> pinguino_ide.desktop

  # move .desktop
  install -m755 -d ${pkgdir}/usr/share/applications/
  mv -vf pinguino_ide.desktop ${pkgdir}/usr/share/applications/

}
