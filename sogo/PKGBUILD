# Maintainer:  Andre Wayand <aur-sogo@awayand.sleepmail.com>
pkgname=sogo
pkgver=2.0.0rc1
pkgrel=1
pkgdesc="groupware server built around OpenGroupware.org (OGo) and the SOPE application server"
arch=('any')
url="http://www.sogo.nu/"
license=('GPL')
depends=('sope=2.0.0rc1' 'gnustep-base>=1.23.0' 'gnustep-make' 'gcc-objc' 'libmemcached')
optdepends=(
	'postgresql: run database server for sogo locally'
	'mysql: run database server for sogo locally'
	'openldap: run directory server for sogo locally'
	'postfix: run smtp server for sogo locally'
	'dovecot: run imap server for sogo locally'
	'courier-imap: run imap server for sogo locally'
	'nginx: webserver to provide web interface locally'
	'apache: webserver to provide web interface locally'
	'funambol: sync mobile devices with sogo contacts, events, tasks via SyncML'
)
source=(
  http://www.sogo.nu/files/downloads/SOGo/Sources/SOGo-$pkgver.tar.gz
)
build() {
  cd "$srcdir/SOGo-${pkgver}"

  #thanks to kwirkie for the below fix!
  find . -type f -exec sed -i -e 's/sel_eq/sel_isEqual/g' {} +

  ./configure --prefix=$(gnustep-config --variable=GNUSTEP_SYSTEM_ROOT)
  make
}

check() {
  cd "$srcdir/SOGo-${pkgver}"
  echo "Nice."
}

package() {
  cd "$srcdir/SOGo-${pkgver}"
  make install DESTDIR="${pkgdir}"
}
md5sums=('ba4ae72512dfcb4670151ffadb25e7fc')
