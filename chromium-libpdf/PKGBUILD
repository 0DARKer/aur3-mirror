# Maintainer: Andrew Webley <unsuspectinghero@gmail.com>
# Contributor: Dmitriy Morozov <archlinux@foxcub.org>


pkgname=chromium-libpdf
#The pkgver is the same as for google chrome unstable, because this library isn't meant to be distributed on its own, and I cannot find any proper version information.
pkgver=26.0.1403.0
pkgrel=1
pkgdesc="PDF Viewer for Chromium"
url="http://wiki.archlinux.org/index.php/Chromium#libpdf.so"
arch=('i686' 'x86_64')
license=('custom')
depends=('chromium')
sha512sums=('363242302e499591283f4d55cd861b5a9bd44a3cfa1e7708fcab87b3d32babd3127796521cfc4340715f322d10c7154bfb8b03c0fc02343738fcc056627a6908')
if [ "$CARCH" = "i686" ]; then
	_arch="i386"
    sha512sums+=('40b87e94f2ae57bd28cac5db926970948b1909a667c5d32ecdbb780899f1880900efb867a98b614b86f2b094821ce088904390e88e3f1692cb2a035fa572b08a')
elif [ "$CARCH" = "x86_64" ]; then
	_arch="amd64"
	sha512sums+=('5c7effe53ca81a62fee11d69036e75c1ce06664e09209af4202c755acba5f9472c69ff11a1b02632607a802a45d4c98b40f9c04a2c144c0d8f56fa2b99eed7d9')
fi
source=(LICENSE
        "https://dl.google.com/linux/direct/google-chrome-unstable_current_${_arch}.deb"
)


build() {
	cd "$srcdir"
	#This extracts the .deb file to only get the relevant tarball, and then extracts that tarball to get the relevant library file.
	bsdtar xvf "google-chrome-unstable_current_${_arch}.deb" data.tar.lzma
	bsdtar xvf data.tar.lzma opt/google/chrome/libpdf.so
	#These lines install the library to the correct directory and with the correct permissions. If you're using iron, change "usr/lib/chromium/" to "/opt/iron".
	install -Dm755 opt/google/chrome/libpdf.so "${pkgdir}/usr/lib/chromium/libpdf.so"
	install -Dm755 LICENSE "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
