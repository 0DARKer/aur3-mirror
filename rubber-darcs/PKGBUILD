# Contributor: Thomas Dahms <thdahms@gmx.de>
pkgname=rubber-darcs
pkgver=20100224
pkgrel=1
pkgdesc="A wrapper for LaTeX and friends, latest darcs version"
arch=('i686' 'x86_64')
url="http://iml.univ-mrs.fr/~beffara/soft/rubber"
license=('GPL')
provides=('rubber')
depends=('python' 'texlive-core')
makedepends=('darcs' 'texinfo')
conflicts=('rubber')

_darcstrunk="http://iml.univ-mrs.fr/~beffara/darcs"
_darcsmod="rubber"

build() {
  cd $startdir/src

  msg "Checking for previous build"
  # get the sources
  if [[ -d $startdir/src/$_darcsmod/_darcs ]]
  then
    msg "Retrieving missing patches"
    cd $_darcsmod
    darcs pull -a $_darcstrunk/$_darcsmod
  else
    msg "Retrieving complete sources"
    darcs get --set-scripts-executable $_darcstrunk/$_darcsmod
  fi

  msg "Starting build"
  cd $startdir/src/$_darcsmod

  ./configure --prefix=/usr
  make || return 1
  make prefix=$startdir/pkg/usr install

}
