# Maintainer: Ignacio Losiggio <naquo@geneu.co.cc>
pkgname=synapse-bzr
pkgver=402
pkgrel=1
pkgdesc="Synaptic file launcher"
arch=(i686 x86_64)
url="http://launchpad.net/synapse-project"
license=('GPL')
depends=('dbus' 'dbus-glib' 'glibc' 'gtkhotkey' 'json-glib' 'libgee' 'libunique' 'libzeitgeist' 'zeitgeist' 'vala-git')
makedepends=('bzr' 'gnome-common' vala-git)
optdepends=('rythmbox: Rythmbox support' 'SSH: SSH support' 'Banshee: Banshee support' 'Pastebinit: pastebin support' 'bc: calculator support')
source=()
md5sums=()
conflicts=('synapse')
provides=('synapse')
_bzrmod="synapse-project"
_bzrtrunk="lp:${_bzrmod}"
build() {

  cd "$srcdir"

  msg "Connecting to Bazaar server...."

  if [ -d $_bzrmod ] ; then
    cd ${_bzrmod} && bzr pull -r ${pkgver}
    msg "The local files are updated."
  else
    bzr branch ${_bzrtrunk} -r ${pkgver}
  fi

  msg "Bazaar checkout done or server timeout"
  msg "Starting make..."

  rm -rf "$srcdir/$_bzrmod-build"
  cp -r "$srcdir/$_bzrmod" "$srcdir/$_bzrmod-build"
  cd "$srcdir/$_bzrmod-build"

  ./autogen.sh --prefix=/usr
  make
}

package() {

cd "$srcdir/$_bzrmod-build"
	make DESTDIR="$pkgdir/" install

}
