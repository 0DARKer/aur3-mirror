# Maintainer: danilo <gezuru *at* gmail *dot* com>
pkgname=pivote-bin
pkgver=1.0.9.0
pkgrel=1
pkgdesc='E-voting tool of the Swiss Pirate Party (binary)'
arch=(i686 x86_64)
url='http://dev.piratenpartei.ch/projects/pi-vote'
license=('BSD')
depends=('mono')
source=("http://projects.piratenpartei.ch/attachments/download/200/PiVote_Client_Linux_x86_${pkgver}.zip"
        'gmp-config.patch')
md5sums=('8572b9cd5e1179f1a2f9f7aa6eb18c88'
         'b88fba24f61b74b51a52a8a27203ac95')


build() {
   # Fix path to libgmp.so
   patch Emil.GMP.dll.config gmp-config.patch  || return 1
}

package() {
    # Create directories
    mkdir -p "${pkgdir}/usr/bin"
    mkdir -p "${pkgdir}/usr/share/${pkgname}"
    mkdir -p "${pkgdir}/usr/share/applications"

    # Change file permissions
    chmod -R a-x *

    # Copy files
    cp -R de-DE fr-FR *.dll *.config *.cfg *.pi-cert Pirate.PiVote.Client.exe "${pkgdir}/usr/share/${pkgname}/"
    install -D -m644 *.desktop "${pkgdir}/usr/share/applications/"
    install -D -m644 License.txt "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"

    # Create startscript
    echo -e "#!/bin/bash\nmono /usr/share/${pkgname}/Pirate.PiVote.Client.exe" > "${pkgdir}/usr/bin/pivote"
    chmod +x "${pkgdir}/usr/bin/pivote"
}
