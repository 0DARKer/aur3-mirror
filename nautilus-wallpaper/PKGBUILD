# Maintainer: Alessandro Nakamuta <alessandro dot nakamuta at archlinux dot com dot br>
# Contributor: Hyperair <hyperair@gmail.com>
# Contributor: 3ED <kas1987@o2.pl>

arch=('i686' 'x86_64')
license=('GPL')
pkgname=nautilus-wallpaper
pkgver=0.1
pkgrel=4
pkgdesc="A Nautilus extension that adds the ability to set your desktop wallpaper from the context menu"
url="http://www.gnome.org/"
depends=('nautilus')
makedepends=('intltool')
source=(nautilus-wallpaper-0.1.tar.gz
	01_add_gconf-2.0_pkgconfig.patch
	02_move_to_extensions-2.0.patch)
md5sums=('e47350626509c85dd9339d0b98900dd6'
	 'c7088d16a747d1ea00fc2187e067e9f9'
	 'bbe78199dbb33e74ea9d0c99dda41ec7')
options=('!libtool')

build() {
  cd "$srcdir/$pkgname-$pkgver"

  # begin patching
  msg "Applying patch 01_add_gconf-2.0_pkgconfig.patch"
  patch -Np1 -i "$srcdir/01_add_gconf-2.0_pkgconfig.patch"
  msg "Applying patch 02_move_to_extensions-2.0.patch"
  patch -Np1 -i "$srcdir/02_move_to_extensions-2.0.patch"
  # end patching

  ./configure --prefix=/usr
  make || return 1
  make DESTDIR="$pkgdir" install

  msg "Tidying up"
  mv "$pkgdir/usr/lib/nautilus/extensions-2.0/libnautilus-wallpaper.so"{.0.0.0,}
  rm "$pkgdir/usr/lib/nautilus/extensions-2.0/libnautilus-wallpaper."{a,so.*}
}
