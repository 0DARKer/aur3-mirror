# Contributor: Larry Hajali <larryhaja [at] gmail [dot] com>

pkgname=sslsniff
pkgver=0.7
pkgrel=1
pkgdesc="sslsniff is designed to MITM all SSL connections on a LAN and dynamically generates certs for the domains that are being accessed on the fly."
arch=('i686' 'x86_64')
url="http://www.thoughtcrime.org/software/sslsniff/"
license=('custom')
depends=('boost' 'log4cpp' 'dsniff')
source=(http://www.thoughtcrime.org/software/${pkgname}/${pkgname}-${pkgver}.tar.gz)
md5sums=('54e57a56b45c725296c651b1bf39a641')

build()
{
  cd $pkgname-$pkgver

  # Fix boost_thread LDFLAG
  sed -i 's|boost_thread|boost_thread-mt|' Makefile.*

  ./configure --prefix=/usr
  make || return 1
  make install DESTDIR="${pkgdir}"

  # Package some example material.
  install -d -m 0755 "${pkgdir}"/usr/share/${pkgname}/{updates,certs}
  install -m 0644 leafcert.pem IPSCACLASEA1.crt "${pkgdir}"/usr/share/$pkgname
  install -m 0644 updates/*xml "${pkgdir}"/usr/share/$pkgname/updates
  install -m 0644 certs/* "${pkgdir}"/usr/share/$pkgname/certs

  # Install license.
  install -D -m 0644 COPYING "${pkgdir}"/usr/share/licenses/$pkgname/LICENSE
}
