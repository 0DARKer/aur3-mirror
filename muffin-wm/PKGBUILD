# Maintainer: Adam Hani Schakaki <adam@schakaki.net>

pkgname=muffin-wm
pkgver=1.0.2
pkgrel=1
pkgdesc="A window manager for GNOME"
arch=('i686' 'x86_64')
url="http://cinnamon.linuxmint.com/"
license=('GPL')
depends=('clutter' 'gconf' 'gobject-introspection' 'libcanberra' 'startup-notification' 'zenity' 'libxxf86vm')
makedepends=('git' 'intltool' 'gnome-doc-utils')
conflicts=('muffin-git')
options=('!libtool' '!emptydirs')
install=${pkgname}.install

build() {
  cd ${srcdir}
  wget -O muffin.tar.gz https://github.com/linuxmint/muffin/tarball/$pkgver
  tar xvf muffin.tar.gz
  cd linuxmint*
  CFLAGS="${CFLAGS} -Wno-deprecated-declarations"
  autoreconf -vfi
  ./configure --prefix=/usr --sysconfdir=/etc --libexecdir=/usr/lib/muffin --localstatedir=/var --disable-static
  make ${MAKEFLAGS}
}

package() {
  cd ${srcdir}
  cd linuxmint*
  make GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1 DESTDIR="${pkgdir}" install

  install -dm755 "${pkgdir}/usr/share/gconf/schemas"
  gconf-merge-schema "${pkgdir}/usr/share/gconf/schemas/${pkgname%-*}.schemas" --domain muffin "${pkgdir}"/etc/gconf/schemas/*.schemas
  rm -v "${pkgdir}"/etc/gconf/schemas/*.schemas
}

