# Maintainer: Pierre-Henri Quelen <pierrehenri.quelen@gmail.com>
pkgname=zygrib
_upname=zyGrib # upstream, case-sensitive project name
pkgver=3.9.9.1
pkgrel=1
pkgdesc="Weather data visualization, GRIB file viewer"
arch=('i686' 'x86_64')
url="http://www.zygrib.org/"
license=('GPL3')
depends=('qt>=4.5' 'bzip2' 'zlib>=1.2.3' 'proj>=4.6.0' 'qwt')
optdepends=('zygrib-maps: gshhs high-resolution maps from zygrib.org')
source=($_upname-$pkgver.tgz::http://www.zygrib.org/getfile.php?file=$_upname-$pkgver.tgz \
		zygrib.patch
        zygrib.sh zygrib.desktop
        zygrib.png) # creative commons licence

md5sums=('a2f129c1605e7f5a32c8f9b8beb5d856'
         'ad444b227a6a06f02578eca92668c438'
         '2fb3d2b4013d676591a31c13f88e44bf'
         'c5b5f1af03375d4512c51e29656c4f31'
         '522f9a9d71d16a76da48f601ba88fa49')

build() {
  cd "$srcdir/$_upname-$pkgver"
  
  patch -p1 -i $srcdir/zygrib.patch
  
  cd src
  qmake zyGrib.pro
  make || return 1
  cd ..

  install -d -m 755 $pkgdir/opt/$pkgname/{bin,img,tr,grib,maps/{gis,gshhs}}
  install -d -m 755 $pkgdir/usr/{bin,share/{applications,pixmaps}}
  install -D -m 755 $srcdir/zygrib.sh $pkgdir/usr/bin/zygrib
  install -D -m 644 $srcdir/zygrib.desktop $pkgdir/usr/share/applications
  install -D -m 644 $srcdir/zygrib.png $pkgdir/usr/share/pixmaps
  install -D -m 755 $srcdir/$_upname-$pkgver/src/$_upname $pkgdir/opt/$pkgname/bin
  install -D -m 755 $srcdir/$_upname-$pkgver/img/* $pkgdir/opt/$pkgname/img
  install -D -m 755 $srcdir/$_upname-$pkgver/tr/* $pkgdir/opt/$pkgname/tr
  install -D -m 755 $srcdir/$_upname-$pkgver/maps/gis/* $pkgdir/opt/$pkgname/maps/gis
  install -D -m 755 $srcdir/$_upname-$pkgver/maps/gshhs/* $pkgdir/opt/$pkgname/maps/gshhs
}
