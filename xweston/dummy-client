#!/bin/sh

# dummy-client - Weston shell client that does nothing
# but send a signal to Xweston when Weston is ready

# Workaround for long startup delay
if [ ! -f "$XDG_RUNTIME_DIR/dummy-client.lock" ]; then
	touch "$XDG_RUNTIME_DIR/dummy-client.lock"

	# Deliberately force Weston to respawn us once, eliminating the delay
	exit 1
else
	# Signal Xweston that Weston is ready for connections
	read xweston_pid < "$XDG_RUNTIME_DIR/Xweston.pid"
	kill -USR2 $xweston_pid
fi

# Prevent respawns
exec sleep infinity
