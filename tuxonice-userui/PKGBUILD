# Contributor: breakdown breakdown.at.archlinux.dot.us

pkgname=tuxonice-userui
pkgver=1.0
pkgrel=6
pkgdesc="TuxOnIce userspace user interface"
url="http://www.tuxonice.net/"
license=("GPL")
install=tuxonice-userui.install
arch=('i686' 'x86_64')
depends=('bash' 'libmng' 'libpng' 'libjpeg' 'lcms' 'freetype2>=2.3.9-2')
makedepends=()
options=('!makeflags')
source=(http://www.tuxonice.net/files/$pkgname-$pkgver.tar.gz \
        userui-install userui-hook pm-utils-hook
        Makefile.diff Tuxonice.diff )
md5sums=('37df358323076fc4882a6287087aaad6'
         '8ae3a4cb1ba3fdfd40d58c9c82ade009'
         'f514798d9ac1c851d08554f1e7c82335'
         '2f20475979c45787120f7f0b0270a523'
         '19dd01f3175ef4998ddaf8eb2d94443e'
         '72bf7a371c46224bc52c42feb6909c49')


build() {
  cd $startdir/src/$pkgname-$pkgver
  patch -p0 < ../Makefile.diff || return 1
  patch -p0 < ../Tuxonice.diff || return 1

  make all || return 1
}

package () {
  cd $startdir/src/$pkgname-$pkgver

  install -D -m644 $startdir/src/userui-install $startdir/pkg/lib/initcpio/install/userui
  install -D -m644 $startdir/src/userui-hook $startdir/pkg/lib/initcpio/hooks/userui
  install -D -m755 $startdir/src/pm-utils-hook $pkgdir/etc/pm/sleep.d/80tuxonice-userui
  make DESTDIR=$startdir/pkg PREFIX=/usr install || return 1
}
