#Contributor: scj <scj archlinux us>
#Maintainer: jorge_barroso <jorge.barroso.11@gmail.com
pkgname=4th
pkgver=3.62.0
pkgrel=1
pkgdesc="A Forth Compiler"
arch=('i686' 'x86_64')
url="http://www.xs4all.nl/~thebeez/4tH/index.html"
license=('LGPL')
depends=('glibc')
install=
if [ "$CARCH" = "x86_64" ]; then
source=("https://4th.googlecode.com/files/${pkgname}-${pkgver}-x86_64.tar.gz"
	'Makefile.patch')
sha512sums=('e9a5824d937cc72511ca7ee49c39adefed261865231e47797dac7f49f1a3c1b3476882a76121765b1f5f4936cc3693e8eae2f3d0df6aa48aae9f761abfacdc9f'
            '684b93ca0b39f0f64dd51d65dd6afc9072c274fee141c0fd603be90fadfc1adea17d115357897e04eae2139cbe3b34521849ec119572ab23d80fed232c45c2ec')
else
source=("https://4th.googlecode.com/files/${pkgname}-${pkgver}-i586.tar.gz"
	'Makefile.patch')
sha512sums=('80dbe8f3c54baa9150226b7f555e37c0183695dec77adb562262bbad10572f60966b47f5c5db133184a00052a42aed48363a00be7f1ed6bf7d891e619e7eff30'
            '684b93ca0b39f0f64dd51d65dd6afc9072c274fee141c0fd603be90fadfc1adea17d115357897e04eae2139cbe3b34521849ec119572ab23d80fed232c45c2ec')
fi

build() {
  cd "${srcdir}/${pkgname}-${pkgver}-unix/sources"
  patch -uNi ${srcdir}/Makefile.patch
  if [ "$CARCH" == "x86_64" ]; then
    cp include/* . ; make clean
  fi
  make
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}-unix/sources"
  install -d ${pkgdir}/usr/{share/{doc,man}/4th,{lib,bin}}
  make BINARIES=${pkgdir}/usr/bin \
       LIBRARIES=${pkgdir}/usr/lib \
       DOCDIR=${pkgdir}/usr/share/doc \
       MANDIR=${pkgdir}/usr/share/man install
}