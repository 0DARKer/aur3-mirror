# Contributor: Christoph Neuroth <christoph.neuroth@gmx.net>
# Contributor: Chris Brannon <cmbrannon79@gmail.com>
pkgname=mmixware
pkgver=20090321
pkgrel=1
pkgdesc="A straightforward MMIX assembler and simulator"
arch=('i686' 'x86_64')
url="http://www-cs-faculty.stanford.edu/~knuth/mmixware.html"
# The license was taken from src/boilerplate.w.
license=('custom')
makedepends=(texlive-bin)
source=("http://www-cs-staff.stanford.edu/%7Eknuth/programs/mmix-$pkgver.tar.gz"
        COPYRIGHT)
noextract=("mmix-$pkgver.tar.gz")
md5sums=('f92efe7cb134b62fc83dae6abd5b6fd7'
         'a2e1fc2dde9b3e6a09f21e1ad65e227f')

build() {
  cd "$srcdir"
  rm -rf "mmix-$pkgver"
  mkdir "mmix-$pkgver"
  cd "mmix-$pkgver"
  tar -xzf "../mmix-$pkgver.tar.gz"
  install -m755 -d "$pkgdir/usr/src/$pkgname"
  install -m644 * "$pkgdir/usr/src/$pkgname"
  install -D -m644 ../COPYRIGHT "$pkgdir/usr/share/licenses/$pkgname/COPYRIGHT"
  unset MAKEFLAGS
  make all || return 1
  install -m755 -d "$pkgdir/usr/bin/" || return 1
  install -m755 abstime mmix mmixal mmmix mmotype "$pkgdir/usr/bin/" || return 1
}

# So why did I (CMB)  decide to install sources to /usr/src/mmixware?
# If you're installing mmixware, you're probably a CS student of some
# sort, regardless of whether or not you are presently pursuing a degree.
# Reading sources is part of the learning process.
# What good is open-source if you have to jump through hoops to
# grab the code?
# Second, Dr. Knuth uses a literate programming environment called CWEB.
# The source is the documentation.
