# Maintainer: archtux <antonio dot arias99999 at gmail dot com>

pkgname=gmediafinder-git
pkgver=20120801
pkgrel=1
pkgdesc="Application to stream or download videos and music from various YouTube-like sites without having flash installed."
arch=('any')
url="http://gnomefiles.org/content/show.php/Gmediafinder?content=138588"
license=('GPL2')
depends=('gnome-icon-theme' 'gstreamer0.10-ffmpeg' 'gstreamer0.10-python' 'libvisual-plugins' 'pygtk' 'python2-beautifulsoup>3.2'
         'python-configobj' 'python2-distutils-extra' 'python-gdata' 'python2-html5lib' 'python-mechanize' 'python2-virtkey' 'python-xlib')
makedepends=('git' 'python2-distribute')
install='gmediafinder.install'

_gitroot=https://github.com/smolleyes/gmediafinder.git
_gitname=gmediafinder


build() {
   cd $srcdir

   msg "Connecting to GIT server...."

   if [ -d $srcdir/$_gitname ] ; then
     cd $_gitname && git pull --rebase
   else
     git clone $_gitroot
   fi

   msg "GIT checkout done or server timeout"
   msg "Starting installation..."

   cd $srcdir/$_gitname

   # Python2 fix
   sed -i 's_#!/usr/bin/env python_#!/usr/bin/env python2_' setup.py
   cd ./GmediaFinder
   sed -i 's_#!/usr/bin/env python_#!/usr/bin/env python2_' gmediafinder.py

   # Install
   cd ..
   python2 setup.py install --root=$pkgdir --optimize=1
}