# Maintainer: Sabart Otto - Seberm <seberm[at]gmail[dot].com

pkgname=salarm-git
pkgver=20101117
pkgrel=1
pkgdesc="sAlarm is a scheduler written in C++, with General public license version 3 used."
url="http://www.seberm.homelinux.org/project/salarm.php"
arch=('i686' 'x86_64')
license=('GPLv3')
install=
source=()
depends=('qt')
makedepends=('git')

_gitname="salarm"
_gitroot="git://git.gitorious.org/$_gitname/${_gitname}.git"


build() {

  cd ${srcdir}
  msg "Connecting to GIT ($_gitroot) ..."

  if [ -d $_gitname ]; then
    cd $_gitname && git pull origin
    msg "The local files of $_gitname were updated."
  else
    git clone $_gitroot $_gitname
  fi
  
  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  # Build 
  cd $srcdir/
  rm -rf build
  mkdir build
  cd build
  
 # Creates translation resources
  lrelease ../$_gitname/src/${_gitname}.pro

  # Generates Makefile
  qmake "INSTALL_PREFIX=${pkgdir}/usr" ../$_gitname/src/${_gitname}.pro

  make || return 1
  make DESTDIR=${pkgdir} install || return 1 # Else return 1 - build failed
}


#package() {
#
#  cd $srcdir/
#  install -D -m755 build/build/bin/salarm $pkgdir/usr/bin/salarm
#  install -d -m755 $pkgdir/usr/share/salarm/
#  install -m644 $_gitname/README $pkgdir/usr/share/salarm/
#
#  # Install the license file
#  install -D -m644 $srcdir/$_gitname/LICENSE $pkgdir/usr/share/licenses/$_gitname/LICENSE
#
#  # Install the icon file
#  install -D -m664 $srcdir/$_gitname/salarm.desktop $pkgdir/$HOME/Desktop/salarm.desktop
#}