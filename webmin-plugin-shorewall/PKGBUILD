# Contributor: vbPadre <vbpadre at gmail dot com>
pkgname=webmin-plugin-shorewall
pkgver=1.53
pkgrel=1
pkgdesc="Shorewall firewall plugin for webmin"
url="http://www.webmin.com/standard.html"
license=('gpl')
arch=('i686' 'x86_64')
depends=('webmin')
install=webmin-plugin-shorewall.install
source=(http://download.webmin.com/download/modules/shorewall.wbm.gz)
md5sums=('52dcf991e96e7c45a6647d0df52234ff')

build() {
    cd ${srcdir} || return 1
    mkdir -p ${pkgdir}/opt/webmin
    mkdir -p ${pkgdir}/etc/webmin/shorewall
    cp -rf ${srcdir}/shorewall/ ${pkgdir}/opt/webmin
    touch ${pkgdir}/etc/webmin/shorewall/config
    touch ${pkgdir}/etc/webmin/shorewall/version
    echo "config_dir=/etc/shorewall" >> ${pkgdir}/etc/webmin/shorewall/config
    echo "shorewall=shorewall" >> ${pkgdir}/etc/webmin/shorewall/config
    echo "actions=/etc/shorewall/actions	/usr/share/shorewall/actions.std" >> ${pkgdir}/etc/webmin/shorewall/config
    echo "macros=/usr/share/shorewall" >> ${pkgdir}/etc/webmin/shorewall/config
    echo "display_zone_descriptions=1" >> ${pkgdir}/etc/webmin/shorewall/config

    # Fix path to perl in cgi scripts by celilo
    sed -e 's|#!/usr/local/bin/perl|#!/usr/bin/perl|g' -i $pkgdir/opt/webmin/shorewall/*.cgi

}

