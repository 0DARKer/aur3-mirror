# Maintainer: Daniel Stengel <dstengel@gmx.net>
# Contributor: Daniel Stengel <dstengel@gmx.net>
# Contributor: Nicolas Qui√©not <niQo @ aur>

pkgname=airfoilspeakers
pkgver=2.7.0
pkgrel=1
pkgdesc="Airfoil Speakers for Linux runs on any version of Linux with Mono 1.2.6 or higher, enabling Airfoil to send any audio to it. Airfoil Speakers for Linux works exclusively with Airfoil for Mac and Airfoil for Windows."
url="http://www.rogueamoeba.com/airfoil/"
arch=('i686' 'x86_64')
license=('custom')
depends=('mono' 'avahi' 'mono-zeroconf' 'alsa-utils' 'alsa-lib')
[ "$CARCH" = "x86_64" ] && depends=('mono' 'avahi' 'mono-zeroconf' 'alsa-utils' 'lib32-alsa-lib')

source=(http://rogueamoeba.com/airfoil/download/AirfoilSpeakersLinux.tgz http://kevin.colyar.net/wp-content/uploads/2009/12/Airfoil-DLLs.zip)

build() {
  cd ${srcdir}/${pkgname}_${pkgver}-${pkgrel}
  mkdir -p ${pkgdir}/usr/{bin,lib,share}
  
  cp bin/* ${pkgdir}/usr/bin/
  cp -R lib/* ${pkgdir}/usr/lib/
  cp -R share/* ${pkgdir}/usr/share/

  # Change PREFIX to fit Archlinux
  cp run_airfoilspeakers tmp_run_airfoilspeakers
  sed 's:PREFIX=./:PREFIX=/usr/:g' tmp_run_airfoilspeakers > ${pkgdir}/usr/bin/airfoilspeakers
  #chown root:root ${pkgdir}/usr/bin/airfoilspeakers
  chmod 755 ${pkgdir}/usr/bin/airfoilspeakers
  rm tmp_run_airfoilspeakers

  ## DLLs fix
  ## see http://kevin.colyar.net/2009/12/fixing-airfoil-speakers-for-ubuntu/
  cd ${srcdir}/Airfoil\ DLLs/
  cp *.dll ${pkgdir}/usr/lib/airfoilspeakers/

}

md5sums=('f7c02e93d62a80333ba0bf462cf512b9'
         '74267324cbf277609df1a403dd3f4f77')
