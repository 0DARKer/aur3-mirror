_name=minetest
name=${_name}
pkgname=${_name}-hg
pkgver=252
pkgrel=1
pkgdesc="An Infiniminer/Minecraft inspired game."
arch=('i686' 'x86_64')
url="https://bitbucket.org/celeron55"
license=('GPL')
makedepends=('mercurial' 'cmake' 'irrlicht' 'libx11' 'mesa' 'libjpeg' 'bzip2' 'libpng' 'zlib')
depends=('libx11' 'libjpeg' 'bzip2' 'libpng' 'zlib')
md5sums=() #generate with 'makepkg -g'

_hgrepo="$_name"
_hgroot=$url


build() {
	cd $srcdir
	msg "Connecting to hg server..."
	if [[ -d "$_hgrepo/.hg" ]]; then
		msg "pull"
		( cd $_hgrepo && hg pull -u )
	else
		msg "clone"
		hg clone "${_hgroot}/${_hgrepo}"
	fi
	cd "${_hgrepo}"
	cmake . "-DCMAKE_INSTALL_PREFIX=$pkgdir/"
	make
	make install
}
