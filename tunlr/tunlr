#!/bin/bash
# tunlr - start and stop tunlr
# see <http://tunlr.net/> for more information

if [ $UID != 0 ]; then
	echo "you must be root to start or stop tunlr"
	exit 1	
fi

case "$1" in
	start)
		echo "starting tunlr"
		cp /etc/resolv.conf /etc/resolv.conf.bak
		echo 'nameserver 149.154.158.186' > /etc/resolv.conf
		echo 'nameserver 199.167.30.144' >> /etc/resolv.conf
		cat /etc/resolv.conf.bak >> /etc/resolv.conf
		echo "restart your web browser to apply the changes"
			;;
	stop)
		echo "stopping tunlr"
		if [ ! -f /etc/resolv.conf.bak ]; then
			echo "/etc/resolv.conf.bak does not exsist. unable to restore DNS config"
			exit 1
		fi
		cp /etc/resolv.conf.bak /etc/resolv.conf
		echo "restart your web browser to apply the changes"
		;;
	*)
		echo "usage: $0 {start|stop}"
		;; 
esac

exit 0
