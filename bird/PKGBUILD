pkgname=bird
pkgver=1.3.3
pkgrel=1
pkgdesc="a dynamic routing daemon for UNIX-like systems"
arch=(i686 x86_64)
license=('GPL')
depends=('readline')
makedepends=('perl' 'bison' 'flex')
options=()
url="http://bird.network.cz/"
source=(ftp://bird.network.cz/pub/bird/${pkgname}-${pkgver}.tar.gz)
md5sums=('d463c2ec9478cbadbcb2d3a3c0cc40d5')

backup=('etc/bird.conf' 'etc/bird6.conf')

build() {
  cd "${srcdir}"
  cp -a ${pkgname}-${pkgver} ${pkgname}-${pkgver}-ipv4
  cp -a ${pkgname}-${pkgver} ${pkgname}-${pkgver}-ipv6

  cd "${srcdir}/${pkgname}-${pkgver}-ipv4"
  ./configure --sysconfdir=/etc --prefix=/usr --localstatedir=/var || return 1
  make || return 1

  cd "${srcdir}/${pkgname}-${pkgver}-ipv6"
  ./configure --sysconfdir=/etc --prefix=/usr --localstatedir=/var --enable-ipv6 || return 1
  make || return 1
}

package () {
  cd "${srcdir}/${pkgname}-${pkgver}-ipv4"
  make sysconfdir=${pkgdir}/etc prefix=${pkgdir}/usr localstatedir=${pkgdir}/var install || return 1
  make docdir=${pkgdir}/usr/share/doc/${pkgname}-${pkgver} install-docs || return 1

  cd "${srcdir}/${pkgname}-${pkgver}-ipv6"
  make sysconfdir=${pkgdir}/etc prefix=${pkgdir}/usr localstatedir=${pkgdir}/var install || return 1
}
