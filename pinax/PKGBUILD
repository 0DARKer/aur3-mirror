# Maintainer: Sergio A. Morales <sergiomorales@archlinux.cl>
# Contributor: Daniel Apolinario <dapolinario@gmail.com>
pkgname=pinax
pkgver=0.7.3
pkgrel=2
pkgdesc="Pinax is an open-source platform built on the Django Web Framework."
arch=('i686' 'x86_64')
url="http://pinaxproject.com/"
license=('MIT')
depends=('python2' 'python-imaging')
source=("http://downloads.pinaxproject.com/Pinax-${pkgver}-bundle.tar.gz")
md5sums=("feba750fb35eab5f0828a82f70b6b9a5")
makedepends=("perl")
install=('pinax.install')
build() {
  cd ${startdir}/src/Pinax-${pkgver}-bundle
  python2 scripts/pinax-boot.py ${pkgdir}/opt/pinax-env
  perl -pi -e "s:^VIRTUAL_ENV.*:VIRTUAL_ENV=\"/opt/pinax-env\":" ${pkgdir}/opt/pinax-env/bin/activate
  find ${pkgdir} -type f  -name "*.pyc" -exec rm -f {} \;
  for i in $(grep -r ${pkgdir} ${pkgdir} | cut -d ":" -f1)
  do
   perl -pi -e "s:${pkgdir}::" $i
  done	
}