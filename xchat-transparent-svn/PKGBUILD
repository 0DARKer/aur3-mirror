# Maintainer: Skyalmian (see Arch Linux Forum profile for e-mail)
# Designer: Erik Xian (of "xchat-transparent")
# Designer: r4 (of "xchat-svn")
# This package is simply a slight merging of the aforementioned and is therefore not mine.

basename=xchat
pkgname=${basename}-transparent-svn
pkgver=1479
pkgrel=1
pkgdesc="A mature GTK+ IRC client, SVN build with inserted true transparency patches."
arch=("i686" "x86_64")
url="http://www.${basename}.org/"
license=("GPL")
depends=("gtk2>=2.10.9" "dbus-glib>=0.7.2" "openssl")
makedepends=("svn" "autoconf" "automake")
optdepends=("enchant: for spell checking support" "tcl: for tcl plugin" \
            "python: for python plugin")
options=("!libtool")
conflicts=("${basename}" "${basename}-transparent" "${basename}-cvs" "${basename}-svn")
source=(xchat-alpha.patch)
md5sums=('dca92d94695c0c3145cccf49a6859c84')

_svntrunk=https://xchat.svn.sourceforge.net/svnroot/xchat/
_svnmod=src

build() {
    cd $startdir/

    if [ -d $_svnmod/.svn ]; then
        (cd $_svnmod && svn up)
    else
        svn co $_svntrunk $_svnmod
    fi

    msg "SVN checkout done or server timeout."

    cd $srcdir
    patch -d ${srcdir}/${_pkgname}/src/fe-gtk/ <xchat-alpha.patch || return 1
    ./autogen.sh || return 1
    touch configure
    ./configure --prefix=/usr --sysconfdir=/etc \
                --enable-openssl --enable-dbus \
                --disable-gnome --disable-textfe \
            --disable-ipv6 --enable-shm \
            --enable-spell=static || return 1
    make || return 1
    make DESTDIR=${pkgdir} install || return 1
}
