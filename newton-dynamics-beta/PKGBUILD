# Maintainer: Sven-Hendrik Haase <sh@lutzhaase.com>
# Contributor: Team Pantheon <maintainer@team-pantheon.de> 

pkgname=newton-dynamics-beta
pkgver=2.17
pkgrel=1
pkgdesc="beta version of the Newton Game Dynamics physics library"
arch=('i686' 'x86_64')
url="http://www.newtondynamics.com"
license=('custom')
depends=('gcc>=4.1' 'glew')
optdepends=('glui: to build samples')
conflicts=('newton-dynamics')
source=(http://www.newtondynamics.com/downloads/NewtonLinux-32-${pkgver}.tar.gz) 
md5sums=('fee11949554512cb7c7b21a63628d997')
if [ "$CARCH" = "x86_64" ]; then
  source=(http://www.newtondynamics.com/downloads/NewtonLinux-64-${pkgver}.tar.gz)
  md5sums=('bcc80c98bc26a0d5cf8d6f671a5d1832')
fi

build() {
  install -Dm644 ${srcdir}/newtonSDK/sdk/Newton.h ${pkgdir}/usr/include/Newton.h
  # Maybe at some point using the following makes sense:
  #install -Dm 644 ${srcdir}/newtonSDK/sdk/dAnimation/* ${pkgdir}/usr/include/newtonSDK/dAnimation/
  #install -Dm 644 ${srcdir}/newtonSDK/sdk/dContainers/* ${pkgdir}/usr/include/newtonSDK/dContainers/
  #install -Dm 644 ${srcdir}/newtonSDK/sdk/dCustomJoints/* ${pkgdir}/usr/include/newtonSDK/dCustomJoints/
  #install -Dm 644 ${srcdir}/newtonSDK/sdk/dMath/* ${pkgdir}/usr/include/newtonSDK/dMath/

  _libver=`echo ${pkgver/./}|sed 's/[[:digit:]]/.&/g'`

  install -Dm644 ${srcdir}/newtonSDK/sdk/libNewton.a ${pkgdir}/usr/lib/libNewton.a
  install -Dm755 ${srcdir}/newtonSDK/sdk/libNewton.so ${pkgdir}/usr/lib/libNewton.so${_libver}

  ln -s libNewton.so${_libver} ${pkgdir}/usr/lib/libNewton.so.2
  ln -s libNewton.so${_libver} ${pkgdir}/usr/lib/libNewton.so

  install -Dm644 ${srcdir}/newtonSDK/doc/license.txt ${pkgdir}/usr/share/licenses/newtonSDK/LICENSE

  mkdir -p ${pkgdir}/usr/share/doc/newtonSDK/
  install -Dm644 ${srcdir}/newtonSDK/doc/* ${pkgdir}/usr/share/doc/newtonSDK/
}
