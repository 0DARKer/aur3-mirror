# Contributor: post <postwannabe@gmail.com>
pkgname='polipo-darcs'
pkgver='darcs'
pkgrel=2
pkgdesc='A small and fast HTTP proxy (can be used with Tor)'
arch=('i686' 'x86_64')
url='http://www.pps.jussieu.fr/~jch/software/polipo/'
license=('MIT')
makedepends=('darcs' 'texinfo')
depends=('sudo')
conflicts=('polipo')
install='polipo.install'
source=('polipo' 'config' 'polipo.rc')
md5sums=('154e4f1cd5ce544526436f9489484527' 'bc95d2344710a53a930ee8a2993b6b21' 'a6275a9e87ea24048eb7ad65f9af0679')
backup=('/etc/polipo/config' '/etc/conf.d/polipo')

build() {
	darcs get http://www.pps.jussieu.fr/~jch/software/repos/polipo/
	cd polipo
	make PREFIX=$startdir/pkg/usr \
	LOCAL_ROOT=$startdir/pkg/usr/share/polipo/www \
	DISK_CACHE_ROOT=$startdir/pkg/var/cache/polipo install
	mkdir -p $startdir/pkg/etc/{polipo,conf.d,rc.d}
	cp $startdir/config $startdir/pkg/etc/polipo/
	cp $startdir/polipo $startdir/pkg/etc/conf.d/
	cp $startdir/polipo.rc $startdir/pkg/etc/rc.d/polipo
}
