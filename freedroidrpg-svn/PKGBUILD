# Maintainer: M Rawash <mrawash@gmail.com>
pkgname=freedroidrpg-svn
pkgver=3146
pkgrel=1
pkgdesc="a mature science fiction role playing game set in the future - development version"
url="http://freedroid.sourceforge.net"
license=("GPL")
arch=('i686' 'x86_64')
depends=('sdl_mixer' 'sdl_image' 'libogg' 'libvorbis' 'libgl')
makedepends=('subversion')
conflicts=('freedroidrpg')
replaces=('freedroidrpg')
source=(freedroidrpg.jpg \
				freedroidrpg.desktop)
md5sums=('b73d9dac44c7e83a6c80fbe4eb96ba79'
         'a5118657951d3c2310aebb2045ba8759')

_svntrunk=https://freedroid.svn.sourceforge.net/svnroot/freedroid
_svnmod=freedroid

build() {
	cd "$srcdir"

	if [ -d $_svnmod/.svn ]; then
		(cd $_svnmod && svn up -r $pkgver)
	else
		svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
	fi

	msg "SVN checkout done or server timeout"
	msg "Starting make..."

	rm -rf "$srcdir/$_svnmod-build"
	cp -r "$srcdir/$_svnmod" "$srcdir/$_svnmod-build"
	cd "$srcdir/$_svnmod-build"

	./autogen.sh
  ./configure --prefix=/usr
  make || return 1
	make DESTDIR=$pkgdir install || return 1

	install -Dm644 $srcdir/freedroidrpg.jpg $pkgdir/usr/share/pixmaps/freedroidrpg.jpg
	install -Dm644 $srcdir/freedroidrpg.desktop $pkgdir/usr/share/applications/freedroidrpg.desktop

}

