pkgname=strigi-git
pkgver=20110131
pkgrel=1
pkgdesc="Fast crawling desktop search engine with Qt4 GUI"
arch=('i686')
url="http://strigi.sourceforge.net/"
license=('GPL')
depends=('qt' 'clucene' 'bzip2' 'exiv2' 'libxml2')
makedepends=('subversion' 'cmake')
provides=(strigi)
conflicts=(strigi)

_gitroot="git://anongit.kde.org/strigi"
_gitname="strigi"


build() {
cd $srcdir
    msg "Connecting to GIT server...."

  if [ -d $_gitname ] ; then
    cd $_gitname
    git pull origin
    git submodule update
    msg "The local files are updated."
  else
    cd $srcdir
    git clone $_gitroot $_gitname
    cd $_gitname
    git submodule update --init

  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."
  
  mkdir $srcdir/$_gitname-build
  
  cd $srcdir/$_gitname-build 
  cmake $startdir/src/$_gitname -DCMAKE_BUILD_TYPE=Release \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DENABLE_INOTIFY=ON
  make
}

package() {
	cd $srcdir/$_gitname-build
	make DESTDIR=$pkgdir install
	rm -r $srcdir/$_gitname-build
}
