# Maintainer: Paul Cox <pauldcox@gmail.com>
# Contributor: Matthew Bauer (previous maintainer)

pkgname=granola-gui
pkgver=4.0.1
pkgrel=1
pkgdesc="GUI to interact with granola-connect for setting account information and viewing statistics."
arch=('i686' 'x86_64')
  [ $CARCH = i686 ] && _arch=i386
  [ $CARCH = x86_64 ] && _arch=$CARCH
url="http://grano.la/"
license=('custom')
depends=('granola' 'granola-connect' 'gtk2>2.16' 'gksu'
         'python2>=2.7' 'pygtk' 'python2-gconf' 'dbus-python')
install=$pkgname.install
changelog=$pkgname.changelog

source=("https://download.miserware.com/linux/tar/$_arch/$pkgname-$pkgver-$_arch.tar.gz"
        'python2-rcd.patch')

[ $_arch = i686 ] && md5sums=('e2531c66ffc1f2aa985b04a24653f430')
[ $_arch = x86_64 ] && md5sums=('450154113efecb4b420bddd7a0bb3af7')
md5sums+=('3a246877a2576249916a22932243e334')

build() {
  cd "$srcdir/$pkgname-$pkgver-$_arch"
  # change python script headers to python2 and init.d references to rc.d
  patch -p1 -i "$srcdir"/python2-rcd.patch
}

package() {
  cd "$srcdir/$pkgname-$pkgver-$_arch"

  cp -r usr "$pkgdir"

  if [ $_arch = x86_64 ]; then
    mv "$pkgdir"/usr/lib64 "$pkgdir"/usr/lib
  fi

  # put license in proper directory
  rm -fr "$pkgdir"/usr/share/doc/
  install -Dm644 usr/share/doc/$pkgname-MAJOR.MINOR.BUILD/COPYING \
          "$pkgdir"/usr/share/licenses/$pkgname/COPYING
}

# vim:set ts=2 sw=2 et:
