# Maintainer: Paul Cox <pauldcox@gmail.com>
# Contributor: Matthew Bauer (previous maintainer)

pkgname=granola-gui
pkgver=5.0.6
pkgrel=1
pkgdesc="MiserWare Granola graphical interface"
arch=('i686' 'x86_64')
  if [ $CARCH = x86_64 ]; then
    _arch=$CARCH
  else
    _arch=i386
  fi
url="http://personal.grano.la/"
license=('custom')
depends=('granola>=5.0.0' 'gtk2' 'gksu' 'dbus-python' 'pygtk' 'python2-gconf')
options=(!strip)
install=$pkgname.install

source=("https://download.miserware.com/linux/tar/$_arch/$pkgname-$pkgver-$_arch.tar.gz"
        '0001-change-to-python2-in-scripts.patch')

[ $_arch = x86_64 ] && sha1sums=('3c42246831629c4058f8d9a1b3f6a7590105e5f4')
[ $_arch = i386 ] && sha1sums=('7e197c525460851e63df4847f1001836581f0ab9')
sha1sums+=('0a0de569d25c9c920951b9b8de68352504db4a73')

build() {
  cd "$srcdir/$pkgname-$pkgver-$_arch"

  # change python script headers to python2
  patch -p1 -i ../0001-change-to-python2-in-scripts.patch
}

package() {
  cd "$srcdir/$pkgname-$pkgver-$_arch"

  cp -r usr "$pkgdir"

  if [ $_arch = x86_64 ]; then
    mv "$pkgdir/usr/lib64" "$pkgdir/usr/lib"
  fi

  # put license in proper directory
  rm -fr "$pkgdir/usr/share/doc/"
  install -Dm644 usr/share/doc/$pkgname-$pkgver/LICENSE.txt \
          "$pkgdir/usr/share/licenses/$pkgname/LICENSE.txt"
}

# vim:set ts=2 sw=2 et:
