pkgname=nagstamon
pkgver=0.9.7.1
_pkgver=${pkgver}-1
pkgrel=1
pkgdesc="Nagstamon is a Nagios status monitor for the desktop"
arch=('i686' 'x86_64')
url="http://nagstamon.ifw-dresden.de/"
license=('GPL')
depends=('python2' 'pygtk' 'gnome-python-extras' 'python-lxml' 'python-rsvg' 'python2-distribute')
makedepends=('deb2targz')
source=("http://downloads.sourceforge.net/project/nagstamon/nagstamon/$pkgname%20${pkgver}/${pkgname}_${_pkgver}_all.deb" 'nagstamon.desktop')
md5sums=('44e404edc2918f22efc0d8c787ba92ed'
         '18c28fc3f5eeeeb333621b54cacd0654')

build() {
  cd $srcdir
  deb2targz ${pkgname}_${_pkgver}_all.deb
  tar -zxvf $srcdir/${pkgname}_${_pkgver}_all.tar.gz

  mkdir -p $pkgdir/usr/bin
  ln -s /usr/share/nagstamon/nagstamon.py $pkgdir/usr/bin/nagstamon
  mkdir $pkgdir/usr/share
  cp -R $srcdir/usr/share/nagstamon $pkgdir/usr/share/
  install -D -m644 ${srcdir}/nagstamon.desktop $pkgdir/usr/share/applications/nagstamon.desktop
  install -D -m644 ${srcdir}/nagstamon.desktop $pkgdir/etc/xdg/autostart/nagstamon.desktop

  sed -i 's|/usr/bin/python|/usr/bin/env python2|' $pkgdir/usr/share/nagstamon/nagstamon.py
}
