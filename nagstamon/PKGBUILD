pkgname=nagstamon
pkgver=0.9.5_rc1
_pkgver=${pkgver/_/-}
pkgrel=1
pkgdesc="Nagstamon is a Nagios status monitor for the desktop"
arch=('i686' 'x86_64')
url="http://nagstamon.sourceforge.net"
license=('GPL')
depends=('python2' 'pygtk' 'gnome-python-extras' 'python-lxml' 'python-rsvg')
makedepends=('deb2targz')
source=("http://downloads.sourceforge.net/project/nagstamon/nagstamon/$pkgname%200.9.5%20RC1/${pkgname}_${_pkgver}_all.deb" 'nagstamon.desktop')
md5sums=('2a2ceae4c47cee3ddf1102fc1cdccf79'
         'd257236c7dd060e2f4700f09cc9eff44')

build() {
  cd $srcdir
  deb2targz ${pkgname}_${_pkgver}_all.deb
  tar -zxvf $srcdir/${pkgname}_${_pkgver}_all.tar.gz

  install -D -m644 $srcdir/nagstamon.desktop $pkgdir/etc/xdg/autostart/nagstamon.desktop
  mkdir -p $pkgdir/usr/bin
  ln -s /usr/share/nagstamon/nagstamon.py $pkgdir/usr/bin/nagstamon
  mkdir $pkgdir/usr/share
  cp -R usr/share/nagstamon $pkgdir/usr/share/nagstamon
  install -D -m644 usr/share/applications/nagstamon.desktop $pkgdir/usr/share/applications/nagstamon.desktop

  sed -i 's|/usr/bin/python|/usr/bin/env python2|' $pkgdir/usr/share/nagstamon/nagstamon.py
}
