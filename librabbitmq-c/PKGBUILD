# Contributor: aleiphoenix <aleiphoenix@gmail.com>
# Contributor: travisghansen <travisghansen@yahoo.com>

pkgname=librabbitmq-c
pkgver=0.4.1
pkgrel=1
pkgdesc="A RabbitMQ(amqp) library written in C-language"
arch=('i686' 'x86_64')
license=('BSD')
makedepends=('cmake' 'python' 'xmlto')
url=https://github.com/alanxz/rabbitmq-c
source=("${pkgname}-${pkgver}.zip::https://github.com/alanxz/rabbitmq-c/archive/v${pkgver}.zip"
        xmlto.patch)
md5sums=('3890cef18e2b2f9031df68a50e3c0070'
         '2e106782e5e3cd35edb75172a17da116')
options=(!libtool)

prepare() {
  cd ${pkgname:3}-$pkgver
  patch -p0 -i "${srcdir}"/xmlto.patch
}

build() {
  cd ${pkgname:3}-$pkgver
  cmake -DCMAKE_INSTALL_PREFIX=/usr -DBUILD_EXAMPLES=OFF -DBUILD_TOOLS=OFF -DBUILD_TOOLS_DOCS=OFF -DBUILD_TESTS=OFF -DENABLE_SSL_SUPPORT=ON -DBUILD_API_DOCS=OFF .
}

package() {
  cd ${pkgname:3}-$pkgver
  DESTDIR="${pkgdir}" cmake --build . --target  install
}
