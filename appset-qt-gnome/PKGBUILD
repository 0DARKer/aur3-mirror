# Maintainer of appset-qt: Simone Tobia <simone.tobia at gmail dot com>
# Maintainer: Jeremy Newton (Mystro256)
#
# Copy of appset but with modifications to integrate well into gnome
# Theme is based on GNOME default icons (GPL) and Gnome-Packagekit icons (GPL)
# Credits to all that helped make those icons!

pkgname=appset-qt-gnome
pkgver=0.6.4
pkgrel=1
pkgdesc="Gnome themed version of appsest-qt: an advanced and feature rich Package Manager Frontend"
arch=('i686' 'x86_64')
url="http://appset.sourceforge.net/"
license=('GPL2')
depends=('qt>=4.7')
makedepends=('gnome-icon-theme')
optdepends=('packer: for AUR support')
conflicts=('appset-qt')
install=appset-qt.install
changelog=appset-qt.changelog
source=(http://sourceforge.net/projects/appset/files/appset-qt/0.6/0.6.4/appset-qt-0.6.4-sources.tar.gz appset-gnome-icons.tar.gz)
md5sums=(f2203af08a370ff5b8e60820833cc313 7984c226ec2ff39556b870e53a3e45f7)

build() {
  cd $srcdir/appset-qt-$pkgver-sources

  #Extract the gnome theme and replace default one
  cp -f -r ../Qt ./

  qmake PREFIX=/usr -Wnone

  #localization
  lrelease Qt/AppSet-Qt/*.ts
  lrelease Qt/AppSetTray-Qt/*.ts
  lrelease Qt/AppSetRepoEditor-Qt/*.ts

  make || return 1
}

package() {
    cd $srcdir/appset-qt-$pkgver-sources

    make INSTALL_ROOT="$pkgdir/" install

    #helper daemon
    install -m 755 -d "$pkgdir/etc/rc.d" || return 1
    install -m 755 "$srcdir/appset-qt-$pkgver-sources/AppSetHelper/appset-helper.sh" "$pkgdir/etc/rc.d/appset-helper"
}
