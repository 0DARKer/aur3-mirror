# Maintainer: Joker-jar <joker-jar@yandex.ru>

pkgname=keditbookmarks-svn
pkgver=1142428
pkgrel=3
pkgdesc="KeditBookmarks is a bookmark editor for Konqueror, Krusader and other applications, which use the XBEL standard for the bookmark format."
depends=('kdelibs')
makedepends=('subversion' 'cmake' 'automoc4' 'kdelibs')
conflicts=('kdebase-konqueror')
provides=('kdebase-konqueror')
url="http://websvn.kde.org/trunk/KDE/kdebase/apps/keditbookmarks"
license="GPL"
arch=('i686' 'x86_64')
 
_svntrunk=svn://anonsvn.kde.org/home/kde/trunk/KDE/kdebase/apps/keditbookmarks
_svnfavicon=svn://anonsvn.kde.org/home/kde/trunk/KDE/kdebase/apps/lib/konq/favicons
 
build() {
  cd $srcdir
  msg "Get sources..."
  svn co $_svntrunk -r $pkgver keditbookmarks
  msg "Get favicons..."
  svn co $_svnfavicon -r $pkgver lib/konq/favicons
  cd keditbookmarks
  msg "Fix CMakeLists.txt"
  sed -i '1 iproject(KEDITBOOKMARKS)\n\nfind_package(KDE4 REQUIRED)\ninclude (KDE4Defaults)\ninclude (MacroLibrary)\ninclude_directories (${KDE4_INCLUDES})\n' CMakeLists.txt
  mkdir -p build
  cd build
  msg "Starting make..."
  cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_BUILD_TYPE=RELEASE ..
  make
  make DESTDIR=$pkgdir install
  rm -r $pkgdir/usr/share/applications
  msg "Enjoy ;)"
}
