# Contributor: Vitaliy Berdinskikh ur6lad[at]archlinux.org.ua

pkgname=jakarta-commons-daemon
pkgver=1.0.5
pkgrel=1
pkgdesc="The Apache Commons Daemon"
arch=('i686' 'x86_64')
url="http://commons.apache.org/daemon/"
license="Apache"
groups=('jakarta-commons')
depends=('java-runtime')
makedepends=('apache-ant' 'java-environment' 'docbook2x')
source=(http://www.eu.apache.org/dist/commons/daemon/source/commons-daemon-$pkgver-src.tar.gz
		build.properties)

build() {
	cd $srcdir/commons-daemon-$pkgver-src

	ant jar

	cd src/native/unix

	./configure --with-java=$JAVA_HOME
	make clean
	make
	docbook2man man/jsvc.1.xml
}

package() {
	mkdir -p $pkgdir/usr/sbin/ $pkgdir/usr/man/man1
	mkdir -p $pkgdir/usr/share/java/commons-daemon/

	cd $srcdir/commons-daemon-$pkgver-src

	install -m644 dist/commons-daemon-$pkgver.jar $pkgdir/usr/share/java/commons-daemon
	ln -sf commons-daemon-$pkgver.jar $pkgdir/usr/share/java/commons-daemon/commons-daemon.jar

	cd src/native/unix

	install -m755 jsvc $pkgdir/usr/sbin
	install -m644 JSVC.1 $pkgdir/usr/man/man1
}

md5sums=('2fe0a35d4a9c0338ecd45dad20f33662'
         '3ddb30105dacda8ebbbd9eef9f421c26')
sha256sums=('afbfc2f144c5c6819d9a44ca9fd224af56ae223febe134e429535cbcfeeadf42'
            '5e33e13668de321ba385e68db8de4eb4839ad294c008232ca52732fc2c9a4b2a')
