# Maintainer:  Michael Kogan <michael dot kogan at gmx dot net>

pkgname=geomspace
pkgver=0.9a
pkgrel=2
pkgdesc="A browser for geometric (i.e. Euclidean, Riemann, Minkowski) spaces"
arch=('i686' 'x86_64')
url="https://sourceforge.net/projects/geomspace/"
license=('GPL')
depends=('glui')
source=(http://downloads.sourceforge.net/project/$pkgname/0.9/GeomSpace-$pkgver-src.tar.gz \
	http://downloads.sourceforge.net/project/$pkgname/Theory/UniformGeomSpace-2010.11.02-en.pdf \
	http://sourceforge.net/projects/geomspace/files/Models/5Cubes.gmsp
	http://sourceforge.net/projects/geomspace/files/Models/5Tetra.gmsp
	make.patch \
	geomspace.png \
	geomspace.desktop)
md5sums=('d74f5a62dcf18afe8237665d772d3c4d'
			'14560f6f2cba975be1ba8d047b5acec5'
			'205c728191134d15cd5053e37c30a454'
			'520350c4ab6aa1385f75028d22e769be'
			'899865b93ed52799f31dd3b2ff8b7f84'
			'86af94ebce3f2d5a40e3a01fb1e1b0bc'
			'0987c858a20d66760bb2627d9517eb8d')
sha1sums=('c03f33cd2724d0c32443feeefee833b122995c00'
			'd224bb95140684449b7ce7ec81fc54dff1e02717'
			'c046032724f667a9d11c41856db351d3ef338713'
			'6a25b29dd104a8326722ae7261c9f4afb14f5944'
			'38ec7e6a2da646981b31e1118863ef766e8512a9'
			'7a85229fe2b49a2ea7f745f9b078bf7364cac115'
			'9ea1201969d3fea1a17d5addad1aa724dd189112')

build() {
    cp /usr/lib/libglui.a $srcdir/GeomSpace/extern/lib/
    if [ -f /usr/include/glui.h ]; then
    	cp /usr/include/glui.h $srcdir/GeomSpace/extern/include/GL/
    fi
    cd $srcdir/GeomSpace/make
    patch Makefile < $srcdir/make.patch
	 if test "$CARCH" == i686; then
		echo "OS = linux32" > platform 
	 fi
    make || return 1
}
package() {
    install -D -m755 $srcdir/GeomSpace/bin/GeomSpace $pkgdir/usr/bin/geomspace
    install -D -m644 $srcdir/GeomSpace/DeveloperManual.pdf $pkgdir/usr/share/doc/$pkgname/DeveloperManual.pdf
    install -D -m644 $srcdir/GeomSpace/UserManual.pdf $pkgdir/usr/share/doc/$pkgname/UserManual.pdf
    install -D -m644 $srcdir/UniformGeomSpace-2010.11.02-en.pdf $pkgdir/usr/share/doc/$pkgname/UniformGeomSpace-2010.11.02-en.pdf
	 install -D -m644 ../${pkgname}.desktop ${pkgdir}/usr/share/applications/${pkgname}.desktop
	 install -D -m644 ../${pkgname}.png ${pkgdir}/usr/share/pixmaps/${pkgname}.png
	 install -d -m755 ${pkgdir}/usr/share/${pkgname}
	 install -d -m755 ${pkgdir}/usr/share/${pkgname}/models
	 install -D -m644 ../5Cubes.gmsp ${pkgdir}/usr/share/${pkgname}/models
	 install -D -m644 ../5Tetra.gmsp ${pkgdir}/usr/share/${pkgname}/models	 
    msg "\033[31;1m The user manual and a document containing a theory explanation have been installed to /usr/share/doc/$pkgname. It is strongly recommended to read them in order to use Geomspace! \033[0m"
	 msg "\033[31;1m Some models of geometrical objects have been installed to /usr/share/$pkgname/models. Additional models can be found at http://sourceforge.net/projects/geomspace/files/Models/ \033[0m"
}
