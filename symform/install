#!/bin/bash

PURGE=1

post_remove() {

[ "$1" = upgrade ] || rm -rf /opt/symform/bin

for f in /usr/lib/systemd/system/symform*.service; do
    [ -f "$f" ] && systemctl disable "$(basename "$f")"
done

rm -f /etc/cron.d/symform-node /etc/init/symform*.conf \
    /usr/lib/systemd/system/symform*.service /usr/share/applications/symform.desktop

if [ "$1" = purge -o "$PURGE" = 1 ]; then
    userdel --remove symform
    grep -q symform /etc/group && groupdel symform
    rm -rf /var/lib/symform /var/run/symform /var/log/symform /usr/share/Symform \
        /opt/symform /etc/ufw/applications.d/Symform*
fi

exit 0
}

pre_upgrade() {
/opt/symform/scripts/prerm
}

post_upgrade() {
/opt/symform/scripts/postrm upgrade && /opt/symform/scripts/postinst configure
}

pre_remove() {
/opt/symform/scripts/prerm
}

post_install() {
/opt/symform/scripts/postinst configure && /opt/symform/scripts/platform/systemd.sh
}

pre_install() {
[ -f /opt/symform/SymformNode.sh ] && /opt/symform/SymformNode.sh stop
exit 0
}

