# Maintainter: thr <r at sledinmay dot com>
# Contributor: Emmanuele Massimi <finferflu at gmail dot com>
pkgname=gtkmagnetic
pkgver=2.3
pkgrel=3
pkgdesc="An interpreter for Magnetic Scrolls adventures."
arch=(i686 x86_64)
url="http://mirror.ifarchive.org/indexes/if-archiveXmagnetic-scrollsXinterpretersXmagnetic.html"
license=('GPL')
depends=('gtk2' 'smpeg')
source=("http://mirror.ifarchive.org/if-archive/magnetic-scrolls/interpreters/magnetic/Magnetic23Src.zip"
	gargoyle.patch ms_init.patch glib2.patch gtkmagnetic.desktop gtkmagnetic.xpm)
md5sums=('74b0d027c6a70e39d9447f12c215e8a9'
         '2f1dcd0446348b32a873d591ce670a37'
         'ec4cb13ac5f78d46069baf83ba674542'
         'd5c5e901442b913279eca35467066222'
         'e66164695a7c559fe046a922526c94d3'
         'f8bda0389176b8ec8cf05d59dcdc7bf2') 

build() {
  patch -Np0 -i $srcdir/ms_init.patch
  patch -Np0 -i $srcdir/gargoyle.patch
  patch -Np0 -i $srcdir/glib2.patch

  cd $srcdir/Gtk
  LIBS="-lm" make || return 1

  mkdir -p $pkgdir/usr/share/gtkmagnetic
  mkdir -p $pkgdir/usr/share/pixmaps

  cp $srcdir/Gtk/README $pkgdir/usr/share/gtkmagnetic/
  cp $srcdir/../$pkgname.xpm $pkgdir/usr/share/pixmaps/$pkgname.xpm
  install -D -m644 $srcdir/../$pkgname.desktop $pkgdir/usr/share/applications/$pkgname.desktop
  install -D ./gtkmagnetic $startdir/pkg/usr/bin/gtkmagnetic
  ln -s /usr/bin/gtkmagnetic $pkgdir/usr/bin/magnetic
}

