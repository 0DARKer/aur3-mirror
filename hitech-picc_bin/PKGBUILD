# Maintainer: BxS <bxsbxs@gmail.com>

pkgname=hitech-picc_bin
_pkgver=9.83
pkgver=$_pkgver.10920
pkgrel=1
pkgdesc="C compiler for PIC10/12/16 MCUs"
arch=('i686' 'x86_64')
url="http://www.microchip.com/stellent/idcplg?IdcService=SS_GET_PAGE&nodeId=1406&dDocName=en542849"
license=('custom')
[ "$CARCH" = "x86_64" ] && depends=('lib32-glibc')
provides=(hitech-picc)
conflicts=(hitech-picc)
replaces=(hitech-picc)
options=(!strip docs libtool emptydirs !zipman)
install=hitech-picc_bin.install
_installer="picc-$_pkgver-linux.run"
source=("http://ww1.microchip.com/downloads/en/DeviceDoc/picc-$_pkgver-linux.zip")
md5sums=('a7bbd474955d2ff9e9f26495abc61b95')

build() {
  cd $srcdir

  chmod 0755 $_installer
}

package() {
  cd $pkgdir

  _install_dir="$pkgdir/opt/hitech/picc/$_pkgver"

  mkdir -p $_install_dir

  $srcdir/$_installer --noexec --keep --nox11 --target $_install_dir &> '/dev/null'

  rm $_install_dir/{reactivate.template,shell-install}
  rm $_install_dir/bin/{activate,activate.dat}

  mkdir -p $pkgdir/usr/share/licenses/$pkgname
  ln -s "/opt/hitech/picc/$_pkgver/licence.txt" "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}
