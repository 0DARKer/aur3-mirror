# Maintainer: The_Muh <marc@themuh.org>

pkgname=smc-git
pkgver=20100615
pkgrel=1
pkgdesc="A classic 2D jump'n run sidescroller game in a style similar to the original SuperMario game"
url='http://www.secretmaryo.org'
license=('GPL3')
arch=('i686' 'x86_64')

depends=('boost' 'cegui>=0.7' 'libpng' 'sdl_image' 'sdl_mixer' 'sdl_ttf' 'libpng' 'libogg' 'libvorbis' 'gettext')
makedepends=('git' 'autoconf' 'automake' 'autogen' )
conflicts=('smc')
provides=('smc')


_gitroot="http://github.com/FluXy/SMC.git"
_gitname="SMC"

build() {
	cd "$srcdir"
	msg "Connecting to GIT server...."

	if [ -d ${srcdir}/$_gitname ] ; then
		cd $_gitname && git pull origin
		msg "The local files are updated."
	else
		git clone $_gitroot
	fi

	msg "GIT checkout done or server timeout"
	msg "Starting make..."

	cd ${srcdir}/${_gitname}/smc
	# BUILD

	./autogen.sh || return 1
	./configure --prefix=/usr/share --bindir=/usr/bin --datadir=/usr/share || return 1
	make install LDADD=-lpng DESTDIR=$startdir/pkg || return 1

	install -D -m644 $startdir/pkg/usr/share/smc/pixmaps/game/items/mushroom_red.png $startdir/pkg/usr/share/pixmaps/smc.png
	install -D -m644 $startdir/smc.desktop $startdir/pkg/usr/share/applications/smc.desktop

	cp -r data/music $startdir/pkg/usr/share/smc
}
