# Maintainer: David Scholl <djscholl at gmail dot com>

pkgname=sofastats
pkgver=1.0.1
pkgrel=1
pkgdesc="Statistics Open For All"
arch=('any')
url="http://www.sofastatistics.com/"
license=('custom')
depends=('wxpython' 'python2-matplotlib' 'pygresql' 'python-pysqlite' 'mysql-python' 'pywebkitgtk')
replaces=('sofa')
source=("http://downloads.sourceforge.net/sofastatistics/$pkgname-$pkgver.tar.gz" "setup.py")
md5sums=('62787e41dc4ee5f88c2bac6b5a0e8225'
         '33b720c5589d8a8b563f17df059d1ac8')

build() {
  cd $srcdir/$pkgname-$pkgver
  cp ../../setup.py ./ || return 1
  sed -i "s/version_from_build_script/$pkgver/" setup.py || return 1
  touch sofa_main/__init__.py
  python2 setup.py build || return 1
  python2 setup.py install --root=$pkgdir || return 1
  echo "#!/bin/bash" > sofastats || return 1
  echo "/usr/bin/env python2 "\
  "/usr/lib/python$(pacman -Q python2 | colrm 1 8 | colrm 4)/site-packages/sofastats/start.py "\
  >> sofastats || return 1
  chmod a+x sofastats || return 1
  install -D sofastats $pkgdir/usr/bin/sofastats || return 1 
  install -D copyright $pkgdir/usr/share/licenses/$pkgname/copyright || return 1
}
