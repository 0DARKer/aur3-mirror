# Maintainer: phara0h (jan@das-labor.org)

pkgname=kernel26-eee-monolithic
pkgver=2.6.37
_kernver=2.6.37
pkgrel=7
pkgdesc="The Linux Kernel for the Asus Eee PC 901 without module support"
arch=('i686')
license=('GPL2')
url="http://www.kernel.org"
replaces=('linux-uvc-eee-svn' 'madwifi-eee-svn')
optdeps=('rt2860-firmware: wlan')
install=kernel26-eee-monolithic.install
source=(ftp://ftp.kernel.org/pub/linux/kernel/v2.6/linux-${_kernver}.tar.bz2
        kernelconfig
	kernel2.6.37-cgroup.patch
	)

build() {
	
  # unset since our build machine may differ from eee
  unset CFLAGS CXXFLAGS

  # get into the linux source directory and start some magic
  cd ${srcdir}/linux-${_kernver}
  
  patch -p1 < ../kernel2.6.37-cgroup.patch

  # load configuration and build kernel
  cp ../kernelconfig ./.config
  make oldconfig || return 1
  #make menuconfig
  make || return 1
 
}

package() {

  # install the kernel
  mkdir ${pkgdir}/lib
  mkdir ${pkgdir}/boot
  cd ${srcdir}/linux-${_kernver}
  cp System.map ${pkgdir}/boot/System.map26-eee
  cp arch/x86/boot/bzImage ${pkgdir}/boot/vmlinuz26-eee
}
sha256sums=('edbf091805414739cf57a3bbfeba9e87f5e74f97e38f04d12060e9e0c71e383a'
            'e892ac4622c637e3a2ce320e03d9b23672de454ef76be223b26a8e1adeb9dba9'
            'c038414605830b42ec19718b3f049e68f50c18b30d74bc3bf4cb7a9d48281770')
