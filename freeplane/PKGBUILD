# Contributor: scrawler@gmail.com

pkgname=freeplane
pkgver=1.1.3
whatdir=${srcdir}/${pkgname}-${pkgver}_10
pkgrel=1
pkgdesc="A Java mindmapping tool"
arch=('i686' 'x86_64')
url="http://freeplane.sourceforge.net"
license=('GPL')
makedepends=('unzip')
depends=('java-runtime')
#source=(http://downloads.sourceforge.net/sourceforge/${pkgname}/${pkgname}_bin-${pkgver//./_}.zip
source=(http://downloads.sourceforge.net/sourceforge/${pkgname}/${pkgname}_bin-${pkgver}.zip
        freeplane.png freeplane.desktop freeplane.run)

md5sums=('e5376e12cce5e01c7d6ff7b8fc25e143'
         '65dc9e13a3b7c2855ab05f804ae5ab8c'
         '85d40893aef0b71f9ffdf2dec4fbb0f0'
         'fb130f66407fed841d034625aa19c451')

build() {
  cd ${whatdir}
  for file in $( find plugins -type f ) ; do
    install -Dm644 ${file} ${pkgdir}/usr/share/freeplane/${file}
  done

  install -Dm755 ${srcdir}/freeplane.run ${pkgdir}/usr/bin/freeplane
  install -Dm755 ${whatdir}/freeplane.sh ${pkgdir}/usr/share/freeplane/freeplane.sh
  install -Dm644 ${whatdir}/init.xargs ${pkgdir}/usr/share/freeplane/init.xargs
  install -Dm644 ${whatdir}/props.xargs ${pkgdir}/usr/share/freeplane/props.xargs
  install -Dm644 ${whatdir}/license.txt ${pkgdir}/usr/share/freeplane/licence.txt

  mkdir -p ${pkgdir}/usr/share/freeplane/resources
  mkdir -p ${pkgdir}/usr/share/freeplane/resources/accelerators
  mkdir -p ${pkgdir}/usr/share/freeplane/resources/ortho
  mkdir -p ${pkgdir}/usr/share/freeplane/resources/xslt

  mkdir -p ${pkgdir}/usr/share/freeplane/core
  mkdir -p ${pkgdir}/usr/share/freeplane/core/org.freeplane.core
  mkdir -p ${pkgdir}/usr/share/freeplane/core/org.freeplane.core/META-INF
  mkdir -p ${pkgdir}/usr/share/freeplane/core/org.freeplane.core/lib
  install -Dm644 ${whatdir}/core/org.freeplane.core/META-INF/* ${pkgdir}/usr/share/freeplane/core/org.freeplane.core/META-INF/
  install -Dm644 ${whatdir}/core/org.freeplane.core/lib/* ${pkgdir}/usr/share/freeplane/core/org.freeplane.core/lib


  install -Dm644 ${whatdir}/resources/accelerators/* ${pkgdir}/usr/share/freeplane/resources/accelerators/
  install -Dm644 ${whatdir}/resources/ortho/* ${pkgdir}/usr/share/freeplane/resources/ortho/
  install -Dm644 ${whatdir}/resources/xslt/* ${pkgdir}/usr/share/freeplane/resources/xslt/

  install -Dm644 ${whatdir}/doc/freeplane.mm ${pkgdir}/usr/share/freeplane/doc/freeplane.mm

  install -Dm644 ${srcdir}/freeplane.desktop ${pkgdir}/usr/share/applications/freeplane.desktop
  install -Dm644 ${srcdir}/freeplane.png ${pkgdir}/usr/share/pixmaps/freeplane.png
  install -Dm644 ${whatdir}/framework.jar ${pkgdir}/usr/share/freeplane/framework.jar
}

