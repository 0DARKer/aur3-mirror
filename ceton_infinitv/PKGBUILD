# Maintainer: Jameson Pugh <imntreal@gmail.com>

pkgname=ceton_infinitv
pkgver=2013.0326.2226
pkgrel=1
pkgdesc="Driver for Ceton InfiniTV"
arch=('i686' 'x86_64')
url="http://cetoncorp.com/infinitv_support/linux_drivers"
license=('GPL')
depends=('linux-headers')
source=("http://www.cetoncorp.com/downloads/${pkgname}_linux_driver_2012_1116_1219.tar.gz"
        'ctn91xx_pci-buildfix.patch'
        'rules.patch')
install=${pkgname}.install
sha256sums=('3ef9fed0c023b0baca661f56304d1f58c2aca5aa84eed5043e8a781a46457f53'
            '61b72bfed9298ac7522acc29541ce90ae263203cd20f750785a7f61f2b9a302b'
            '107b928b976facc5f0ba5189c48e79a1c995c1b2faa73a54dc96780a97bb71c7')

build() {
  cd "$srcdir/${pkgname}_linux_driver"
  patch -p1 < ../ctn91xx_pci-buildfix.patch
  patch -p0 < ../rules.patch
  make
}

package() {
  cd "$srcdir/${pkgname}_linux_driver"
  KERNEL_VERSION=`uname -r`
	install -D -m644 ctn91xx.ko ${pkgdir}/usr/lib/modules/$KERNEL_VERSION/extramodules/ctn91xx.ko
	gzip -9 ${pkgdir}/usr/lib/modules/$KERNEL_VERSION/extramodules/ctn91xx.ko
	install -D -m644 98-ctn91xx.rules ${pkgdir}/etc/udev/rules.d/98-ctn91xx.rules
}

# vim:set ts=2 sw=2 et:
