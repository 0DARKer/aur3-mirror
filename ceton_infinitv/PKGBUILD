# This is an example PKGBUILD file. Use this as a start to creating your own,
# and remove these comments. For more information, see 'man PKGBUILD'.
# NOTE: Please fill out the license field for your package! If it is unknown,
# then please put 'unknown'.

# Maintainer: Your Name <youremail@domain.com>
pkgname=ceton_infinitv
pkgver=1.4
pkgrel=2
pkgdesc="Driver for Ceton InfiniTV"
arch=('i686' 'x86_64')
url="http://www.cetoncorp.com/infinitv/support/linux.php"
license=('GPL')
depends=('linux-headers' 'linux')
makedepends=()
source=(http://www.cetoncorp.com/firmware/${pkgname}_linux_driver_1_4.tar.gz)
install=${pkgname}.install
sha1sums=('64862c5c9c0cd62d08359ebaac7866fce0d4cc33')

build() {
  cd "$srcdir/${pkgname}_linux_driver"
  sed -i -e 's/DMA_32BIT_MASK/DMA_BIT_MASK(32)/g' ctn91xx_pci.c
  make
}

package() {
  cd "$srcdir/${pkgname}_linux_driver"
  KERNEL_VERSION=`uname -r`
  KERNEL_DIR=/lib/modules/$KERNEL_VERSION/build
	install -D -m644 ctn91xx.ko ${pkgdir}/lib/modules/$KERNEL_VERSION/extra/ctn91xx.ko
	gzip -9 ${pkgdir}/lib/modules/$KERNEL_VERSION/extra/ctn91xx.ko
	install -D -m644 98-ctn91xx.rules ${pkgdir}/etc/udev/rules.d/98-ctn91xx.rules
}

# vim:set ts=2 sw=2 et:
