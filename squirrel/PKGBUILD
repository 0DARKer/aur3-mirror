# Maintainer:   Ilgrim    <ilgrim at gmail dot com>

pkgname=squirrel
pkgver=2.2.4
pkgrel=3
pkgdesc="A light-weight scripting language that fits in the size, memory bandwidth, and real-time requirements of applications like video games."
arch=('i686' 'x86_64')
url="http://www.squirrel-lang.org/"
source=(http://downloads.sourceforge.net/project/${pkgname}/squirrel2/${pkgname}%20${pkgver}%20stable/${pkgname}_${pkgver}_stable.tar.gz)
license=('ZLIB')
depends=('glibc')
md5sums=('e411dfd1bcc5220aa80de53e4a5f094d')

build() {
  cd ${srcdir}/SQUIRREL2
  # If $arch is x86_64, compile for 64bits. Else do it for 32.
  if [ $(uname -m)='x86_64' ]; then
    make sq64 &> /dev/null
  else
    make sq32 &> /dev/null
  fi
}

package() {
  # Install squirrel Interpreter.
  install -Dm755 ${srcdir}/SQUIRREL2/bin/sq ${pkgdir}/usr/bin/squirrel
  # Install Includes and various headers.
  for _file in $(ls ${srcdir}/SQUIRREL2/include)
  do
     install -Dm755 ${srcdir}/SQUIRREL2/include/$_file ${pkgdir}/usr/include/$_file
  done
  # Install all static libraries & others.
  for _file in $(ls ${srcdir}/SQUIRREL2/lib)
  do
     install -Dm755 ${srcdir}/SQUIRREL2/lib/$_file ${pkgdir}/usr/lib/$_file
  done
  # Install docs & examples. 
  for _file in $(ls ${srcdir}/SQUIRREL2/doc)
  do
     install -Dm755 ${srcdir}/SQUIRREL2/doc/$_file ${pkgdir}/usr/share/$pkgname/doc/$_file
  done
  for _file in $(ls ${srcdir}/SQUIRREL2/samples)
  do
     install -Dm755 ${srcdir}/SQUIRREL2/samples/$_file ${pkgdir}/usr/share/$pkgname/samples/$_file
  done
  # Install Other docs.
  install -Dm755 ${srcdir}/SQUIRREL2/HISTORY ${pkgdir}/usr/share/$pkgname/HISTORY
  install -Dm755 ${srcdir}/SQUIRREL2/README ${pkgdir}/usr/share/$pkgname/README
  for _file in $(ls ${srcdir}/SQUIRREL2/etc)
  do
     install -Dm755 ${srcdir}/SQUIRREL2/etc/$_file ${pkgdir}/usr/share/$pkgname/embebing/$_file
  done 
  # Install specific license.
  install -Dm755 ${srcdir}/SQUIRREL2/COPYRIGHT ${pkgdir}/usr/share/licenses/$pkgname/COPYRIGHT
}
