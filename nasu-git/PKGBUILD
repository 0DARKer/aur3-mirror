# Maintainer: OrdinaryMagician <saniukeokusainaya@gmail.com>
pkgname=nasu-git
pkgver=20121121
pkgrel=2
pkgdesc="A standalone version of the minigame from Yume Nikki"
arch=('x86_64' 'i686')
url="https://github.com/OrdinaryMagician/nasu"
license=('custom:MULSv2')
depends=('sdl' 'sdl_image' 'sdl_mixer' 'sdl_ttf' 'sdl_gfx')
makedepends=('git')
_gitroot="git://github.com/OrdinaryMagician/nasu.git"
_gitname="nasu"

build() {
  msg "Connecting to GIT server..."

  if [[ -d ${_gitname} ]]; then
      ( cd ${_gitname} && git pull origin )
      msg "The local files are updated."
  else
      git clone ${_gitroot}
  fi
  
  msg "GIT checkout done or server timeout"
  msg "Starting make..."
  
  cd ${srcdir}/nasu
  make -f makefile.linux
}

package() {
  cd "${srcdir}/nasu"
  install -dm755 "${pkgdir}/usr/share/games/nasu"
  install -Dm644 -t "${pkgdir}/usr/share/games/nasu" gamedata/*
  install -Dm755 nasu "${pkgdir}/usr/bin/nasu"
  # MULS license
  install -Dm644 LICENSE "${pkgdir}/usr/share/licenses/nasu/LICENSE"
}
