# This script is incomplete and in development. To install bumblebee use the one in the AUR
# http://aur.archlinux.org/packages.php?ID=49469

# Maintainer: Samsagax <samsagax@gmail.com>

pkgname=bumblebee
pkgver=20110815
pkgrel=1
pkgdesc="Stable branch of Bumblebee. Optimus Support for Linux Through VirtualGL. Power management not supported"
arch=('i686' 'x86_64')
makedepends=('git')
depends=('virtualgl-bin' 'dkms-nvidia' 'nvidia-utils-bumblebee')
#optdepends=('acpi_call: turn on/off discrete card (unstable)')
if [ "$CARCH" = "x86_64" ]; then
     optdepends[0]='lib32-nvidia-utils-bumblebee: run 32bit applications with optirun'
fi
url="https://github.com/Bumblebee-Project/Bumblebee"
license=("GPL3")
install=('bumblebee.install')
conflicts=('bumblebee-nouveau' 'bumblebee')
provides=('bumblebee')
#sources=()

_gitroot="git://github.com/Bumblebee-Project/Bumblebee.git"
_gitname="Bumblebee"
_gitbranch="release-2.3"
_temp_dir="install-temp"
_installscript="sh ./install --dest-dir=../$_temp_dir --skip-stages=checkprivileges,archlinux/checkdependencies,welcome,configure,createuninstaller,finish"

build() {
    cd "$srcdir"
    msg "Connecting to GIT server...."
    if [ -d $_gitname ] ; then
        cd $_gitname && git pull origin
        msg "The local files are updated."
        cd "$srcdir"
    else
        git clone $_gitroot -b $_gitbranch $_gitname --depth=1
    fi
    msg "GIT checkout done or server timeout"
    
    mkdir -p "$_temp_dir"
    cd "$_gitname"
    $_installscript
}

package() {
    cd "$srcdir/$_temp_dir"
    cp -a ./* "$pkgdir"
}





















