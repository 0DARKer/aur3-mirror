# Contributor: Ross Melin <rdmelin@gmail.com>
# Contributor: Tri Le <trile7@gmail.com>
# Contributor: libc <primehunter326@gmail.com>
# Contributor: Albert Nguyen <albertbmnguyen@yahoo.com>
# Contributor: Devaev Maxim <mdevaev@gmail.com>


pkgname="mjpg-streamer-pikvm"
pkgver="r64"
pkgrel="1"
pkgdesc="Stream mjpeg frames from a webcam via http (PiKVM edition)"
url="https://github.com/mdevaev/mjpg-streamer"
license="GPL"
arch=("i686" "x86_64" "armv6h")
depends=("libjpeg" "imagemagick")
makedepends=("gcc")
provides=("mjpeg-streamer")
options=("!makeflags")
_commit="75fe20e5d7101d5ae47b7afc7dd1b8a2e2294643"
source=("https://github.com/mdevaev/mjpg-streamer/archive/$_commit.tar.gz")
md5sums=("d97d3d4a3647f4fc427873a2dbc1cd01")


build() {
	cd "$srcdir/mjpg-streamer-$_commit/mjpg-streamer-experimental"
	make application input_uvc.so output_http.so
}

package() {
	cd "$srcdir/mjpg-streamer-$_commit/mjpg-streamer-experimental"
	mkdir -p $pkgdir/usr/share/mjpg-streamer
	mkdir -p $pkgdir/usr/lib
	mkdir -p $pkgdir/usr/bin
	install *.so $pkgdir/usr/lib/
	install mjpg_streamer $pkgdir/usr/bin/
	install -m 644 CHANGELOG LICENSE README $pkgdir/usr/share/mjpg-streamer/
}
