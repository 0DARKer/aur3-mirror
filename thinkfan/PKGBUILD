# Maintainer: nblock <nblock [/at\] archlinux DOT us>
# Contributor: Frederik Alk√¶rsig (FALKER) <havnelisten AT gmail.com>

pkgname=thinkfan
pkgver=0.7.2
pkgrel=1
pkgdesc="A minimalist fan control program. Supports the sysfs hwmon interface and thinkpad_acpi"
arch=('i686' 'x86_64')
license=('GPL')
source=(http://downloads.sourceforge.net/project/${pkgname}/${pkgname}-${pkgver}.tar.gz "thinkfan")
url="http://thinkfan.sourceforge.net/"
backup=('etc/thinkfan.conf')
md5sums=('bb209657c5bcb5fa35b5a1e32833e5a8'
         '16fc3a83a1468e3ccaeba67e14ab2177')

build() {
    cd ${srcdir}/${pkgname}-${pkgver}
    make
    install -D -m755 ${pkgname} ${pkgdir}/usr/sbin/${pkgname}
    install -D -m755 ${srcdir}/${pkgname} ${pkgdir}/etc/rc.d/${pkgname}

    if ! [[ -f /proc/acpi/ibm/fan ]]; then 
        echo "thinkpad_acpi procfs entries don't seem to exist." \
        "You'll need to use the generic sysfs hwmon interface. Will use sysfs conf."
        install -D -m644 thinkfan.conf.sysfs ${pkgdir}/etc/thinkfan.conf
    else
        echo "This seems to be a Thinkpad. You should use the IBM" \
        "interface. Will use thinkfan conf."
        install -D -m644 thinkfan.conf.thinkpad ${pkgdir}/etc/thinkfan.conf
    fi
}

# vim:set ts=2 sw=2 noet:
