# Contributor: Frederik Alk√¶rsig (FALKER) <havnelisten AT gmail.com>
pkgname=thinkfan
pkgver=0.7
pkgrel=1
pkgdesc="A minimalist fan control program. Supports the sysfs hwmon interface and thinkpad_acpi"
arch=('i686' 'x86_64')
license=('GPL')
source=(http://phuk.ath.cx:3080/thinkfan/thinkfan-0.7.tar.gz "thinkfand")
url="https://phuk.ath.cx:3443/wordpress/?p=93"
md5sums=('575d3297f01061a7c9a5d2f0cb192cfa'
         '16fc3a83a1468e3ccaeba67e14ab2177')
backup=('etc/thinkfan.conf')

build() {
    cd $srcdir/thinkfan-0.7
    make
    install -d $startdir/pkg/usr/sbin
    install $srcdir/thinkfan-0.7/thinkfan $startdir/pkg/usr/sbin
    install -D -m755 ${startdir}/thinkfand ${pkgdir}/etc/rc.d/thinkfan

    if ! [[ -f /proc/acpi/ibm/fan ]]; then 
        echo "thinkpad_acpi procfs entries don't seem to exist." \
        "You'll need to use the generic sysfs hwmon interface. Will use sysfs conf."
        install -D -m644 thinkfan.conf.sysfs ${pkgdir}/etc/thinkfan.conf
    else
        echo "This seems to be a Thinkpad. You should use the IBM" \
        "interface. Will use thinkfan conf."
        install -D -m644 thinkfan.conf.thinkpad ${pkgdir}/etc/thinkfan.conf
    fi

}
