# Contributor: wido <widomaker2k7@gmail.com>
# Maintainer: SanskritFritz (gmail)

pkgname=logkeys-svn
pkgver=92
pkgrel=2
pkgdesc="Simple keylogger also supporting USB keyboards"
license=('GPL3')
arch=('i686' 'x86_64')
depends=('')
optdepends=('logkeys-keymap: for additional keymaps')
makedepends=('subversion')
conflicts=('logkeys')
provides=('logkeys')
url="http://logkeys.googlecode.com/"
source=(logkeysd.sh)
install=logkeys.install

md5sums=('aed9cd7a6775d7ec42fe71dc27dbf6cf')

_svnmod="logkeys"
_svntrunk="http://logkeys.googlecode.com/svn/trunk/"

build() {
	cd "$srcdir/"
	msg "Getting source..."
	if [ -d $_svnmod/.svn ]; then
		(cd $_svnmod && svn up)
	else
		svn co $_svntrunk $_svnmod
	fi

	msg "Creating make environment..."
	rm -rf $srcdir/$_svnmod/build/*
	mkdir -p "$pkgdir/usr/bin/"
	cd $srcdir/$_svnmod/build

	msg "Starting make..."
	../configure --prefix=/usr
	make || return 1
}

package() {
	cd $srcdir/$_svnmod/build
	make DESTDIR="$pkgdir/" install

	install -Dm0755 "${srcdir}/logkeysd.sh" "${pkgdir}/etc/rc.d/logkeys"
}
