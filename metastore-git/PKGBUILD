#Contributor: mathieu.clabaut <mathieu.clabaut@gmail.com>

pkgname=metastore-git
pkgver=20071221
pkgrel=1
pkgdesc="Store, compare and retrieve the metadata of files/directories/links
in a file tree to/from a separate file"
arch=('i686' 'x86_64')
url="http://david.hardeman.nu/software.php#metastore"
license=('GPL2')
provides=('metastore')
conflicts=('metastore')
source=()
md5sums=()

_gitroot="git://git.hardeman.nu/metastore.git"
_gitname="metastore"

build() {
  cd $startdir/src

  if [ -d $_gitname ]; then
    (cd $_gitname && git-pull origin)
  else
    git clone $_gitroot
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  [ -d $_gitname-build ] && rm -rf $_gitname-build 
  cp -r $_gitname $_gitname-build
  cd $_gitname-build

  sed -i -e 's+/share/man+/man+' Makefile

  make || return 1
  make DESTDIR=$startdir/pkg install || return 1

  install -d -m755 examples $startdir/pkg/usr/share/metastore/examples
  install -m644 examples/* $startdir/pkg/usr/share/metastore/examples

}

