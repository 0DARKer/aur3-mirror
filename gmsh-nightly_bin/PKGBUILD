# Contributor: mickele <mimocciola@yahoo.com>
# Contributor: gborzi <gborzi@ieee.org>
# Maintainer: Emanuele Rossi <nuovodna at gmail dot com>


pkgname=gmsh-nightly_bin
pkgver=2.4.3+svn
pkgrel=1
pkgdesc="Gmsh is an automatic 3D finite element mesh generator with pre and post-processing facilities."
arch=('i686' 'x86_64')
url="http://www.geuz.org/gmsh/"
license=('custom')
depends=('fltk' 'lapack')
makedepends=('cmake' 'desktop-file-utils' 'sed' 'coreutils')
optdepends=()
source=(http://www.geuz.org/gmsh/bin/Linux/gmsh-nightly-Linux.tgz gmsh-nightly.desktop)
md5sums=('5231c607341b0b3b7fe5326f95af86f1'
         '68223fa90439b2c8cd41b1ad18e7a540')	 

build(){
  cd "${srcdir}/gmsh-2.4.3-svn-Linux" || return 1

  # Intallation
  mkdir -p ${pkgdir}/opt/gmsh-nightly
  cp -a ./* ${pkgdir}/opt/gmsh-nightly || return 1

  # Scripts for running it
  mkdir -p ${pkgdir}/usr/bin/
  cat << EOF > ${pkgdir}/usr/bin/gmsh-nightly
#!/bin/bash
cd /opt/gmsh-nightly/bin
./gmsh \$@
EOF
 
  # Fixing permissions
  chmod 755 ${pkgdir}/usr/bin/gmsh-nightly || return 1

  # .desktop file 
  mkdir -p ${pkgdir}/usr/share/applications
  install -m 644 ${srcdir}/gmsh-nightly.desktop ${pkgdir}/usr/share/applications || return 1
  install -m 644 ${srcdir}/gmsh-nightly.desktop ${pkgdir}/usr/share/applications || return 1

} 
