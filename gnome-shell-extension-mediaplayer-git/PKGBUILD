# Maintainer: Alucryd <alucryd@gmail.com>
pkgname=gnome-shell-extension-mediaplayer-git
pkgver=20110606
pkgrel=1
pkgdesc="A mediaplayer indicator for the gnome-shell."
arch=('any')
url="http://github.com/horazont/gnome-shell-extensions-mediaplayer"
license=('GPL3')
depends=('gnome-shell')
makedepends=('git')

_gitroot="https://github.com/horazont/gnome-shell-extensions-mediaplayer"
_gitname="gnome-shell-extension-mediaplayer"

build() {
    cd ${srcdir}
    msg "Connecting to the GIT server..."
    if [[ -d ${srcdir}/${_gitname} ]] ; then
    	cd ${_gitname}
    	git pull origin
    	msg "The local files are updated..."
    else
    	git clone ${_gitroot} ${_gitname}
        cd ${_gitname}
    fi
    msg "GIT checkout done."
    cd media@sotecware.net
    msg "Modifying metadata to support latest version of gnome-shell."
    sed -i 's/3.0.1/3.0/g' metadata.json
    msg "Modifying extension to support player of your choice."
    echo "Please select your mediaplayer :"
    select mp in "Banshee" "Clementine" "Quod Libet" "Rhythmbox"; do
        case $mp in
            "Banshee" ) sed -i 's/rhythmbox/banshee/g' extension.js; break;;
            "Clementine" ) sed -i 's/rhythmbox/clementine/g' extension.js; break;;
            "Quod Libet" ) sed -i 's/rhythmbox/quodlibet/g' extension.js; break;;
            "Rhythmbox" ) break;;
        esac
    done
}

package() {
    cd "$srcdir/${_gitname}"
    mkdir -p "$pkgdir/usr/share/gnome-shell/extensions/"
    cp -R "media@sotecware.net" "$pkgdir/usr/share/gnome-shell/extensions"
}

