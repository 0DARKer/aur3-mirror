# Maintainer: Your Name <arik.kfir@gmail.com>

###################################################
# General information about the package
###################################################
pkgname=intellij-idea
pkgver=135.667
pkgrel=1
pkgdesc="The most intelligent IDE for Java and other technologies"
arch=('any')
url="http://www.jetbrains.com/idea/"
license=('unknown')
groups=('arikkfir')
depends=('java-environment' 'bash')
options=('emptydirs' '!strip')
changelog=ChangeLog
source=("${pkgname}::http://download.jetbrains.com/idea/ideaIU-${pkgver}.tar.gz"
        "${pkgname}-src::http://download.jetbrains.com/idea/ideaIC-${pkgver}-src.tar.bz2"
        "jetbrains-idea.desktop")
sha256sums=('061b69552c2e0c8c6d8d656cbde85f78e1bf2328648217d187bb800d085dddee'
            '289db9f2f0adc3ac1ef27d92e5548c09545796368dd916bb5f207f474f81d993'
            'e156cedc06fabecb771d6e768bb30745d0ee48d61f8d50f5030ba8d88e8ddd2c')

###################################################
# Package
###################################################
package() {
    
    targetDir="${pkgdir}/opt/jetbrains/${pkgname}"
    mkdir -p ${targetDir}
    mkdir -p ${targetDir}/src
    mkdir -p ${pkgdir}/usr/share/applications

    mv ${srcdir}/idea-IU-${pkgver}/* ${targetDir}
    cp ${srcdir}/jetbrains-idea.desktop ${pkgdir}/usr/share/applications
    mv ${srcdir}/ideaIC-${pkgver}/* ${targetDir}/src
    
    sed --in-place -e "
            s,-Xms.*,-Xms1g,g;
            s,-Xmx.*,-Xmx2g,g;
            s,-Dawt.useSystemAAFontSettings=lcd,-Dawt.useSystemAAFontSettings=on,g;" ${targetDir}/bin/idea.vmoptions
    echo "-Dswing.aatext=true" >> ${targetDir}/bin/idea.vmoptions
    sed --in-place -e "
            s,-Xms.*,-Xms1g,g;
            s,-Xmx.*,-Xmx2g,g;
            s,-Dawt.useSystemAAFontSettings=lcd,-Dawt.useSystemAAFontSettings=on,g;" ${targetDir}/bin/idea64.vmoptions
    echo "-Dswing.aatext=true" >> ${targetDir}/bin/idea64.vmoptions
                
}

