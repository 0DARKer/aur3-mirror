#Maintainer: Lothar_m <lothar_m at riseup dot net>

pkgname='ducklauncher'
_gitname='launcher'
pkgver=20140610
pkgrel=1
arch=('i686' 'x86_64')
url="https://github.com/the-duck/launcher"
depends=('python2-pyside' 'python2-xlib' 'pygtk' 'python2-wnck' 'python2-cssutils' 'hicolor-icon-theme')
makedepends=('git')
license=('GPL2')
pkgdesc="Duck Launcher Application Laucher by Mark Spurgeon <markspurgeon96@hotmail.com>"
provides=(ducklauncher)
conflicts=(ducklauncher)
install=ducklauncher.install
source=("git://github.com/the-duck/launcher.git"
	"duck-launcher.desktop"
	"ducklauncher.install"	)
md5sums=('SKIP'
         '4500989ac6761a81c53aa87c3d2c8499'
         '0b6211b511da48346cecdc1d2f963c76')

#pkgver() {
#	cd "$srcdir/$_gitname"
#	# Use tag of the last commit, but removing the prefix
#	git describe --long | sed -r 's/^v//;s/([^-]*-g)/r\1/;s/-/./g'
#}

build() {
	cd "${_gitname}"
	cd "$srcdir/$_gitname"
	## Make sure python2 is used instead of python
	sed -i 's/python/python2/' duck-launcher.desktop
	echo "" >> duck-launcher.desktop
	echo "Categories=Utility;Accessories;" >> duck-launcher.desktop
}


package() {
	## Install executables
	mkdir -p "$pkgdir/usr/bin/duck_launcher"
	install -D -m755 "$srcdir/$_gitname/duck_launcher/Apps.py" "$pkgdir/usr/bin/duck_launcher/Apps.py"
	install -D -m755 "$srcdir/$_gitname/duck_launcher/Config.py" "$pkgdir/usr/bin/duck_launcher/Config.py"
	install -D -m755 "$srcdir/$_gitname/duck_launcher/Files.py" "$pkgdir/usr/bin/duck_launcher/Files.py"
	install -D -m755 "$srcdir/$_gitname/duck_launcher/Main.py" "$pkgdir/usr/bin/duck_launcher/Main.py"
	install -D -m755 "$srcdir/$_gitname/duck_launcher/Settings.py" "$pkgdir/usr/bin/duck_launcher/Settings.py"
	install -D -m755 "$srcdir/$_gitname/duck_launcher/Window.py" "$pkgdir/usr/bin/duck_launcher/Window.py"
	install -D -m755 "$srcdir/$_gitname/duck_launcher/XlibStuff.py" "$pkgdir/usr/bin/duck_launcher/XlibStuff.py"

	## Install icons
	mkdir -p "$pkgdir/usr/share/duck_launcher/icons"
	mkdir -p "$pkgdir/usr/share/icons/hicolor/scalable"
	install -D -m644 "$srcdir/$_gitname/icons/add.svg" "$pkgdir/usr/share/duck_launcher/icons/add.svg"
	install -D -m644 "$srcdir/$_gitname/icons/apps.svg" "$pkgdir/usr/share/duck_launcher/icons/apps.svg"
	install -D -m644 "$srcdir/$_gitname/icons/back.svg" "$pkgdir/usr/share/duck_launcher/icons/back.svg"
	install -D -m644 "$srcdir/$_gitname/icons/close.svg" "$pkgdir/usr/share/duck_launcher/icons/close.svg"
	install -D -m644 "$srcdir/$_gitname/icons/file.svg" "$pkgdir/usr/share/duck_launcher/icons/file.svg"
	install -D -m644 "$srcdir/$_gitname/icons/folder.svg" "$pkgdir/usr/share/duck_launcher/icons/folder.svg"
	install -D -m644 "$srcdir/$_gitname/icons/home.svg" "$pkgdir/usr/share/duck_launcher/icons/home.svg"
	install -D -m644 "$srcdir/$_gitname/icons/open-apps.svg" "$pkgdir/usr/share/duck_launcher/icons/open-apps.svg"
	install -D -m644 "$srcdir/$_gitname/icons/quit.svg" "$pkgdir/usr/share/duck_launcher/icons/quit.svg"
	install -D -m644 "$srcdir/$_gitname/icons/settings.svg" "$pkgdir/usr/share/duck_launcher/icons/settings.svg"
	install -D -m644 "$srcdir/$_gitname/icons/star.svg" "$pkgdir/usr/share/duck_launcher/icons/star.svg"
	install -D -m644 "$srcdir/$_gitname/icons/win.svg" "$pkgdir/usr/share/duck_launcher/icons/win.svg"
	install -D -m644 "$srcdir/$_gitname/duck-launcher.svg" "$pkgdir/usr/share/icons/hicolor/scalable/duck-launcher.svg"

	## Install Desktop File
	mkdir -p "$pkgdir/usr/share/applications"
	install -D -m644 "$srcdir/duck-launcher.desktop" "$pkgdir/usr/share/applications/duck-launcher.desktop"
}
