--- src/ksubtitleripper-0.3.1/src/convertdialog.cpp	2005-05-20 14:11:03.000000000 +0200
+++ src-work/ksubtitleripper-0.3.1/src/convertdialog.cpp	2007-06-19 13:16:32.000000000 +0200
@@ -166,11 +166,11 @@
 
 	// TODO check if gocr is executable
 
-	*proc << "gocr" << "-p" << databasePath;
-	*proc << "-s" << "10" << "-m" << "130";
-	*proc << "-f" << Config().subEncoding();
-	*proc << filename + ".pgm" << "-o" << filename + ".pgm.txt";
-
+	*proc << "gocr" << " -p " << databasePath;
+	*proc << " -s " << "10 " << "-m " << "130 ";
+	*proc << "-f " << Config().subEncoding();
+	*proc << " " << filename + ".pgm " << " -o " << filename + ".pgm.txt";
+	
 	if ( !proc->start( KProcess::NotifyOnExit, KProcess::All ) )
 		kdError() << "error executing process\n";
 }
@@ -197,7 +197,7 @@
 	QStringList buf = QStringList::split( '\n', QString::fromLatin1( buffer, buflen ) );
 
 	for ( uint i = 0; i < buf.count(); i++ ) {
-		if ( buf[i].startsWith( "# list pattern" ) ) {
+		if ( buf[i].startsWith( "# list pattern" ) || buf[i].startsWith( "# show box" ) ) {
 			QRegExp regExp( "\\b\\d+\\b" );
 			int pos, x, y, w, h;
 
@@ -214,7 +214,7 @@
 			// load the subtitle and mark the unknown cluster on the image
 			loadSubtitle( QRect( x, y, w, h) );
 
-		} else if ( buf[i].startsWith( "The upper char" ) ) {
+		} else if ( buf[i].startsWith( "The upper char" ) || buf[i].startsWith("The above pattern") ) {
 			m_correctString->setEnabled( true );
 			editChanged( m_line->text() );
 			m_line->setFocus();
@@ -241,7 +241,10 @@
 void ConvertDialog::writeStdin( KProcess *proc, QString data ) {
 	QString aux = data + '\n';
 
-	toSent.append( qstrdup( aux.local8Bit().data() ) );
+	QCString tmp = qstrdup( aux.local8Bit().data());
+	tmp = tmp.mid(1,tmp.length() - 3 );
+	tmp.append("\n");
+	toSent.append( qstrdup(tmp) );
 	if ( !sending ) {
 		sending = true;
 		proc->writeStdin( toSent.first(), strlen( toSent.first() ) );
