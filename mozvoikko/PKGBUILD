# Contributor: Jussi Timperi <jussi.timperi at gmail dot com>

pkgname=mozvoikko
pkgver=1.10.0
pkgrel=2
pkgdesc="Finnish spell-checker extension for Firefox using Voikko"
arch=('i686' 'x86_64')
url="http://voikko.sourceforge.net"
license=('GPL2')
depends=('firefox' 'libvoikko')
makedepends=('xulrunner')
source=(http://downloads.sourceforge.net/voikko/$pkgname-$pkgver.tar.gz
        "http://voikko.svn.sourceforge.net/viewvc/voikko/trunk/mozvoikko/mozvoikko.config?revision=3983")

build() {
  cd "$srcdir/$pkgname-$pkgver"

  CFLAGS="${CFLAGS} -fno-strict-aliasing -std=gnu++0x"

  sed 's|libxul-unstable|libxul|'		-i src/Makefile.xulrunner
  sed 's|$(CC_LIBS)|$(CC_LIBS) -lmozalloc|'	-i src/Makefile.xulrunner

  ##Support FF6
  cp '../mozvoikko.config?revision=3983' ./mozvoikko.config

  make -f Makefile.xulrunner extension-files
}

package() {
  cd "$srcdir/$pkgname-$pkgver"

  make -f Makefile.xulrunner DESTDIR="$pkgdir/usr/lib/firefox-6.0/extensions" install-unpacked
}

md5sums=('2b88a22a740635760aadbcee7dc3d6ef'
         'c7d577cb86aadc9f6e64a5f2b8845c79')
