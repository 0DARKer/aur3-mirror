# Contributor: max.bra <max.bra at alice dot it>
# Maintainer: max.bra <max.bra at alice dot it>

pkgname=gnome-exe-thumbnailer
pkgver=0.7
pkgrel=7
pkgintver=0ubuntu1~lucid1
pkgdesc="Wine .exe and other executable thumbnailer for Gnome"
arch=('any')
url="https://launchpad.net/~ubuntu-wine"
license=('LGPL')
depends=('imagemagick' 'icoutils')
makedepends=()
optdepends=()
install=$pkgname.install
source=(https://launchpad.net/ubuntu/+archive/primary/+files/${pkgname}_${pkgver}-${pkgintver}.tar.gz icotool-wrong-icon.patch gnome-exe-thumbnailer.thumbnailer)
md5sums=('3d3f60753a9614fec62d33a1c1b4c60b' '6d3bbf896789348f4887fa52d1f8a6a8' 'aa30ba4c310f4f89c9bef824f9a74337')

build() {
	# icotool non-bug: index is correct but extract wrong icon on terrible icon packs
	patch "${srcdir}"/${pkgname}-${pkgver}/${pkgname}.sh -i icotool-wrong-icon.patch
}

package() {
	install -D -m755 "${srcdir}"/${pkgname}-${pkgver}/${pkgname}.sh "${pkgdir}"/usr/bin/${pkgname}.sh
	
	# old thumbnailer schemas	
	#install -D -m644 "${srcdir}"/${pkgname}-${pkgver}/${pkgname}.schemas "${pkgdir}"/usr/share/gconf/schemas/${pkgname}.schemas

	install -D -m644 "${srcdir}"/${pkgname}-${pkgver}/generic.png "${pkgdir}"/usr/share/pixmaps/${pkgname}/generic.png
	install -D -m644 "${srcdir}"/${pkgname}-${pkgver}/generic-exe.png "${pkgdir}"/usr/share/pixmaps/${pkgname}/generic-exe.png
	install -D -m644 "${srcdir}"/${pkgname}-${pkgver}/generic-installer.png "${pkgdir}"/usr/share/pixmaps/${pkgname}/generic-installer.png
	install -D -m644 "${srcdir}"/${pkgname}-${pkgver}/template.png "${pkgdir}"/usr/share/pixmaps/${pkgname}/template.png

	# gnome 3 new thumbnailer
	install -D -m644 "${srcdir}"/gnome-exe-thumbnailer.thumbnailer "${pkgdir}"/usr/share/thumbnailers/gnome-exe-thumbnailer.thumbnailer
}
