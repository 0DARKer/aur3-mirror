# Maintainer: xRemaLx <anton.komolov@gmail.com>

pkgname=a4tool-git
pkgver=20121124
pkgrel=1
pkgdesc="Tools for control your smart mouse. A4Tech G10-700F, and other \"Oscar mouse's\"."
arch=('x86_64' 'i686')
url="https://github.com/Marisa-Chan/init-gmouse"
license=('BSD')
options=('!strip' '!emptydirs')
depends=("libusbx>=1.0")
source=("40-a4tech-usb-devices.rules")
md5sums=("38c96db4897f72fe1c8cc898d0282114")
_gitroot="git://github.com/Marisa-Chan/init-gmouse.git"
_gitname="init-gmouse"

build() {
  cd "$srcdir"

  msg "Connecting to the $_gitname git repository..."
  if [ -d "$srcdir/$_gitname" ] ; then
    cd $_gitname && git pull origin
    msg "The local files are updated."
  else
    git clone $_gitroot
  fi

  msg "GIT checkout done or server timeout"
  cd "$srcdir"
  rm -rf $_gitname-build
  git clone $_gitname $_gitname-build
  cd "$_gitname-build"
  cd libgmouse
  make
  cd ../a4_tool
  make
}

package() {
  mkdir -p "$pkgdir/usr/lib/udev/rules.d"
  mkdir -p "$pkgdir/usr/bin"
  install -m644 "40-a4tech-usb-devices.rules" "$pkgdir/usr/lib/udev/rules.d/"
  install -m755 "$_gitname-build/a4_tool/a4_tool" "$pkgdir/usr/bin/a4_tool"
}

# vim:set ts=2 sw=2 et:
