# Maintainer: Kilian Lackhove <kilian.lackhove@gmail.com>

pkgname='m4baker-git'
pkgver=20130130
pkgrel=1
pkgdesc="Bake full-featured m4b-audiobooks"
arch=('any')
url='http://code.google.com/p/m4baker/'
license=('GPL3')
depends=('sox' 'faac' 'libmp4v2' 'python2-qt')
makedepends=('git' 'python2-distribute')
provides=('m4baker')
conflicts=('m4baker')
replaces=('m4baker')

_gitroot="https://github.com/crabmanX/m4baker.git"
_gitname="m4baker"
_gitbranch="master"

build() {
  cd "$srcdir"

  msg2 "Connecting to GIT server..."
  if [[ -d "$_gitname" ]]; then
    cd "$_gitname" && git pull origin
    msg2 "The local files are updated."
  else
    git clone -b "$_gitbranch" "$_gitroot" "$_gitname"
  fi
  msg2 "GIT checkout done or server timeout."

  cd "$srcdir/$_gitname"
  git checkout "$_gitbranch"
  python2 setup.py build
}

package() {
  cd "$srcdir/$_gitname"
  python2 setup.py install --prefix=/usr --root="$pkgdir" || return 1
}
