# Contributors:
#   henning mueller <henning@orgizm.net>

pkgname=legend-of-grimrock
pkgdesc='A 3D grid-based dungeon crawler inspired by classic 1980s and 1990s action role-playing games Dungeon Master, Eye of the Beholder and Ultima Underworld.'
url='http://www.grimrock.net/'
_pkgdate=2012-12-18
pkgver=20121218
pkgrel=2
arch=(i686 x86_64)
license=(custom)
depends=(
  freeimage minizip sdl2-hg libvorbis freetype2 zlib openal libgl libx11
  gcc-libs-multilib libogg libxext
)

[ "$CARCH" = "i686" ] && _arch=x86 || _arch=x86_64

package() {
  sh LegendOfGrimrock-Linux-$_pkgdate.sh --tar xf

  _target=$pkgdir/usr/share/$pkgname

  mkdir -p $_target
  lzma -d < instarchive_linux_$_arch | tar xf - -C $_target
  lzma -d < instarchive_all | tar xf - -C $_target

  mkdir -p $pkgdir/usr/bin
  ln -s ../share/$pkgname/Grimrock.bin.$_arch $pkgdir/usr/bin/$pkgname
}
