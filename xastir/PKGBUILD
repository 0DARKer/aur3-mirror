#Maintainer: Gordon JC Pearce <gordon@gjcp.net>
pkgname=xastir
pkgver=2.0.0
pkgrel=1
pkgdesc="Full featured APRS Tracking/Information Reporting System"
url="http://www.xastir.org/"
makedepends=('autoconf' 'automake')
depends=('lesstif' 'shapelib' 'curl' 'libax25' 'libxml2' 'libpng' 'gv' 'gdal'\
  'gpsman' 'gpsmanshp' 'imagemagick')

source=(http://downloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.gz
        http://downloads.sourceforge.net/$pkgname/$pkgname-sounds.tgz
        $pkgname.desktop
        $pkgname-festival.desktop
        $pkgname-speech
        $pkgname.png
        Makefile.am.patch
        )
#http://www.swcp.com/~russo/shape_web/sdtsrd2.dbfawk
arch=('i686' 'x86_64')
license=('GPL' 'LGPL')

md5sums=('3e660b8168c9037b06e20b0579af3c80'
         '4201e7079cb5b2bd8a7c34dccfa3f2bb'
         'a2b560b97a10c9c132ab0db24435ab3c'
         '38431e4985b2002a68444be502be3973'
         'e56e55a1c43038d4488fbdd429a0a755'
         '0a7269113052d3bd2711b84ff2fda9d6'
         'cb95459f2fd556e76fbaea2314ed0ff3')

build() {
  cd $startdir/src/$pkgname-$pkgver
  patch -p0 < $srcdir/Makefile.am.patch
  ./configure --prefix=/usr
  
  
  sed -i -e s:doc/xastir:xastir/doc: Makefile
  
  make || return 1
  make DESTDIR=$startdir/pkg install
  
  cd $startdir/src
  mkdir -p $startdir/pkg/usr/share/pixmaps
  mkdir -p $startdir/pkg/usr/share/applications
  install -m644 *.desktop $startdir/pkg/usr/share/applications/
  install -m644 *.png $startdir/pkg/usr/share/pixmaps/
  
  install -m755 $pkgname-speech $startdir/pkg/usr/bin/
  
  rm $startdir/pkg/usr/share/$pkgname/sounds/*
  install -m644 sounds/* $startdir/pkg/usr/share/$pkgname/sounds/
  
  chmod 4755 $startdir/pkg/usr/bin/$pkgname
}

