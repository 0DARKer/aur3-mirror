# Maintainer: RazrFalcon <razrfalcon@gmail.com>
# Contributor: N30N <archlinux@alunamation.com>

pkgname="svgcleaner"
pkgver=0.5
pkgrel=1
pkgdesc="An application that cleans svg images from unnecessary data in batch mode."
provides=("svg-cleaner")
arch=("i686" "x86_64")
url="https://launchpad.net/svg-cleaner"
license=("GPL3")
makedepends=("qt4")
depends=("p7zip" "qt4")
source=("svgcleaner.install" \
"https://github.com/RazrFalcon/SVGCleaner/archive/v${pkgver}.tar.gz")
install="svgcleaner.install"
md5sums=('810885f50b9792377a5a0b9335e232b8'
         'c10405248ed01ace11e79ae5f25de03f')

build() {
cd "${srcdir}/SVGCleaner-${pkgver}"
qmake-qt4 src/cli/svgcleaner-cli.pro CONFIG+="release"
make

# fix lrelease name
sed 's/QMAKE_LRELEASE = lrelease/QMAKE_LRELEASE = lrelease-qt4/' -i translations/translations.pri

qmake-qt4 src/gui/svgcleaner-gui.pro CONFIG+="release"
make
}

package() {
cd "${srcdir}/SVGCleaner-${pkgver}"
mkdir -p "${pkgdir}/usr/bin"
mkdir -p "${pkgdir}/usr/share/svgcleaner/presets"
mkdir -p "${pkgdir}/usr/share/svgcleaner/translations"
mkdir -p "${pkgdir}/usr/share/icons/hicolor/scalable/apps/"
mkdir -p "${pkgdir}/usr/share/applications/"
install -m755 "svgcleaner-cli" "${pkgdir}/usr/bin/svgcleaner-cli"
install -m755 "svgcleaner-gui" "${pkgdir}/usr/bin/svgcleaner-gui"
install -m644 "presets/Soft.preset" "${pkgdir}/usr/share/svgcleaner/presets/Soft.preset"
install -m644 "presets/Normal.preset" "${pkgdir}/usr/share/svgcleaner/presets/Normal.preset"
install -m644 "presets/Optimal.preset" "${pkgdir}/usr/share/svgcleaner/presets/Optimal.preset"
install -m644 "svgcleaner_cs.qm" "${pkgdir}/usr/share/svgcleaner/translations/svgcleaner_cs.qm"
install -m644 "svgcleaner_ru.qm" "${pkgdir}/usr/share/svgcleaner/translations/svgcleaner_ru.qm"
install -m644 "svgcleaner_uk.qm" "${pkgdir}/usr/share/svgcleaner/translations/svgcleaner_uk.qm"
install -m644 "svgcleaner_de.qm" "${pkgdir}/usr/share/svgcleaner/translations/svgcleaner_de.qm"
install -m644 "icons/svgcleaner.svg" "${pkgdir}/usr/share/icons/hicolor/scalable/apps/svgcleaner.svg"
install -m644 "svgcleaner.desktop" "${pkgdir}/usr/share/applications/svgcleaner.desktop"
}
