# Maintainer: Alexander 'z33ky' Hirsch <1zeeky@gmail.com>

pkgname=btogre-git
pkgver=20130221
pkgrel=2
pkgdesc="A thin Bullet-Ogre connection."
arch=('i686' 'x86_64')
url="http://www.ogre3d.org/forums/viewtopic.php?f=5&t=46856"
license=('zlib')
depends=('bullet' 'ogre')
makedepends=('git')
source=('cmake-targets.patch')
md5sums=('04de7ba58a645b96739e50092ae7a067')
sha1sums=('b705573e40bf33f3ee76f08ebead2b67f577fa4c')

_gitroot="git://github.com/nikki93/btogre.git"
_gitname="btogre"

build() {
  cd ${srcdir}

  msg "Connecting to GIT server..."
  if [[ -d ${_gitname} ]]; then
    (cd ${_gitname} && git pull origin)
  else
    git clone ${_gitroot} ${_gitname}
  fi
  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  rm -rf ${_gitname}-build
  git clone --depth 1 file://${srcdir}/${_gitname} ${_gitname}-build

  cd ${srcdir}/${_gitname}-build

  patch -Np1 -i ${srcdir}/cmake-targets.patch

  cmake -DCMAKE_INSTALL_PREFIX:PATH=/usr
  make
}

package() {
  cd ${srcdir}/${_gitname}-build

  make DESTDIR=${pkgdir} install
}
