# Contributor: h31 <h31mail@yandex.com>

pkgname=qmmp-svn-stable
pkgver=1746
pkgrel=1
pkgdesc="A Qt4 based audio-player - svn version (stable 0.4.x branch)"
arch=('i686' 'x86_64')
url="http://qmmp.ylsoftware.com"
license=('GPL')
depends=('alsa-lib' 'curl' 'hicolor-icon-theme' 'libmad' 'libvorbis' 'libogg'  'qt>=4.3' 'taglib' 'xdg-utils')
makedepends=('cmake'  'flac' 'jack' 'libmpcdec' 'pulseaudio' 'ffmpeg' 'libsamplerate' 'libmodplug' 'libsndfile' 'wavpack')
optdepends=('flac: native FLAC support'
            'jack: JACK sound output'
            'libmpcdec: Musepack support'
            'pulseaudio: PulseAudio output'
            'libmodplug: MOD playing library'
            'libsndfile: sampled sound support'
            'ffmpeg' 'libsamplerate' 'wavpack')
install=$pkgname.install
provides=('qmmp' 'qmmp-svn')
conflicts=('qmmp' 'qmmp-svn')
source=()
md5sums=()

_svntrunk=http://qmmp.googlecode.com/svn/branches/qmmp-0.4/
_svnmod=qmmp

build() {

  svn co $_svntrunk $_svnmod

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  cp -r $_svnmod $_svnmod-build
  cd $_svnmod-build

  cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_BUILD_TYPE=RELEASE

  make || return 1
  make DESTDIR="${pkgdir}" install || return 1

  rm -rf ${srcdir}/$_svnmod-build
}
 
