# Maintainer: Det <nimetonmaili at gmail a-dot com>
# Contributor: Lee Jackson <tomoe AT lbjackson DOTCOM>
# Based on [extra]'s wine

pkgname=bin32-wine-suse
pkgver=1.3.19
pkgrel=6
_suserel=1.${pkgrel}
pkgdesc="A compatibility layer for running Windows programs - prebuilt openSUSE i586 build"
url="http://en.opensuse.org/Wine"
install=${pkgname}.install
arch=(x86_64)
license=(LGPL)
depends=('lib32-fontconfig' 'lib32-mesa' 'lib32-libxcursor' 'lib32-libxrandr' 'lib32-libxdamage' 'lib32-libxxf86dga' 'lib32-alsa-lib' 'desktop-file-utils')
makedepends=('libarchive>=2.4.12' 'rpmextract')
optdepends=('lib32-giflib' 'lib32-libpng' 'lib32-libldap' 'lib32-lcms' 'lib32-libxml2' 'lib32-mpg123' 'lib32-openal' 'lib32-jack' 'lib32-libcups' 'lib32-gnutls' 'lib32-v4l-utils' 'wine_gecko'
            'zenity: GUI for GNOME desktop'
            'kdebase-kdialog: GUI for KDE desktop')
provides=("wine=${pkgver}" "bin32-wine=${pkgver}" "bin32-winetricks=${pkgver}")
conflicts=('wine' 'bin32-wine' 'bin32-winetricks')
source=(http://download.opensuse.org/repositories/Emulators:/Wine/openSUSE_Factory/i586/wine-${pkgver}-${_suserel}.i586.rpm
        http://download.opensuse.org/repositories/Emulators:/Wine/openSUSE_Factory/i586/wine-32bit-${pkgver}-${_suserel}.i586.rpm
        http://download.opensuse.org/repositories/Emulators:/Wine/openSUSE_Factory/i586/wine-devel-${pkgver}-${_suserel}.i586.rpm)
md5sums=(`wget ${source}.md5 -qO - | cut -d " " -f1`
         `wget ${source[1]}.md5 -qO - | cut -d " " -f1`
         `wget ${source[2]}.md5 -qO - | cut -d " " -f1`)

package() {
  rpmextract.sh wine-*.i586.rpm
  rpmextract.sh wine-32bit-*.i586.rpm
  rpmextract.sh wine-devel-*.i586.rpm

### Clean up unnecessary desktop entries
  rm usr/share/applications/wine-*

### Re-arrange docs
  mv usr/share/doc/{packages/wine,wine}
  rmdir usr/share/doc/packages

  mv usr/ "${pkgdir}"
}