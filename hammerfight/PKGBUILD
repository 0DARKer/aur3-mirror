# Maintainer: Gadget3000 <gadget3000 at msn dot com>

pkgname=hammerfight
pkgver=20111707
pkgrel=2
pkgdesc="A 2D physics-based video game in which you swing large melee weapons to destroy enemies"
arch=('i686' 'x86_64')
url="http://www.koshutin.com/"
license=('unknown')
groups=('humblebundle3' 'humblebundles')
makedepends=('unzip')
source=(hammerfight.desktop)
md5sums=('195982a823b269ddca43452314dba501')

_archive="hf-linux-07172011-bin"
_archive_md5="4b979c6d0741aa0626018cf451309c25"

build() {
  install -Dd ${srcdir}/extractedInstaller
  cd $srcdir

  if [ ! -f ${_archive} ]; then
	  echo Please place hf-linux-07172011-bin into $(pwd)
	  echo Press Enter to continue
	  read -a _unused
  fi

  if ! echo "${_archive_md5}  ${_archive}" | md5sum -c --quiet; then
    echo "Invalid checksum for ${_archive}"
    return 1
  fi

  install -Dd ${pkgdir}/opt/
  unzip -qqo hf-linux-07172011-bin -x guis/* meta/* scripts/* -d ${srcdir}/extractedInstaller/ && msg Finished Extracting
  install -Dd ${pkgdir}/opt/hammerfight
  mv ${srcdir}/extractedInstaller/data/* ${pkgdir}/opt/hammerfight/
  install -Dd ${pkgdir}/usr/bin
  echo \#\!/bin/bash > ${pkgdir}/usr/bin/hammerfight
  echo /opt/hammerfight/Hammerfight >> ${pkgdir}/usr/bin/hammerfight
  chmod +x ${pkgdir}/usr/bin/hammerfight

  install -D ${srcdir}/hammerfight.desktop ${pkgdir}/usr/share/applications/hammerfight.desktop
}
