# Maintainer : Mark E. Lee <mark@markelee.com>

pkgname=libreoffice-rpm
pkgver=4.0
pkgrel=0
pkgpat=3
pkgdesc="LGPL Office Suite installed from rpms"
arch=('i686' 'x86_64')
url='http://www.libreoffice.org'
license=('LGPL')
makedepends=('rpmextract')
if [ "$(uname -m)" == "i686" ]; then  ## convert bit architecture to libreoffice format
  arch_mod='x86';
  md5sums=('c0c60aedaf885c4c446783ac496bbe30');
 else
  arch_mod='x86_64';
  md5sums=('4d644278ef42137c508a062738288fe1')
fi;
source=("http://download.documentfoundation.org/libreoffice/stable/${pkgver}.${pkgrel}/rpm/${arch_mod}/LibreOffice_${pkgver}.${pkgrel}_Linux_${arch_mod/_/-}_rpm.tar.gz")

build () {   ## build function

   ## Get libreoffice libraries
   cd ${srcdir}/LibreOffice_${pkgver}.${pkgrel}.${pkgpat}_Linux_${arch_mod/_/-}_rpm/RPMS;  ## enter the rpms directory
   for a in *.rpm; do  ## loop for all rpm files found
      rpmextract.sh $a;  ## extract the rpm files
   done;
   cp -r opt ${pkgdir}/;  ## copy the opt directory to the package directory
   chmod 755 ${pkgdir}/opt;  ## change directory permissions to read/write/execute for root, read/execute only for other users
   
   ## Get desktop icons for libreoffice
   cd ${srcdir}/LibreOffice_${pkgver}.${pkgrel}.${pkgpat}_Linux_${arch_mod/_/-}_rpm/RPMS/desktop-integration;  ## enter the desktop integration directory
   rpmextract.sh libreoffice${pkgver}-freedesktop-menus-${pkgver}.${pkgrel}-103.noarch.rpm;  ## extract the desktop files
   cp -r usr ${pkgdir}/;  ## copy the usr directory to the package directory
   chmod 755 ${pkgdir}/usr;  ## change directory permissions to read/write/execute for root, read/execute only for other users
}