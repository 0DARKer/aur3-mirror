# Maintainer: skydrome <skydrome@i2pmail.org>
# Contributors: Charles Ghislain, Guillaume ALAUX, Daniel J Griffiths, Jason Chu, Geoffroy Carrier, Army, kfgz, Thomas Dziedzic, Dan Serban, jjacky, EasySly, Det

pkgname=ejre
_major=7
_minor=21
_build=b11
_date=4_apr_2013
pkgver="${_major}.${_minor}"
pkgrel=2
pkgdesc="Java SE Embedded Runtime Environment $_major"
arch=('i686' 'armv6h')
url="http://www.oracle.com/technetwork/java/embedded/downloads/index.html"
license=('custom')
makedeps=('git')
conflicts=("${provides[@]}" 'java-environment')
provides=("java-runtime=$_major" "java-runtime-headless=$_major")
backup=('etc/profile.d/jre.sh')
options=(!strip)
install='jre.install'

[[ "$CARCH" = 'armv6h' ]] && _branch=arm || _branch=x86
source=("git://github.com/skydrome/ejre.git#branch=${_branch}"
        'jre.sh')
md5sums+=('SKIP'
          '1efe5755b77f4533bd5b9f4728b40fad')

package() {
    cd "$srcdir/ejre/ejre1.${_major}.0_${_minor}"
    mkdir -p "${pkgdir}"/{opt/$pkgname/jre,usr/{bin,/share/licenses/$pkgname},etc/{.java/.systemPrefs,profile.d}}
    cp -r COPYRIGHT *.txt "$pkgdir"/usr/share/licenses/$pkgname/
    cp -r * "$pkgdir"/opt/$pkgname/jre/
    ln -s /opt/java-$pkgname/jre/bin/java "$pkgdir"/usr/bin/java
    install -m755 "$srcdir"/jre.sh "$pkgdir"/etc/profile.d/
}