# Contributor: Sergio Montesinos <sermonpe@yahoo.es>

pkgname=rosa-icons
pkgver=1.0.35
pkgrel=2
pkgdesc="ROSA icons theme."
arch=('any')
url="http://www.rosalinux.com"
license=('GPL')
depends=('gnome-icon-theme')
makedepends=('rpmextract' 'fdupes' 'inkscape')
source=("http://mirror.yandex.ru/rosa/rosa2012.1/repository/SRPMS/main/release/${pkgname}-${pkgver}-1.src.rpm")
md5sums=('0dc44bcd104e5e903f3687f02ee231ef')

build() {
  cd "${srcdir}"
  rpmextract.sh "${pkgname}-${pkgver}-1.src.rpm"
  install -dm755 "${pkgdir}/usr/share/icons"
  tar -Jxf "rosa-${pkgver}.tar.xz"
  # A hack from rosa-icons.spec
  # An ugly hack to work with Ikscape.
  # TODO: Neccessary find a real problem!
  cd "${srcdir}/rosa-${pkgver}/places/16"
  for i in `ls`
  do
    echo "Converting $i to plain SVG."
    inkscape -l $i $i
  done
  # devices icons should be converted too
  cd "${srcdir}/rosa-${pkgver}/devices/16"
  for i in `ls`
  do
    echo "Converting $i to plain SVG."
    inkscape -l $i $i
  done
  cd "${srcdir}"
  fdupes -s "${srcdir}/rosa-${pkgver}"
  mv -v "rosa-${pkgver}" "${pkgdir}/usr/share/icons"

}
