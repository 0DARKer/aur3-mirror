# Contributor: fnord0 < fnord0 AT riseup DOT net >
# Maintainer: Barry Keegan < barrykeegan AT gmail DOT com >

pkgname=maltego
pkgver=3.5.3
pkgrel=1
pkgdesc="Maltego Radium Community Edition - a proprietary software for open source intelligence and forensics"
arch=('i686' 'x86_64')
url="http://www.paterva.com/web6/products/maltego.php"
license=('custom')
depends=('java-runtime')
install=$pkgname.install
source=("https://www.paterva.com/malv35/community/MaltegoCarbonCE.v$pkgver.zip"
	"http://www.paterva.com/web6/documentation/M3GuideGUI.pdf")
md5sums=('c35d5c5a35247b154a45486c7c4c6126'
	 'baa2896367542f25d5588049bc4add37')
sha1sums=('773cc7f7325ae1b41301fb199526d67a06441710'
	  'b3d496acaa2fbd5a0fd0409aafc0af05280db736')

package() {
  cd ${srcdir}/MaltegoCarbonCE
  install -d ${pkgdir}/usr/share/${pkgname} || return 1
  install -d ${pkgdir}/usr/share/${pkgname}/doc || return 1
  install -d ${pkgdir}/usr/bin || return 1 
  #install -d ${pkgdir}/usr/share/licenses/${pkgname} || return 1
  # the COMMERCIAL client license resides @ https://www.paterva.com/web5/server/MaltegoServerAgreement.pdf
  cp -pR bin etc groovy ide java maltego maltego-core-platform maltego-ui platform ${pkgdir}/usr/share/maltego || return 1
  install -Dm644 ${startdir}/M3GuideGUI.pdf ${pkgdir}/usr/share/${pkgname}/doc/M3GuideGUI.pdf || return 1

  #create startup app
  echo "#!/bin/sh" > ${pkgdir}/usr/bin/${pkgname}
  echo "cd /usr/share/maltego/bin" >> ${pkgdir}/usr/bin/${pkgname}
  echo "./maltego \"\$@\"" >> ${pkgdir}/usr/bin/${pkgname}
  echo "cd -" >> ${pkgdir}/usr/bin/${pkgname}
  chmod +x ${pkgdir}/usr/bin/${pkgname}
}
