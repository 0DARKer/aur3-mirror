# Contributor: fnord0 < fnord0 AT riseup DOT net >
# Maintainer: Michael Egger <gcarq at yahoo dot com>

pkgname=maltego
pkgver=3.4.0.5004
pkgrel=3
pkgdesc="Maltego Radium Community Edition - a proprietary software for open source intelligence and forensics"
arch=('i686' 'x86_64')
url="http://www.paterva.com/web6/products/maltego.php"
license=('custom')
depends=('java-runtime')
install=$pkgname.install
source=("https://www.paterva.com/malv34/community/MaltegoCE.v$pkgver.zip"
	"http://www.paterva.com/malv3/303/M3GuideGUI.pdf")
md5sums=('57b9c4e0b0f34682e34b9131370f909e'
	 'baa2896367542f25d5588049bc4add37')
sha1sums=('e2a29f01b05ce3ced56c09a9a847659070f97746'
	  'b3d496acaa2fbd5a0fd0409aafc0af05280db736')

package() {
  cd ${srcdir}/MaltegoTungstenCE3.4.0.5004
  install -d ${pkgdir}/usr/share/${pkgname} || return 1
  install -d ${pkgdir}/usr/share/${pkgname}/doc || return 1
  install -d ${pkgdir}/usr/bin || return 1 
  #install -d ${pkgdir}/usr/share/licenses/${pkgname} || return 1
  # the COMMERCIAL client license resides @ https://www.paterva.com/web5/server/MaltegoServerAgreement.pdf
  cp -pR bin etc groovy ide java maltego maltego-core-platform maltego-ui platform ${pkgdir}/usr/share/maltego || return 1
  install -Dm644 ${startdir}/M3GuideGUI.pdf ${pkgdir}/usr/share/${pkgname}/doc/M3GuideGUI.pdf || return 1

  #create startup app
  echo "#!/bin/sh" > ${pkgdir}/usr/bin/${pkgname}
  echo "cd /usr/share/maltego/bin" >> ${pkgdir}/usr/bin/${pkgname}
  echo "./maltego \"\$@\"" >> ${pkgdir}/usr/bin/${pkgname}
  echo "cd -" >> ${pkgdir}/usr/bin/${pkgname}
  chmod +x ${pkgdir}/usr/bin/${pkgname}
}
