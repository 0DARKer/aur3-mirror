# Maintainer: Stephen Zhang <zsrkmyn at gmail dot com>

########################################### NOTICE!!! #######################################
# To use this PKGBUILD, you need to download the source package from http://www.segger.com. #
# Go to this webpage: "http://www.segger.com/jlink-software.html" and download              #
# "Software and documentation pack for Linux V4.88b, TGZ archive xx-bit version [x,xxx kb]".#
# Place the package you downloaded together with this PKGBUILD and run "makepkg -s".        #
#############################################################################################

pkgname=j-link-software-and-documentation
pkgver=V4.88b
_pkgver=V488b
pkgrel=1
pkgdesc="J-Link software & documentation pack for Linux"
arch=('x86_64' 'i686')
url="http://www.segger.com/jlink-software.html"
license=('custom')
depends=('libedit')
source=("JLink_Linux_${_pkgver}_x86_64.tgz::http://xxx")
if [ "$CARCH" = "x86_64" ]; then
	md5sums=('3584c4a25c025017b2ce6112bbdf2b5f')
	source=("JLink_Linux_${_pkgver}_x86_64.tgz::http://xxx")
else
	md5sums=('2c441f9d9ef8b6da6132dd765d328d8e')
	source=("JLink_Linux_${_pkgver}_i386.tgz::http://xxx")
fi

package(){
	install -d "${pkgdir}/usr/share/licenses/${pkgname}" "${pkgdir}/etc/udev/rules.d/" "${pkgdir}/usr/lib/" "${pkgdir}/usr/bin/" "${pkgdir}/usr/share/doc/${pkgname}/ReleaseNotes" "${pkgdir}/usr/share/${pkgname}/Samples/JLink/Scripts/"
	cd ${srcdir}/JLink_Linux_${_pkgver}_x86_64/
	install -Dm644 99-jlink.rules "${pkgdir}/etc/udev/rules.d/"
	install -Dm755 JLink* "${pkgdir}/usr/bin/"
	install -Dm644 Doc/*.pdf "${pkgdir}/usr/share/doc/${pkgname}/"
	install -Dm644 Doc/ReleaseNotes/* "${pkgdir}/usr/share/doc/${pkgname}/ReleaseNotes/"
	install -Dm644 Samples/JLink/Scripts/* "${pkgdir}/usr/share/${pkgname}/Samples/JLink/Scripts/" 
	install -Dm644 Doc/License.txt "${pkgdir}/usr/share/licenses/${pkgname}/"
	install -Dm755 libjlinkarm.so.4 "${pkgdir}/usr/lib/"
	cd ${pkgdir}/usr/lib/
	ln -s libjlinkarm.so.4{,.80.8}
}
