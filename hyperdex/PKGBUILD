# Maintainer: Serge Zirukin <ftrvxmtrx@gmail.com>

pkgname=hyperdex
pkgver=0.2b6
pkgrel=2
pkgdesc="A Searchable Distributed Key-Value Store"
arch=('x86_64')
url="http://hyperdex.org/"
license=('BSD')
groups=()
depends=('libe' 'libpo6' 'cityhash' 'google-glog' 'libbsd' 'python')
makedepends=()
checkdepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
source=("http://hyperdex.org/src/${pkgname}-${pkgver}.tar.gz"
  "configure.patch"
  "parser.py.patch")
md5sums=('a13bb576efcaaf28cebeca744ad8259b'
         'c2692e59d5c0a134f67f7693542dc6f2'
         'bb4570f3766094759076a9401236f6c7')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  patch -Np2 -i "$srcdir/configure.patch" || return 0
  patch -Np2 -i "$srcdir/parser.py.patch" || return 0
  ./configure --prefix=/usr --disable-python-bindings CXXFLAGS="$(pkg-config --cflags libbsd)"
  make || return 1
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir/" install
}
