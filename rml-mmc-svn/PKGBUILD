# Maintainer: Randy Heydon <randy dot heydon at clockworklab dot net>

pkgname=rml-mmc-svn
pkgver=20120730
pkgrel=1
pkgdesc="Relational Meta Language and the Meta Modelica Compiler"
arch=('i686' 'x86_64')
url="http://www.ida.liu.se/~pelab/rml/"
license=('custom:OSMC')
depends=('smlnj>=110.57' 'sh')
makedepends=('subversion')

_svndir="trunk"
_svnurl="https://openmodelica.org/svn/MetaModelica/$_svndir"

build() {
    cd $srcdir
    if [ -d $_svndir/.svn ]; then
        (cd $_svndir && svn up -r $pkgver)
    else
        svn --username anonymous --password none --no-auth-cache co $_svnurl
    fi
    cd $_svndir
    source /etc/profile.d/smlnj.sh
    ./configure --prefix=/usr
    make
}

package() {
    cd $srcdir/$_svndir
    make DESTDIR="$pkgdir" install
    install -Dm 644 $srcdir/trunk/COPYRIGHT $pkgdir/usr/share/licenses/$pkgname/LICENSE
}
