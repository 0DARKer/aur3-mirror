# Contributor: Andre Klitzing <aklitzing () online () de>
# Contributor: Ute <moc liamg msg_omh <- backwards >
# Contributor: mutantmonkey <mutantmonkey@mutantmonkey.in>

pkgname=python-otr
_pkgname=python-potr
pkgver=1.0.0beta1
pkgrel=1
pkgdesc="Simple python bindings for OTR"
arch=('any')
url="http://python-otr.pentabarf.de"
license=('GPL')
depends=('libotr>=3.2.0' 'python2')
makedepends=('swig')
conflicts=('pyotr')
replaces=('pyotr')
source=(http://$pkgname.pentabarf.de/releases/${_pkgname}-$pkgver.tar.gz)
md5sums=('a3819cd9e06f02e3d589f629bc344abc')
sha256sums=('b4d9472b00cead6c0d55b78d18147d9f47018a8ff70a2abe2b7c763b5ed1343e')

build() {
	cd "${srcdir}/${_pkgname}-${pkgver}"

	# Great python3 rebuild
	for file in $(find . -name '*.py' -print); do
	sed -i 's_^#!.*/usr/bin/python_#!/usr/bin/python2_' "${file}"
	sed -i 's_^#!.*/usr/bin/env.*python_#!/usr/bin/env python2_' "${file}"
	done

	python2 setup.py build
}

package() {
	cd "${srcdir}/${_pkgname}-${pkgver}"

	python2 setup.py install --prefix=/usr --root="${pkgdir}"
}
