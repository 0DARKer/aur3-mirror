# Mantainer: Marty Plummer <ntzrmtthihu777@gmail.com>
pkgname=('rt5572sta')
pkgver=('2.613')
pkgrel=1
pkgdesc='kernel module and firmware for DLink DWA-160 B2 wifi dongle'
arch=('any')
url='http://code.google.com/p/rt5572sta/'
license=('GPL')
depends=('dkms' 'wpa_supplicant')
makedepends=('linux-headers')
conflicts=()
provides=()
options=('!strip')
install=$pkgname.install
source=(
	${pkgname}-3.x-kernel.patch
)
md5sums=('6bae5f1c3e12583e1a7211616ca528cb')
sha512sums=('983ca8b38ea8e5e32027a479de8063f7f96e8c5269a8b3c90a6c44c8547a3b4d702d688ceb57eeda66c0aefea35b6b83d565c8f3409fd6a98bc29b1d8102f3ac')
_gitroot="https://code.google.com/p/${pkgname}/"
build() {
  cd "${srcdir}"
  msg "Connecting to GIT server...."

  if [[ -d "${pkgname}" ]]; then
    cd "$pkgname" && git pull origin
    msg "The local files are updated."
  else
    git clone "${_gitroot}"
  fi
  msg "GIT checkout done or server timeout"

  msg "Patching..."
	cd ${srcdir}/${pkgname}/usr/src/${pkgname}
	patch -p2 < ../../../../${pkgname}-3.x-kernel.patch
}

package() {
    cp -RL ${srcdir}/${pkgname}/usr ${pkgdir}/
    cp -RL ${srcdir}/${pkgname}/lib ${pkgdir}/
}
