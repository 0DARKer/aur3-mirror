#Contributor: MatToufoutu <mattoufootu[at]gmail[dot]com>

pkgname=nevernote
pkgver=0.97
pkgrel=4
pkgdesc="a clone of Evernote designed to run on Linux"
url="http://nevernote.sourceforge.net/"
arch=('i686' 'x86_64')
license=('GPL')
depends=('java-runtime' 'libpng12')

if [ "$CARCH" == "i686" ]; then
    source=("http://downloads.sourceforge.net/${pkgname}/${pkgname}-${pkgver}_i386.tar.gz"
            "nevernote")
    md5sums=('04e774185f6e2e2cd6d92029a03f213f'
             '59dc9e8d0507a2cb75cf7b129e24ad5e')
else
    source=("http://downloads.sourceforge.net/${pkgname}/${pkgname}-${pkgver}_amd64.tar.gz"
            "nevernote")
    md5sums=('da3d46bbadf36c081ff1363b09e96fb0'
             '59dc9e8d0507a2cb75cf7b129e24ad5e')
fi

build() {
    mv ${srcdir}/${pkgname} ${srcdir}/${pkgname}-src
    cd ${srcdir}/${pkgname}-src
    sed 's/\/usr\/share/\/opt/g' usr/share/applications/nevernote.desktop > usr/share/applications/nevernote.desktop.fix
    install -d ${pkgdir}/{opt/${pkgname},usr/{bin,share/applications}}
    install -m644 usr/share/applications/nevernote.desktop.fix ${pkgdir}/usr/share/applications/nevernote.desktop

    for SUBDIR in images lib qss spell translations xml; do
        DESTDIR="${pkgdir}/opt/${pkgname}/${SUBDIR}"
        install -d ${DESTDIR}
        install -m644 usr/share/${pkgname}/${SUBDIR}/* ${DESTDIR}/
    done

    for FILE in nevernote.jar nevernote.png README.txt gpl.txt license.txt; do
        install -m644 usr/share/nevernote/${FILE} ${pkgdir}/opt/${pkgname}/${FILE}
    done

    install -m755 usr/share/nevernote/nevernote.sh ${pkgdir}/opt/${pkgname}/
    install -m755 ../../${pkgname} ${pkgdir}/usr/bin/
}

# vim: set ts=4 sw=4 ft=PKGBUILD :

