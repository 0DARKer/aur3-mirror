# Contributor: Stefano Zamprogno <mie-dot-iscrizioni-at-gmail-dot-com>
# Contributor: Thanks to Blind (nick from aur) for zfs-fuse rc.d daemon

pkgname=zfs-fuse-git
pkgver=20100330
pkgrel=2
pkgdesc="A port of the ZFS filesytem to the FUSE framework."
arch=("i686" "x86_64")
url="http://zfs-fuse.net"
license=('CDDL')
depends=('fuse' 'zlib' 'libaio')
makedepends=('git' 'scons')
conflicts=('zfs-fuse')
replaces=()
options=(!strip)

_gitroot="http://git.zfs-fuse.net/official"


source=(zfs-fuse.rcd zfs-fuse.confd)
md5sums=('1efc3d817f200a86f89b33232c326e15'
         'b67e735d914a5fcd47f6e4b236a29489')

build() {
  cd ${srcdir}
  msg "Connecting to GIT server...."

  git clone ${_gitroot}

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  cd ${srcdir}/official/src || return 1

  scons debug=0 || return 1
  scons debug=0 install install_dir=$startdir/pkg/usr/sbin man_dir=$startdir/pkg/usr/share/man/man8
  install -D -m755 ${startdir}/zfs-fuse.rcd ${pkgdir}/etc/rc.d/zfs-fuse
  install -D -m644 ${startdir}/zfs-fuse.confd ${pkgdir}/etc/conf.d/zfs-fuse
}


