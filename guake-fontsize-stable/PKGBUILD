# Maintainer: Ivan de Jesús Pompa García <ivan.pompa@gmx.com>

pkgname=guake-fontsize-stable
pkgver=0.4.2
pkgrel=1
pkgdesc="Drop-down terminal for GNOME with shortcuts for fontsize"
arch=('i686' 'x86_64')
url="http://projects.comum.org/guake"
license=('GPL')

depends=('python-notify'
	'vte'
	'python2-gconf'
	'dbus-python')

makedepends=('intltool')

conflicts=('guake')
provides=('guake')

source=("http://guake.org/files/guake-0.4.2.tar.gz"
	"fix-font-size-guake.py.patch"
	"fix-font-size-prefs.py.patch"
	"fix-font-size-keybinder.h.patch"
	"fix-font-size-guake.schemas.patch"
	"guake.install")

md5sums=("1f0feff3bfc15c998147dbf07d9d8a8e"
	"d1a9043367ac08e0cbade7f3c7203706"
	"92eb1f4e61085f336c0b16a861da0e7c"
	"4f4378cfd49c0128480f7ce0cddddb6c"
	"7513dd275aff1ef6bbb408dfe68c2b06"
	"6231a937568f7c1f88c690791bd1742c")


build() {
	cp fix-font-size-guake.py.patch $srcdir/guake-$pkgver
	cp fix-font-size-prefs.py.patch $srcdir/guake-$pkgver
	cp fix-font-size-keybinder.h.patch $srcdir/guake-$pkgver
	cp fix-font-size-guake.schemas.patch $srcdir/guake-$pkgver
	cd $srcdir/guake-$pkgver
	patch -Np1 < fix-font-size-guake.py.patch
	patch -Np1 < fix-font-size-prefs.py.patch
	patch -Np1 < fix-font-size-keybinder.h.patch
	patch -Np1 < fix-font-size-guake.schemas.patch

	cd $srcdir/guake-$pkgver
	./configure --prefix=/usr --sysconfdir=/etc || return 1

	cd $srcdir/guake-$pkgver/po
	make update-po

	cd $srcdir/guake-$pkgver
	make
	make DESTDIR=$pkgdir install

	rm $pkgdir/usr/lib/guake/globalhotkeys.la
	mkdir -p $pkgdir/usr/share/gconf/schemas
	mv $pkgdir/etc/gconf/schemas/guake.schemas \
	   $pkgdir/usr/share/gconf/schemas/guake.schemas
}

install=guake.install
