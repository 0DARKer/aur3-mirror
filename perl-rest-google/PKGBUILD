pkgname=perl-rest-google
_realname=REST-Google
pkgver=1.0.8
pkgrel=1
pkgdesc="access Google REST (aka AJAX) API from Perl"
arch=(i686 x86_64)
license=('perl')
url="http://search.cpan.org/~ejs/REST-Google"
options=(!emptydirs)
depends=('perl>=5.6.1' 'perl-uri' 'perl-http-headers' 'perl-class-data-inheritable' 'perl-class-accessor' 'perl-json-any')
#provides=('REST-Google')
provides=('rest-google=1.0.8' 'REST::Google::Feeds=1.0.8' 'perl-rest-google-feeds=1.0.8' 'REST::Google::Search::Video=1.0.8' 'perl-rest-google-search-video=1.0.8' 'REST::Google::Search::Web=1.0.8' 'perl-rest-google-search-web=1.0.8' 'REST::Google=1.0.8' 'perl-rest-google=1.0.8' 'REST::Google::Search::News=1.0.8' 'perl-rest-google-search-news=1.0.8' 'REST::Google::Translate=1.0.8' 'perl-rest-google-translate=1.0.8' 'REST::Google::Search::Patent=1.0.8' 'perl-rest-google-search-patent=1.0.8' 'REST::Google::Search::Images=1.0.8' 'perl-rest-google-search-images=1.0.8' 'REST::Google::Search::Books=1.0.8' 'perl-rest-google-search-books=1.0.8' 'REST::Google::Search::Blogs=1.0.8' 'perl-rest-google-search-blogs=1.0.8' 'REST::Google::Search::Local=1.0.8' 'perl-rest-google-search-local=1.0.8' 'REST::Google::Search=1.0.8' 'perl-rest-google-search=1.0.8')
source=(http://search.cpan.org/CPAN/authors/id/E/EJ/EJS/REST-Google-1.0.8.tar.gz)
md5sums=('e4b07546dd6858c772c0820a5edf1d54')

build() {
  _expected_dir="${srcdir}/${_realname}-${pkgver}"
  if [ -d "$_expected_dir" ]; then
    cd "$_expected_dir"
  else
    _expected_dir="${srcdir}/$(bsdtar -t -f $(basename $source) | head -n1)"
    if [ -d "$_expected_dir" ]; then
      cd "$_expected_dir"
    else
      _makefile=$(find $srcdir -iname Makefile.PL)
      if [ ! -z "$_makefile" ]; then
        _expected_dir=$(dirname $_makefile)
        if [ -d "$_expected_dir" ]; then
          cd "$_expected_dir"
        else
          echo "[1;31mERROR[0m unable to detect source directory"
          echo "[1;34m-->[0m this is often due to CPAN's lack of standard naming conventions"
          echo "[1;34m-->[0m it may be possible to fix this by adjusting the build function in the PKGBUILD"
        fi
      fi
    fi
  fi
  # install module in vendor directories.
  perl Build.PL destdir=${pkgdir} \
       --install_path lib=/usr/lib/perl5/site_perl/current \
       --install_path arch=/usr/lib/perl5/site_perl/current/${archname}
  ./Build
  ./Build install

  # remove perllocal.pod and .packlist
  find ${pkgdir} -name perllocal.pod -delete
  find ${pkgdir} -name .packlist -delete
}

# vim:set ts=2 sw=2 et:
