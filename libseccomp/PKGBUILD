pkgname=libseccomp
pkgver=0.1.0
pkgrel=2
pkgdesc='Enhanced seccomp library'
arch=('i686' 'x86_64')
license=('LGPL2.1')
url="http://sourceforge.net/projects/libseccomp/"
depends=('glibc')
source=("http://downloads.sourceforge.net/project/$pkgname/$pkgname-$pkgver.tar.gz"
'libseccomp-0.1.0-build_verbose.patch')
md5sums=('60c1c9b94fa46597800652131f5ebe97'
'11562c3b44bd763809ea805ba5d74aaf')
sha256sums=('e940989c093c9c057aca4e1a878be48bdcdb027f876a8d4bdcd9a1405a3d7f6f'
'490550520125874ea743889fee289750aabcc9c21f28acf0a684a543dbeebe88')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  patch -Np1 -i "$srcdir/libseccomp-0.1.0-build_verbose.patch"
  ./configure --prefix=/usr
  make GCC="${CC:-gcc}" V=1
}

check() {
  cd "$srcdir/$pkgname-$pkgver"
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir" install 

  mkdir -m 0755 -p "$pkgdir/usr/share/doc/$pkgname"

  find . -maxdepth 1 -type f | grep -v "[a-z]" | while read somefile; do
    install -v "$somefile" "$pkgdir/usr/share/doc/$pkgname"
  done
}
