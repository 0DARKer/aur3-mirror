# Maintainer: Jamie Paton <jamie.paton@googlemail.com>
# Contributor: max-k <max-k@post.com>

if [ $(uname -m) = "x86_64" ] ; then
_arch="x86_64"
else
_arch="x86"
fi

_major="7.0.0b2"
_majoralt="7.0.0-beta2"
_minor=67670


pkgname="komodo-ide-testing"
pkgver="${_major}_${_minor}"
pkgrel=1
pkgdesc="ActiveState Komodo IDE"
arch=(i686 x86_64)
url="http://www.activestate.com/komodo-ide"
license=('MPL')
depends=('glibc>=2.4' 'libjpeg>=6.2' 'gcc-libs' 'gtk2')
optdepends=('php: PHP debugging'
	    'ruby: Ruby debugging'
	    'python2: Python 2.x debugging'
	    'python: Python 3.x debugging'
            'git: Git SCC integration'
            'subversion: SVN SCC integration'
)
conflicts=()
options=(!strip)
source=("http://downloads.activestate.com/Komodo/releases/${_major}/Komodo-IDE-${_majoralt}-${_minor}-linux-${_arch}.tar.gz")

if [ $_arch = "x86_64" ] 
then
  md5sums=('31363032a373a2a870d1e709056a6793')
else
  md5sums=('fb91060e8833bdaefee7b76952a8f437')
fi

build() {
cd ${startdir}/src/Komodo-IDE-${_majoralt}-${_minor}-linux-${_arch}
./install.sh -s -I ${startdir}/pkg/opt/${pkgname}
sed -i 's/Komodo\ IDE-7.desktop/Komodo\ Edit\ 7/' ${startdir}/pkg/opt/${pkgname}/share/desktop/komodo-ide-7.desktop
grep -v ${startdir} ${startdir}/pkg/opt/${pkgname}/share/desktop/komodo-ide-7.desktop > ${startdir}/${pkgname}.desktop
echo "Exec=/opt/${pkgname}/bin/komodo %F" >> ${startdir}/${pkgname}.desktop
echo "Icon=/opt/${pkgname}/share/icons/komodo48.png" >> ${startdir}/${pkgname}.desktop
install -D -m 644 ${startdir}/${pkgname}.desktop ${startdir}/pkg/usr/share/applications/${pkgname}.desktop
}
