# Contributor: Jens Staal <staal1978@gmail.com>

pkgname="plan9rootfs-9vx"
pkgver="2011.11.21"
pkgrel=1
pkgdesc="Plan9 base system to be run under vx32+union mounts"
url='http://plan9.bell-labs.com/plan9/'
arch=('i686' 'x86_64')
license=('LPL')
depends=('9vx-hg' 'unionfs-fuse')
source=('plan9user' 'plan9glenda')
md5sums=('85091028a8cdc0bf014ba4aabdd20a05' '1cb6ed1dd0509be07fe397ee0a8be867')

build() {
	msg "getting the daily snapshot of the Plan9 iso from Bell labs"
	wget http://plan9.bell-labs.com/plan9/download/plan9.iso.bz2
	bunzip2 plan9.iso.bz2
	mkdir -p $srcdir/temp
	mount -o loop -t iso9660 plan9.iso $srcdir/temp
}

package() {
	mkdir -p "$pkgdir/opt/vx32/plan9root"
	mkdir -p "$pkgdir/usr/bin"
	cp -ar $srcdir/temp/ $pkgdir/opt/vx32/plan9root/
	umount $srcdir/temp

	install -m755 $srcdir/{plan9user,plan9glenda} $pkgdir/usr/bin/
}
