# Maintainer: Dan Serban

pkgname=pdfchain-all-inclusive
pkgver=0.123
pkgrel=3
pkgdesc="Combo package: PDF Chain and pdftk (patched to remove the pointless limitation to max. 26 items when merging)"
depends=(gtkmm)
makedepends=(intltool)
provides=(pdftk pdftk-bin pdfchain)
conflicts=(pdftk pdftk-bin pdfchain)
license=(GPLv3)
url=http://pdfchain.sourceforge.net/
arch=(i686 x86_64)
source=("http://downloads.sourceforge.net/project/pdfchain/pdfchain-${pkgver}/PDF%20Chain%20version%20${pkgver}/pdfchain-${pkgver}.tar.gz"
        "definings.hh.patched"
        "merge.cc.patched")
md5sums=('88870ffaf28833b85d84b02da60f41a4'
         'c4518155839a9df68564238db524849d'
         'f4763b7e8a69965c9738ee0b9ca2b40e')
_filearch=i386
[ "${CARCH}" = "x86_64" ] && _filearch=amd64
_pdftk_debian_ver=1.44-3
_libgcj12_debian_ver=4.6.0-3

build()
{
  _url_prefix="http://mirrors.kernel.org/debian/pool/main"

  # --- pdftk ---
  _file="pdftk_${_pdftk_debian_ver}_${_filearch}.deb"
  # wget "${_url_prefix}/p/pdftk/${_file}"
  bsdtar -xf "${_file}" data.tar.gz
  bsdtar -xf data.tar.gz -C "${pkgdir}"
  rm data.tar.gz

  # --- libgcj12 ---
  _file="libgcj12_${_libgcj12_debian_ver}_${_filearch}.deb"
  # wget "${_url_prefix}/g/gcj-4.6/${_file}"
  bsdtar -xf "${_file}" data.tar.gz
  bsdtar -xf data.tar.gz usr/lib/libgcj.so.12.0.0
  rm data.tar.gz
  install -Dm644 usr/lib/libgcj.so.12.0.0 "${pkgdir}"/usr/lib/libgcj.so.12

  # --- pdfchain ---
  cd "pdfchain-${pkgver}"
  install -Dm644 ../definings.hh.patched src/definings.hh
  install -Dm644 ../merge.cc.patched src/merge.cc
  ./configure
  make
  make prefix="${pkgdir}"/usr install
}

