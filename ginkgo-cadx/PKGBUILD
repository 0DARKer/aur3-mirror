# Maintainer: Jonathan Liu <net147@gmail.com>
pkgname=ginkgo-cadx
_realpkgname=Ginkgo_CADx
pkgver=2.10.0.4786
pkgrel=1
pkgdesc="Complete DICOM viewer solution"
arch=('i686' 'x86_64')
url="http://ginkgo-cadx.com/"
license=('LGPL3')
makdepends=('cmake')
depends=('dcmtk' 'insight-toolkit' 'tcp_wrappers' 'vtk' 'wxgtk')
install="${pkgname}.install"
options=('!strip')
source=("http://downloads.sourceforge.net/project/ginkgocadx/${pkgver%.*}/${pkgname/-/}-${pkgver}.tgz"
        "itk-4.0.patch"
        "ginkgocadx.desktop"
        "ginkgocadx.png")
md5sums=('a08c8e8fe03b9063a015319556d93e76'
         '0cc4bacb5b1378e2865669887688e06f'
         '16998d859432ab9348a9e835d0135a98'
         '1de087126d5e72ecdacc2e215601827f')

build() {
  cd "${srcdir}/${pkgname/-/}-${pkgver}"
  patch -Np1 -i "${srcdir}/itk-4.0.patch"
  [[ -d build ]] && rm -r build
  mkdir build && cd build
  LDFLAGS=-L/usr/lib/dcmtk cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_LIBRARY_PATH=/usr/lib/dcmtk ..
  make
}

package() {
  cd "${srcdir}/${pkgname/-/}-${pkgver}/build"
  make DESTDIR="${pkgdir}" install
  install -D -m644 "${srcdir}/ginkgocadx.desktop" "${pkgdir}/usr/share/applications/ginkgocadx.desktop"
  install -D -m644 "${srcdir}/ginkgocadx.png" "${pkgdir}/usr/share/pixmaps/ginkgocadx.png"
}

# vim:set ts=2 sw=2 et:
