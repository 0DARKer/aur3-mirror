# atommixz <atommixz@gmail.com>
# Contributor: dhamp <dhamp@ya.ru>

#FLAGS (may be you change this?)

#if set: build and install only changed translation (* equal install all translation)
#available now: be en es fr hu pl ru sr uk
#example _lang="ru en"
_lang="*"
#if 1 use local boost headers
_use_local_boost=1
#ENDFLAGS

_name=eiskaltdcpp
pkgname=$_name-gtk-svn
pkgver=1610
pkgrel=1
pkgdesc="Gtk-based DC and ADC client based on dcpp core"
license=('GPL3')
arch=('i686' 'x86_64')
url="http://code.google.com/p/eiskaltdc"
depends=('gtk2' 'gettext' 'pango' 'glib2' 'libglade' 'libnotify')
makedepends=('subversion' 'gcc' 'pkgconfig' 'cmake')
conflicts=('eiskaltdcpp' 'eiskaltdcpp-svn')
provides=('eiskaltdcpp')
options=(!emptydirs)
install=$_name.install
_svntrunk="http://eiskaltdc.googlecode.com/svn/branches/trunk"
_svnmod=$_name
build() {
        cd $srcdir
        if [ -d $svnmod/.svn ]; then
            (cd $svnmod && svn up -r $pkgver)
        else
            svn co $_svntrunk $_svnmod
        fi
        msg "SVN checkout done or server timeout"
        msg "Starting make..."
        rm -rf $_name-build
        cp -r $_name $_name-build
		cd $_name-build
        cmake . -DCMAKE_BUILD_TYPE=Release \
				-DCMAKE_INSTALL_PREFIX=/usr \
				-Dlinguas="$_lang" \
				-DLOCAL_BOOST=$_use_local_boost \
				-DUSE_GTK=ON \
				-DUSE_QT=OFF \
				-DFREE_SPACE_BAR_C=OFF \
				-DFORCE_XDG=OFF \
				-DUSE_LIBUPNP=OFF \
				-DDBUS_NOTIFY=OFF \
				-DUSE_MINIUPNP=OFF
        make DESTDIR=$pkgdir install
        rm -rf $_name-build
}

