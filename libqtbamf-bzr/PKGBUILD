# Contributor: Marius Dransfeld <marius.dransfeld@googlemail.com>

pkgname=libqtbamf-bzr
pkgver=369
pkgrel=1
pkgdesc="Qt bindings for libbamf"
arch=('i686' 'x86_64')
url="https://launchpad.net/bamf-qt"
license=('GPL')
depends=('qt' )
makedepends=('cmake' 'bzr')
conflicts=('libqtbamf')
replaces=('libqtbamf')

_bzrtrunk=lp:bamf-qt
_bzrmod=bamf-qt

build() {
  cd "$srcdir"
  msg "Connecting to Bazaar server...."

  if [ -d $_bzrmod ] ; then
    cd ${_bzrmod} && bzr  pull ${_bzrtrunk} -r ${pkgver}
    msg "The local files are updated."
  else
    bzr  branch ${_bzrtrunk} ${_bzrmod} -q -r ${pkgver}
  fi

  msg "Bazaar checkout done or server timeout"
  msg "Starting make..."

  cd ${srcdir}/${_bzrmod}
  rm -rf build
  mkdir build
  cd build
  cmake -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=/usr ..
  make
  make DESTDIR=${pkgdir} install
}

