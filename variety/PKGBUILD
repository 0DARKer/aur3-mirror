# vim:set ts=2 sw=2 et:
# Maintainer: xzy3186 <xzy3186@gmail.com>

pkgname=variety
pkgver=0.4.15
pkgrel=1
pkgdesc='Variety wallpaper changer is an app that changes the wallpaper on a regular interval using user-specified or automatically downloaded images.'
url="https://launchpad.net/variety"
license=('GNU GPL v3')
depends=('python2' 'libnotify' 'python2-configobj' 'python2-gobject' 'pyexiv2' 'python2-pycurl' 'gtk3' 'python2-dbus' 'gobject-introspection' 'python2-imaging' 'gdk-pixbuf2' 'python2-beautifulsoup4' 'libwebkit3' 'yelp' 'imagemagick' 'python2-lxml' 'python2-distutils-extra')
#makedepends=('bzr')
arch=('any')

#_bzrtrunk="lp:variety"
#_bzrmod="variety"
source=("https://launchpad.net/variety/trunk/${pkgver}/+download/${pkgname}_${pkgver}.tar.gz")
md5sums=('2d9a078d6fb9685b62799884280e6f42')

package() {
  cd "${srcdir}/${pkgname}"
  #msg "Connecting to Bazaar server...."

  #if [[ -d "$_bzrmod" ]]; then
  #  cd "$_bzrmod" && bzr pull "$_bzrtrunk"
  #  msg "The local files are updated."
  #else
  #  bzr branch "$_bzrtrunk" "$_bzrmod"
  #fi

  #msg "Bazaar checkout done or server timeout"
  #msg "Starting build..."
  #cd "$srcdir/$_bzrmod"
  for file in $(grep -R "/usr/bin/python" . | cut -f1 -d :)
  do
    sed -i "s|usr/bin/python$|usr/bin/python2|g" $file
  done

  python2 setup.py install --root="${pkgdir}/"
  ### fix for libboost_python1.52 ###
  ln -s /usr/lib/libboost_python.so.1.52.0 ${pkgdir}/usr/lib/libboost_python.so.1.50.0
}
