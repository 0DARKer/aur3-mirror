# Maintainer: Abhishek Dasgupta <abhidg@gmail.com>
# Original-Package: network-manager-applet
# Original-Package-Maintainer: Jan de Groot <jgc@archlinux.org>
# Contributor: Bart Verhoeven <bart_verhoeven (at) belgacom (dot) net>
# Contributor: Arjan Timmerman <arjan@archlinux.org>
# Contributor: Wael Nasreddine <gandalf@siemens-mobiles.org>
# Contributor: Tor Krill <tor@krill.nu>
# Contributor: Will Rea <sillywilly@gmail.com>

pkgname=nm-applet-notify-osd
_realname=network-manager-applet
pkgver=0.7.1
pkgrel=1
pkgdesc="GNOME frontends to NetWorkmanager"
arch=(i686 x86_64)
license=('GPL')
url="http://www.gnome.org/projects/NetworkManager/"
makedepends=('pkgconfig' 'perlxml')
depends=('networkmanager-notify-osd>=0.7.1rc3' 'libglade>=2.6.3' 'gnome-keyring>=2.24.0' 'policykit-gnome' 'notification-daemon' 'libnotify')
replaces=('gnome-network-manager')
conflicts=('gnome-network-manager' 'network-manager-applet')
provides=('gnome-network-manager' 'network-manager-applet')
install=network-manager-applet.install
source=(http://ftp.gnome.org/pub/GNOME/sources/network-manager-applet/0.7/network-manager-applet-${pkgver}.tar.bz2
         add_libmbca_support.patch
         lp289466_always_show_tray_icon.patch
         lp328572-dxteam-connect-text.patch
         lp330571_dxteam_wired_connect_text.patch
         lp330608_dxteam_gsm_connect_text.patch
         lp337960_dxteam_notification_icon_names.diff
         lp337960_dxteam_notification_icon_names_part2-images.diff
         lp341684_device_sensitive_disconnect_notify.patch)

#source=(http://archive.ubuntu.com/ubuntu/pool/main/n/network-manager-applet/${_realname}_${pkgver}.orig.tar.gz
#*.patch )

build() {
cd "${srcdir}/${_realname}-${pkgver}"
# Apply patches for new notification system.
patch -p1 < ../add_libmbca_support.patch || return 1
patch -p1 < ../lp289466_always_show_tray_icon.patch || return 1
patch -p1 < ../lp328572-dxteam-connect-text.patch || return 1
patch -p1 < ../lp330571_dxteam_wired_connect_text.patch || return 1
patch -p1 < ../lp330608_dxteam_gsm_connect_text.patch || return 1
patch -p1 < ../lp337960_dxteam_notification_icon_names.diff || return 1
patch -p1 < ../lp337960_dxteam_notification_icon_names_part2-images.diff || return 1
patch -p1 < ../lp341684_device_sensitive_disconnect_notify.patch || return 1

./configure --prefix=/usr --sysconfdir=/etc  --localstatedir=/var
make || return 1
make DESTDIR="${pkgdir}" install || return 1
}
md5sums=('d90a997e3e2051ce8866fe24f765141f'
         'd080f1c2eabb18e69c331206542385bf'
         'fd48d246c0a25e2ed5f1da8701473416'
         'c92458d6665c81bbb5b901705f41a907'
         '110dfeaef8e6a94ce5927f19e45623c7'
         'e3cbe31ff25cb3953a73021b2f181596'
         'ddaa4b039b970d9b08001e101e98a5c5'
         '96c93ae3601019b0818f764fbc821bb4'
         '5d9fc442e7a04245146f3774e09164eb')
