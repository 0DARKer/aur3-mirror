# Maintainer: Wido <widomaker2k7 at gmail dot com>

pkgname=beep-game
_pkgname=beep
pkgver=1.1
pkgrel=1
pkgdesc="a 2D side-scrolling platformer with physics-based gameplay. (requires copy of the full game)"
url="http://www.gameolith.com/game/beep/"
license=('custom: "commercial"')
arch=('i686' 'x86_64')
makedepends=()
source=("${_pkgname}_${pkgver}_i386.tar.gz" "beep.sh" "beep.desktop")
md5sums=('cad89e1eb67f2270dbd0c69e4dd22930'
         '1cf275e07f42cd21f15b092c43b03484'
         'ae653c7ab8b7adf241901520c83752eb')

depends=('mesa')
_depends64=('lib32-mesa')

if [[ $CARCH == x86_64 ]]; then
  depends=(${_depends64[@]})
fi

build() {
  cd ${srcdir}
  mkdir -p ${pkgdir}/opt/${_pkgname}
  cp -R ${srcdir}/{lib,Art} ${pkgdir}/opt/${_pkgname}/
  cp ${srcdir}/BEEP.bin32 ${pkgdir}/opt/${_pkgname}/

}

package(){
  cd ${srcdir}

  # Install Launcher
  install -Dm 755 ${srcdir}/${_pkgname}.sh ${pkgdir}/usr/bin/${_pkgname}-game

  # Install Desktop
  install -D -m644 ${srcdir}/${_pkgname}.desktop \
        ${pkgdir}/usr/share/applications/${_pkgname}.desktop

  # Make save game Directory with user group permissions (config)
  install -d -m775 -g users ${pkgdir}/opt/${_pkgname}/Art/Save/
  install -m644 -g users ${srcdir}/Art/Settings.xml ${pkgdir}/opt/${_pkgname}/Art/
}
