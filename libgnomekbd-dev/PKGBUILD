# Maintainer: Adam Hani Schakaki (krzd) <krzd@krzd.net>

_pkg=libgnomekbd
pkgname=libgnomekbd-dev
pkgver=2.91.5
_majorver=(`echo $pkgver | egrep -o '[0-9]+\.[0-9]*+'`)
pkgrel=1
pkgdesc="Gnome keyboard library"
url="http://gswitchit.sourceforge.net"
arch=('i686' 'x86_64')
license=('LGPL')
depends=('libxklavier>=5.0' 'gconf')
makedepends=('intltool' 'pkg-config')
conflicts=("${_pkg}")
provides=("${_pkg}=${pkgver}")
options=('!libtool' '!emptydirs')
install=libgnomekbd-dev.install
source=("http://ftp.gnome.org/pub/gnome/sources/${_pkg}/${_majorver}/${_pkg}-${pkgver}.tar.bz2")
sha256sums=(`wget ${source/.t*}.sha256sum -qO - | grep tar.bz2 | cut -d " " -f1`)

build() {
  cd "${_pkg}-${pkgver}"
  ./configure --prefix=/usr --sysconfdir=/etc \
      --localstatedir=/var --disable-static
  make
}

package() {
  cd "${_pkg}-${pkgver}"
  make GCONF_DISABLE_MAKEFILE_SCHEMA_INSTALL=1 DESTDIR="${pkgdir}" install

  install -m755 -d "${pkgdir}/usr/share/gconf/schemas"
  gconf-merge-schema "${pkgdir}/usr/share/gconf/schemas/libgnomekbd.schemas" --domain libgnomekbd ${pkgdir}/etc/gconf/schemas/*.schemas
  rm -f ${pkgdir}/etc/gconf/schemas/*.schemas
}
