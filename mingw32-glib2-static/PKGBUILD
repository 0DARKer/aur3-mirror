# Maintainer: Ondrej Jirman <megous@megous.com>

pkgname=mingw32-glib2-static
pkgver=2.24.2
pkgrel=1
arch=(i686 x86_64)
pkgdesc="glib2 (mingw32)"
depends=(mingw32-gettext-static)
makedepends=(mingw32-gcc)
license=(LGPL)
url="http://www.gtk.org/"
source=(http://ftp.gnome.org/pub/gnome/sources/glib/2.24/glib-$pkgver.tar.bz2)
md5sums=(8a6e45d7840460ed84288ebfd75782d4)
options=(!strip)

build()
{
  cd $srcdir/glib-$pkgver

cat > win32.cache << EOF
glib_cv_long_long_format=I64
glib_cv_stack_grows=no
EOF
export CPPFLAGS="-D_REENTRANT"
LDFLAGS=''
  ./configure --cache-file=win32.cache --prefix=/usr/i486-mingw32 --host=i486-mingw32 --enable-static --disable-shared || return 1
  make || return 1
  make DESTDIR=$pkgdir install || return 1
  rm -rf usr/i486-mingw32/share/{gtk-doc,man}
  rm -rf usr/i486-mingw32/lib/charset.alias
}

