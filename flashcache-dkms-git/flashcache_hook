# vim:set ft=sh:
# from flashcache-git/src/util/flashcache_scan
run_hook ()
{
    msg   "Scanning for flashcache devices"
    echo   "Waiting for udev to settle..."
    /sbin/udevadm settle --timeout=30

    PARTITIONS=`cat /proc/partitions | awk '{ print $NF; }' | grep -v name`
    for P in $PARTITIONS; do
        if /sbin/flashcache_load "/dev/$P"  2> /dev/null; then
            echo "Loaded flashcache device from /dev/$P"
        fi
    done

    msg "Flashcache scanning done."

}

