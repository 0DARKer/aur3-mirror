# Contributor: Vojtech "kralyk" Kral

pkgname='libopencl'
pkgver=1.1
pkgrel=2
_amdstream_ver=2.5

pkgdesc='OpenCL library and ICD loader'
arch=('i686' 'x86_64')
url="http://developer.amd.com/gpu/ATIStreamSDK/Pages/default.aspx"
license=("custom")
install='install'

provides=('libcl')
conflicts=('libcl' 'nvidia-utils')

#Architecture resolution
_arch="${CARCH/i6/x}"
_bits=${_arch/x86/32}
_bits=${_bits/32_/}
[ "$CARCH" = 'x86_64' ] && _hash='b121183f4ce5d296d5195ec2fbb8f857f44ec79fc2daceaf8aea815189351787' \
                        || _hash='01ff3b55f2f5a702bd54bb8641c67b86397d383e9a8b8c1ba629181f86da15ca'
#Sources
source=("http://developer.amd.com/Downloads/AMD-APP-SDK-v${_amdstream_ver}-lnx${_bits}.tgz" 
        "AMD-APP-SDK-v2.5-RC2-lnx${_bits}.tgz")

#sha256sums
sha256sums=($_hash 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855')

build() { true; }

package()
{
  cd "${srcdir}/AMD-APP-SDK-v2.5-RC2-lnx${_bits}"

  mkdir -p "${pkgdir}/usr/lib"
  install -m 755 "./lib/${_arch}/libOpenCL.so.1" "${pkgdir}/usr/lib"
  ln -s 'libOpenCL.so.1' "${pkgdir}/usr/lib/libOpenCL.so"
}
