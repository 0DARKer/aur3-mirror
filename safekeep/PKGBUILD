# Maintainer: Jaroslav Lichtblau <dragonlord@aur.archlinux.org>

pkgname=safekeep
pkgver=1.3.1
pkgrel=1
pkgdesc="A client/server backup system which enhances the power of rdiff-backup"
arch=('any')
url="http://safekeep.sourceforge.net"
license=('GPL')
depends=('python2' 'rdiff-backup' 'openssh')
makedepends=('asciidoc' 'docbook-xsl' 'patch' 'xmlto')
install=$pkgname.install
source=(http://downloads.sourceforge.net/sourceforge/$pkgname/$pkgname-$pkgver.tar.gz)
md5sums=('c3e76d5b6b9425c770559d3d2e0f8034')

build() {
  cd ${srcdir}/$pkgname-$pkgver

  make docs

#Python2 fix
  sed -i 's_env python_env python2_' $pkgname

#installing files
  install -D -m755 $pkgname ${pkgdir}/usr/bin/$pkgname
  install -D -m644 $pkgname.conf ${pkgdir}/etc/safekeep/safekeep.conf
  install -D -m644 $pkgname.cron ${pkgdir}/usr/share/safekeep/safekeep.cron
  install -D -m644 doc/$pkgname.1 ${pkgdir}/usr/share/man/man1/$pkgname.1
  install -D -m644 doc/$pkgname.conf.5 ${pkgdir}/usr/share/man/man5/$pkgname.conf.5
  install -D -m644 doc/$pkgname.backup.5 ${pkgdir}/usr/share/man/man5/$pkgname.backup.5

#  install -d ${pkgdir}/etc/safekeep/backup.d
#  install -D -m644 sample.backup ${pkgdir}/etc/safekeep/backup.d/sample.backup
}
