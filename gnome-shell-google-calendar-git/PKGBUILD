# Maintainer: Pietro Bonfa <bonfus at gmail com>

pkgname=gnome-shell-google-calendar-git
pkgver=20110601
pkgrel=1
pkgdesc="An attempt to integrate google calendar into gnome-shell."
arch=('i686' 'x86_64')
url="https://github.com/jnns/gnome-shell-google-calendar"
license=('GPL')
depends=('python2' 'pygtk' 'dbus-python' 'python-gdata')
makedepends=('git')
conflicts=('')
provides=('')
optdepends=()
source=('gnome-shell-google-calendar.desktop'
        'gnome-shell-google-calendar.install')
md5sums=('ec6016e5cbf06963d6fbf9080bc69608'
         '3175a0718ef64cdd3d356be83874b896')
install=gnome-shell-google-calendar.install

_gitroot="git://github.com/jnns/gnome-shell-google-calendar.git gnome-shell-google-calendar"
_gitname="gnome-shell-google-calendar"

build() {
  cd ${srcdir}
  msg "Connecting to github GIT server...."

  if [ -d ${srcdir}/${_gitname} ] ; then
   cd ${_gitname} && git pull origin
   msg "The local files are updated."
  else
   git clone ${_gitroot}
  fi

  msg "GIT checkout done or server timeout"
  
  rm -rf "$srcdir/$_gitname-build"
  cp -rf "$srcdir/${_gitname}" "$srcdir/${_gitname}-build"
  cd "$srcdir/${_gitname}-build"

  msg "Patching python version"
  sed -i 's/python/python2/' gnome-shell-google-calendar.py

}
	
package() {
  
  install -D -m 0644  gnome-shell-google-calendar.desktop "$pkgdir/usr/share/gnome-shell-google-calendar/gnome-shell-google-calendar.desktop"
  cd "gnome-shell-google-calendar-build"
  install -D -m 0755  gnome-shell-google-calendar.py "$pkgdir/usr/bin/gnome-shell-google-calendar.py"
  install -D -m 0644  README.rst "$pkgdir/usr/share/gnome-shell-google-calendar/README.rst"

}
