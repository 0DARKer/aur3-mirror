# Maintainer: Igor "FeR" Scabini <furester@gmail.com>

pkgname=libkdcraw-svn
pkgver=692424
pkgrel=1
pkgdesc="kde library for dcraw, svn version"
url="http://extragear.kde.org/apps/kipi/"
depends=('kdelibs4-svn' 'qt-copy-svn' 'dcraw')
makedepends=('subversion' 'versionpkg' 'cmake')
arch=('i686')
license=('GPL')

provides=('libkdcraw')
conflicts=('libkdcraw')
source=()
md5sums=()

_svntrunk=svn://anonsvn.kde.org/home/kde/trunk/extragear/libs
_svnmod=libkdcraw

_svnbranch=svn://anonsvn.kde.org/home/kde/branches/KDE/3.5/kde-common
_svnbranchmod=admin

build() {
	
    cd $startdir/src
    touch ~/.subversion

    svn co -N $_svntrunk
    cd libs
    
    svn co $_svntrunk/$_svnmod
    svn co $_svnbranch/$_svnbranchmod
    
    msg "SVN checkout done or server timeout"
    msg "Starting make..."
     
    export VERBOSE=1
    export QTDIR=/opt/qt4/  
    export PATH=$QTDIR/bin:$PATH 
    cmake . -DCMAKE_BUILD_TYPE=debugfull -DCMAKE_INSTALL_PREFIX=/opt/kde4

    make || return 1
    make DESTDIR=$startdir/pkg/ install

    # fix pkg-config that it is in main path
    mkdir -p $startdir/pkg/usr/lib/
    mv $startdir/pkg/opt/kde4/lib/pkgconfig $startdir/pkg/usr/lib/

}

