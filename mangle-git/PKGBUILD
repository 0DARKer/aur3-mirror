# Maintainer: William Giokas <1007380 at gmail dot com>
pkgname=mangle-git
pkgver=20120427
#Previous versions:
#	   20120425
pkgrel=2
pkgdesc="A simple python image converter for the Amazon Kindle"
arch=('any')
url="http://foosoft.net/mangle/"
license=('GPL')
depends=('python2' 'python2-pyqt' 'python-imaging')
makedepends=('git')
provides=('mangle')
conflicts=('mangle-git' 'mangle')
source=('mangle-git.desktop' 'mangle.png')
md5sums=('9cabeeb3b2ac90f1d4ac9faa3eb581c6'
         '724e6d6bdb10890629113c281b5b01e1')

_gitroot="git://github.com/FooSoft/mangle.git"
_gitname="mangle"

build() {
	cd $srcdir
	msg "Connecting to the GIT server...."
	
	if [[ -d $srcdir/$_gitname ]] ; then
		cd $_gitname
		git pull origin
		msg "The local files have been updated."
	else
		git clone $_gitroot $_gitname
	fi
	  
	cd $srcdir
	#Make directories
	mkdir -p "$pkgdir/usr/share/applications/"
	mkdir -p "$pkgdir/usr/share/pixmaps/"
	mkdir -p "$pkgdir/usr/share/mangle/"
	mkdir -p "$pkgdir/usr/bin/mangle/"
	mkdir -p "$pkgdir/usr/share/mangle/"
	#desktop entry
	cp "mangle-git.desktop" "$pkgdir/usr/share/applications/mangle.desktop"
	#Icon (feel free to change, I made it in a few minutes using GIMP, it's not an official icon or anything)
	cp "mangle.png" "$pkgdir/usr/share/pixmaps/mangle.png"
    #Copying git files
    cd "$srcdir/mangle"
    cp -R "mangle" "$pkgdir/usr/share/mangle/mangle"
	cp -R "ref" "$pkgdir/usr/share/mangle/ref"
	#Copy main pyw file
	cp "mangle.pyw" "$pkgdir/usr/share/mangle/mangle.pyw"
}
