# Maintainer: Zhengyu Xu <xzy3186[at]gmail[dot]com>
pkgname=rhythmbox-plugin-coverart-browser
pkgver=20121117
pkgrel=1
pkgdesc="a Rhythmbox plugin that lets you browse and play your music via an album art view"
url="https://github.com/fossfreedom/coverart-browser"
arch=('x86_64' 'i686')
license=('GPLv3')
depends=('glib2' 'gtk3' 'rhythmbox')
#source=("https://launchpad.net/~fossfreedom/+archive/rhythmbox-plugins/+files/${pkgname}_${pkgver}-1ubuntu2_all.deb")
#sha256sums=("fdc2068141ad148379a0da2b1ef38b0ce08774540698fca5753a2b3cb1f9b7cb")
_gitroot="git://github.com/fossfreedom/coverart-browser.git"
_gitname="coverart-browser"
install=$pkgname.install
build() {
  cd ${srcdir}
  msg2 "Connecting to GIT server..."
  if [[ -d "$_gitname" ]]; then
    cd "$_gitname" && git pull origin
    msg2 "The local files are updated."
  else
    git clone "$_gitroot" "$_gitname"
  fi
  msg2 "GIT checkout done or server timeout."
  cd "${srcdir}/$_gitname"
  ############ fix crash bugs ################
  sed -i "s/self.entry_changed_id/#self.entry_changed_id/g" coverart_album.py
  sed -i "s/self._entry_changed/#self._entry_changed/g" coverart_album.py

  make DESTDIR=${pkgdir} install
  #ar x ${pkgname}_${pkgver}-1ubuntu2_all.deb
  #tar -xvzf data.tar.gz
  #sed -i "/IAge=2/a Depends=rb" usr/lib/rhythmbox/plugins/coverart_browser/coverart_browser.plugin
}

# vim:set ts=2 sw=2 et:
