# Maintainer: James Bulmer <nekinie@gmail.com>

pkgname="kafka"
pkgver=0.8.1.1
pkgrel=1
pkgdesc="A high-throughput distributed messaging system"
arch=("i686" "x86_64")
url="http://kafka.apache.org/"
license=("Apache")

depends=(
  "bash"
  "java-environment"
  "scala10"
)

conflicts=("zookeeper")

source=(
  "zookeeper.service"
  "kafka.service"
  "http://mirror.catn.com/pub/apache/kafka/0.8.1.1/kafka_2.10-${pkgver}.tgz"
)

md5sums=(
  "6f370d177baa31b79f4ea1d5c8004ef1"
  "4a2631d972f31d98d373b0758dfc515b"
  "f3f7446788d9a06f6bfaba72912bd8cf"
)

package() {
  cd "${srcdir}/kafka_2.10-${pkgver}/"
  mkdir -p $pkgdir/opt/kafka_2.10-${pkgver}/ $pkgdir/etc/
  cp -r bin/ $pkgdir/opt/kafka_2.10-${pkgver}/
  cp -r libs/ $pkgdir/opt/kafka_2.10-${pkgver}/
  cp -r config/ $pkgdir/etc/kafka
  install -m 644 -D "${srcdir}/zookeeper.service" "${pkgdir}/usr/lib/systemd/system/zookeeper.service"
  install -m 644 -D "${srcdir}/kafka.service" "${pkgdir}/usr/lib/systemd/system/kafka.service"
}