Index: libmpcodecs/vd.c
===================================================================
--- libmpcodecs/vd.c	(revision 32493)
+++ libmpcodecs/vd.c	(working copy)
@@ -40,6 +40,7 @@
 extern const vd_functions_t mpcodecs_vd_ffmpeg;
 extern const vd_functions_t mpcodecs_vd_theora;
 extern const vd_functions_t mpcodecs_vd_dshow;
+extern const vd_functions_t mpcodecs_vd_dshowserver;
 extern const vd_functions_t mpcodecs_vd_dmo;
 extern const vd_functions_t mpcodecs_vd_vfw;
 extern const vd_functions_t mpcodecs_vd_vfwex;
@@ -71,6 +72,7 @@
 #ifdef CONFIG_OGGTHEORA
     &mpcodecs_vd_theora,
 #endif
+        &mpcodecs_vd_dshowserver,
 #ifdef CONFIG_WIN32DLL
     &mpcodecs_vd_dshow,
     &mpcodecs_vd_dmo,
Index: Makefile
===================================================================
--- Makefile	(revision 32493)
+++ Makefile	(working copy)
@@ -20,6 +20,7 @@
 # 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301 USA.
 
 include config.mak
+EXTRALIBS += -lrt
 
 ###### variable declarations #######
 
@@ -521,6 +522,7 @@
               stream/stream_mf.c \
               stream/stream_null.c \
               stream/url.c \
+              libmpcodecs/vd_dshowserver.c \
               $(SRCS_COMMON-yes)
 
 
@@ -900,6 +902,8 @@
 libdvdread4/%: CFLAGS := -Ilibdvdread4 -D_GNU_SOURCE $(CFLAGS_LIBDVDCSS_DVDREAD) $(CFLAGS)
 libfaad2/%:    CFLAGS := -Ilibfaad2 -DHAVE_CONFIG_H $(CFLAGS_FAAD_FIXED) $(CFLAGS)
 
+libmpcodecs/%: CFLAGS := $(CFLAGS) -g -O0
+
 loader/%: CFLAGS += -fno-omit-frame-pointer $(CFLAGS_NO_OMIT_LEAF_FRAME_POINTER)
 #loader/%: CFLAGS += -Ddbg_printf=__vprintf -DTRACE=__vprintf -DDETAILED_OUT
 loader/win32%: CFLAGS += $(CFLAGS_STACKREALIGN)
