# Maintainer: lolilolicon <lolilolicon{at}gmail{dot}com>

pkgname=ffcast
pkgver=20110518
pkgrel=2
pkgdesc="Takes screencast of given window or screen area using ffmpeg, xwininfo, and xrectsel."
arch=(i686 x86_64)
url="http://github.com/lolilolicon/ffcast"
license=(GPL3)
makedepends=(git)
depends=('bash>=3.2' xorg-xwininfo libx11 'ffmpeg>=0.5' 'x264>=20090416' bc)

_gitroot="git://github.com/lolilolicon/ffcast.git"
_gitname=master

build() {
  msg "Connecting to GIT server..."
  if [ -d "$srcdir/$pkgname" ]; then
    cd "$srcdir/$pkgname" && git pull origin $_gitname
  else
    git clone "$_gitroot" "$srcdir/$pkgname"
    cd "$srcdir/$pkgname" && git checkout $_gitname
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  rm -rf "$srcdir/$pkgname-build"
  git clone "$srcdir/$pkgname" "$srcdir/$pkgname-build"

  cd "$srcdir/$pkgname-build"
  make
}

package() {
  cd "$srcdir/$pkgname-build"
  make PREFIX=/usr DESTDIR="$pkgdir" install
}
