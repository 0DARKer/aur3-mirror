_plugin_name=self_destructing_cookies
_plugin_version=0.4.6

pkgname=firefox-extension-self-destructing-cookies
pkgver=$_plugin_version
pkgrel=1
pkgdesc="Fix the web. Gets rid of a site's cookies and LocalStorage as soon as you close its tabs. Protects against trackers and zombie-cookies. Trustworthy services can be whitelisted."

license=('GPL2')
arch=('any')
url="https://addons.mozilla.org/en-US/firefox/addon/self-destructing-cookies"
depends=("firefox")

source=("https://addons.mozilla.org/firefox/downloads/file/277030/${_plugin_name}-${_plugin_version}.xpi")
sha256sums=('10462eb3e700da142bba6d26ae03cf0bbbd5c1a22112aa142de9fd21c21c4ca9')

package() {
  cd $srcdir

  emid=$(sed -n '/.*<em:id>\(.*\)<\/em:id>.*/{s//\1/p;q}' install.rdf) || return 1
  local dstdir=$pkgdir/usr/lib/firefox/browser/extensions/${emid}

  install -d $dstdir
  cp -r * $dstdir
  rm $dstdir/$_plugin_name-$_plugin_version.xpi
  chmod -R 755 $dstdir
}
