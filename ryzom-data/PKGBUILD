# Maintainer:Bjoern Bidar <theodorstormgrade@gmail.com>
pkgname=ryzom-data
pkgver=1122
pkgrel=2
pkgdesc="Ryzom game data"
arch=('any')
url="http://www.ryzom.com/"
license=('CCPL:by-sa')
makedepends=('p7zip' 'rsync')
provides=('ryzom-data')
source=( 'https://sourceforge.net/projects/ryzom/files/ryzom_client.7z' )
noextract=("ryzom_client.7z")
md5sums=( 'dd4d093e041fa86579a30ea2514484fb' )
# The package is big and xz is slow
PKGEXT='.pkg.tar.gz'

build() {
  :
}

package() {
  cd "$srcdir"
  7za x -ro${pkgdir}/usr/share/ryzom_data ryzom_client.7z ryzom/data
  cd ryzom/data/

  msg "Updating the official Ryzom game data, this can take a while..."
  rsync -rtzvu --progress --stats --recursive --timeout=30 www.ryzom.com::ryzom/data/ ./ > /dev/null 2>&1 
  msg 'Update completed...'

  cd "$srcdir/ryzom/data"

  # creating directories
  install -d -m 755 "${pkgdir}/usr/share/ryzom/data/fonts/"

  # installing files
  install -m 644 fonts/* "${pkgdir}/usr/share/ryzom/data/fonts/"
  rm -rf fonts

  install -m 644 * "${pkgdir}/usr/share/ryzom/data/"


}