# Maintainer: Perberos <perberos@gmail.com>
pkgname=cosmicbreak
pkgver=0.33.0
pkgrel=20110507
pkgdesc="CosmicBreak is an MMO third person shooter featuring massive PvP battles of up to 30 vs. 30 players at one time. Familiar WASD control and fast-paced Arena action makes CosmicBreak quick and easy to get into for any gamer."
arch=('any')
url="http://www.cosmicbreak.com/"
license=('custom:cosmicbreak')
depends=('wine')
makedepends=('cabextract')
source=(cosmicbreak.desktop
		cosmicbreak.sh
		cosmicbreak_16.png
		cosmicbreak_32.png
		cosmicbreak_64.png)
md5sums=('d4bfb4b2d929911efba0ba21ac37dacc'
         '2c8a053a0b24d31a592f2d138862c303'
         'cbf3d993c9ecdd97104d279b705d74f5'
         'c52eb297d21e2cf8ca06371a017fe96d'
         'bd1fe97b40ccb16a3ffb718274f149fe')

install=cosmicbreak.install
_fileinstaller="CosmicBreakSetup_eng.exe"

package() {
	wget -c http://download.getamped.com/CosmicBreakSetup_eng.exe
	# carpetas basicas
	install -dm775 ${pkgdir}/opt/cosmicbreak
	install -dm644 ${pkgdir}/usr/share/licenses/${pkgname}/
	install -dm644 ${pkgdir}/usr/share/doc/${pkgname}/

	# el archivo ejecutable se puede descomprimir como .cab
	cabextract --directory=${pkgdir}/opt/cosmicbreak/ ${_fileinstaller}
	
	# quitando archivos sin usar
	rm -f ${pkgdir}/opt/cosmicbreak/install-panel.bmp
	rm -f ${pkgdir}/opt/cosmicbreak/install-icon.bmp
	rm -f ${pkgdir}/opt/cosmicbreak/cs-banner.bmp
	rm -f ${pkgdir}/opt/cosmicbreak/CosmicBreak.com.URL
	
	# grupo y permisos
	chgrp games -R ${pkgdir}/opt/cosmicbreak/
	chmod 775 -R ${pkgdir}/opt/cosmicbreak/

	# movemos la licencia y copyright a su debida carpeta
	mv ${pkgdir}/opt/cosmicbreak/CosmicBreakClientSoftwareLicenseAgreement.txt \
		${pkgdir}/usr/share/licenses/${pkgname}/LICENSE
	mv ${pkgdir}/opt/cosmicbreak/readme.txt \
		${pkgdir}/usr/share/licenses/${pkgname}/COPYRIGHT
	mv ${pkgdir}/opt/cosmicbreak/StageEditorManual.pdf \
		${pkgdir}/usr/share/doc/${pkgname}/
	
	# menu icon
	install -Dm644 ${srcdir}/cosmicbreak.desktop \
		${pkgdir}/usr/share/applications/cosmicbreak.desktop
	install -Dm644 ${srcdir}/cosmicbreak.sh \
		${pkgdir}/usr/bin/cosmicbreak
	chmod +x ${pkgdir}/usr/bin/cosmicbreak
	
	# los iconos
	install -Dm644 ${srcdir}/cosmicbreak_16.png \
		${pkgdir}/usr/share/icons/hicolor/16x16/apps/cosmicbreak.png
	install -Dm644 ${srcdir}/cosmicbreak_32.png \
		${pkgdir}/usr/share/icons/hicolor/32x32/apps/cosmicbreak.png
	install -Dm644 ${srcdir}/cosmicbreak_64.png \
		${pkgdir}/usr/share/icons/hicolor/64x64/apps/cosmicbreak.png
}
