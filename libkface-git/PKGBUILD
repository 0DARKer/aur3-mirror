# Contributor: Flamelab <panosfilip@gmail.com> 
# PKGBUILD based on libkface-svn. Contributors:
# Chris Heien <chris.h.heien@gmail.com>
# Dany Martineau <dany.luc.martineau at gmail.com>

pkgname=libkface-git
pkgver=20110206
pkgrel=1
pkgdesc='LibFace Library interface for KDE'
arch=('i686' 'x86_64')
license=('GPL')
url="http://www.digikam.org/"
depends=('kdelibs' 'libface-svn')
makedepends=('git')
options=('!libtool')
provides=('libkface')

_gitroot="git://anongit.kde.org/libkface.git"
_gitname="libkface"

build() {

   cd ${srcdir}/

    msg "Connecting to the GIT server...."
    if [[ -d ${srcdir}/${_gitname} ]] ; then
    	cd ${_gitname}
    	git pull origin
    	msg "The local files are updated..."
    else
    	git clone --depth=1 ${_gitroot}
    fi

    msg "GIT checkout done."

    msg "Starting make for: ${pkgname}"

    if [[ -d ${srcdir}/${_gitname}-build ]]; then
       msg "Cleaning the previous build directory..."
       rm -rf ${srcdir}/${_gitname}-build
    fi

    cp -r ${srcdir}/${_gitname} ${srcdir}/${_gitname}-build

    cd ${srcdir}/${_gitname}-build

    rm cmake/modules_opencv/FindOpenCV.cmake

    cmake -DCMAKE_INSTALL_PREFIX=/usr \
     -DCMAKE_SKIP_RPATH=ON 

}

package() {

  cd ${srcdir}/${_gitname}-build

  make DESTDIR="$pkgdir" install

}
