pkgname=eagle
pkgver=6.0.0
pkgrel=1
pkgdesc="A powerful suite for schematic capture and printed circuit board design (aka eaglecad)"
arch=('i686' 'x86_64')
url="http://www.cadsoft.de/"
license=('custom')
[[ $CARCH = i686 ]] && depends=('gcc-libs' 'libjpeg6' 'libpng12' 'libxcursor' 'libxi'
    'libxrandr' 'openssl-compatibility')
[[ $CARCH = x86_64 ]] && depends=('lib32-fontconfig' 'lib32-freetype2'
    'gcc-libs-multilib' 'lib32-libjpeg6' 'lib32-libpng12' 'lib32-libxcursor'
    'lib32-libxi' 'lib32-libxrandr' 'lib32-libxrender' 'lib32-openssl-compatibility')
options=('!strip')
source=(ftp://ftp.cadsoft.de/$pkgname/program/${pkgver%.*}/$pkgname-lin-$pkgver.run
        $pkgname.desktop $pkgname.sh)
md5sums=('a3265d222a68c5d7251384063e63e5fc'
         '8744e3b023e728660b97146b2e3c2dc7'
         'b8ca9325c3600b2a9e837c71b36a0cc1')

build() {
  cd $srcdir
  install -Dm755 $pkgname.sh $pkgdir/usr/bin/$pkgname
  install -Dm644 $pkgname.desktop \
    $pkgdir/usr/share/applications/$pkgname.desktop

  msg2 "Running installation script (this may take a while)..."
  sh $pkgname-lin-$pkgver.run $pkgdir/opt > /dev/null || return 1
  install -dm755 $pkgdir/usr/share/{man/man1,licenses/$pkgname,pixmaps}
  ln -sf /opt/$pkgname-$pkgver/doc/$pkgname.1 \
    $pkgdir/usr/share/man/man1/$pkgname.1
  ln -sf /opt/$pkgname-$pkgver/doc/license_en.txt \
    $pkgdir/usr/share/licenses/$pkgname/LICENSE
  chown -R root:root $pkgdir/opt/$pkgname-$pkgver
  sed -i "s/@VERSION@/$pkgver/; s/@RELEASE@/$pkgrel/" \
    $pkgdir/usr/{bin/$pkgname,share/applications/$pkgname.desktop}
}
