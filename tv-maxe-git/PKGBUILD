# Maintainer: jfperini <@jfperini>
# Contributor: jfperini <@jfperini>

pkgname=tv-maxe-git
pkgver=0.r35.695decf
pkgrel=1
pkgdesc="Watch TV channels on Linux"
arch=('i686' 'x86_64')
url="http://code.google.com/p/tv-maxe/"
license=('GPLv3')
makedepends=('git')
depends=('python2' 'pygtk' 'vlc' 'mplayer' 'libstdc++5' 'sopcast' 'gstreamer0.10-python' 'ffmpeg' 'python2-pillow' 'python-virtkey')
conflicts=('tv-maxe' 'tv-maxe-svn')
optdepends=('lirc' 'mencoder')
install=tv-maxe.install

source=("$pkgname"::'git+https://code.google.com/p/tv-maxe/')
# Because the sources are not static, skip Git checksum:
md5sums=('SKIP')

pkgver() {
  cd "$srcdir/$pkgname"
  # Use the tag of the last commit
  printf "0.r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}



build() {
	cd "$srcdir/$pkgname"
}

package() {

	cd "$srcdir/$pkgname"
	
	rm -rf {.git,.gitignore,CONTRIBUTORS,COPYING,CREDITS,LICENSE.txt,README.md}

	install -m 755 -d $pkgdir/usr/share/tv-maxe
	
	echo "[Desktop Entry]
	Version=1.0
	Encoding=UTF-8
	Type=Application
	Categories=AudioVideo
	Name=TV-maxe
	Comment=Watch TV channels on Linux
	Exec=tv-maxe
	Icon=/usr/share/tv-maxe/tvmaxe.png
	StartupNotify=true
	Terminal=false" | tee tv-maxe.desktop
	chmod +x tv-maxe.desktop && echo -e "...Ok.\n"
	
	install -m 644 -D $srcdir/$pkgname/tv-maxe.desktop $pkgdir/usr/share/applications/tv-maxe.desktop

	
	install -m 755 -D tv-maxe $pkgdir/usr/bin/tv-maxe
	cp -avx * $pkgdir/usr/share/tv-maxe
	sed -i "s|python|python2|g" $pkgdir/usr/bin/tv-maxe
	
	

}

# vim:set ts=2 sw=2 et:
