# Maintainer: crazyelf5

pkgname=chromium-pepper-flash
pkgver=11.2.31.109
pkgrel=2
pkgdesc="Google Chrome's Pepper Flash plugin for Chromium"
arch=('i686' 'x86_64')
_arch=amd64
[ $CARCH = 'i686' ] && _arch=i386
url="http://wiki.archlinux.org/index.php/Chromium"
license=('non-free')
depends=('chromium-browser' 'openssl>=1.0.0')
install=pepper.install

package() {
  wget http://dl.google.com/linux/direct/google-chrome-unstable_current_${_arch}.deb -O - | bsdtar -xf - data.tar.lzma

  bsdtar -xf data.tar.lzma opt/google/chrome/PepperFlash

  install -dm755 "$pkgdir/opt/chromium-browser/PepperFlash"
  for i in opt/google/chrome/PepperFlash/*; do install -m644 "$i" "$pkgdir/opt/chromium-browser/PepperFlash"; done

  # Change libcrypto.so version
  sed -i 's|libcrypto.so.0.9.8|libcrypto.so.1.0.0|g' "$pkgdir/opt/chromium-browser/PepperFlash/libpepflashplayer.so"

  sed -i "s/version=0/version=${pkgver}/g" "$startdir/pepper.install"
}
