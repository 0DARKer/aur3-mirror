# Maintainer: crazyelf5

pkgname=chromium-pepper-flash
pkgver=11.2.31.114
pkgrel=1
pkgdesc="Google Chrome's Pepper Flash plugin for Chromium"
arch=('i686' 'x86_64')
_arch=amd64
[ $CARCH = 'i686' ] && _arch=i386
url="http://wiki.archlinux.org/index.php/Chromium"
license=('non-free')
depends=('chromium-browser' 'openssl098')
makedepends=('wget')
install=pepper.install

package() {
  wget http://dl.google.com/linux/direct/google-chrome-unstable_current_${_arch}.deb
  bsdtar -xf google-chrome-unstable_current_${_arch}.deb data.tar.lzma
  bsdtar -xf data.tar.lzma opt/google/chrome/PepperFlash

  if [ ! -f /etc/chromium-browser/default ]; then
    install -dm 755 "$pkgdir/etc/chromium-browser"
    echo 'CHROMIUM_FLAGS="--enable-greasemonkey --enable-sync"' >> "$pkgdir/etc/chromium-browser/default"
  fi

  install -dm755 "$pkgdir/opt/chromium-browser/PepperFlash"
  for i in opt/google/chrome/PepperFlash/*; do install -m644 "$i" "$pkgdir/opt/chromium-browser/PepperFlash"; done

  sed -i "s/version=0/version=${pkgver}/g" "$startdir/pepper.install"
}
