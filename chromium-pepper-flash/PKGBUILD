# Maintainer: Ner0

pkgname=chromium-pepper-flash
pkgver=11.4.31.102
pkgrel=1
pkgdesc="Google Chrome's Pepper Flash plugin for Chromium (latest development version)"
arch=('i686' 'x86_64')
url="http://www.google.com/chrome"
license=('custom:chrome')
#depends=('chromium')
optdepends=('pulseaudio-alsa: For PulseAudio users')
conflicts=('chromium-pepper-flash-stable')
install=pepper.install

if [[ "$CARCH" == 'i686' ]]; then
   _arch='i386'
   md5sums=('0167b19c49eb1a47a7d8f36c545b5a29')
elif [[ "$CARCH" == 'x86_64' ]]; then
   _arch='x86_64'
   md5sums=('2d4052a1a71e973af2ad8474cb797060')
fi

source=("google-chrome-pepper-${pkgver}_${_arch}.rpm::https://dl.google.com/dl/linux/direct/google-chrome-unstable_current_$_arch.rpm")

[[ -f '/usr/bin/chromium-browser' ]] && _default='/etc/chromium-browser/default'
[[ -f '/usr/bin/chromium' ]] && _default='/etc/chromium/default'

package() {
  if [ ! -f "$_default" ]; then
    error "There's no '$_default' file. Reinstall Chromium or create it manually." && return 1
  fi

  install -dm755 "$pkgdir/usr/lib/PepperFlash"
  install -m644 opt/google/chrome/PepperFlash/* "$pkgdir/usr/lib/PepperFlash"
  sed -i "s/flashver=.*/flashver=$pkgver/" "$startdir/pepper.install"
}
