# Contributor: Yaohan Chen <yaohan.chen@gmail.com>
# modelled after the dofus AUR package by robb_force
pkgname=defenders-quest

pkgver=1.0.73

pkgrel=1
pkgdesc='A Tower Defense / RPG hybrid that focuses on story, customization, and tactics. (requires full copy of game)'
url='http://www.defendersquest.com/'
license=("custom")
arch=('i686' 'x86_64')
# LICENSE.txt copied from http://www.defendersquest.com/eula.html

source=(defenders_quest_1_0_73.tar.gz::
air-generic-launcher.sh
LICENSE.txt)
depends=('adobe-air-sdk')

md5sums=('d7da836f6e761057d869c030181df329'
         'f179eaa5e6e6674b1853cf826fc33c3a'
         '0a762badadf7f3827cc300f3ac21fdda')

package() {
  install_dir="opt/$pkgname"
  mkdir -p "$pkgdir/$install_dir"

  cd $srcdir
  cp -R share "$pkgdir/$install_dir"
  rm -rf "$pkgdir/$install_dir/share/NativeApps/"{Mac,Windows}

  mkdir -p "$pkgdir/$install_dir/bin"
  install "$srcdir/air-generic-launcher.sh" "$pkgdir/$install_dir/bin/$pkgname"
  mkdir -p "$pkgdir/usr/bin"
  ln -s "/$install_dir/bin/$pkgname" "$pkgdir/usr/bin/"
  

  mkdir -p "$pkgdir/usr/share/applications"
  cat > "$pkgdir/usr/share/applications/${pkgname}.desktop" <<EOF
[Desktop Entry]
Encoding=UTF-8
Type=Application
Name=Defender's Quest
GenericName=Defender's Quest
Comment=Defender's Quest
Icon=/$install_dir/share/icons/icon48.png
Exec=/$install_dir/bin/$pkgname
Path=/$install_dir/share
Categories=Game;RolePlaying
EOF

  mkdir -p "$pkgdir/usr/share/licenses/$pkgname"
  install -t "$pkgdir/usr/share/licenses/$pkgname" "$srcdir/LICENSE.txt"
}
# vim:set ts=2 sw=2 et:
