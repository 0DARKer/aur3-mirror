# Maintainer: Glen Oakley <goakley123@gmail.com>

pkgname=terralang-git
pkgrel=1
pkgver=9b464ef
pkgdesc="A low-level counterpart to Lua"
arch=('i686' 'x86_64')
url="http://terralang.org/"
license=('MIT')
groups=()
depends=('clang' 'gcc-libs' 'llvm' 'luajit')
makedepends=('git' 'clang')
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
noextract=()
source=("$pkgname"::'git://github.com/zdevito/terra.git')
md5sums=('SKIP')

pkgver () {
  cd "$srcdir/$pkgname"
  git describe --always | sed 's/-/./g'
}

build() {
  cd "$srcdir/$pkgname"
  make
}

package() {
  cd "$srcdir"
  mkdir -p "$pkgdir/usr/bin"
  cp "$srcdir/$pkgname/terra" "$pkgdir/usr/bin/"
  mkdir -p "$pkgdir/usr/share/licenses/$pkgname"
  cp "$srcdir/$pkgname/LICENSE.txt" "$pkgdir/usr/share/licenses/$pkgname"
  mkdir -p "$pkgdir/usr/lib"
  cp "$srcdir/$pkgname/build/"*.a "$pkgdir/usr/lib/"
  cp "$srcdir/$pkgname/build/"*.o "$pkgdir/usr/lib/"
  mkdir -p "$pkgdir/usr/include/terra"
  cp "$srcdir/$pkgname/build/"*.h "$pkgdir/usr/include/terra/"
  cp "$srcdir/$pkgname/src/"*.h "$pkgdir/usr/include/terra/"
}
