# Maintiner: Kyle Keen <keenerd@gmail.com>
pkgname=fexl-git
pkgver=20120922
pkgrel=1
pkgdesc="A small and embeddable interpreter for a programming language based on functions.  Broken!"
url="http://fexl.com/code/"
arch=('i686' 'x86_64')
license="GPLv3"
depends=()
makedepends=('git')
source=()
md5sums=()

_gitroot="git@github.com:chkoreff/Fexl.git"
_gitname="Fexl"

build() {
    msg "No really, this is broken."
    msg "Comment out the return if you are dead set on building it."
    return 1
    cd "$srcdir"
    msg "Connecting to github..."

    if [ -d "$srcdir"/${_gitname} ] ; then
        cd ${_gitname} && git pull origin
        msg "The local files are updated."
    else
        git clone --depth 1 ${_gitroot}
    fi

    msg "GIT checkout done or server timeout"
    msg "Starting build..."

    cd "$srcdir/$_gitname"
    ./build
    # his custom build tool is fairly broken
    sed -i "s|$pkgdir/usr/lib/fexl/libfexl.so|/usr/lib/fexl/libfexl.so\x00|" bin/fexl
}

package() {
    cd "$srcdir/$_gitname"
    # more brokenness
    mkdir -p "$pkgdir/usr/bin/"
    mkdir -p "$pkgdir/usr/share/fexl"
    sed -i "s|\"/usr\"|\"$pkgdir/usr\"|" build
    sed -i 's|$sudo||' build
    sed -i 's|sudo ||' build
    # oh, and tries to run gcc with root privileges
    ./build install
}
