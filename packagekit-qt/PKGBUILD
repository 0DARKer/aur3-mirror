# Contributor: PirateJonno <j@skurvy.no-ip.org>
# Contributor: Zom <zom@eevul.org>
# Contributor: fettouhi <A.Fettouhi@gmail.com>

pkgname=packagekit-qt
pkgver=0.6.12
pkgrel=1
pkgdesc='Qt-specific libs for PackageKit.'
arch=('i686' 'x86_64')
url='http://www.packagekit.org/'
license=('GPL')
depends=('glib2>=2.22.0' 'dbus-glib>=0.74' 'polkit>=0.92'
	 'pacman-glib' 'python2' 'sqlite3' 'packagekit')
makedepends=('intltool' 'qt' 'gobject-introspection')
options=('!libtool')
source=("http://www.packagekit.org/releases/PackageKit-${pkgver}.tar.bz2")
sha256sums=('29c2f1dab00d10ca97a782bc0632edcc4d8517221fe82176248718b3432e5fab')

build() {
	cd "${srcdir}/PackageKit-${pkgver}"
	
	sed -i 's/SUBDIRS = test/SUBDIRS =/' backends/Makefile.in
	
	./autogen.sh --prefix=/usr \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--libexecdir=/usr/lib/PackageKit \
		--disable-static \
		--disable-gtk-doc \
		--enable-qt \
		--disable-managed \
		--disable-tests \
		--disable-local \
		--disable-browser-plugin \
		--disable-gstreamer-plugin \
		--disable-gtk-module \
		--disable-command-not-found \
		--disable-cron \
		--disable-debuginfo-install \
		--disable-pm-utils \
		--disable-dummy \
		--enable-pacman \
		--with-default-backend=pacman

	# we only need the stuff in this directory, the rest is already there
	cd ${srcdir}/PackageKit-${pkgver}/lib/packagekit-qt
	make -s || return 1
	make -s DESTDIR=${pkgdir} install || return 1
}
