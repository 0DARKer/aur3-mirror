# Contributor: Dmitriy Morozov <archlinux@foxcub.org>
pkgname=visit-bin
_pkgname=visit
pkgver=2.7.1
_pkgver=2_7_1
pkgrel=1
pkgdesc="Interactive parallel visualization and graphical analysis tool"
url="https://wci.llnl.gov/codes/visit/"
arch=('x86_64')
license="BSD"
depends=('libpng')
makedepends=('cpio')
source=(http://portal.nersc.gov/svn/${_pkgname}/trunk/releases/$pkgver/${_pkgname}${_pkgver}.linux-x86_64-ubuntu11.tar.gz
        http://portal.nersc.gov/svn/${_pkgname}/trunk/releases/$pkgver/${_pkgname}-install${_pkgver}
        visit-bin.sh
        visit.patch)
md5sums=('90b6398c4d9cae30dfb627997ca900f3'
         '5d556d1572a50c10c8ed12407d811d92'
         'eda322f9745ff8ace1cfbec7536929df'
         '1e3e007983fe50f42c405b42cca8102b')

build()
{
    cd ${srcdir}
    mkdir -p ${pkgdir}/opt/$_pkgname
    mv ${_pkgname}${_pkgver}.linux-x86_64-ubuntu11.tar.gz ${_pkgname}${_pkgver}.linux-x86_64.tar.gz
    sh $_pkgname-install$_pkgver -c none $pkgver linux-x86_64 ${pkgdir}/opt/$_pkgname

    patch ${pkgdir}/opt/visit/bin/frontendlauncher < ${srcdir}/visit.patch

    mkdir -p ${pkgdir}/etc/profile.d/
    install -m 755 visit-bin.sh ${pkgdir}/etc/profile.d/
}
