# Maintainer: eolianoe <eolianoe [At] GmaiL [Dot] com>
# Contributor: Dmitriy Morozov <archlinux@foxcub.org>
pkgname=visit-bin
_pkgname=visit
pkgver=2.8.1
_pkgver=2_8_1
pkgrel=1
pkgdesc="Interactive parallel visualization and graphical analysis tool"
url="https://wci.llnl.gov/simulation/computer-codes/visit"
arch=('x86_64')
license=('BSD' 'custom')
provides=('visit')
conflicts=('visit' 'visit-svn')
depends=('libpng12' 'glu')
makedepends=('cpio')
#_ver=ubuntu11
_ver=rhel6
source=(${_pkgname}${_pkgver}.linux-x86_64.tar.gz::http://portal.nersc.gov/svn/${_pkgname}/trunk/releases/${pkgver}/${_pkgname}${_pkgver}.linux-x86_64-${_ver}.tar.gz
        http://portal.nersc.gov/svn/${_pkgname}/trunk/releases/${pkgver}/${_pkgname}-install${_pkgver}
        visit-bin.sh
        visit.patch)
noextract=(${_pkgname}${_pkgver}.linux-x86_64.tar.gz)
md5sums=('de40bc23567c0c80e0ef98c304e76ce1'
         'f02d0365c1542f13e179accc5ec84d33'
         'eda322f9745ff8ace1cfbec7536929df'
         '47b97f9275adc14dbbda8fab5c63d131')

package() {
  cd ${srcdir}

  install -dm755 ${pkgdir}/opt/${_pkgname}
  
  sh ${_pkgname}-install${_pkgver} -c none ${pkgver} linux-x86_64 ${pkgdir}/opt/${_pkgname}

  patch ${pkgdir}/opt/visit/bin/frontendlauncher < ${srcdir}/visit.patch

  install -Dm755 visit-bin.sh ${pkgdir}/etc/profile.d/visit-bin.sh
}
