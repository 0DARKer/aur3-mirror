export CFLAGS="$CFLAGS -O0 -fbuiltin -g"
export CXXFLAGS="$CXXFLAGS -O0 -fbuiltin -g"

pkgname=screencloud-git
pkgver=r37.fec175a
pkgrel=1
pkgdesc="Easy to use screenshot sharing application."
arch=('i686' 'x86_64')
url=http://screencloud.net
license=('custom')
depends=('qt4' 'qoauth' 'qca' 'qca-ossl' 'sdl' 'sdl_mixer' 'qt4-solutions' 'quazip' 'libqxt' 'qtscriptgenerator')
#options=('strip' 'docs' 'libtool' 'staticlibs' 'emptydirs' 'zipman' 'purge' '!upx' '!debug')

options=(!strip libtool debug)

source=(git://github.com/olav-st/screencloud.git)
sha512sums=('SKIP')

conflicts=(screencloud)

install=screencloud.install

pkgver() {
  cd "${pkgname%-*}"
  printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
}

build() {
  cd "${pkgname%-*}"
  mkdir build
  cd build
  cmake ../screencloud -DQT_QMAKE_EXECUTABLE=/usr/bin/qmake-qt4
  make
}

package() {
  cd "${pkgname%-*}/build"
  make DESTDIR="$pkgdir" install
  install -dm755 "$pkgdir/usr/bin"
  ln -s /opt/screencloud/screencloud.sh "$pkgdir/usr/bin/screencloud"
}
