# Maintainer: Martin Rotter <rotter.martinos@gmail.com>
# Contributor: Petr Vanek <petr@scribus.info>

pkgname=rss-guard
pkgver=0.9.9
pkgrel=2
pkgdesc='A (very) tiny RSS & ATOM reader developed using Qt framework.'
arch=('i686' 'x86_64')
url="http://code.google.com/p/rss-guard/"
license=('GPL3')
depends=(qt curl qtwebkit hicolor-icon-theme)
makedepends=(gcc git)

__gitname=rss-guard
__gitroot=https://Rotter.Martinos@code.google.com/p/rss-guard/

build() {
  cd "$srcdir"
  msg "Cloning rss-guard repository..."
  
  if [ -d $__gitname ] ; then
    cd $__gitname && git pull origin
    msg "The local files are updated..."
  else
    git clone $__gitroot
  fi

  msg "Git checkout done or server timeout..."
  cd "$srcdir/$__gitname"

  msg "Preparing files with qmake..."
  qmake -makefile -Wall -recursive
  qmake *.pro

  msg "Compiling files..."
  make
  msg "All files were successfully compiled..."
}

package() {
  install -D -m755 $srcdir/$__gitname/bin/rssguard $pkgdir/usr/bin/rssguard
  install -D -m755 $srcdir/$__gitname/resources/graphics/rssguard.png $pkgdir/usr/share/icons/hicolor/128x128/apps/rssguard.png
  install -D -m755 $srcdir/$__gitname/resources/desktops/rssguard.desktop $pkgdir/usr/share/applications/rssguard.desktop
}
