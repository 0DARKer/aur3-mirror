# Maintainer:   Lucky <archlinux@builds.lucky.li>

pkgname=bley-git
_pkgname="${pkgname%-*}"
pkgver=189.f9f14e7
pkgrel=1
pkgdesc="Intelligent greylisting daemon for Postfix"
url="http://bley.mx"
license=("BSD")
arch=("any")
backup=("etc/bley/bley.conf")
depends=("python2" "python2-pyspf" "twisted")
optdepends=("python-psycopg2: required for PostgreSQL support"
            "mysql-python: required for MySQL support")
makedepends=("git" "python2-distribute")
source=("git://github.com/evgeni/bley.git")
md5sums=("SKIP")

pkgver() {
  cd "${_pkgname}"
  #git describe --tags --always | sed "s|^${_pkgname}/||g;s|-|.|g"
  echo $(git rev-list --count master).$(git rev-parse --short master)
  #date +%Y%m%d
}

build() {
  cd "${srcdir}/${_pkgname}"
  python2 setup.py build
}

package() {
  cd "${srcdir}/${_pkgname}"
  python2 setup.py install --root="${pkgdir}"
}
