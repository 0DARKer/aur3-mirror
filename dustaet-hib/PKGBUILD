pkgname=dustaet-hib
pkgver=01082014
pkgrel=1
pkgdesc="Dust: An Elysian Tail. An action packed 2D, hack'n'slay platformer"
arch=('i686' 'x86_64')
url="http://www.noogy.com/main.html"
license=('custom:commercial')
makedepends=('unzip')

DLAGENTS+=('hib::/usr/bin/echo "Could not find %u. Manually download it to \"$(pwd)\", or set up a hib:// DLAGENT in /etc/makepkg.conf."; exit 1')

_gamepkg="dustaet-${pkgver}-bin"

source=("hib://$_gamepkg"
	"dustaet.desktop")
noextract=("$_gamepkg")

sha512sums=('e79f9e67256640e2587ba738d4213c7763c63f8084ae1046f1604c674cc396b8f4183b6d890a540d979dead899bbf1ec5016dce4729bfbb4876d9dec92cbc1ae'
	'22fefa7210fa7e33861f714d41ce838a7f24a34ccd9ea27b6812841eaf79116c841ca4fd5470d366112f462e8b2f1d93eb64e79b1fa4c6985411b4935efeb528')

PKGEXT='.pkg.tar'

package() {
	mkdir -p $pkgdir/opt/dustaet
	mkdir -p $pkgdir/usr/{bin,share/applications}
	unzip $_gamepkg data/* -d $srcdir/ || true
	mv $srcdir/data/* $pkgdir/opt/dustaet/
	echo -e "#!/bin/bash\ncd /opt/dustaet/\n./DustAET" > $pkgdir/usr/bin/dustaet
	chmod a+x $pkgdir/usr/bin/dustaet
	mv ${source[1]} $pkgdir/usr/share/applications/
}
