# Maintainer: Jesus Alvarez <jeezusjr@gmail.com>
# Contributor: sxe <sxxe@gmx.de>
# Based on the wine-git in AUR

pkgname='wine-compholio-bin'
pkgver=1.5.17
_pkgname='wine-compholio'
_pkgpre='1.5.17~quantal11'
pkgrel=1
pkgdesc="A compatibility layer for running Windows programs with netflix-desktop patches."
url="https://launchpad.net/~ehoover/+archive/compholio/"
arch=('x86_64')
license=('LGPL')
install=wine-compholio.install

depends=(
  fontconfig      lib32-fontconfig
  mesa            lib32-mesa
  libxcursor      lib32-libxcursor
  libxrandr       lib32-libxrandr
  libxdamage      lib32-libxdamage
  libxi           lib32-libxi
  gettext         lib32-gettext
  desktop-file-utils
)
makedepends=(#autoconf ncurses bison perl fontforge flex prelink
  giflib          lib32-giflib
  libpng          lib32-libpng
  gnutls          lib32-gnutls
  libxinerama     lib32-libxinerama
  libxcomposite   lib32-libxcomposite
  libxmu          lib32-libxmu
  libxxf86vm      lib32-libxxf86vm
  libxml2         lib32-libxml2
  libldap         lib32-libldap
  lcms            lib32-lcms
  mpg123          lib32-mpg123
  openal          lib32-openal
  v4l-utils       lib32-v4l-utils
  alsa-lib        lib32-alsa-lib
  samba
)
optdepends=(
  giflib          lib32-giflib
  libpng          lib32-libpng
  libldap         lib32-libldap
  gnutls          lib32-gnutls
  lcms            lib32-lcms
  libxml2         lib32-libxml2
  mpg123          lib32-mpg123
  openal          lib32-openal
  v4l-utils       lib32-v4l-utils
  libpulse        lib32-libpulse
  alsa-plugins    lib32-alsa-plugins
  alsa-lib        lib32-alsa-lib
  oss             cups
  samba
)

if [[ $CARCH == i686 ]]; then
  # Strip lib32 etc. on i686
  depends=(${depends[@]/*32-*/})
  makedepends=(${makedepends[@]/*32-*/})
  makedepends=(${makedepends[@]/*-multilib*/})
  optdepends=(${optdepends[@]/*32-*/})
fi

# wine-compholio_1.5.17~quantal11_i386.deb
_url="https://launchpad.net/~ehoover/+archive/compholio/+files"
_deb="${_pkgname}_${_pkgpre}_i386.deb"
source=("${_url}/${_deb}" "wine-compholio.sh" "wine-compholio.conf" "wine-compholio.install")
md5sums=('c56356853e15a348488834d66214b978'
         'd498baf51c66f5557fa9c55fc668320f'
         '8fa84e57657f504a67191455488d47e1'
         'e56bcd68746a8bacc21dd4664e4b0333')

build() {
    msg2 "Extracting files..."
    cd "$srcdir"
    ar x ${_deb}
    tar xf data.tar.lzma -C $pkgdir
    # msg2 "Making it nice..."
    # mkdir -p $pkgdir/usr/share/licenses/${pkgname}
    # ln -s /usr/share/doc/${_pkgname}/copyright $pkgdir/usr/share/licenses/${pkgname}/LICENSE.txt
}

package() {
  install -Dm755 $srcdir/wine-compholio.sh $pkgdir/etc/profile.d/wine-compholio.sh
  install -Dm644 $srcdir/wine-compholio.conf $pkgdir/etc/ld.so.conf.d/wine-compholio.conf
}
# vim:set ts=2 sw=2 et:
