# Contributor: grimi <grimi at poczta dot fm>

pkgname=omnibook-git
pkgver=20110911
pkgrel=6
pkgdesc="Kernel module for HP OmniBook,Pavilion,Toshiba and Compal ACL00 laptops"
arch=('i686' 'x86_64')
url="http://omnibook.sourceforge.net"
license=('GPL')
depends=('linux')
makedepends=('git' 'linux-headers')
conflicts=('omnibook')
provides=('omnibook')
source=("$pkgname::git://omnibook.git.sourceforge.net/gitroot/omnibook/omnibook" "omnibook-kernel-3.0.patch")
md5sums=('SKIP' '149b5ae2d66998fdc2490f15e99b1e35')
install=$pkgname.install


pkgver() {
   cd "$srcdir/$pkgname"
   git log -1 --format="%cd" --date="short"|sed 's|-||g'
}


build() {
  cd "$srcdir/$pkgname"
  patch -Np0 -i ../omnibook-kernel-3.0.patch
  make
  gzip omnibook.ko
}


package() {
  cd "$srcdir/$pkgname"
  install -Dm644 omnibook.ko.gz \
     "$pkgdir"/usr/lib/modules/extramodules-$(uname -r|sed 's/\(.\..\).*/\1/')-ARCH/omnibook.ko.gz
}

