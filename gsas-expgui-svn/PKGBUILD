# Maintainer: Zachary A. Jones <jazzplayerl9@gmail.com>
pkgname=gsas-expgui-svn
pkgver=1187
pkgrel=2
pkgdesc="General Structure Analysis System - refinement for powder diffraction patterns"
arch=(i686 x86_64)
url="http://www.ccp14.ac.uk/solution/gsas/"
license=(custom)
depends=(libstdc++5 python2 subversion tcsh tcl tk blt)
makedepends=(hd2u)
source=(http://11bm.xor.aps.anl.gov/downloads/gsas/svnload/gsassvnlinux.tar.gz
	EXPGUI.desktop
	GSAS.desktop
	bootstrap.patch
	license.txt)

md5sums=('23a38547be86cc1ac318b62898d39d42'
	 'd1de894759785072e29add004b6d5d6c'
	 '6bf9e5e1a0b67267658d63b5537843e5'
	 '37d1b1396b6c75b8573ec79ad075a302'
	 '4c8e94cd085eae5c6557331514483b78')
build() 
{
  cd "$pkgdir"
  mkdir -p opt/gsas
  mkdir -p usr/share/licenses/gsas-expgui-svn/
  cd opt/gsas
  bsdtar -x -f "$srcdir/gsassvnlinux.tar.gz"
  patch "$srcdir/bootstrap.py" < "$srcdir/bootstrap.patch"
  cp "$srcdir/bootstrap.py" "$pkgdir/opt/gsas/bootstrap.py"
  python2 bootstrap.py
  cd "$pkgdir"
  install -m 644 -D "$srcdir/license.txt" usr/share/licenses/gsas-expgui-svn/LICENSE
  mkdir -p usr/share/applications/
  install -m 644 -D "$srcdir/GSAS.desktop" usr/share/applications/GSAS.desktop
  install -m 644 -D "$srcdir/EXPGUI.desktop" usr/share/applications/EXPGUI.desktop
  mkdir -p usr/bin
  dos2unix "$pkgdir/opt/gsas/expgui/expgui"
  chmod +x "$pkgdir/opt/gsas/expgui/expgui"
  ln -s /opt/gsas/GSAS usr/bin/GSAS
  ln -s /opt/gsas/expgui/expgui usr/bin/expgui
}
