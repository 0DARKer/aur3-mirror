# Maintainer: Tom Kuther <gimpel@sonnenkinder.org>

pkgname=blocxx-svn
pkgver=20120129
pkgrel=1
pkgdesc="A cross-platform, general purpose C++ framework for application development"
provides=('blocxx')
conflicts=('blocxx')
arch=('i686' 'x86_64')
url="http://sourceforge.net/projects/blocxx"
license=('BSD')
depends=('openssl' 'pcre')
makedepends=('re2c' 'subversion')
source=()

_svnname='blocxx'
_svnroot='https://blocxx.svn.sourceforge.net/svnroot/blocxx/trunk'

build() {
	if [ -d ${srcdir}/${_svnname}/.git ] ; then
		( cd ${srcdir}/${_svnname} && svn up )
		msg "The local files are updated."
	else
		( svn co ${_svnroot} ${_svnname} )
	fi
	msg "SVN checkout done or server timeout"

	msg "creating build directory"
	cd ${srcdir}
	[ -d ${_svnname}-build ] && rm -rf ${_svnname}-build
	cp -a ${_svnname} ${_svnname}-build

	msg "Starting make..."
	cd ${_svnname}-build
	aclocal
	libtoolize --force --automake --copy
	autoheader
	automake --add-missing --copy
	autoconf
	./configure --prefix=/usr
	make
}

package() {
	cd ${_svnname}-build
	msg2 "Running make install"
	make DESTDIR=${pkgdir} install
}
