# Maintainer: Andy Weidenbaum <archbaum@gmail.com>

pkgname=bfgminer
pkgver=2.9.4
pkgrel=1
pkgdesc="Bitcoin miner featuring overclocking, monitoring, fan speed control and remote management. For FPGA/GPU/CPU Bitcoin mining."
arch=('i686' 'x86_64')
depends=('curl' 'jansson' 'ncurses')
makedepends=('make')
optdepends=('libopencl: build with AMD GPU mining support'
            'opencl-catalyst: build with AMD GPU mining support'
            'libcl: build with NVIDIA GPU mining support'
            'yasm: add assembly routines for improved CPU mining support')
url="https://github.com/luke-jr/bfgminer"
license=('GPL3')
source=(http://luke.dashjr.org/programs/bitcoin/files/$pkgname/$pkgver/$pkgname-$pkgver.tbz2
        Makefile.patch)
sha256sums=('c0ae1ec0c7c897fa7c538a4d07395a195c048cd28a37526f2d8c4791209dcc46'
            '6481f2fce4e32a1fa226f4d3041281b4596c34d57f0b67c8c83f3398a1c437e0')
provides=('bfgminer')
conflicts=('bfgminer' 'cgminer')

build() {
  cd "$srcdir"/$pkgname-$pkgver

  msg "Patching Makefile.am..."
  patch -p1 < ${srcdir}/Makefile.patch

  msg "Running configure..."
  ./configure --prefix=/usr --enable-cpumining

  msg "Running make..."
  make
}

package() {
  cd "$srcdir"/$pkgname-$pkgver

  msg "Installing..."
  make DESTDIR="$pkgdir" install
}
