# Mantainer: Ivan de Jesús Pompa García <ivan.pompa@gmx.com>
# Contributor: kyak <bas@bmail.ru>

pkgname=('dkms-alx')
_vname='3.8-rc5-1'
_dkmsname='alx'
pkgver='3.8'
pkgrel=1
epoch=2
pkgdesc='Atheros alx Linux ethernet device driver'
arch=('i686' 'x86_64')
url='http://linuxwireless.org/'
license=('custom')
depends=('dkms')
makedepends=('linux-headers>=3.7')
options=('!strip')
conflicts=('dkms-alx', 'alx-driver', 'alx-driver-legacy')
provides=('dkms-alx', 'alx-driver', 'alx-driver-legacy')
install=alx-driver.install
source=(
  http://www.kernel.org/pub/linux/kernel/projects/backports/stable/v3.8-rc5/compat-drivers-${_vname}-u.tar.bz2
	dkms.conf
)

md5sums=(
  '1c3060c3139012564339136b2fd0b945'
  '68b773e00558fd9646a9a2224db86e8c'
)

build() {
	cd ${srcdir}/compat-drivers-${_vname}-u
	rm -rf drivers/net/wireless
	./scripts/driver-select alx

	mkdir -p ${pkgdir}/usr/src/${_dkmsname}-${pkgver}
    cp -RL ${srcdir}/compat-drivers-${_vname}-u/* ${pkgdir}/usr/src/${_dkmsname}-${pkgver}
    cp -RL ${srcdir}/compat-drivers-${_vname}-u/.compat* ${pkgdir}/usr/src/${_dkmsname}-${pkgver}
    cp -RL ${srcdir}/dkms.conf ${pkgdir}/usr/src/${_dkmsname}-${pkgver}
}
