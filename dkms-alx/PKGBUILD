# Mantainer: Ivan de Jesús Pompa García <ivan.pompa@gmx.com>
# Contributor: kyak <bas@bmail.ru>

pkgname=dkms-alx
_pkgname=alx
pkgver=20121204
pkgrel=1
_vname='2012-12-04-1-u'
pkgdesc='DKMS-controlled Atheros alx Linux ethernet device driver'
url='http://www.linuxfoundation.org/collaborate/workgroups/networking/alx'
arch=('i686' 'x86_64')
license=('custom')
depends=('dkms')
options=('!strip')
provides=('alx' 'alx-driver' 'dkms-alx')
conflicts=('alx' 'alx-driver' 'dkms-alx')

source=(
	'http://www.kernel.org/pub/linux/kernel/projects/backports/2012/12/04/compat-drivers-2012-12-04-1-u.tar.bz2'
	'dkms.conf'
)
md5sums=(
	'bc46200e288acb862149a2af11f4b293'
	'cd2f584cd3a932ddd730ed1f781fac27'
)

install=alx-driver.install

build() {
	cd "${srcdir}/compat-drivers-${_vname}"
	rm -rf drivers/net/wireless
	./scripts/driver-select alx
}

package() {
	cd "${srcdir}"
	mkdir -p ${pkgdir}/usr/src/${_pkgname}-${pkgver}
	cp -RL compat-drivers-${_vname}/* ${pkgdir}/usr/src/${_pkgname}-${pkgver}
	cp -RL compat-drivers-${_vname}/.compat* ${pkgdir}/usr/src/${_pkgname}-${pkgver}
	cp -RL dkms.conf ${pkgdir}/usr/src/${_pkgname}-${pkgver}
}
