# Maintainer: Vasil Yonkov <bustervill at fastmail dot fm>
pkgname=libebur128-git
_gitname=libebur128
pkgver=649.ef61e33
pkgrel=1
pkgdesc="A library implementing the EBU R128 loudness standard."
arch=('x86_64')
url="https://github.com/jiixyj/libebur128"
license=('MIT')
makedepends=('git' 'cmake')
optdepends=('gtk2: scanner dependency'
            'qt: scanner dependency'
            'taglib: scanner dependency'
            'libsndfile: SNDFILE input module support'
            'mpg123: MPG123 input module support'
            'libmpcdec: MPCDEC input module support'
            'ffmpeg: FFMPEG input module support'
            'gstreamer0.10: GStreamer  input module support')
source=('libebur128::git://github.com/jiixyj/libebur128.git')
md5sums=('SKIP')

pkgver() {
  cd $_gitname
  echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

build() {
  cd $_gitname
  git submodule init
  git submodule update
  git checkout 1c0e8dac8d1a2f1ce07bee469d26ccfbb2688247
  mkdir build
  cd build
  cmake -DCMAKE_INSTALL_LIBDIR:path=lib -DCMAKE_INSTALL_PREFIX=/usr ..
  make
}

package() {
  cd $_gitname/build
  make PREFIX=/usr DESTDIR="$pkgdir/" install
  install -d -m755 ${pkgdir}/usr/share/licenses/${pkgname}/
  ln -sf /usr/share/doc/COPYING ${pkgdir}/usr/share/licenses/${pkgname}/
}

# vim:set ts=2 sw=2 et:
