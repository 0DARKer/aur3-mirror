# Maintainer: Drake Arconis <lightdrake@gmail.com>

pkgname=exodus-bin
pkgver=12.11.24.1
pkgrel=2
pkgdesc="This is an alternative viewer for SecondLife. SecondLife is a 3-D virtual world entirely built and owned by its residents."
url="http://www.exodusviewer.com/"
license=('LGPL')
depends=('openal' 'gnome-vfs' 'gtk2' 'libpng' 'dbus-glib' 'libidn' 'sdl' 'mesa')
optdepends=('gstreamer0.10: For video support - may need good, bad and ugly plugins')
[ "$CARCH" = "x86_64" ] && depends=('lib32-gtk2' 'lib32-libpng' 'lib32-openal' 'lib32-dbus-glib' 'lib32-libidn' 'lib32-sdl' 'lib32-mesa')
[ "$CARCH" = "x86_64" ] && optdepends=('lib32-nvidia-utils: GL support for NVIDIA drivers' 'lib32-catalyst-utils: GL support for Catalyst Drivers')
arch=('i686' 'x86_64')
install="exodus.install"
source=("http://files.exodusviewer.com/linux/x86/exodusviewer-$pkgver.tar.lzma" 'exodus.install' 'exodus.desktop' 'exodus.launcher')
sha512sums=('b931c7b8a82cb8fbdf57cd27d0b6d2115f70d02cc6d21081645641993669353544eee982933188d124daf6d9d9a8cf872d20ffef4ae5e4f9ba5da8fe8061d5cf'
            '93a3ca0096cf2b7af78b406f3722b90c2166a5af75889c230709b58d56352b51abe360aa1434e62ca1e9c55c6c4ee5b7b63d33b38455334551544ae2b18f1e42'
            'f547f0ba7181d478c2530df8088c716d13d612cbc9ca756bd807488d70c4dfd7c998c26e3b85ca898b7e40187e8959171003ce48f9874e3ed9b24ddcf4c7d575'
            '9e899744285f8529f5a9e7bc235e2064478d578d3f2ecb4dd1b6ee6d15fd1cf9bcf41fa60acf840f061aee017ce710281da30d5bafb9b732a4e13b6ba8cc0603')

build() {
    cd $srcdir;

    # Rename Data Directory
    mv exodusviewer-${pkgver}/ exodus-bin
    chmod 755 exodus-bin

    # Install Desktop File
    install -D -m644 $srcdir/exodus.desktop \
        $pkgdir/usr/share/applications/exodus.desktop

    # Install Icon File
    install -D -m644 $srcdir/exodus-bin/secondlife_icon.png \
        $pkgdir/usr/share/pixmaps/exodus_icon.png

    # Install Launcher
    install -D -m755 $srcdir/exodus.launcher \
        $pkgdir/usr/bin/exodus

    # Move Data to Destination Directory
    install -d $pkgdir/opt/
    mv exodus-bin/ $pkgdir/opt

    # Change Permissions of files to root:games
    chown -R root:games $pkgdir/opt/exodus-bin
    chmod -R g+r $pkgdir/opt/exodus-bin

    # Make Binary Group-Executable
    chmod g+x $pkgdir/opt/exodus-bin/secondlife
}
