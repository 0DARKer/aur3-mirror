# Maintainer: archtux <antonio dot arias99999 at gmail dot com>

pkgname=miam-player
pkgver=0.7.0
pkgrel=1
pkgdesc="Cross-platform open source music player built with Qt5, VLC and Taglib."
arch=('i686' 'x86_64')
url="http://www.miam-player.org/"
license=('GPL3')
depends=('libvlc-qt-git' 'qt5-multimedia')
source=(https://github.com/MBach/Miam-Player/archive/v$pkgver.tar.gz
        $pkgname.desktop)
md5sums=('bf5fe93f8097a364038f276069ae9bb5'
         '7e4d5016d7d0610a9126bc528d4dd757')

prepare() {
  cd $srcdir/Miam-Player-$pkgver/code

  # Fix Uppercase/Lowercase error for building(Separatoritem.h -> separatoritem.h)
  sed -i 's|Separatoritem.h|separatoritem.h|' MiamPlayer/library/separatoritem.cpp

  qmake-qt5       
}

build() {
  cd $srcdir/Miam-Player-$pkgver/code
  make       
}

package() {
  cd $srcdir/Miam-Player-$pkgver/code
  make INSTALL_ROOT=$pkgdir install
  
  # Desktop icon
  cd $srcdir
  install -Dm644 $pkgname.desktop $pkgdir/usr/share/applications/$pkgname.desktop
  install -Dm644 Miam-Player-$pkgver/packaging/debian/miam-player/usr/share/icons/hicolor/64x64/apps/application-x-miamplayer.png $pkgdir/usr/share/pixmaps/$pkgname.png

}