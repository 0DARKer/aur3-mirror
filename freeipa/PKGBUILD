# Maintainer: Fran√ßois Steinmetz <francois.steinmetz@gmail.com>

pkgname=freeipa
pkgver=2.1.4
pkgrel=2
epoch=
pkgdesc="FreeIPA (identity, policy, audit) is an integrated security information management solution."
arch=('x86_64')
url="http://freeipa.org"
license=('GPL')
groups=()
depends=('python2' 'authconfig' 'python2-ldap' 'python2-netaddr' 'sssd' 'python-nss')
makedepends=()
checkdepends=()
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
changelog=
source=("http://freeipa.org/downloads/src/$pkgname-$pkgver.tar.gz"
        "ipa-client-common.patch"
        "util.patch")
noextract=()
md5sums=('213047f62f3dfa5d6088fe916356c298'
         'c2b55cbd0fd2846381aab08065d315e8'
         '3844382a00780c2ebd8c8f76dcc47a7d')

build() {
  cd "$srcdir/$pkgname-$pkgver"

  # python2 fixes
  sed -i 's/python setup/python2 setup/' Makefile
  sed -i 's|\<python\>|python2|' makeapi
  sed -i 's|python |python2 |' ipapython/Makefile
  sed -i 's|python |python2 |' ipapython/py_default_encoding/Makefile
  
  patch -p2 -i "$srcdir/util.patch"
  patch -p2 -i "$srcdir/ipa-client-common.patch"

  make
}

check() {
  echo
}

package() {
  cd "$srcdir/$pkgname-$pkgver"
  make DESTDIR="$pkgdir/" install
}

# vim:set ts=2 sw=2 et:
