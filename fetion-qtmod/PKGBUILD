# Maintainer: Corsair <chris.corsair@gmail.com>
pkgname=fetion-qtmod
realname=linux-fetion
pkgver=0.9.1
pkgrel=1
pkgdesc="Linux Fetion a QT IM client, Using CHINA MOBILE's Fetion Protocol "
arch=('i686' 'x86_64')
url="http://www.libfetion.cn/"
license=('GPL')
depends=("qtmod>4.3" "curl" "gcc-libs" "libstdc++5")
makedepends=("gcc")
source=(http://libfetion-gui.googlecode.com/files/$realname-$pkgver.tar.gz)
md5sums=('68e336f9d6566a4cd7b757dbc3630a7c')

build()
{
  cd ${startdir}/src/${realname}-${pkgver}

  # if [[ "${CARCH}" == "x86_64" ]]; then
  #   ./64_libfetion.sh
  # fi

  qmake || return 1
  make ||return 1

  install -d ${startdir}/pkg/usr/{bin,share/{applications,libfetion,pixmaps,app-install/icons}}
  install -m755 ${startdir}/src/${realname}-${pkgver}/linux-fetion \
    ${startdir}/pkg/usr/bin/
  install -m644 ${startdir}/src/${realname}-${pkgver}/misc/LibFetion.desktop \
    ${startdir}/pkg/usr/share/applications/
  cp -R ${startdir}/src/${realname}-${pkgver}/skins \
    ${startdir}/pkg/usr/share/libfetion/
  cp -R ${startdir}/src/${realname}-${pkgver}/faces_image \
    ${startdir}/pkg/usr/share/libfetion/
  cp -R ${startdir}/src/${realname}-${pkgver}/sound \
    ${startdir}/pkg/usr/share/libfetion/
  install -m644 ${startdir}/src/${realname}-${pkgver}/fetion_utf8_CN.qm \
    ${startdir}/pkg/usr/share/libfetion/
  install -m644 ${startdir}/src/${realname}-${pkgver}/misc/fetion.png \
    ${startdir}/pkg/usr/share/pixmaps/
  install -m644 ${startdir}/src/${realname}-${pkgver}/misc/fetion.png \
    ${startdir}/pkg/usr/share/app-install/icons
  chmod -R 755 $startdir/pkg/usr/share/libfetion
}
