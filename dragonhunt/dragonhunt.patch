--- code/g.py~	2007-05-06 13:17:19.000000000 +0600
+++ code/g.py	2009-11-06 14:53:20.374121445 +0500
@@ -31,7 +31,7 @@
 from random import random
 #needed for save/load game
 import pickle
-from os import path, mkdir, remove, walk
+from os import path, mkdir, remove, walk, environ
 
 #needed for scripting
 from scripting import *
@@ -137,11 +137,11 @@
 #uses pickle, first line is a version number.
 def savegame(save_file):
 	#If there is no save directory, make one.
-	if path.isdir(g.mod_directory + "/saves") == 0:
-		if path.exists(g.mod_directory + "/saves") == 1:
-			remove(g.mod_directory + "/saves")
-		mkdir(g.mod_directory + "/saves")
-	save_loc = g.mod_directory + "/saves/" + save_file
+	if path.isdir(environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves") == 0:
+		if path.exists(environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves") == 1:
+			remove(environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves")
+		mkdir(environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves")
+	save_loc = environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves/" + save_file
 	savefile=open(save_loc, 'w')
 	#savefile version; update whenever the data saved changes.
 	pickle.dump("dh3.3", savefile)
@@ -187,7 +187,7 @@
 	savefile.close()
 
 def loadgame(save_file):
-	save_loc = g.mod_directory + "/saves/" + save_file
+	save_loc = environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves/" + save_file
 	savefile=open(save_loc, 'r')
 	version = pickle.load(savefile)
 	if version != "dh3.3":
@@ -229,7 +229,7 @@
 	savefile.close()
 
 def loadgame_31(save_file):
-	save_loc = g.mod_directory + "/saves/" + save_file
+	save_loc = environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves/" + save_file
 	savefile=open(save_loc, 'r')
 	version = pickle.load(savefile)
 	if version != "dh3.2":
@@ -372,7 +372,7 @@
 	fullscreen = 0
 	#try to open settings.txt. If it doesn't exist,
 	# just use the default settings.
-	try: file = open("../settings.txt", 'r')
+	try: file = open(environ["HOME"] + "/.dragonhunt/settings.txt", 'r')
 	except IOError: return 0
 	line = file.readline()
 	while (line != ''):
--- code/loadgame.py~	2007-05-05 10:43:50.000000000 +0600
+++ code/loadgame.py	2009-11-06 14:54:55.267445839 +0500
@@ -21,7 +21,7 @@
 
 import pygame
 import g
-from os import listdir, path, mkdir, remove
+from os import listdir, path, mkdir, remove, environ
 
 #was a game loaded? Used to determine whether to use newgame script.
 did_load = ""
@@ -92,7 +92,7 @@
 			tmp_titles.append("")
 #		return
 	else:
-		save_loc = g.mod_directory + "/saves/" + saves_array[saves_pos]
+		save_loc = environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves/" + saves_array[saves_pos]
 		savefile=open(save_loc, 'r')
 		version_unused = g.pickle.load(savefile)
 		tmp_stats["name"] = str(g.pickle.load(savefile))
@@ -359,14 +359,14 @@
 	pixels_per_line = 20
 
 	#If there is no save directory, make one.
-	if path.isdir(g.mod_directory + "/saves") == 0:
-		if path.exists(g.mod_directory + "/saves") == 1:
-			remove(g.mod_directory + "/saves")
-		mkdir(g.mod_directory + "/saves")
+	if path.isdir(environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves") == 0:
+		if path.exists(environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves") == 1:
+			remove(environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves")
+		mkdir(environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves")
 	#show the files contained in the saves directory.
 	global saves_array
 	saves_array = []
-	tmp_saves_array = listdir(g.mod_directory + "/saves")
+	tmp_saves_array = listdir(environ["HOME"] + "/.dragonhunt/saves/" + g.mod_directory + "/saves")
 	for save_name in tmp_saves_array:
 		if save_name [:1] != "." and save_name  != "CVS":
 			saves_array.append(save_name)
--- code/options.py~	2007-05-06 12:04:14.000000000 +0600
+++ code/options.py	2009-11-06 15:05:38.880717907 +0500
@@ -20,7 +20,7 @@
 
 import pygame
 import g
-from os import path
+from os import path, environ
 
 #-1=none, 0=fullscreen, 1=difficulty, 2=custom key, 3=use joy, 4=custom joy
 #5=save, 6=reset, 7=cancel
@@ -276,8 +276,8 @@
 
 			#save the settings to disk
 			options_file_text = []
-			if path.exists(g.mod_directory + "/../../settings.txt") == 1:
-				optionfile = open(g.mod_directory + "/../../settings.txt")
+			if path.exists(environ["HOME"] + "/.dragonhunt/settings.txt") == 1:
+				optionfile = open(environ["HOME"] + "/.dragonhunt/settings.txt")
 				options_file_text = optionfile.readlines()
 			else:
 				"Could not open settings.txt. Not saving settings."
@@ -309,7 +309,7 @@
 					options_file_text[linenum]=command+"="+str(g.joy_axis1)+"\n"
 
 			optionfile.close()
-			optionfile = open(g.mod_directory + "/../../settings.txt", "w")
+			optionfile = open(environ["HOME"] + "/.dragonhunt/settings.txt", "w")
 			optionfile.writelines(options_file_text)
 
 
