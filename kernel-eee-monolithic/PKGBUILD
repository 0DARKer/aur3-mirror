# Maintainer: phara0h (jan@das-labor.org)

pkgname=kernel-eee-monolithic
#pkgver=2.6.38
#_kernver=2.6.38.6
pkgver=3.0
_kernver=3.0-rc1
pkgrel=1
pkgdesc="The Linux Kernel for the Asus Eee PC 901 without module support"
arch=('i686')
license=('GPL2')
url="http://www.kernel.org"
#makedepends=('gcc<4.6')
replaces=('linux-uvc-eee-svn' 'madwifi-eee-svn' 'kernel26-eee-monolithic')
optdeps=("rt2860-firmware: wlan (if it's not already working)")
install=kernel-eee-monolithic.install
#source=(ftp://ftp.kernel.org/pub/linux/kernel/v2.6/linux-${_kernver}.tar.bz2
#        kernelconfig
#	)
source=(http://www.kernel.org/pub/linux/kernel/v3.0/testing/linux-${_kernver}.tar.bz2
        kernelconfig
       )

build() {
	
  # unset since our build machine may differ from eee
  unset CFLAGS CXXFLAGS

  # get into the linux source directory and start some magic
  cd ${srcdir}/linux-${_kernver}
  
  # load configuration and build kernel
  cp ../kernelconfig ./.config
  make oldconfig || return 1
  #make menuconfig
  make || return 1
 
}

package() {

  # install the kernel
  mkdir ${pkgdir}/lib
  mkdir ${pkgdir}/boot
  cd ${srcdir}/linux-${_kernver}
  cp System.map ${pkgdir}/boot/System.map30-eee
  cp arch/x86/boot/bzImage ${pkgdir}/boot/vmlinuz30-eee
}
md5sums=('98afe9dd7e79f66800c30769ccd11a0f'
         'eda7798231b2047901e2935958d6ec67')
md5sums=('98afe9dd7e79f66800c30769ccd11a0f'
         '623ccb41fbfbc827a950fcd0d063dc10')
