pkgname=lighthouse-git
pkgver=r65.b4fc5b6
pkgrel=3
pkgdesc='lighthouse - A simple scriptable popup dialog to run on X.'
arch=('i686' 'x86_64')
url='https://github.com/emgram769/lighthouse'
license=('MIT')
depends=('libx11' 'libxcb' 'cairo')
source=('git://github.com/emgram769/lighthouse.git' 'lighthouse-git.install')
md5sums=('SKIP' 'f100ee37dd15fe47df3487efc633a151')
install='lighthouse-git.install'

pkgver() {
    cd "$srcdir/lighthouse"
    ( set -o pipefail
      git describe --long --tags 2>/dev/null | sed 's/\([^-]*-g\)/r\1/;s/-/./g' ||
      printf "r%s.%s" "$(git rev-list --count HEAD)" "$(git rev-parse --short HEAD)"
    )
}

build(){
    cd "${srcdir}/lighthouse"
    make
}

package() {
    cd "${srcdir}/lighthouse"
    mkdir -p ${pkgdir}/usr/{bin,share/lighthouse}
    cp lighthouse "${pkgdir}/usr/bin"
    cp -ir config/* "${pkgdir}/usr/share"
    chmod +x "${pkgdir}/usr/share/lighthouse/cmd"
}
