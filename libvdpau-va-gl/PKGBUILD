# Maintainer: Behem0th <grantipak@gmail.com>

pkgname=libvdpau-va-gl
pkgver=20121029
pkgrel=1
pkgdesc='VDPAU driver with OpenGL/VAAPI backend'
arch=('i686' 'x86_64')
url='https://github.com/i-rinat/libvdpau-va-gl'
license=('LGPLv3')
depends=('libvdpau' 'libva' 'libgl' 'ffmpeg')
makedepends=('git')
provides=('libvdpau-va-gl')

_gitroot='https://github.com/i-rinat/libvdpau-va-gl.git'
_gitname='libvdpau-va-gl'

build() {
  msg 'Connecting to github.com GIT server....'

  if [ -d $_gitname ] ; then
    msg "Skipping git pull, do it yourself if you need"
    cd $_gitname
    git pull
    msg 'The local files are updated.'
  else
    git clone $_gitroot
  fi

  msg 'GIT checkout done or server timeout'

  msg 'Creating build directory'
  cd "${srcdir}"
  rm -rf $_gitname-build
  cp -R $_gitname $_gitname-build

  msg 'Starting make...'
  cd $_gitname-build

  cmake -DCMAKE_BUILD_TYPE=Release

  make
}

package() {

cd $_gitname-build

make DESTDIR="${pkgdir}" install
}
