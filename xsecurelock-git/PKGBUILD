# Maintainer: Ricardo Vieira <ricardo.vieira@tecnico.ulisboa.pt>
_pkgver=0.1
_pkgname=xsecurelock
pkgname=xsecurelock-git
pkgver=0.1.6.f33f63c
pkgrel=1
pkgdesc="X11 screen lock utility with security in mind (from google)"
arch=('i686' 'x86_64')
url="https://github.com/google/xsecurelock"
license=('APACHEV2')
groups=()
depends=('libx11' 'libxss' 'pam')
makedepends=('git' 'automake' 'binutils' 'gcc' 'make')
checkdepends=()
optdepends=('mplayer: for the saver_mplayer module' 'mpv: for the saver_mpv module' 'imagemagick: for the auth_pamtester module' 'pamtester: for the auth_pamtester module' 'xorg-server-utils: for the saver_blank module' 'xscreensaver: for the saver_xscreensaver module')
provides=('xsecurelock')
conflicts=('xsecurelock')
replaces=()
backup=()
options=()
install=
changelog=
source=("$_pkgname-$_pkgver"::'git+https://github.com/google/xsecurelock.git#branch=master' 'xsecurelock-pam.patch')
noextract=()
md5sums=('SKIP'
         '74ba40a94b5a03cce8385a73db7ea756')

pkgver() {
	cd "$srcdir/$_pkgname-$_pkgver"
	echo "$_pkgver.$(git rev-list --count HEAD).$(git rev-parse --short master)"
}

prepare() {
	cd "$srcdir/$_pkgname-$_pkgver"
	git apply -v "$srcdir/xsecurelock-pam.patch"
}

build() {
	cd "$srcdir/$_pkgname-$_pkgver"
	sh autogen.sh
	./configure --prefix=/usr --libexecdir=/usr/lib
	make
}

package() {
	cd "$srcdir/$_pkgname-$_pkgver"
	make DESTDIR="$pkgdir/" install
}


