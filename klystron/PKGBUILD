# Contributor: Eric Forgeot < http://anamnese.online.fr >

pkgname=klystron
pkgver=354
pkgrel=1
pkgdesc="A framework for a Thrust clone"
arch=('i686' 'x86_64')
url="http://code.google.com/p/klystron/"
license=('MIT')
depends=('sdl')
provides=('klystron')



build() {
	cd $startdir/
	
    svn co -r 354 http://klystron.googlecode.com/svn/trunk/ --config-dir ./  klystron-read-only


  msg 'SVN checkout done or server timeout'
  msg 'Starting make...'

  #rm -rf "${_svnmod}-build"
  #cp -r "$_svnmod" "${_svnmod}-build"
  #cd "${_svnmod}-build"
  cd ${pkgname}-read-only
  
  sed -i -e "s|bin.\$(CFG)\/ksnd.dll| |g" Makefile
  sed -i -e "s|\@dlltool|#|g" Makefile
  sed -i -e "s|include \"SDL_RWops.h\"|include \"SDL_rwops.h\"|g" src/snd/music.h
	make build
	



	mkdir -p $startdir/pkg/usr/share/klystron
	
}

package() {
  cp -fr $startdir/${pkgname}-read-only/bin.debug/ $startdir/pkg/usr/share/klystron
  cp -fr $startdir/${pkgname}-read-only/src/ $startdir/pkg/usr/share/klystron
  cp -fr $startdir/${pkgname}-read-only/tools/ $startdir/pkg/usr/share/klystron
  cp -fr $startdir/${pkgname}-read-only/deps/ $startdir/pkg/usr/share/klystron
  cp -fr $startdir/${pkgname}-read-only/Makefile $startdir/pkg/usr/share/klystron
}
