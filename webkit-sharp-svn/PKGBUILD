# Contributor: TDY <tdy@gmx.com>
# Contributor: Paul Burton <paulburton89@gmail.com>
# Contributor: rabyte <rabyte__gmail>
# Contributor: Daniel Isenmann <daniel@archlinux.org>

pkgname=webkit-sharp-svn
pkgver=144171
pkgrel=1
pkgdesc="Mono/.NET bindings for the WebKit rendering engine"
arch=('i686' 'x86_64')
url="http://www.mono-project.com/"
license=('custom:MIT')
depends=('gtk-sharp-2' 'libwebkit')
makedepends=('subversion' 'pkgconfig>=0.9.0')
provides=('webkit-sharp')
conflicts=('webkit-sharp')
source=()
md5sums=()

_svntrunk='svn://anonsvn.mono-project.com/source/trunk/webkit-sharp'
_svnmod='webkit-sharp'

build() {
  cd "$srcdir"

  if [ -d $_svnmod/.svn ]; then
    (cd $_svnmod && svn up -r $pkgver)
  else
    svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
  fi

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  rm -rf "$srcdir/$_svnmod-build"
  cp -r "$srcdir/$_svnmod" "$srcdir/$_svnmod-build"
  cd "$srcdir/$_svnmod-build"
  
  export MONO_SHARED_DIR="${srcdir}/.wabi"
  mkdir -p "${MONO_SHARED_DIR}"

  ./autogen.sh --prefix=/usr || return 1
  make || return 1
  make DESTDIR="${pkgdir}" install || return 1
  install -Dm644 COPYING "$pkgdir/usr/share/licenses/$pkgname/COPYING"
}
