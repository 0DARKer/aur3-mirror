# Maintainer: Oleg Smirnov <oleg.smirnov@gmail.com>
# Contributor: Jason Taylor <jftaylor21@gmail.com>
# Contributor: Christophe Gueret <tolgam@homegnu.net>
pkgname=blt
pkgver=2.4z
pkgrel=8
pkgdesc="Adds new commands and widgets to the Tcl interpreter."
url="http://blt.sourceforge.net"
license="custom"
depends=('tk')
makedepends=()
arch=('i686' 'x86_64')
source=(http://downloads.sourceforge.net/sourceforge/${pkgname}/BLT${pkgver}.tar.gz
       blt.diff defines.diff COPYING blt2.4z-noexactversion.patch)
md5sums=('aa2ed73080f3005d9c2a3b5e57ab1eff'
         '5d0287412b5f7807ab2237e59e327db4'
         'bd8d820a8e581650f682ef79041737d2'
         '49ab6c4bd72e045108c92d839368df04'
         '269d703bd10feb6127e384f93c1c8cda')
build() {
	# Fix for the man directory
	mkdir -p ${pkgdir}/usr/share/man

	# Add license
	mkdir -p ${pkgdir}/usr/share/licenses/blt
	cp COPYING ${pkgdir}/usr/share/licenses/blt

	# Patch, configure
	cd ${srcdir}/${pkgname}${pkgver}
	patch -Np1 -i ${srcdir}/blt.diff || return 1
	patch -Np1 -i ${srcdir}/defines.diff || return 1
	patch -Np0 -i ${srcdir}/blt2.4z-noexactversion.patch || return 1

	./configure --prefix=/usr --with-tcl=/usr/lib --with-x --x-includes=/usr/include --x-libraries=/usr/lib --mandir=/usr/share/man

	# Compile, install
	make -j 1 || return 1
	make -j 1 INSTALL_ROOT=$startdir/pkg install

	# Delete man file, it is still owned by extra/tk
	rm ${pkgdir}/usr/share/man/mann/bitmap.n
}
