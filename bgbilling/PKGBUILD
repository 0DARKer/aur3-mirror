# Maintainer: Alexander Boyko <brdcom@ya.ru>
pkgname=bgbilling
_pkgname=BGBillingServer
pkgver=5.2
pkgrel=1410
pkgdesc="BGBilling server"
arch=('i686' 'x86_64') 
url="http://bgbilling.ru"
license=('proprietary')
depends=('mysql' 'activemq' 'java-runtime' 'pbzip2')
makedepends=('unzip' 'dos2unix')
source=(ftp://bgbilling.ru/pub/${pkgname}/${pkgver}/${_pkgname}_${pkgver}_${pkgrel}.zip
	http://bgbilling.ru/test_license/5.0/lic.properties
	service )
install=install

md5sums=('994975c7663ed99126f465f848bf1282'
         '8c68d2529f97471033f7c21f5dc27a57'
         'ec8ffc61b4f5ad130438f8f068876d0d')

build() {
  install -d -m0755 ${pkgdir}/opt
  install -d -m0755 ${pkgdir}/usr/lib/systemd/system

  cp -r ${srcdir}/BGBillingServer ${pkgdir}/opt/${pkgname}
  install -D -m0644 ${srcdir}/dump.sql ${pkgdir}/opt/${pkgname}
  rm -f ${pkgdir}/opt/${pkgname}/data/lic.properties
  install -D -m0644 ${srcdir}/lic.properties ${pkgdir}/opt/${pkgname}/data/lic.properties
  install -D -m0644 ${srcdir}/service ${pkgdir}/usr/lib/systemd/system/bgbilling.service

  cd ${pkgdir}/opt/${pkgname}/script/
  dos2unix *
  chmod 0755 *

  cd ..
  dos2unix *.sh
  chmod 0755 *.sh

  rm -rf *.ini
  rm -rf *.bat
  rm -rf *.exe
  rm -rf prepare*
}
