# Maintainer: maz-1 <loveayawaka at gmail dot com>

_pkgname=nixnote2
pkgname=$_pkgname-git
pkgver=411.7a8d856
pkgrel=1
pkgdesc="A C++ rewrite of nixnote,a clone of Evernote designed to run on Linux.Formerly called nevernote."
arch=('any')
url="http://nevernote.sourceforge.net/"
license=('GPL2')
depends=('tidyhtml' 'opencv' 'hunspell' 'qt4' 'qtwebkit' 'sqlite' 'poppler-qt4')
makedepends=('git' 'qtchooser' 'boost')
provides=($_pkgname)
conflicts=($_pkgname 'nixnote-beta')
source=("git://github.com/baumgarr/$_pkgname.git")
sha256sums=('SKIP')
_gitname=$_pkgname

pkgver() {
	cd "$srcdir/$_gitname"
	echo "$(git rev-list --count HEAD).$(git describe --always)"
}

build() {
	cd "$srcdir/$_gitname"
	#sed -i "s:/usr/lib/x86_64-linux-gnu/qt4/bin/qmake:/usr/lib/qt4/bin/qmake:" ./Makefile
	#sed -i "s:CONFIG+=debug:CONFIG+=release:" ./Makefile
	#sed -i "s:QMAKE_CXXFLAGS +=-g -O2:QMAKE_CXXFLAGS +=-Os:" ./NixNote2.pro
	make
}

package() {
	cd "$srcdir/$_gitname"
	#make DESTDIR="$pkgdir" install
	mkdir -p $pkgdir/usr/share/nixnote2
	mkdir -p $pkgdir/usr/bin
	mkdir -p $pkgdir/usr/share/applications
	install -m 755 ./nixnote2 $pkgdir/usr/bin/nixnote2
	cp -R ./certs $pkgdir/usr/share/nixnote2
	cp -R ./help $pkgdir/usr/share/nixnote2
	cp -R ./images $pkgdir/usr/share/nixnote2
	cp -R ./qss $pkgdir/usr/share/nixnote2
	cp -R ./translations $pkgdir/usr/share/nixnote2
	cp -R ./java $pkgdir/usr/share/nixnote2
	install -m 644 ./changelog.txt $pkgdir/usr/share/nixnote2
	install -m 644 ./copyright $pkgdir/usr/share/nixnote2
	install -m 644 ./gpl.txt $pkgdir/usr/share/nixnote2
	install -m 644 ./license.html $pkgdir/usr/share/nixnote2
	install -m 644 ./README.txt $pkgdir/usr/share/nixnote2
	install -m 644 ./shortcuts.txt $pkgdir/usr/share/nixnote2
	install -m 644 ./nixnote2.desktop $pkgdir/usr/share/applications
}
