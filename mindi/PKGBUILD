# Maintainer: M.Carreira <arch@carreira.com.pt>
# Contributor: M.Carreira <manuel@carreira.com.pt>
pkgname=mindi
pkgver=2.1.1
pkgrel=1
pkgdesc="Create bootable disks or CD image with your system files, to allow system maintenance"
arch=('i686' 'x86_64')
url="http://www.mondorescue.org/"
license=('GPL2')
changelog=ChangeLog
backup=('etc/mindi/mindi.conf' 'etc/mindi/deplist.txt' 'etc/mindi/deplist.d/addon.conf')
depends=('bzip2>=0.9' 'udev>=173' 'cdrkit' 'ncurses' 'binutils' 'gawk' 'dosfstools' 'mindi-busybox>=1.7.3' 'parted' 'perl' 'mtools' 'which' 'grep>=2.5' 'cpio' 'inetutils')

# Not on all systems
#conflicts=(bonnie++)

source=(ftp://ftp.mondorescue.org/src/$pkgname-$pkgver.tar.gz
	install.patch
	addon.patch
	base.patch
	mindi.patch
	minimal.patch
	net.patch
	rcs.patch
	udevfiles.patch)

md5sums=('c0b1b0edfbcd2ee5843f91d97aa99e00'
         'da6b07d496ef315df270f42faa830c86'
         '5c894dfd695a0c28d3c34bbbd8dad2e4'
         'defb1768ffa77be5a6841bbdaaa4d50e'
         'ef38f2444b9ac99b23411722d733119f'
         '9f4a34fee78ee306c7635026ff35d793'
         '8dfd2e26e47e8341a0edd285643d955e'
         '2ba87b950b4afbf9ea821b2bee61e7cd'
         '74788950c34c8d2baf2ae7d43573cf21')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  patch -p1 < ../install.patch
  patch -p1 < ../addon.patch
  patch -p1 < ../base.patch
  patch -p1 < ../mindi.patch
  patch -p1 < ../minimal.patch
  patch -p1 < ../net.patch
  patch -p1 < ../rcs.patch
  patch -p1 < ../udevfiles.patch
  export DONT_RELINK=1
  export HEAD=$pkgdir
  export PREFIX=/usr
  export CONFDIR=/etc
  export DOCDIR=/usr/share/doc
  export LIBDIR=/usr/lib
  export CACHEDIR=/var/cache/$pkgname
  export PKGBUILDMINDI="true"  

 ./install.sh 
  DOCDIR_INST=${pkgdir}${DOCDIR}/${pkgname}-${pkgver}
  install -d $DOCDIR_INST
  install -m 644 ChangeLog AUTHORS COPYING README README.* TODO INSTALL NEWS $DOCDIR_INST
}

# vim:set ts=2 sw=2 et:

