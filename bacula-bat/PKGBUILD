# Maintainer: Dogukan Korkmazturk <d.korkmazturk@gmail.com>
# Maintainer: Stephane Travostino <stephane.travostino@gmail.com>
# Contributor: Calogero Lo Leggio <kalos@autistici.org>

pkgname=bacula-bat
pkgver=5.0.0
pkgrel=1
pkgdesc="Bacula, the Network Backup Tool for Linux, Unix, Mac and Windows [qt console]"
arch=(i686 x86_64)
url="http://www.bacula.org"
license=('GPL')
depends=('qt' 'qwt')
makedepends=('qt' 'qwt')
backup=(etc/bacula/bat.conf)
install="bat.install"
source=("http://downloads.sourceforge.net/sourceforge/bacula/bacula-$pkgver.tar.gz")
md5sums=('68e008d2578a6d9a50af60439db17dcb')

build() {
    cd "$startdir/src/bacula-$pkgver"

    ./configure --prefix=/usr --sbindir=/usr/bin \
    --enable-client-only --enable-bat \
    --with-x --with-tcp-wrappers --with-openssl \
    --sysconfdir=/etc/ --with-scriptdir=/etc/bacula/scripts \
    --with-archivedir=/usr/var/bacula/archive

    make || return 1

    # install only bat files
    mkdir -p $startdir/pkg/etc/ $startdir/pkg/usr/bin/ $startdir/pkg/usr/man/man1
    mkdir -p $startdir/pkg/etc/ $startdir/pkg/etc/bacula
    install -m755 $startdir/src/bacula-$pkgver/src/qt-console/bat $startdir/pkg/usr/bin/bat
    install -m644 $startdir/src/bacula-$pkgver/src/qt-console/bat.conf $startdir/pkg/etc/bacula/bat.conf
    install -m644 $startdir/src/bacula-$pkgver/manpages/bat.1 $startdir/pkg/usr/man/man1/bat.1
}
