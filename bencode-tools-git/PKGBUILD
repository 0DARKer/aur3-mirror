# Author: Enverex <ben@xnode.org>

pkgname=bencode-tools-git
pkgver=20121205
pkgrel=2
pkgdesc="Bencode Tools is a collection of tools for manipulating bencoded data"
arch=('i686' 'x86_64')
url="http://zakalwe.fi/~shd/foss/bencode-tools/"
license=('GPL')
makedepends=('git')
source=('Makefile.patch')
md5sums=('a7b25b4369e65c6572d553f8ed8b8d48')
conflict=('bencode-tools')
provides=('bencode-tools')

_gitroot="git://github.com/heikkiorsila/bencode-tools.git"
_gitname="bencode-tools"

build() {
  cd "$srcdir"
  msg "Connecting to GIT server...."

  if [ -d $_gitname ] ; then
    cd $_gitname && git pull origin
    msg "Local files updated."
  else
    git clone $_gitroot $_gitname
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  rm -rf "$srcdir/$_gitname-build"
  git clone "$srcdir/$_gitname" "$srcdir/$_gitname-build"

  cd "$srcdir/$_gitname-build"
  patch < "$srcdir/Makefile.patch"
  ./configure --prefix="/usr" --package-prefix="$pkgdir"
  make
}

package() {
  cd "$srcdir/$_gitname-build"
  make install
}
