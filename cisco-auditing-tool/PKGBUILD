# Maintainer: fnord0 <fnord0 at riseup dot net>
pkgname=cisco-auditing-tool
pkgver=1
pkgrel=1
pkgdesc="Perl script which scans cisco routers for common vulnerabilities. Checks for default passwords, easily guessable community names, and the IOS history bug. Includes support for plugins and scanning multiple hosts."
arch=('i686' 'x86_64')
url="http://www.scrypt.net"
license=('GPL')
depends=('perl')
source=(http://www.packetstormsecurity.org/cisco/CiscoAuditingTool-v$pkgver.tar.gz)
md5sums=(8d3a3e32c04648d29469a9f37e65caf3)

build() {
                cd $srcdir/CiscoAuditingTool
                install -d $startdir/pkg/usr/bin || return 1
		install -d $startdir/pkg/usr/share/${pkgname}/lib || return 1
		install -d $startdir/pkg/usr/share/${pkgname}/lib/Net || return 1
		install -d $startdir/pkg/usr/share/${pkgname}/plugins || return 1
		install -d $startdir/pkg/usr/share/${pkgname}/lists || return 1
		install -Dm755 $startdir/CAT ${startdir}/pkg/usr/bin/CAT || return 1
                install -Dm755 CAT ${startdir}/pkg/usr/share/${pkgname}/CAT || return 1
                install -Dm644 TODO ${startdir}/pkg/usr/share/${pkgname}/${doc} || return 1
		cd $srcdir/CiscoAuditingTool/lib/Net
                for lib in SNMP.pm Telnet.pm; do
                        install -Dm644 ${lib} ${startdir}/pkg/usr/share/${pkgname}/lib/Net/${lib} || return 1
                done
		cd $srcdir/CiscoAuditingTool/lists
                for lists in passwords community; do
                        install -Dm644 ${lists} ${startdir}/pkg/usr/share/${pkgname}/lists/${lists} || return 1
                done
		cd $srcdir/CiscoAuditingTool/plugins
                for plugins in snmp brute ihist usage; do
                        install -Dm644 ${plugins} ${startdir}/pkg/usr/share/${pkgname}/plugins/${plugins} || return 1
                done
                msg "CiscoAuditingTool avaiable on '/usr/share/cisco-auditing-tool' and, is called from '/usr/bin/CAT'"
}
