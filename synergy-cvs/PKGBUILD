# Contributor: slubman <slubman.dndd@slubman.info>

pkgname=synergy-cvs
pkgver=20080429
pkgrel=1
pkgdesc="A software kvm without the video thing"
arch=(i686 x86_64)
makedepends=('cvs')
depends=('gcc-libs' 'libxtst' 'libsm' 'libxinerama') 
backup=('etc/synergy.conf')
source=(gcc43.patch)
conflicts=('synergy')
provides=('synergy')
license=('GPL')
options=('!libtool')
url="http://synergy2.sourceforge.net/"

_cvsroot=":pserver:anonymous@synergy2.cvs.sourceforge.net:/cvsroot/synergy2"
_cvsmod="synergy"

build() {
   cd $startdir/src

   # get the sources
   msg "Connecting to synergy2.sourceforge.net CVS server...."
   if [ -d $_cvsmod/CVS ]; then
      cd $_cvsmod
      cvs -z3 update -d
   else
      cvs -z3 -d $_cvsroot co $_cvsmod
      cd $_cvsmod
   fi
   msg "CVS checkout done or server timeout"

   # patch for gcc 4.3
   patch -p0 < $startdir/src/gcc43.patch

   # Build
   ./configure --prefix=/usr
   make || return 1
   make DESTDIR=$startdir/pkg install

   # Installing sample conf
   mkdir $startdir/pkg/etc
   install -m644 examples/synergy.conf $startdir/pkg/etc/synergy.conf
}

md5sums=('c60457ebd9911451fd3097c9ac38a449')
sha256sums=('6390649b027dc21ac9333956422e442ffb9e618ed4e8ebab23f590cb568a543a')
