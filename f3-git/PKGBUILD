# Maintainer:   Lucky <archlinux@builds.lucky.li>

pkgname=f3-git
_pkgname="${pkgname%-*}"
pkgver=33.b5dba24
pkgrel=1
pkgdesc="Integrity test for data media, especially for recognising USB sticks and SD cards that have been tampered with. An alternative to h2testw"
url="http://oss.digirati.com.br/f3/"
license=("GPL3")
arch=("i686" "x86_64")
install=${pkgname}.install
source=("git://github.com/AltraMayor/${_pkgname}.git")
md5sums=("SKIP")

pkgver() {
  cd "${_pkgname}"
  #git describe --always | sed "s|^${_pkgname}-||g;s|-|.|g"
  echo $(git rev-list --count master).$(git rev-parse --short master)
  #date +%Y%m%d
}

build() {
  cd "${srcdir}/${_pkgname}"
  make linux
}

package() {
  cd "${srcdir}/${_pkgname}"

  install -Dm755 "f3write"  "${pkgdir}/usr/bin/f3write"
  install -Dm755 "f3read"   "${pkgdir}/usr/bin/f3read"

  install -Dm644 "LICENSE"  "${pkgdir}/usr/share/licenses/${_pkgname}/LICENSE"
  install -Dm644 "f3read.1" "${pkgdir}/usr/share/man/man1/f3read.1"
}
