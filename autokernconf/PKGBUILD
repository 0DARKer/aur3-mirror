# Maintainer:  TDY <tdy@gmx.com>
# Contributor: Paulo Freire <paulofreire gmail com>

pkgname=autokernconf
pkgver=2010.07.22
pkgrel=1
pkgdesc="AUTOmagical KERNel CONFiguration via the Linux Kernel Driver Database (LKDDb)"
arch=('any')
url="http://cateee.net/autokernconf/"
license=('GPL')
depends=('coreutils' 'grep' 'sed' 'which')
optdepends=('pciutils: for pci.ids data'
            'util-linux-ng: for dmesg support')
install=$pkgname.install
source=(http://cateee.net/sources/$pkgname/$pkgname-${pkgver//./-}.tar.gz
        http://cateee.net/sources/lkddb/lkddb-${pkgver//./-}.tar.gz)
md5sums=('7d83bde4d35253f7dd439532e6ff2e54'
         'e53e34dfbf971c2993e701c1a9bd79a7')

build() {
  cd "$srcdir/$pkgname-${pkgver//./-}"
  sed -i 's#s\(bin/lsmod\)#\1#' kdetect.sh
  sed -i "s#lkddb\.list#/usr/share/$pkgname/&#" $pkgname.sh
  install -Dm755 kdetect.sh "$pkgdir/usr/bin/kdetect"
  install -Dm755 $pkgname.sh "$pkgdir/usr/bin/$pkgname"
  install -Dm755 ../lkddb-${pkgver//./-}/lkddb.list \
    "$pkgdir/usr/share/$pkgname/lkddb.list"
}
