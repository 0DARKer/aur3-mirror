pkgname=libpkcs11-gost
pkgver=4.2.0
pkgrel=1
pkgdesc="Module OpenSSL PKCS#11 GOST for Rutoken ECP"
url="http://www.rutoken.ru/"
license=("custom")
depends=("openssl")
conflicts=("libp11")
options=("!emptydirs")
arch=("i686"
      "x86_64")
if [ "${CARCH}" == "i686" ]
then
  filename="pkcs11-gost-linux-x86.zip"
  md5sums=("df581b5ef85afe4576371e8d2c6f9ae3")
elif [ "${CARCH}" == "x86_64" ]
then
  filename="pkcs11-gost-linux-x64.zip"
  md5sums=("03ae35df988b2f7c8a0493300ec1025d")
fi
source=("https://download.rutoken.ru/Rutoken/Support_OpenSSL/${pkgver}/${filename}")

package(){
  install -dm 0755                               "${pkgdir}/usr/lib/pkcs11-gost"
  install -Dm 0644 "${srcdir}/libp11.so.2"       "${pkgdir}/usr/lib/libp11.so.2"
  install -Dm 0644 "${srcdir}/libpkcs11_gost.so" "${pkgdir}/usr/lib/pkcs11-gost/libpkcs11_gost.so"
  install -Dm 0644 "${srcdir}/librtpkcs11ecp.so" "${pkgdir}/usr/lib/pkcs11-gost/librtpkcs11ecp.so"
}
