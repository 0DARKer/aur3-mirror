# Maintainer: JokerYu <dayushinn@gmail.com>
pkgname=forticlientsslvpn
pkgver=4.4.2297
pkgrel=2
pkgdesc="Fortinet SSL VPN Client for linux"
arch=("i686" "x86_64")
url="https://support.fortinet.com"
license=("custom")

if [ "$CARCH" = "i686" ]; then
  depends=("libsm" "gtk2")
  optdepends=("gtk-engines: for gtk theme support")
elif [ "$CARCH" = "x86_64" ]; then
  depends=("lib32-libsm" "lib32-gtk2")
  optdepends=("lib32-gtk-engines: for gtk theme support")
fi

md5sums=('4ed572b8904ed0ab6a1a179e02f88aae'
         '45236be55af0cc05ec707bc1014d2f1b'
         'ba87cd86fec77062c0d20da95c9e21f6'
         '6f5ebe493c5abaf60bfcd2b8bc9d73fc'
         '3ea0ca6d225315937b58b1a30ca03d49'
         '43f95eae96db16248d7294c1e8bfc561')

source=(
  "ftp://pftpintl:F0rt1intl@support.fortinet.com/FortiGate/v5.00/5.0/5.0.7/SSL-VPN/forticlientsslvpn_linux_${pkgver}.tar.gz"
  "${pkgname}.patch"
  "forticlientsslvpn.sh"
  "forticlientsslvpn_cli.sh"
  "forticlientsslvpn.desktop"
  "forticlientsslvpn.png"
)

package() {
  cd ${srcdir}/${pkgname}/helper

  patch < ${srcdir}/${pkgname}.patch

  msg "copying files..."
  mkdir -p ${pkgdir}/opt/fortinet/${pkgname}/icons
  mkdir -p ${pkgdir}/usr/bin
  mkdir -p ${pkgdir}/usr/share/applications
  mkdir -p ${pkgdir}/usr/share/licenses/${pkgname}

  cp -rp ${srcdir}/${pkgname} ${pkgdir}/opt/fortinet/
  install -Dm 777 ${srcdir}/${pkgname}.png ${pkgdir}/opt/fortinet/${pkgname}/icons/
  chmod -R 777 ${pkgdir}/opt/fortinet/
  chmod 555 ${pkgdir}/opt/fortinet/${pkgname}/helper
  install -Dm 644 ${srcdir}/${pkgname}.desktop ${pkgdir}/usr/share/applications/
  install -Dm 644 ${srcdir}/${pkgname}/helper/License.txt ${pkgdir}/usr/share/licenses/${pkgname}/
  install -Dm 755 ${srcdir}/${pkgname}.sh ${pkgdir}/usr/bin/${pkgname}
  install -Dm 755 ${srcdir}/${pkgname}_cli.sh ${pkgdir}/usr/bin/${pkgname}_cli
}