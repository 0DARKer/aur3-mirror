# Maintainer: Thomas Dziedzic < gostrc at gmail >

pkgname=opencde
pkgver=620
pkgrel=2
pkgdesc="OpenCDE is a free implementation of the Open Group's Common Desktop Environment."
arch=('i686' 'x86_64')
url='http://devio.us/~kpedersen/index.php'
license=('BSD')
depends=('openmotif')
source=("http://devio.us/~kpedersen/releases/${pkgname}-${pkgver}.tar.gz")
md5sums=('b9558b0366c9ed4ca8449abb40b060d3')


build() {
  cd ${pkgname}/src

  # fix build errors
  unset CFLAGS CXXFLAGS LDFLAGS

##  sed -i "s_PREFIX=/usr/local_PREFIX=${pkgdir}/usr_" config.Mk
##  sed -i "s_PREFIX=/usr/local_PREFIX=/usr_" config.Mk

##  sed -i 's/$(CC) -c $(CPPFLAGS) $< -o $@/$(CC) -fPIC -c $(CPPFLAGS) $< -o $@/' motifmm/Makefile
sed -i "s_-lmotifmm_-lmotifmm -lXm -lXt -lX11_" dtpanel/Makefile

  make
}

package() {
  cd ${pkgname}

  # probably need to submit patch to upstream
  #install -d ${pkgdir}/usr/bin

  # removed in 0.4.1 again...
  #make install

  install -d ${pkgdir}/usr
  cp -r bin share etc lib ${pkgdir}/usr
}
