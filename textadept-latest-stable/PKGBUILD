# Maintainer: Ivan de Jesús Pompa García <ivan.pompa@gmx.com>

pkgname=textadept-latest-stable
pkgver=6.4
pkgrel=1
pkgdesc="A fast, minimalist, and ridiculously extensible cross-platform text editor. Package for GTK3."
arch=('i686' 'x86_64')
url="http://foicica.com/textadept"
license=('MIT')

depends=('gtk3'
		'lua'
		'desktop-file-utils')

conflicts=('textadept')
provides=('textadept')

source=("http://foicica.com/textadept/download/textadept_${pkgver}.src.zip"
		"textadept.desktop"
		"textadept.install")

md5sums=("9263867abf2d354baf59066b0d899ed6"
		"f73f31facd5d77da09c566b743d062e7"
		"b9bd572f64ea15c77bb6f26866c86d07")


build() {
	cd ${srcdir}/textadept_${pkgver}.src/src
	make GTK3=1 -e CXX="g++ -lgmodule-2.0 -llua -lm -ldl" || return 1
  	make GTK3=1 -e CXX="g++ -fpermissive -lgmodule-2.0 -llua -lm -ldl" ncurses || return 1

	if [ ! -d "${pkgdir}/usr/share/textadept" ]; then
		mkdir -p ${pkgdir}/usr/share/textadept
	fi

	if [ ! -d "${pkgdir}/usr/share/doc/textadept" ]; then
		mkdir -p ${pkgdir}/usr/share/doc/textadept
	fi

	cd ${srcdir}/textadept_${pkgver}.src
	cp -R -t ${pkgdir}/usr/share/textadept core init.lua lexers LICENSE \
		modules themes textadept textadept-ncurses
	cp -R doc/* ${pkgdir}/usr/share/doc/textadept

	install -D -m644 ${startdir}/textadept.desktop \
		${pkgdir}/usr/share/applications/${pkgname}.desktop
}

install=textadept.install
