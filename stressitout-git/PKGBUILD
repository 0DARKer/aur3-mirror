pkgname=stressitout-git
pkgver=20120304
pkgrel=1
pkgdesc="StressItOut (or SIO, for short) is a free (as in freedom) hardware stressing and testing program for GNU/Linux writen on Qt"
arch=('i686' 'x86_64')
url='http://qt-apps.org/content/show.php/StressItOut?content=136985'
license=('GPL2')
depends=('qt')
makedepends=('git')

_gitroot="git://gitorious.org/stressitout/stressitout-dev.git"
_gitname="stressitout-dev"

build() {
  cd "${srcdir}" || return 1
  msg "Connecting to GIT server...."

  if [ -d $_gitname ]; then
    cd $_gitname && git pull origin
    msg "The local files are updated."
  else
    git clone $_gitroot
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  cd "${srcdir}/stressitout-dev"
  qmake .
  make
}

package() {
  install -Dm755 "${srcdir}/stressitout-dev/stressitout" "${pkgdir}/usr/bin/stressitout"
  install -Dm644 "${srcdir}/stressitout-dev/stressitout.desktop" "${pkgdir}/usr/share/applications/stressitout.desktop"
  install -Dm644 "${srcdir}/stressitout-dev/icon/64x64/stressitout.png" "${pkgdir}/usr/share/pixmaps/stressitout.png"
}