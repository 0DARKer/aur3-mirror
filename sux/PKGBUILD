# Contributor: Andreas Wagner <A dot Wagner at stud dot uni-frankfurt dot de>

pkgname=sux
pkgver=1.0.1_5
pkgrel=1
_majorversion=1.0.1
pkgdesc="A wrapper around su which will transfer your X credentials"
arch=('i686' 'x86_64')
url="http://sourceforge.net/projects/sux/"
license="custom"
depends=('coreutils' 'xorg-xauth')
source=(http://ftp.de.debian.org/debian/pool/main/s/${pkgname}/${pkgname}_${pkgver/_/-}.diff.gz
        http://ftp.de.debian.org/debian/pool/main/s/${pkgname}/${pkgname}_${_majorversion}.orig.tar.gz)
md5sums=('959585e1bf0a5c62c61722d85d999dce'
         '5bafe1b4a285e6b3c0365e751b8ab494')

build() {
    cd $startdir/src/${pkgname}-${_majorversion}

    # patch with debian patches
    patch -p0 < ../${pkgname}_${pkgver/_/-}.diff || return 1

    # replace tempfile with mktemp
    sed -i -e 's|tempfile -p sux|mktemp --tmpdir sux.XXXXXXXXXX|' sux || return 1
    sed -i -e 's|tempfile -p sux|mktemp --tmpdir sux.XXXXXXXXXX|' suxterm || return 1

    # install executables
    install -D -m775 sux  $startdir/pkg/usr/bin/sux
    install -D -m775 suxterm  $startdir/pkg/usr/bin/suxterm

    # install man pages
    install -D -m644 ${pkgname}-${_majorversion}/debian/sux.1 $startdir/pkg/usr/share/man/man1/sux.1
    install -D -m644 ${pkgname}-${_majorversion}/debian/suxterm.1 $startdir/pkg/usr/share/man/man1/suxterm.1

    # install license
    install -D -m644 ${pkgname}-${_majorversion}/debian/copyright $startdir/pkg/usr/share/licenses/sux/COPYING
}

