# Maintainer: Kevin Slagle <kjslag at gmail dot com>

pkgname=alps
_pkgver=2.0.2-r5790
pkgver=2.0.2_r5790
pkgrel=1
pkgdesc="Provides physics simulation code for strongly correlated quantum mechanical systems"
arch=('i686' 'x86_64')
url="http://alps.comp-phys.org"
license=('custom:ALPS')
depends=('boost' 'fftw' 'python2-scipy' 'python2-h5py' 'python2-matplotlib')
makedepends=('cmake' 'gcc-fortran')
#optdepends=('foo: description')
source=(http://alps.comp-phys.org/static/software/releases/${pkgname}-${_pkgver}-src.tar.gz)
md5sums=('18a3e859eb0775aadf0a65d26d22a51c')

build() {
  cd "${srcdir}/${pkgname}-${_pkgver}-src/alps"
  # http://alps.comp-phys.org/mediawiki/index.php/Download_and_install_ALPS_2#Build_ALPS
  
  # this line is recommended, but gave a compilation error
  #[ "$CARCH" = "x86_64" ] && _CMAKE=-DLAPACK_64_BIT=ON
  
  cmake ./ -DCMAKE_INSTALL_PREFIX=/opt/alps -DPYTHON_INTERPRETER=/usr/bin/python2 ${_CMAKE}
  make
  make test
}

package() {
  cd "${srcdir}/${pkgname}-${_pkgver}-src/alps"
  make DESTDIR="${pkgdir}" install
  install -Dm644 LICENSE.txt "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
  
  # uncomment if installing into /usr
  #cd "${pkgdir}"
  #mv tutorials share/alps/
}
