# Maintainer: André Silva <emulatorman@lavabit.com>
# Contributor: Márcio Silva <coadde@lavabit.com>

pkgname=linux-libre-firmware
pkgver=3.10
pkgrel=1
pkgdesc='Free firmware files for Linux-libre'
arch=('any')
url=('http://linux-libre.fsfla.org/')
license=('GPL2')
depends=('ath9k-htc-firmware')
provides=('linux-firmware'
          'kernel26-firmware=2.6.34.99')
conflicts=('linux-firmware'
           'linux-firmware-git'
           'kernel26-firmware'
           'ar9170-fw'
           'iwlwifi-1000-ucode'
           'iwlwifi-3945-ucode'
           'iwlwifi-4965-ucode'
           'iwlwifi-5000-ucode'
           'iwlwifi-5150-ucode'
           'iwlwifi-6000-ucode'
           'rt2870usb-fw'
           'rt2x00-rt61-fw'
           'rt2x00-rt71w-fw')
replaces=('linux-firmware'
          'kernel26-firmware'
          'ar9170-fw'
          'iwlwifi-1000-ucode'
          'iwlwifi-3945-ucode'
          'iwlwifi-4965-ucode'
          'iwlwifi-5000-ucode'
          'iwlwifi-5150-ucode'
          'iwlwifi-6000-ucode'
          'rt2870usb-fw'
          'rt2x00-rt61-fw'
          'rt2x00-rt71w-fw')
source=("http://linux-libre.fsfla.org/pub/linux-libre/releases/$pkgver-gnu/linux-libre-$pkgver-gnu.tar.xz")
md5sums=('d562fd52580a3b6b18b6eeb5921d1d5c')

package() {

  # create firmware folder to put the free firmware files there
  install -d -m755 $pkgdir/usr/lib/firmware

  cd $srcdir/linux-$pkgver

  # compile free firmware files  
  make INSTALL_FW_PATH=$pkgdir/usr/lib/firmware firmware_install

  # create licenses folder to put the licenses files there
  install -d -m755 $pkgdir/usr/share/licenses/$pkgname

  # move WHENCE file to linux-firmware license folder
  cd $srcdir/linux-$pkgver
  install -m644 firmware/WHENCE $pkgdir/usr/share/licenses/$pkgname

}
