# Contributor: Piotr Rogo≈ºa <rogoza dot piotr at gmail dot com>
# Created: 24/03/2011
pkgname=varicad-view
_pkgname=varicad2011-view
pkgver=2011.1.10
_pkgver=1.10
pkgrel=1
pkgdesc='Viewer VariCAD files. It can also open STEP (3D), DWG (2D), DXF (2D) and IGES (2D) files.'
arch=('i686' 'x86_64')
url='http://www.varicad.com'
license=('custom: "free, requirement login or register"')
depends=('hicolor-icon-theme' 'mesa' 'gtk2' 'desktop-file-utils')
install=$pkgname.install
options=(!strip)
#CARCH=x86_64
case $CARCH in
  i686)
    source=("http://www.varicad.com/userdata/files/release/en/${_pkgname}-en_${_pkgver}_i386.deb")
    __pkgname=${_pkgname}-en_${_pkgver}_i386.deb
md5sums=('48c9a3d51e9f9757565e9eac26231d5d')
    ;;
  x86_64)
    source=("http://www.varicad.com/userdata/files/release/en/${_pkgname}-en_${_pkgver}_amd64.deb")
    __pkgname=${_pkgname}-en_${_pkgver}_amd64.deb
md5sums=('c3b2a6ca65ed7299fc14b136b6bacfa9')
    ;;
esac

#if [ ! -f ${__pkgname} ]; then
#	echo "To proceed to download, please login or register on http://www.varicad.com/en/home/products/download/"
#	exit 1
#fi

package(){
  cd "$srcdir" || return 1
  ar x ${__pkgname} data.tar.gz || return 1
  tar zxf data.tar.gz || return 1
  tar -c opt | tar -x -C ${pkgdir} || return 1
  tar -c usr | tar -x -C ${pkgdir} || return 1
  rm -f ${pkgdir}/usr/share/doc/varicad2010-view-en/{changelog.gz,copyright,README.Debian} || \
    return 1

  cd ${srcdir}/opt/VariCAD-View/desktop || return 1
  install -Dm644 varicadview.desktop \
    ${pkgdir}/usr/share/applications/varicadview.desktop || return 1
  install -Dm644 x-varicadview.desktop \
    ${pkgdir}/usr/share/mimelnk/application/x-varicadview.desktop || return 1
  for i in 16x16 22x22 32x32 48x48; do
    install -Dm 644 varicadview_${i}.png \
      ${pkgdir}/usr/share/icons/hicolor/${i}/apps/varicadview.png || return 1
  done
  install -Dm 664 varicadview.xpm ${pkgdir}/usr/share/pixmaps/varicadview.xpm || return 1
  install -Dm 664 varicadview.xpm ${pkgdir}/usr/share/icons/varicadview.xpm || return 1
}
# vim:set ts=2 sw=2 et ft=sh
