# Maintainer: Tom Vincent <http://tlvince.com/contact>
pkgname=gollum
pkgver=2.7.0
pkgrel=5
pkgdesc="A simple, Git-powered wiki."
arch=('any')
url="http://github.com/gollum/gollum"
license=('MIT')
depends=('ruby' 'ruby-grit' 'ruby-github-markup'
'ruby-github-markdown' 'ruby-pygments.rb' 
'ruby-sinatra' 'ruby-mustache' 'ruby-sanitize' 
'ruby-nokogiri' 'ruby-useragent' 'ruby-stringex' 
'ruby-gollum-lib')
makedepends=('rubygems')
source=(http://rubygems.org/downloads/$pkgname-$pkgver.gem 'gollum.service')
noextract=($pkgname-$pkgver.gem)
md5sums=('189618e50e887103e4f9ed4cfabed7fb'
         'd158bf8e10417f68ed808fab3280a4e9')
install="gollum.install"

package() {
  cd "$srcdir"
  local _gemdir="$(ruby -e'puts Gem.default_dir')"
  gem install --ignore-dependencies --no-user-install -i "$pkgdir$_gemdir" -n "$pkgdir/usr/bin" $pkgname-$pkgver.gem

  install -Dm644 gollum.service "${pkgdir}"/usr/lib/systemd/user/gollum.service
  install -Dm644 gollum.service "${pkgdir}"/usr/lib/systemd/system/gollum.service
}
