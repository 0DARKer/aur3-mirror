# Maintainer: Michal Donat <michal.donat@atlas.cz>
# Contributor: t3ddy  <t3ddy1988 "at" gmail {dot} com>
# Contributor: Lluixhi <lluixhi (at) Gmail (dot) com>

pkgname=supertuxkart-svn
pkgver=12668
pkgrel=1
pkgdesc="A kart racing game featuring Tux and his friends - development version"
url="http://supertuxkart.sourceforge.net/"
license=("cc-by-sa-3.0")
arch=('i686' 'x86_64')
makedepends=("subversion" "cmake")
depends=("sdl>=1.2" "libvorbis" "freealut" "libgl" "freeglut" "fribidi")
conflicts=("supertuxkart")
replaces=("supertuxkart-cmakesvn")
source=("trunk::svn+https://supertuxkart.svn.sourceforge.net/svnroot/supertuxkart/main/trunk/")
md5sums=('SKIP')

pkgver() {
  cd "$SRCDEST/trunk"
  svnversion | tr -d [A-z]
}


build() {
	cd "${srcdir}/trunk"
	msg "Starting build..."

	# Build irrlicht
	cd lib/irrlicht/source/Irrlicht/
	NDEBUG=1 make

	cd -
    [ -d "build" ] && rm -r build
    mkdir build && cd build

	# Build stk
	cmake -DCMAKE_INSTALL_PREFIX=/usr ..
	make
}

package() {
	cd "trunk/build"
	make DESTDIR=${pkgdir} install
}
