
pkgname=lxtask-git
pkgver=20110430
pkgrel=1
pkgdesc="Task manager and system monitor of LXDE"
arch=('i686' 'x86_64')
license=('GPL2')
groups=('lxde')
depends=('libx11' 'glib2' 'gtk2>=2.12.0')
makedepends=('autoconf' 'automake' 'gcc' 'libtool' \
         'make' 'pkgconfig' 'git')
provides=('lxtask')
conflicts=('lxtask')
url="http://lxde.org/"
# startlxde is useless without lxsession 
optdepends=(lxsession-lite)
_gitroot=git://lxde.git.sourceforge.net/gitroot/lxde/lxtask
_gitname=lxtask

build() {
  cd "$srcdir"

  msg "Connecting to $_gitroot..."
  if [[ -d $_gitname ]]; then
    cd $_gitname && git pull origin && cd ..
    msg2 "Local files updated"
  else
    git clone $_gitroot
    msg2 "Git checkout done"
  fi

  rm -rf $_gitname-build
  git clone $_gitname $_gitname-build
  cd $_gitname-build

  msg "Starting make..."
 # sed -i -e "s/SUBDIRS = man/ /" Makefile.am
 # sed -i -e "s/lxde.conf/LXDE.conf/" Makefile.am
  ./autogen.sh
  ./configure --prefix=/usr --sysconfdir=/etc
  make || return 1
}

package() {
  cd "$srcdir/$_gitname-build"
  make DESTDIR="$pkgdir" install
}

