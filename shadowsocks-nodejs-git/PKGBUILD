# Maintainer: Sascha Weaver <wzyboies@gmail.com>

pkgname=shadowsocks-nodejs-git
_gitname=shadowsocks-nodejs
_insdir="/opt/${_gitname}"
pkgver=111.a8d5381
pkgrel=1
pkgdesc="A lightweight tunnel proxy which can help you get through firewalls. A port of shadowsocks."
arch=('any')
url="https://github.com/clowwindy/shadowsocks-nodejs"
depends=('nodejs')
makedepends=('git')
license=('MIT')
backup=(opt/shadowsocks-nodejs/config.json)
install=shadowsocks-nodejs.install
source=('git://github.com/clowwindy/shadowsocks-nodejs.git'
        'shadowsocks-nodejs.service')
sha256sums=('SKIP'
            'e7bb7fe4a5b0de164c04736e95c7bdbeaaacc8e6c608ceba0b6719479f8baecd')

pkgver() {
  cd ${_gitname}
  echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

package() {
  rm -rf .git .travis.yml src test Cakefile local.bat
  mkdir -p "${pkgdir}/${_insdir}"
  cp -a "${_gitname}/"* "${pkgdir}/${_insdir}"
  install -Dm644 "${srcdir}"/${_gitname}.service "${pkgdir}"/usr/lib/systemd/system/${_gitname}.service
}
