# Contributor: DaNiMoTh <jjdanimoth@gmail.com>

pkgname=tahoe-lafs-i2p
pkgver=1.8.3
pkgrel=1
pkgdesc="a secure, decentralized, fault-tolerant filesystem over I2P network"
arch=('i686' 'x86_64')
url='http://tahoe-lafs.org/'
license=('GPL')
groups=()
# net-tools is needed because Tahoe-LAFS uses /sbin/ifconfig
depends=('net-tools' 'python2' 'twisted' 'pyasn1' 'pycrypto' 'pycryptopp' 'nevow' 
         'python-foolscap-i2p' 'python-simplejson' 'zfec' 'python2-pyopenssl' 
         'pyutil' 'python2-argparse' 'zbase32' 'pythonmock>=0.6.0' 'i2p')
provides=(tahoe-lafs)
conflicts=(tahoe-lafs)
source=(http://tahoe-lafs.org/source/tahoe-lafs/snapshots/allmydata-tahoe-$pkgver.zip 
        http://killyourtv.i2p.to/tahoe-lafs/patches/tahoe-lafs-i2p-$pkgver-r1.patch)

build(){
  cd "$srcdir/allmydata-tahoe-$pkgver" || return 1
  patch -Np1 -i "$srcdir/tahoe-lafs-i2p-$pkgver-r1.patch"
  python2 setup.py build || return 1
  python2 setup.py test || return 1
}

package(){
  cd "$srcdir/allmydata-tahoe-$pkgver" || return 1
  python2 setup.py install --root="$pkgdir" || return 1
}
md5sums=('60aa8b4e8aec2bc6539de3271b9814a6'
         '253564fe0324309d35fe5835addac630')
