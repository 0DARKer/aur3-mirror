# Contributor: Snorre Jensen snojen@gmail.com

pkgname=openttd-beta
pkgver=1.1.0_beta5
pkgrel=1
pkgdesc="OpenTTD is an Open Source clone of Transport Tycoon Deluxe"
arch=('i686' 'x86_64')
url="http://www.openttd.org"
license=('GPL')
depends=(libpng sdl fontconfig icu)
makedepends=()
optdepends=('openttd-opengfx: free graphics' 
            'openttd-opensfx: free soundset'
            'openttd-openmsx: free musicset')

source=(http://binaries.openttd.org/releases/${pkgver/_/-}/openttd-${pkgver/_/-}-source.tar.xz)
#       http://binaries.openttd.org/releases/1.1.0-beta1/openttd-1.1.0-beta1-source.tar.gz
#       http://binaries.openttd.org/releases/1.1.0-beta1/openttd-1.1.0-beta1-source.tar.xz
md5sums=('2989c487b730288339ab90482c638b2e')

build() {
    cd $startdir/src/openttd-${pkgver/_/-}
     
    ./configure \
    --prefix-dir=/usr \
    --binary-dir=bin \
    --binary-name=${pkgname} \
    --data-dir=share/${pkgname} \
    --doc-dir=share/doc/${pkgname} \
    --personal-dir=.${pkgname} \
    --install-dir=$startdir/pkg/ \
    --menu-name="OpenTTD beta"
    make || return 1
    make install || return 1

   cd $pkgdir/usr/share/${pkgname}/data

   ln -s /usr/share/openttd/data/ogfx1_base.grf ogfx1_base.grf
   ln -s /usr/share/openttd/data/ogfxc_arctic.grf ogfxc_arctic.grf
   ln -s /usr/share/openttd/data/ogfxe_extra.grf ogfxe_extra.grf
   ln -s /usr/share/openttd/data/ogfxh_tropical.grf ogfxh_tropical.grf
   ln -s /usr/share/openttd/data/ogfxi_logos.grf ogfxi_logos.grf
   ln -s /usr/share/openttd/data/ogfxt_toyland.grf ogfxt_toyland.grf
   ln -s /usr/share/openttd/data/opengfx.obg opengfx.obg
   ln -s /usr/share/openttd/data/opensfx.cat opensfx.cat
   ln -s /usr/share/openttd/data/opensfx.obs opensfx.obs
   ln -s /usr/share/openttd/data/sample.cat sample.cat

}
