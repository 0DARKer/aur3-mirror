# Contributor: Stefan Husmann 
# Maintainer: Eric Forgeot < http://esclinux.tk >

pkgname=textallion
pkgver=2011_07_24
pkgrel=1
pkgdesc="A simple word processor based on txt2tags and its markup, for publishing prose, literature, poetry in HTML, PDF or EPUB, and also cyoa (gamebooks & renpy)"
arch=('any')
url="http://anamnese.online.fr/site2/textallion/docs/presentation.html"
license=('BSD')
depends=('python2')
makedepends=('gzip')
optdepends=('texlive-humanities: export to pdf' 'calibre: export to epub' 'tidyhtml: cleaning html for epub export' 'psutils: advanced postscript operations like making booklets' 'ttf-linux-libertine: xetex optional backend' 'imagemagick: generate personalised covers' 'perl: for renpy export' 'gnome-inform7: for z-code export')
source=(http://textallion.googlecode.com/files/textallion_2011-07-24_merode.zip )

md5sums=('7a7ce5d5286e1207b56f3b58a4964e13')

build() {
  cd $srcdir/${pkgname}
    	mkdir -p $pkgdir/usr/bin/
	mkdir -p $pkgdir/usr/share/${pkgname}
	cp -fr $srcdir/${pkgname}/* $pkgdir/usr/share/${pkgname}
	rm $pkgdir/usr/share/${pkgname}/textallion_install.sh
	chmod -R 755 $pkgdir/usr/share/textallion/
	chmod +x $pkgdir/usr/share/textallion/core/textallion.sh
	chmod +x $pkgdir/usr/share/textallion/contrib/txt2tags/txt2tags

    echo "sh /usr/share/textallion/core/textallion.sh" > $pkgdir/usr/bin/textallion
    chmod +x $pkgdir/usr/bin/textallion
    
    #desktop icons
	mkdir -p $pkgdir/usr/share/pixmaps
	cp $srcdir/${pkgname}/images/icon_textallion256.png $pkgdir/usr/share/pixmaps/textallion.png
	install -D -m644 $srcdir/${pkgname}/contrib/others/textallion.desktop $pkgdir/usr/share/applications/textallion.desktop
    
    
}
