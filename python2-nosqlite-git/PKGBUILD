# Maintainer: Chris van Dijk (quigybo) <quigybo at hotmail dot com>

pkgname=python2-nosqlite-git
_pkgname=python2-nosqlite
_pkgbasename=nosqlite
pkgver=20130305
pkgrel=1
pkgdesc="A lightweight zeroconf noSQL document-oriented forking Python SQLite networked authenticated XMLRPC database server"
url="http://code.google.com/p/nosqlite/"
license=('BSD')
arch=('any')
depends=(python2 sqlite3)
makedepends=(python2-distribute)
source=(setup_install.patch)
md5sums=('7add5a04d43f4f4175ef0239e7e7c35d')

_gitroot="git://github.com/williamstein/nosqlite"
_gitname="nosqlite"

build() {
  cd "$srcdir"
  msg "Connecting to GIT server...."

  if [[ -d "$_gitname" ]]; then
    cd "$_gitname" && git pull origin
    msg "The local files are updated."
  else
    git clone "$_gitroot" "$_gitname"
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting build..."

  rm -rf "$srcdir/$_gitname-build"
  git clone "$srcdir/$_gitname" "$srcdir/$_gitname-build"
  cd "$srcdir/$_gitname-build"

  patch -Np1 < "${srcdir}"/setup_install.patch
}

package() {
  cd "$srcdir/$_gitname-build"
  python2 setup.py install --root="${pkgdir}" --optimize=1
  install -Dm644 README.txt "${pkgdir}/usr/share/licenses/${_pkgname}/README"
}

# vim:set ts=2 sw=2 et:
