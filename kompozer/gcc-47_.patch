--- a/xpcom/components/nsCategoryCache.cpp	2009-05-02 17:43:38.000000000 +0100
+++ b/xpcom/components/nsCategoryCache.cpp	2012-04-17 12:14:54.000000000 +0100
@@ -42,6 +42,7 @@
 #include "nsObserverService.h"
 
 #include "nsCategoryCache.h"
+#include <unistd.h>
 
 nsCategoryObserver::nsCategoryObserver(const char* aCategory,
                                        nsCategoryListener* aListener)
--- a/xpcom/ds/nsProperties.cpp	2009-05-02 17:43:43.000000000 +0100
+++ b/xpcom/ds/nsProperties.cpp	2012-04-17 12:03:53.000000000 +0100
@@ -38,6 +38,7 @@
 #include "nsProperties.h"
 #include "nsString.h"
 #include "nsCRT.h"
+#include <unistd.h>
 
 ////////////////////////////////////////////////////////////////////////////////
 
--- a/xpcom/ds/nsProperties.h	2009-05-02 17:43:43.000000000 +0100
+++ b/xpcom/ds/nsProperties.h	2012-04-17 11:59:48.000000000 +0100
@@ -43,6 +43,7 @@
 #include "nsInterfaceHashtable.h"
 #include "nsHashKeys.h"
 #include "nsAgg.h"
+#include <unistd.h>
 
 #define NS_PROPERTIES_CID                            \
 { /* 4de2bc90-b1bf-11d3-93b6-00104ba0fd40 */         \
--- a/xpcom/glue/nsBaseHashtable.h	2009-05-02 17:43:39.000000000 +0100
+++ b/xpcom/glue/nsBaseHashtable.h	2012-04-17 12:19:15.000000000 +0100
@@ -41,6 +41,7 @@
 #include "nsTHashtable.h"
 #include "prlock.h"
 #include "nsDebug.h"
+#include <unistd.h>
 
 template<class KeyClass,class DataType,class UserDataType>
 class nsBaseHashtable; // forward declaration
@@ -123,7 +124,7 @@
    */
   PRBool Get(KeyType aKey, UserDataType* pData) const
   {
-    EntryType* ent = GetEntry(aKey);
+    EntryType* ent = this->GetEntry(aKey);
 
     if (!ent)
       return PR_FALSE;
@@ -142,7 +143,7 @@
    */
   PRBool Put(KeyType aKey, UserDataType aData)
   {
-    EntryType* ent = PutEntry(aKey);
+    EntryType* ent = this->PutEntry(aKey);
 
     if (!ent)
       return PR_FALSE;
@@ -156,7 +157,7 @@
    * remove the data for the associated key
    * @param aKey the key to remove from the hashtable
    */
-  void Remove(KeyType aKey) { RemoveEntry(aKey); }
+  void Remove(KeyType aKey) { this->RemoveEntry(aKey); }
 
   /**
    * function type provided by the application for enumeration.
--- a/xpcom/glue/nsClassHashtable.h	2009-05-02 17:43:39.000000000 +0100
+++ b/xpcom/glue/nsClassHashtable.h	2012-04-17 11:51:32.000000000 +0100
@@ -98,7 +98,7 @@
 nsClassHashtable<KeyClass,T>::Get(KeyType aKey, T** retVal) const
 {
   typename nsBaseHashtable<KeyClass,nsAutoPtr<T>,T*>::EntryType* ent =
-    GetEntry(aKey);
+    this->GetEntry(aKey);
 
   if (ent)
   {
@@ -126,7 +126,7 @@
   PR_Lock(this->mLock);
 
   typename nsBaseHashtableMT<KeyClass,nsAutoPtr<T>,T*>::EntryType* ent =
-    GetEntry(aKey);
+    this->GetEntry(aKey);
 
   if (ent)
   {
--- a/xpcom/glue/nsINIParser.cpp	2009-05-02 17:43:39.000000000 +0100
+++ b/xpcom/glue/nsINIParser.cpp	2012-04-17 11:36:46.000000000 +0100
@@ -45,6 +45,8 @@
 #include <stdlib.h>
 #include <stdio.h>
 
+#include <unistd.h>
+
 #if defined(XP_WIN) || defined(XP_OS2)
 #define BINARY_MODE "b"
 #else
--- a/xpcom/glue/nsInterfaceHashtable.h	2009-05-02 17:43:39.000000000 +0100
+++ b/xpcom/glue/nsInterfaceHashtable.h	2012-04-17 12:06:41.000000000 +0100
@@ -41,6 +41,7 @@
 #include "nsBaseHashtable.h"
 #include "nsHashKeys.h"
 #include "nsCOMPtr.h"
+#include <unistd.h>
 
 /**
  * templated hashtable class maps keys to interface pointers.
@@ -111,7 +112,7 @@
   (KeyType aKey, UserDataType* pInterface) const
 {
   typename nsBaseHashtable<KeyClass, nsCOMPtr<Interface>, Interface*>::EntryType* ent =
-    GetEntry(aKey);
+    this->GetEntry(aKey);
 
   if (ent)
   {
@@ -139,7 +140,7 @@
   (KeyType aKey, PRBool* aFound) const
 {
   typename nsBaseHashtable<KeyClass, nsCOMPtr<Interface>, Interface*>::EntryType* ent =
-    GetEntry(aKey);
+    this->GetEntry(aKey);
 
   if (ent)
   {
@@ -167,7 +168,7 @@
   PR_Lock(this->mLock);
 
   typename nsBaseHashtableMT<KeyClass, nsCOMPtr<Interface>, Interface*>::EntryType* ent =
-    GetEntry(aKey);
+    this->GetEntry(aKey);
 
   if (ent)
   {
--- a/xpcom/glue/nsRefPtrHashtable.h	2009-05-02 17:43:39.000000000 +0100
+++ b/xpcom/glue/nsRefPtrHashtable.h	2012-04-17 12:27:52.000000000 +0100
@@ -112,7 +112,7 @@
   (KeyType aKey, UserDataType* pRefPtr) const
 {
   typename nsBaseHashtable<KeyClass, nsRefPtr<RefPtr>, RefPtr*>::EntryType* ent =
-    GetEntry(aKey);
+    this->GetEntry(aKey);
 
   if (ent)
   {
@@ -140,7 +140,7 @@
   (KeyType aKey, PRBool* aFound) const
 {
   typename nsBaseHashtable<KeyClass, nsRefPtr<RefPtr>, RefPtr*>::EntryType* ent =
-    GetEntry(aKey);
+    this->GetEntry(aKey);
 
   if (ent)
   {
@@ -168,7 +168,7 @@
   PR_Lock(this->mLock);
 
   typename nsBaseHashtableMT<KeyClass, nsRefPtr<RefPtr>, RefPtr*>::EntryType* ent =
-    GetEntry(aKey);
+    this->GetEntry(aKey);
 
   if (ent)
   {
