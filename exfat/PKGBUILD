# Maintainer: Kowalczyk Patryk <patryk AT kowalczyk DOT ws>

pkgname=exfat 
pkgver=33.53c9015
_gitname=exfat-nofuse
pkgrel=1
_kernver=`uname -r`
pkgdesc='Native support for exfat (nofuse)'
arch=('i686' 'x86_64')
url='https://github.com/rxrz/exfat-nofuse'
license=('unknown')
depends=('linux>=3.8' 'linux<3.11')
makedepends=('linux-headers' 'git')
source=("git+https://github.com/rxrz/exfat-nofuse.git")
md5sums=('SKIP')
install="$pkgname.install"

pkgver() {
  cd  "${srcdir}/${_gitname}"
  echo $(git rev-list --count HEAD).$(git rev-parse --short HEAD)
}

build() {
msg "GIT checkout done or server timeout"
msg "Starting make..."
 cd "${srcdir}/${_gitname}"

	make	
}

package() {
gzip ${srcdir}/$_gitname/exfat_fs.ko
        gzip ${srcdir}/$_gitname/exfat_core.ko
        install -Dm644 ${srcdir}/$_gitname/exfat_fs.ko.gz ${pkgdir}/usr/lib/modules/${_kernver}/extramodules/exfat_fs.ko.gz
        install -Dm644 ${srcdir}/$_gitname/exfat_core.ko.gz ${pkgdir}/usr/lib/modules/${_kernver}/extramodules/exfat_core.ko.gz

}
