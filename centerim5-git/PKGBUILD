# Maintainer: k6b (k6b@0x2a.co)

pkgname=centerim5-git
pkgver=5.0.0alpha2.324_7
pkgrel=1
pkgdesc="CenterIM5 - An ncurses bases terminal chat client" 
arch=('i686' 'x86_64')
url="http://centerim.org//"
license=('GPL')
depends=('python2' 'libjpeg' 'gpgme')
makedepends=('ca-certificates')
provides=("centerim5=$pkgver")
conflicts=()
options=('!libtool')
source=()
md5sums=()

_gitroot="git+ssh://mob@repo.or.cz/srv/git/centerim5.git"
_gitname="centerim5"

build() {
  cd "$srcdir"
  msg "Connecting to GIT server...."

    if [ -d $_gitname ] ; then
        cd $_gitname && git pull origin
        msg "The local files are updated."
    else
        git clone -b mob $_gitroot $_gitname 
    fi

    msg "GIT checkout done or server timeout"
    msg "Starting make..."

    rm -rf "${srcdir}/$_gitname-build"
    git clone "${srcdir}/$_gitname" "${srcdir}/$_gitname-build"
    cd "${srcdir}/$_gitname-build"


  ./bootstrap
  ./configure 

  make 
  make DESTDIR="$pkgdir" install

  # Remove GConf schema file
  rm -rf "$pkgdir/etc"

  # Remove libpurple and pidgin development headers
  rm -rf "$pkgdir/usr/include"

  # Remove pkgconfig scripts
  rm -rf "$pkgdir/usr/lib/pkgconfig"

  # Remove libpurple aclocal macro file
  rm -rf "$pkgdir/usr/share/aclocal"
}
