

pkgname=mixxx-bzr
pkgver=2370
pkgrel=1
pkgdesc="Digital DJ mixing software"
arch=('i686' 'x86_64')
url="http://www.mixxx.org/"
license=('GPL2')
source=(mixxx.desktop)
md5sums=('e996f3f43d8d9bf8b4e96c2783856cd9')
depends=('qt' 'libsndfile' 'libogg' 'libid3tag' 'libmad' 'libvorbis' 'portaudio'  'portmidi')
makedepends=('bzr' 'scons' 'pkgconfig')
optdepends=('pulseaudio' 'ffmpeg')
_bzrbranch=lp:mixxx
_bzrname=mixxx

build() {
  cd ${srcdir}
  msg "Connecting to BZR server..."

  if [ -d ${srcdir}/${_bzrname} ] ; then
    cd ${_bzrname} && bzr pull ${_bzrbranch}
    msg "Local repository updated."
  else
    bzr co ${_bzrbranch}
  fi
  
  cd ${startdir}

  msg "BZR checkout done or server timeout"

   cd "$srcdir/$_bzrname/$_bzrname"
   scons qtdir=/usr/lib/qt prefix=/usr install_root=$pkgdir/usr || return 1
   
#scons hifieq=1  vinylcontrol=1 cmetrics=0 asmlib=1 script=1 midiscript=1 tonal=1 qdebug=0 test=1 shoutcast=1 qtdir=/usr/lib/qt prefix=/usr 
   install_root=$startdir/pkg/usr || return 1
   scons qtdir=/usr/lib/qt prefix=/usr install_root=$startdir/pkg/usr install || return 1
   cp $srcdir/mixxx.desktop $pkgdir/usr/share/applications/


}
