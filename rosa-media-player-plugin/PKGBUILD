# Maintainer: M0Rf30

pkgname=rosa-media-player-plugin
pkgver=0.951
pkgrel=2
pkgdesc="The new multimedia player(based on SMPlayer) with clean and elegant UI (mozilla plugin only)."
arch=(i686 x86_64)
url=http://www.rosalab.ru/blogs/rosa-media-player-10-beta
license=(GPL)
depends=('mplayer')
makedepends=('qt')


build()
{
  cd $srcdir/
  wget -O rosaplugin.tar.gz http://svn.mandriva.com/svn/packages/cooker/rosa-media-player-plugin/current/SOURCES/$pkgname-$pkgver.tar.gz
  tar xvf rosaplugin.tar.gz  
  cd rosa-media-player
  qmake rosampcore.pro
  make
  cd ..
  cd rosamp-plugin
  qmake rosamp-plugin-smp.pro
  make
  qmake rosamp-plugin-qt.pro
  make
  qmake rosamp-plugin-wmp.pro
  make
  qmake rosamp-plugin-dvx.pro
  make
  qmake rosamp-plugin-rm.pro
  make
  lrelease rosamp-plugin-qt.pro
  cd ..

}

package()
{
    mkdir -p $pkgdir/usr/lib/mozilla/plugins/
    mkdir -p $pkgdir/usr/lib/mozilla/plugins/translations/
    mkdir -p $pkgdir/usr/lib/
    cd $srcdir/
    cp -f rosamp-plugin/build/librosa-media-player-plugin-smp.so $pkgdir/usr/lib/mozilla/plugins/
    cp -f rosamp-plugin/build/librosa-media-player-plugin-dvx.so $pkgdir/usr/lib/mozilla/plugins/
    cp -f rosamp-plugin/build/librosa-media-player-plugin-qt.so $pkgdir/usr/lib/mozilla/plugins/
    cp -f rosamp-plugin/build/librosa-media-player-plugin-rm.so $pkgdir/usr/lib/mozilla/plugins/
    cp -f rosamp-plugin/build/librosa-media-player-plugin-wmp.so $pkgdir/usr/lib/mozilla/plugins/
    cp -f rosa-media-player/build/librosampcore.so.1.0.0 $pkgdir/usr/lib/

    cp -f rosamp-plugin/translations/*.qm $pkgdir/usr/lib/mozilla/plugins/translations/

    cd rosa-media-player/build/
    ln -s librosampcore.so.1.0.0 $pkgdir/usr/lib/librosampcore.so.1.0
    ln -s librosampcore.so.1.0.0 $pkgdir/usr/lib/librosampcore.so.1
    ln -s librosampcore.so.1.0.0 $pkgdir/usr/lib/librosampcore.so
}
md5sums=('f53ff81be9e4b6dfda56629e67f80307')
