# Maintainer: Mihai Militaru <mihai.militaru@xmpp.ro>
# Contributor: Foucault <foucault.online@gmail.com>

pkgname=tktreectrl
pkgver=2.3
pkgrel=2
pkgdesc="A flexible listbox widget for Tk."
arch=('i686' 'x86_64') 
url="http://tktreectrl.sourceforge.net/"
license=('custom')
depends=('tcl' 'tk' 'libx11')
source=("http://downloads.sourceforge.net/project/$pkgname/$pkgname/$pkgname-$pkgver/$pkgname-$pkgver.tar.gz")
md5sums=('4424af8d9fd180b21e8d58e685566fae')

build() {
  cd ${srcdir}/${pkgname}-${pkgver}

  if [ "$CARCH" = "x86_64" ]; then
    ./configure --prefix=/usr --enable-threads --enable-64bit
  else
    ./configure --prefix=/usr --enable-threads --disable-64bit
  fi

  sed -i \
  "s#-I\"/usr/include\" -I\"/usr/include\"#\
  -I\"/usr/include\" -I\"/usr/include/tk-private/generic\" -I\"/usr/include/tk-private/unix\"#\
  g" Makefile

  make || return 1
  make DESTDIR=${pkgdir} install || return 1

  mkdir -p ${pkgdir}/usr/share/doc/tktreectrl || return 1
  mv ${pkgdir}/usr/lib/treectrl2.3/htmldoc ${pkgdir}/usr/share/doc/tktreectrl/ || return 1

  # install license
  install -Dm644 license.terms ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE
}
