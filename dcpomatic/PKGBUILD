# Maintainer: Stefan Karner <stefan.karner@student.tuwien.ac.at>

pkgname=dcpomatic
pkgver=1.29
pkgrel=3
pkgdesc="A free, open-source program to generate Digital Cinema Packages (DCPs) from videos or images"
arch=('i686' 'x86_64')
url="http://dcpomatic.com/"
license=('GPL2')
groups=
depends=('libcxml>=0.07' 'libdcp>=0.81' 'ffmpeg' 'glib2' 'imagemagick' 'openjpeg>=1.5.0' 'openjpeg<=1.5.1' 'libssh' 'wxgtk2.9' 'libquickmail>=0.1.16' 'libzip' 'xz' 'libsndfile')
makedepends=('python2' 'boost>=1.45' )
optdepends=()
provides=()
conflicts=()
replaces=()
backup=()
options=
install=
source=("${pkgname}.tar.gz::http://dcpomatic.com/downloads/${pkgver}/${pkgname}-${pkgver}.tar.bz2"
        'quickmail.patch')
md5sums=('3ff2ccb39fe5ba7a6576fac079e3d0a2'
         '098fb8e6b4115c795aa3abab5bdd1861')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  $(which patch) -p1 < ../../quickmail.patch

  # Workaround for wxgtk2.9
  ln -f -s $(which wx-config-2.9) "${srcdir}/wx-config"
  export PATH=$srcdir:$PATH

  python2 waf configure --prefix=/usr
  python2 waf build
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"

  python2 waf install --destdir=$pkgdir
}
