#! /bin/bash
# Maintainer: Jorge Barroso <jorge.barroso.11@gmail.com>
# Thanks to Superlex for their comments to improve this PKGBUILD and the installation of Iceweasel

# We're getting this from Debian Experimental
 
_debname=iceweasel
_debver=19.0
_debrel=1
_debrepo=http://ftp.de.debian.org/debian/pool/main/i/
 
pkgname=iceweasel-bin
pkgver=${_debver}.deb${_debrel}
pkgrel=2
pkgdesc="Debian Browser based on Mozilla Firefox (bin version)"
arch=('i686' 'x86_64')
url=("http://www.geticeweasel.org")
license=('MPL' 'GPL' 'LGPL')
conflicts=("$_debname")
provides=("$_debname"="$_debver")
depends=("xulrunner=${_debver}" 'gtk2' 'mozilla-common' 'libxt' 'startup-notification' 'mime-types' 'dbus-glib' 'alsa-lib'
         'libnotify' 'desktop-file-utils' 'hicolor-icon-theme' 'libvpx' 'libevent' 'nss>=3.14.1' 'hunspell' 'sqlite')
optdepends=('iceweasel-sync: Speed up Iceweasel using tmpfs'
	    'mozplugger: A Mozilla & Firefox multimedia plugin.'
	    'mozilla-searchplugins: extra search plugins'
	    'iceweasel-extension-globalmenu: Global dbusmenu/appmenu extension for Iceweasel'
	    'iceweasel-extension-archsearch: Iceweasel Arch search engines (AUR, Pkgs, BBS, Wiki, etc.)'
	    'iceweasel-i18n-it: Language Pack for Iceweasel'
	    'iceweasel-i18n-es: Spanish language pack for Iceweasel')
install=iceweasel.install
 
if [ "$CARCH" = "x86_64" ]; then
   _debarch=amd64
   sha512sums=('9515fd19eba868e7c3719bb6a61c3b7429578d935f7e250e2766ce411840b67c2fccf2dd43f867c95390d0efc24ee17e94d119cca94f63090143745ab728748c')
else
   _debarch=i386
   sha512sums=('af17a440cf5afa08b9eee4863e90f00bc58b49ae4d6081bd6279bfa21d1b9de9bd6742b797449209ab9be9ac80a6ff7e9337c03891f2c8896055e47bd7c32d04')
fi
 
source=("${_debrepo}/${_debname}/${_debname}_${_debver}-${_debrel}_${_debarch}.deb")
 
package() {
      msg2 "Installing Iceweasel..."
      tar Jxvf "${srcdir}"/data.tar.xz -C "$pkgdir"/
           
      msg2 "Cleaning up unwanted files..."
      rm -rv "${pkgdir}"/usr/lib/{mozilla,mime}
      rm -rv "${pkgdir}"/usr/share/{bug,mozilla,doc}
      rm -v "${pkgdir}"/usr/bin/firefox
}
 
# vim:set ts=2 sw=2 et: