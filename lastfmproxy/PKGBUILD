#Contributor: Will Foran <will.foran@gmail.com>
#copy-paste from quantax

pkgname=lastfmproxy
pkgver=1.3b
pkgrel=2
pkgdesc="A proxy server for the last.fm radio streams that allows you to use your regular old audio player to listen to the last.fm streams."
url="http://vidar.gimp.org/lastfmproxy"
license='GPL-2'
depends=('python')
makedepends=()
conflicts=()
replaces=()
backup=()
arch=('i686' 'x86_64')
source=(http://vidar.gimp.org/wp-content/uploads/2007/12/$pkgname-$pkgver.tar.gz)
md5sums=('6cc0def3634080e2610f99425cc85a82')

build() {
cd $startdir/src/$pkgname-$pkgver

# create directories
install -d $startdir/pkg/usr/share/lastfmproxy/ \
$startdir/pkg/usr/share/lastfmproxy/data/ \
$startdir/pkg/usr/bin/

# install everything
#install -D -m 644 * $startdir/pkg/usr/share/lastfmproxy/
cp -r * $startdir/pkg/usr/share/lastfmproxy/
chmod -R 644 $startdir/pkg/usr/share/lastfmproxy/*
install -D -m 644 data/* $startdir/pkg/usr/share/lastfmproxy/data/
install -D -m 755 main.py changestation.py $startdir/pkg/usr/share/lastfmproxy/

# create additional executables in $PATH
cd $startdir/pkg/usr/bin/
# launcher
echo "#!/bin/sh
/usr/share/lastfmproxy/main.py" > lastfmproxy
# firefox protocol handler
echo "#!/bin/sh
/usr/share/lastfmproxy/changestation.py \$@" > lastfmproxy-station

chmod 755 lastfmproxy lastfmproxy-station
}
