# Contributor: Miguel Useche <migueluseche@skatox.com>
# Contributor: Pat <whaevr@archlinux.us>
pkgname=gnomenu
trunk=2.9
pkgver=2.9
pkgrel=3
pkgdesc="A consolidated menu for gnome that brings eye candy to the world of the Gnome menu's."
arch=(any)
url="https://launchpad.net/gnomenu"
license=('GPL3')
depends=('python2' 'pyxdg' 'pycairo' 'gnome-python' 'deskbar-applet' 'pyxml' 'pygtk')
optdepends=('python-xlib' 'python-numpy' 'gettext')
makedepends=('python2-distribute')
source=("http://launchpad.net/gnomenu/trunk/${trunk}/+download/${pkgname}-${pkgver}.tar.gz")
md5sums=('9810e4bcf03a1a0b1a34344b335fbef8')

build() {
	cd ${srcdir}/gnomenu
	sed -i "s|python|python2|" Makefile
}

package() {
	export PYTHON=/usr/bin/python2
	cd ${srcdir}/gnomenu
	make DESTDIR=${pkgdir} install || return 1
	
	cd $pkgdir
	sed -i -e "s|#!/usr/bin/python$|#!/usr/bin/python2|" \
           -e "s|#!/usr/bin/env python$|#!/usr/bin/env python2|" $(find ./ -name '*.py')
	sed -i "s|python\ -u|python2\ -u |g" usr/bin/GnoMenu.py
}