# Contributor: forest76 <forestt@poczta.onet.pl>
# Contributor: Tilman Blumenbach <tilman@ax86.net>

pkgname=autotrace
pkgver=0.31.1
pkgrel=10
pkgdesc='autotrace is a utility to trace bitmaps: convert bitmaps to vector graphics'
arch=('i686' 'x86_64')
url='http://autotrace.sourceforge.net/'
license=('GPL' 'LGPL')
depends=('pstoedit' 'imagemagick>=6.5.3.10')
makedepends=('pkg-config' 'autoconf')
options=('!libtool')
source=(http://downloads.sourceforge.net/autotrace/$pkgname-$pkgver.tar.gz
        build-fixes.patch)

build() {
    _configure_args='--prefix=/usr'
    if [ `/usr/bin/pacman -Q pstoedit | cut -d ' ' -f 2` = '3.50-3' ]; then
        # This version of the pstoedit package is broken (FS #19221).
        warning \
            'Broken pstoedit package found, disabling pstoedit support in AutoTrace.'
        _configure_args="${_configure_args} --without-pstoedit"
    fi

    cd "${srcdir}/${pkgname}-${pkgver}"
    patch -Np 1 -i "${srcdir}/build-fixes.patch" || return 1

    autoreconf -fi
    ./configure ${_configure_args}
    make || return 1
    make "DESTDIR=${pkgdir}" install || return 1
}

md5sums=('54eabbb38d2076ded6d271e1ee4d0783'
         'f44a610e531543f99271e389f8dc53c3')
