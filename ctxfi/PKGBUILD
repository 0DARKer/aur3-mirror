# Contributor: Tim Yang <tdy@gmx.com>
pkgname=ctxfi
pkgver=1.00
pkgrel=4
pkgdesc="Audio driver for the X-Fi and X-Fi Titanium series"
arch=('i686' 'x86_64')
url="http://www.creative.com/"
license=('GPL2' 'custom:CEULA')
depends=('kernel26')
install=ctxfi.install
source=(http://ccftp.creative.com/manualdn/Drivers/AVP/10792/0x0343D29A/XFiDrv_Linux_Public_US_$pkgver.tar.gz
        ctxfi-$pkgver.diff)
md5sums=('908cad28ee4fdbee1216e96ff1eba4cc'
         '75f5f962d1a4b7e551fc8d8a1ddfcbcc')

build() {
  cd "$srcdir/XFiDrv_Linux_Public_US_$pkgver"
  patch -Np1 -i ../ctxfi-$pkgver.diff || return 1
  make || return 1
  make DESTDIR="$pkgdir" install || return 1
  sed -i "/^KERN/ s/=.*/=$(uname -r)/" "$startdir/$install"
}
