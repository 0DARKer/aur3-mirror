# Contributor: Andrea Zucchelli <zukka77@gmail.com>
pkgname=keepalived
pkgver=1.1.19
pkgrel=1
pkgdesc="implements an independent VRRPv2 stack and a userspace daemon for LVS cluster nodes healthchecks and LVS directors failover"
arch=('i686' 'x86_64')
url="http://www.keepalived.org/"
license=('GPL')
groups=()
backup=('etc/keepalived/keepalived.conf' 'etc/conf.d/keepalived')
depends=('openssl' 'popt')
source=("http://www.keepalived.org/software/$pkgname-$pkgver.tar.gz"
        "keepalived"
	)


build() {
  cd "$startdir/src/$pkgname-$pkgver"
  #patch -p0 -i "$startdir/src/vrrp_arp.patch"
  export CPPFLAGS=-I/usr/src/linux-`uname -r`/include
  ./configure --prefix=/usr --sysconfdir=/etc --mandir=/usr/share/man
  make || return 1
  make DESTDIR="$startdir/pkg" install
  install -d -m 755 "$startdir/pkg/etc/rc.d"
  rm  "$startdir/pkg/etc/rc.d/init.d/keepalived"
  rmdir "$startdir/pkg/etc/rc.d/init.d"
  cp "$startdir/src/keepalived" "$startdir/pkg/etc/rc.d"
  mv "$startdir/pkg/etc/keepalived/keepalived.conf" "$startdir/pkg/etc/keepalived/keepalived.conf.sample"
  mv "$startdir/pkg/etc/sysconfig" "$startdir/pkg/etc/conf.d"
}
md5sums=('a35b8d9d462810f7650d292bd7457523'
         '5d01008994157f47968e8bd82fb366d5')
