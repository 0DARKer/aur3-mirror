# Maintainer: Cliff Hood <archlinux@hoodgroup.us>

pkgname=nutups
pkgver=2.4.3
pkgrel=2
pkgdesc="Network UPS Tools for power mangement and controlling of more than just APC's UPS models on Unix and Linux machines."
arch=(i686 x86_64)
url="http://www.networkupstools.org"
license=('GPL')
depends=('gcc-libs' 'gd' 'gconf')
conflicts=('apcupsd')
makedepends=('pkgconfig')
install="nut.install"
source=(http://networkupstools.org/source/2.4/nut-$pkgver.tar.gz
        nut)
md5sums=('6f893b61b07915e7a139324fa3f79121' 
         'ec33471deb4330b8b89c7e9a502ec933')
 
build() {
  cd $startdir/src/nut-$pkgver
  ./configure --prefix=/usr \
	--with-serial --with-usb \
	--with-drivers=apcsmart,usbhid-ups,belkinunv,genericups \
	--with-drvpath=/usr/lib/nut \
	--with-user=nut --with-group=ups \
	--sysconfdir=/etc/nut \
	--libdir=/usr/lib/nut \
	--datadir=/etc/nut/data \
	--with-udev-dir=/etc/udev \
	--with-cgi --with-lib \
	--with-cgipath=/srv/http/cgi-bin \
	--with-htmlpath=/srv/http/nut \
	--with-pidpath=/var/run/nut \
	--with-statepath=/var/run/nut

  make || return 1
  make DESTDIR=$startdir/pkg install || return 1

  install -D -m755 $startdir/nut $startdir/pkg/etc/rc.d/nut && \
  chmod 755 $startdir/pkg/usr/bin/* && \
  mkdir -p $pkgdir/srv/http/cgi-bin/$pkgname && \
  mv $pkgdir/srv/http/cgi-bin/*.cgi $pkgdir/srv/http/cgi-bin/$pkgname
}
