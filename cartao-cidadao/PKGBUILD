# Maintainer: Micael Capit√£o <mjpcapitao@gmail.com>
pkgname=cartao-cidadao
pkgver=234
pkgrel=1
pkgdesc="Portuguese Citizen Card Application. Repackaged from Fedora 16 SVN version's package."
arch=('x86_64')
url="http://www.cartaodecidadao.pt"
license=('custom')
depends=('qt>=4.5.0' 'libpng12' 'pcsclite>=1.5.0' 'jasper' 'openssl' 'acsccid>=1.0.3' 'xerces-c' 'openssl>=1.0')
makedepends=('rpmextract')
downloaddir="http://svn.gov.pt/projects/ccidadao/repository/middleware-offline/tags/builds/lastversion"
source=("${downloaddir}/pteid-mw_fedora16_x86_64.rpm")
sha1sums=('e5eaf2bb9aa16a4f634a1823652e4c20656e7066')

build() {
    rm -rf "${srcdir}/${pkgname}-${pkgver}"
    mkdir "${srcdir}/${pkgname}-${pkgver}"
    cd "${srcdir}/${pkgname}-${pkgver}" || return 1
    rpmextract.sh ../pteid-mw_fedora16_x86_64.rpm
    find . -name .svn | xargs rm -fr
    mkdir -p etc/ld.so.conf.d
    echo "/usr/local/lib" >> etc/ld.so.conf.d/pteidgui.conf
    mkdir lib || return 1
    cd lib || return 1
    ln -s /lib/libcrypto.so.1.0.0 libcrypto.so.10
    ln -s /lib/libssl.so.1.0.0 libssl.so.10
}

package() {
    cd "${srcdir}/${pkgname}-${pkgver}" || return 1
    cp -r * ${pkgdir} || return 1
}
