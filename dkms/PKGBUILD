# $Id:$
# Contributor: Balwinder S "bsd" Dheeman (bdheeman AT gmail.com)
# Maintainer: Balwinder S "bsd" Dheeman (bdheeman AT gmail.com)

pkgname=dkms
pkgver=2.2.0.1
pkgrel=1
pkgdesc="A Dynamic Kernel Modules System or Framework"
arch=('any')
url=http://linux.dell.com/dkms/
license=('GPL')
depends=('kernel26-headers')
backup=('etc/dkms/framework.conf')
install=dkms.install
changelog=ChangeLog
source=(http://linux.dell.com/$pkgname/permalink/$pkgname-$pkgver.tar.gz
    'dkms_autoinstaller.patch')

build() {
    cd "$srcdir/$pkgname-$pkgver"
    if [ -x configure ]; then
	./configure --prefix=/usr
    fi
    make || return 1
}

package() {
    cd "$srcdir/$pkgname-$pkgver" || return $1
    make DESTDIR="$pkgdir" install || return $1

    # patch dkms, rc_script and create symlink
    patch -d$pkgdir -p1 -i $srcdir/dkms_autoinstaller.patch || return $1
    mkdir -p $pkgdir/etc/rc.d
    ln -s ../../usr/lib/dkms/dkms_autoinstaller $pkgdir/etc/rc.d/
}

# vim:set ts=2 sw=2 et:
md5sums=('8622625afa8f08795d4be4f8e505efa2'
         'cec3a549793baf5cfc44a99a8bcb495a')
