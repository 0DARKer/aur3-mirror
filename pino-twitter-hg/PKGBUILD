# Maintainer Renzo Carbonara <gnuk0001@gmail.com>
# Old Maintainer Emanuele Rossi <newdna1510 at yahoo dot it>

pkgname=pino-twitter-hg
pkgver=214
pkgrel=1
pkgdesc="Mercurial build of Pino Twitter Client GTK2/Vala "
arch=('i686' 'x86_64')
url="http://code.google.com/p/pino-twitter/"
license=('GPL')
depends=('vala' 'gtk2' 'libgee' 'libsoup' 'libwebkit' 'libxml2' 'intltool')
makedepends=('pkgconfig' 'mercurial')
provides=('pino-twitter-hg' 'pino-hg')
conflicts=('pino')
source=()
md5sums=()
source=('pino-construct-only-properties.patch')
md5sums=('30836dde1d7a9d39173f3de74d2a824c')

_hgroot=https://pino-twitter.googlecode.com/hg/
_hgrepo=pino-twitter

build() {
	cd ${startdir}/src

	if [ -d ${_hgrepo} ]; then
		cd ${startdir}/src/${_hgrepo}
		hg pull -u
	else
		hg clone ${_hgroot}${_hgrepo} || return 1
		cd ${startdir}/src/${_hgrepo}
	fi

	msg "Mercurial checkout done or server timeout"
	msg "Starting make..."

	cp -R ${startdir}/src/${_hgrepo} ${startdir}/src/${_hgrepo}-build
	cd ${startdir}/src/${_hgrepo}-build

	patch -N -l -p1 -i $srcdir/pino-construct-only-properties.patch || return 1

	./waf configure --prefix=/usr || return 1
	./waf build 	|| return 1
	./waf --destdir=$startdir/pkg install || return 1

	rm -rf ${startdir}/src/${_hgrepo}-build
}


