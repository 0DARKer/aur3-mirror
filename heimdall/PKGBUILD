# Contributor: Todd Musall 
# Contributor: dront78 (Ivan)
# Contributor: Victor Noel
# Maintainer: Ng Oon-Ee <ngoonee.talk@gmail.com>
pkgname=('heimdall')
pkgver=20110621
pkgrel=1
pkgdesc="Heimdall is a cross-platform open-source utility to flash firmware (aka ROMs) onto Samsung Galaxy S devices."
arch=('i686' 'x86_64')
url="http://www.glassechidna.com.au/products/heimdall/"
license=('MIT')
depends=('libusb')
optdepends=('udev-android-rules: Udev rules to connect Android devices to your linux box')
makedepends=('gcc')

_gitroot="http://github.com/Benjamin-Dobell/Heimdall"
_gitname=heimdall

build() {
  cd $srcdir
  
  if [ -d $_gitname ]; then
    cd $_gitname && git pull origin
  else
    git clone $_gitroot $_gitname
  fi
  # Remove old -build
  rm -rf $srcdir/$_gitname-build

  cp -r $srcdir/$_gitname $srcdir/$_gitname-build
  cd $srcdir/$_gitname-build/heimdall

  ./configure --prefix=/usr
  make
}

package() {
  cd $srcdir/$_gitname-build/heimdall
  # Prevent make install from trying to reload udev
  # We'll do this the Arch way at package install time
  mv Makefile Makefile.orig
  sed -e 's/sudo service udev restart/echo sudo service udev restart/' <Makefile.orig >Makefile
  make DESTDIR="${pkgdir}" install
}
# vim: set ft=sh ts=2 sw=2 et:
