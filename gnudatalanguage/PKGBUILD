# Maintainer: Orlando Garcia Feal <rodland at gmail dot com>

pkgname=gnudatalanguage
pkgver=0.9.3
pkgrel=3
pkgdesc="An IDL (Interactive Data Language) compatible incremental compiler (ie. runs IDL programs)"
arch=('i686' 'x86_64')
url="http://gnudatalanguage.sourceforge.net/"
license=('GPL')
depends=('python2' 'python2-numpy' 'plplot' 'gsl' 'readline' 'hdf5' 'netcdf' \
         'netcdf-cxx-legacy' 'wxgtk' 'fftw' 'udunits' 'pslib' 'grib_api' 'udunits')
options=('!makeflags')
source=(http://downloads.sourceforge.net/gnudatalanguage/gdl-${pkgver}.tar.gz gdl.profile)
md5sums=('f71f869e6c9aa99bbfdb22ecd5c88914'
         'f09b277f4b4fee3bedcc57c5add1ffe7')

build() {
  cd $srcdir/gdl-${pkgver}
  aclocal
  automake --add-missing --copy
  autoreconf
  ./configure --prefix=/usr --with-python --enable-python_version=2.7 --without-Magick --with-fftw \
    --with-hdf5 --with-udunits --with-grib --without-hdf CPPFLAGS="${CPPFLAGS} -I/usr/include/ImageMagick \
    -I/usr/include/python2.7 -I/usr/lib/python2.7/site-packages/numpy/core/include"
  make
}
package() {
  cd $srcdir/gdl-${pkgver}
  make DESTDIR=$pkgdir install

  install -d $pkgdir/usr/lib/gdl
  cp -r src/pro/* $pkgdir/usr/lib/gdl
  chmod -R 644 $pkgdir/usr/lib/gdl	 
  install -D -m755 ../gdl.profile $pkgdir/etc/profile.d/gdl.sh
}
