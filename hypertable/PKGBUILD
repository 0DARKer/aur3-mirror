# Maintainer: Alexander RÃ¸dseth <rodseth@gmail.com>
# Contributor: Thomas Dziedzic < gostrc at gmail >

pkgname=hypertable
pkgver=0.9.5.5
pkgrel=2
pkgdesc='High performance, scalable, distributed storage and processing system'
arch=('x86_64' 'i686')
url='http://hypertable.org/'
license=('GPL2')
depends=('log4cpp' 'hyperic-sigar' 'thrift' 'gperftools' 'kfs' 'rrdtool' 'ceph')

if [ $CARCH == "i686" ]; then
  source=("http://cdn.hypertable.com/packages/0.9.5.5/hypertable-0.9.5.5-linux-i386.tar.bz2")
  sha256sums=('2b7c5e132b590741ac03bcf701f740f2290c6b5619a422fccc87aa1afd7c025e')
else
  source=("http://cdn.hypertable.com/packages/0.9.5.5/hypertable-0.9.5.5-linux-x86_64.tar.bz2")
  sha256sums=('0773d8f06289ae980481db60489527771ce7a7953b85960211a17d8e7e939964')
fi

build() {
  cd "$srcdir/$pkgname-$pkgver"

  if [ -d build ]; then 
    rm -r build
  fi
  mkdir build
  cd build

  cmake \
    -DCMAKE_BUILD_TYPE=Release \
    -DThrift_LIB=/usr/lib/libthrift.so \
    -DSIGAR_LIBRARY=/usr/lib/libsigar-x86-linux.so \
    "../$pkgname-$pkgver"
  make
}

package() {
  cd "$srcdir/build"

  make DESTDIR="$pkgdir" install
}

# vim:set ts=2 sw=2 et:
