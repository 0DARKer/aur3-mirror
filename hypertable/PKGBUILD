# Maintainer: Alexander RÃ¸dseth <rodseth@gmail.com>
# Contributor: Thomas Dziedzic < gostrc at gmail >

pkgname=hypertable
pkgver=0.9.7.1
pkgrel=1
pkgdesc='High performance, scalable, distributed storage and processing system'
arch=('x86_64' 'i686')
url='http://code.google.com/p/hypertable/'
license=('GPL2')
depends=('log4cpp' 'libsigar' 'thrift' 'gperftools' 'kfs' 'rrdtool' 'ceph' 're2-hg' 'snappy' 'cronolog')
source=("http://$pkgname.googlecode.com/files/$pkgname-$pkgver-src.tar.gz")
sha256sums=('f0ad7860b477fc76be989420f81b7c6f4faff84b76b31c6b1838c094ca84fd99')

build() {
  cd "$srcdir"
  
  if [ -d build ]; then 
    rm -rf build
  fi
  mkdir build
  cd build

  export CXXFLAGS="$CXXFLAGS -fpermissive -lboost_regex"

  cmake \
    -DCMAKE_BUILD_TYPE=Release \
    -DThrift_LIB=/usr/lib/libthrift.so \
    -DSIGAR_LIBRARY=/usr/lib/libsigar.so \
    -DCMAKE_CXX_FLAGS=' -fpermissive -lboost_regex' \
    "../$pkgname-$pkgver"

  make -j1
}

package() {
  cd "$srcdir/build"

  make DESTDIR="$pkgdir" install
}

# vim:set ts=2 sw=2 et:
