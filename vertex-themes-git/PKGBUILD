# Maintainer: CanalGuada <dguadal at free dot fr>
# Author: horst3180 @ deviantart

pkgname=vertex-themes-git
pkgver=r274.20141027
pkgrel=1
pkgdesc='Vertex Gtk2, Gtk3, Metacity, Xfwm, Cinnamon and GNOME Shell themes (GNOME 3.14 version)'
_gnomever=3.14
arch=('any')
url='http://horst3180.deviantart.com/art/Vertex-Theme-470663601'
license=('GPL3')
depends=('gtk-engine-murrine')
makedepends=('git')
provides=('vertex-themes')
conflicts=('vertex-themes')
source=($pkgname::git+https://github.com/horst3180/Vertex-theme.git)
sha256sums=('SKIP')

pkgver() {
	cd $pkgname
	# get number of last git commit
	_commitCount=$(git rev-list --count HEAD)
	# get time of last git commit
	_commitTime=$(git show -s --format="%ci" | grep -o "....-..-.." | sed "s/-//g")
	# add ".r*.*" from package version
	echo "r$_commitCount.$_commitTime"
}

build() {
	cd $pkgname

  sed -i '125,126d' ./build.sh
  chmod +x ./build.sh
  ./build.sh
}
package() {
	cd $pkgname

  find "Vertex-Gnome-Shell" -type f -not -name *~ -exec install -Dm644 '{}' "$pkgdir/usr/share/themes/{}" \;
  find "Vertex_alt_metacity" -type f -not -name *~ -exec install -Dm644 '{}' "$pkgdir/usr/share/themes/{}" \;
  find "Vertex-Cinnamon" -type f -not -name *~ -exec install -Dm644 '{}' "$pkgdir/usr/share/themes/{}" \;
  cd Gnome-${_gnomever}
  find "Vertex" -type f -not -name *~ -exec install -Dm644 '{}' "$pkgdir/usr/share/themes/{}" \;
  find "Vertex-Dark" -type f -not -name *~ -exec install -Dm644 '{}' "$pkgdir/usr/share/themes/{}" \;
  find "Vertex-Light" -type f -not -name *~ -exec install -Dm644 '{}' "$pkgdir/usr/share/themes/{}" \;
  cd ../Chrome
  mkdir -p "$pkgdir"/usr/share/themes/{Vertex,Vertex-Light}/Chrome/
  cp -dr --no-preserve='ownership' Vertex.crx "$pkgdir"/usr/share/themes/Vertex/Chrome/
  cp -dr --no-preserve='ownership' Vertex-light.crx "$pkgdir"/usr/share/themes/Vertex-Light/Chrome/
  cd ../Thunderbird
  cd Vertex
  find "chrome" -type f -not -name *~ -exec install -Dm644 '{}' "$pkgdir/usr/share/themes/Vertex/Thunderbird/{}" \;
  cd ../Vertex-Dark
  find "chrome" -type f -not -name *~ -exec install -Dm644 '{}' "$pkgdir/usr/share/themes/Vertex-Dark/Thunderbird/{}" \;
  cd ../..
  cp -dr --no-preserve='ownership' {LICENSE,README} "$pkgdir"/usr/share/themes/Vertex/
}

# vim: ts=2 sw=2 et:
