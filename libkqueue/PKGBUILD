# $Id: pkgbuild-mode.el,v 1.23 2007/10/20 16:02:14 juergen Exp $
# Maintainer: Sebastien Binet <binet@farnsworth>
pkgname=libkqueue
pkgver=1.0
pkgrel=1 
pkgdesc="libkqueue is a portable userspace implementation of the kqueue(2) kernel event notification mechanism"
url="http://mark.heily.com/libkqueue/"
arch=('i686' 'x86_64')
license=('BSD')
depends=('glibc' 'linux-api-headers')
makedepends=('gcc')
provides=('libkqueue')
backup=()

source=(configure.patch libkqueue-license.txt
  http://mark.heily.com/libkqueue/dist/$pkgname-$pkgver.tar.gz
)
md5sums=('7f6bd2f566a2a37dc1feff894a083066'
         'e1feaa147250b1581d021efaebd55252'
         'dcae841fdc8f7968b2102aab8083144e')


build() {
  cd $startdir/src

  msg "patching 'configure'..."
  patch -p0 < configure.patch || return 1
  cd $startdir/src/$pkgname-$pkgver
  CFLAGS='-fPIC -I./include -I./src/common -Wall -Werror' ./configure --prefix=/usr || return 1
  make || return 1
  make DESTDIR=$startdir/pkg install || return 1

  install -D -m644 $startdir/libkqueue-license.txt $pkgdir/usr/share/licenses/$pkgname/LICENSE

  # remove libtool file
  /bin/rm $startdir/pkg/usr/lib/libkqueue.la

}