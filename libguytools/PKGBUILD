# Maintainer: yannsen <ynnsen@gmail.com>
pkgname=libguytools
pkgver=2.0.1
pkgrel=2
pkgdesc="A small programming toolbox."
arch=('i686' 'x86_64')
url="http://guymager.sourceforge.net/"
license=('GPL')
depends=(qt)
makedepends=(subversion)
_svntrunkfoobar="https://libguytools.svn.sourceforge.net/svnroot/libguytools/tags/tools-2.0.1"
_svnmodfoobar=libguytools
_svnpkgver=6

build() {
  cd $startdir/src
  msg "Connecting to SVN server...."
  if [ -d $_svnmodfoobar/.svn ]; then
    (cd $_svnmodfoobar && svn up -r $_svnpkgver)
  else
    svn co $_svntrunkfoobar --config-dir ./ -r $_svnpkgver $_svnmodfoobar
  fi

  msg "SVN checkout done or server timeout"
  msg "Starting make..."

  if [ -d "${srcdir}/${_svnmodfoobar}-build" ]; then
    rm -rf "${srcdir}/${_svnmodfoobar}-build"
  fi

  svn export $_svnmodfoobar $_svnmodfoobar-build
  cd $_svnmodfoobar-build
  
  ./create_version_file.sh
  qmake toolsstatic.pro
  make || return 1
  qmake tools.pro
  make || return 1
  install -d $pkgdir/usr/lib/ || return 1
  cp -R $srcdir/$_svnmodfoobar-build/lib/ $pkgdir/usr/ || return 1
  install -d $pkgdir/usr/include/libguytools2 || return 1
  cp -R $srcdir/$_svnmodfoobar-build/include/* $pkgdir/usr/include/libguytools2 || return 1
}
