# Maintainer: Estevao Valadao <estevao@archlinux-br.org>

pkgname=vpack
pkgver=20110826
pkgrel=1
pkgdesc="vABS Packaging Utility"
arch=('i686' 'x86_64')
url="http://github.com/archlinuxbr/vpack"
license=('GPL')
makedepends=('git')
depends=('sqlite3' 'zsync')
optdepends=('sudo')
install='vpack.install'
_gitroot='http://github.com/archlinuxbr/vpack.git'
_gitname='vpack'

package() {
    cd "${srcdir}"

    msg "Connecting to GitHub..."
        
    if [ -d "$startdir/src/$_gitname" ] ; then
        cd $_gitname && git pull origin
    else
        git clone "$_gitroot"
        cd $_gitname
    fi

    mkdir -p "$pkgdir/etc"
    mkdir -p "$pkgdir/usr/bin/"
    mkdir -p "$pkgdir/var/lib/vpack"
    mkdir -p "$pkgdir/usr/share/licenses/$pkgname"
    install -m 755 vpack "$pkgdir/usr/bin/vpack"
    install -m 644 vpack.conf "$pkgdir/etc/vpack.conf"
    install -m 644 COPYING "$pkgdir/usr/share/licenses/$pkgname/COPYING"

    if [ $CARCH = "i686" ]; then
        sed -i '/ARCH=/s|x86_64|i686|' ${pkgdir}/etc/vpack.conf
    fi
}
