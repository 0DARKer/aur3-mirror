pkgname=kokua-bin
pkgver=0.1.0
pkgrel=1
_pkgbasever='0.1.0-WIP'
arch=('i686' 'x86_64')
_arch='32'
[ "$CARCH" = "x86_64" ] && _arch='64'
pkgdesc="Second Life is a 3-D virtual world entirely built and owned by its residents. Kokua is an alternative viewer (native version)."
url="http://www.kokuaviewer.org"
license=('GPL')
depends=('alsa-lib' 'apr-util' 'freealut' 'gnome-vfs' 'gtk2' 'gstreamer0.10' 'libgl' 'libidn' 'libjpeg6' 'libpng12' 'mesa' 'nss' 'sdl' 'pulseaudio>=0.9.21')
install=kokua-bin.install
source=('kokua-bin.desktop' 'kokua-bin.launcher' \
"http://download.kokuaviewer.org/files/kokua/test-builds/Kokua-${_pkgbasever}-Linux${_arch}.tar.bz2")
md5sums=('1285fa6170c454de9313ab96c26492d9'
         '87a28e5c1e3762c12077b2a9a46b0dfa'
         'a5dea5249febe1347d34b62f1926d6cb')
[ "$CARCH" = "x86_64" ] && md5sums=(
         '1285fa6170c454de9313ab96c26492d9'
         '87a28e5c1e3762c12077b2a9a46b0dfa'
         'a88afab257b376eb177769ef7a0ba409') # Probably a cleaner way to do this

build() {
    cd $srcdir;

    # Rename Data Directory
    mv Kokua-${_pkgbasever}-Linux${_arch}/ kokua-bin

    # Install Desktop File
    install -D -m644 $srcdir/kokua-bin.desktop \
        $pkgdir/usr/share/applications/kokua-bin.desktop

    # Install Icon File
    # Changed name to experimental so the release version can co-exist
    install -D -m644 $srcdir/kokua-bin/kokua_icon.png \
        $pkgdir/usr/share/pixmaps/kokua-bin.png

    # Install Launcher
    install -D -m755 $srcdir/kokua-bin.launcher \
        $pkgdir/usr/bin/kokua-bin

    # Move Data to Destination Directory
    install -d $pkgdir/opt/
    mv kokua-bin/ $pkgdir/opt/

    # Change Permissions of files to root:games
    chown -R root:games $pkgdir/opt/kokua-bin
    chmod -R g+r $pkgdir/opt/kokua-bin

    # Make Binary Group-Executable
    chmod g+x $pkgdir/opt/kokua-bin/kokua
}
