pkgname=qutim-git
pkgver=20110716
pkgrel=1
pkgdesc="Multiplatform instant messenger"
arch=('i686' 'x86_64')
url="http://qutim.org"
license=('GPL')
depends=('qt>=4.6' 'openssl' 'libxss' 'qca>=2')
makedepends=('cmake' 'git' 'pkgconfig' 'libpurple')
conflicts=('qutim' 'qutim-0.3-git')

_gitroot="git://github.com/euroelessar/qutim.git"
_gitname="qutim"
    
build()
{
    if [ -d $srcdir/$_gitname ]
    then
        cd $srcdir/$_gitname
        git pull
    else
        cd $srcdir
        git clone $_gitroot $_gitname
        cd $srcdir/$_gitname
    fi
    git submodule update --init --recursive
    
    if [ -d $srcdir/$_gitname-build ]
    then 
        rm -rf $srcdir/$_gitname-build
    fi
    
    cp -r $srcdir/$_gitname $srcdir/$_gitname-build
    rm -rf $srcdir/$_gitname-build/plugins/kdeintegration
    mkdir $srcdir/$_gitname-build/build
    cd $srcdir/$_gitname-build/build
    msg "Building..."
    cmake -DCMAKE_INSTALL_PREFIX=/usr -DCMAKE_BUILD_TYPE=release ..
    make
    make DESTDIR=$pkgdir install
}

