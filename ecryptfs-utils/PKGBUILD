# Contributor: Richard Murri <admin@richardmurri.com>
# Contributor: Michal Krenek <mikos@sg1.cz>

pkgname=ecryptfs-utils
pkgver=87
pkgrel=1
arch=(i686 x86_64)
pkgdesc="Enterprise-class stacked cryptographic filesystem for Linux"
url="https://launchpad.net/ecryptfs"
license=('GPL')
makedepends=('swig' 'intltool' 'gettext')
depends=('keyutils' 'openssl' 'nss')
install=ecryptfs-utils.install
source=(http://launchpad.net/ecryptfs/trunk/${pkgver}/+download/${pkgname}_${pkgver}.orig.tar.gz
        0001-Do-not-update-mtab-if-it-is-a-symlink.patch)
options=(!libtool)
md5sums=('b3e4ec1c70b3c57bd289b327363c39f6'
         '376a516e1bb02af90b2725679a976245')

build() {
  cd "$srcdir/${pkgname}-${pkgver}"

  patch -p1 < "$srcdir/0001-Do-not-update-mtab-if-it-is-a-symlink.patch"

  export PYTHON=python2
  export PATH=$PATH:/usr/lib/perl5/core_perl/bin
  ./configure --prefix=/usr
  make || return 1
  make DESTDIR=$pkgdir install
}
