# Maintainer: Testuser_01 <arch@nico-siebler.de>

pkgname=webstorm
_pkgname=WebStorm
pkgver=3.0
_pkgver=111.19
pkgrel=1
pkgdesc="The smartest JavaScript IDE. 30-day free trial."
arch=('i686' 'x86_64')
url="http://www.jetbrains.com/${pkgname}"
license=('custom')
depends=('java-runtime>=7')
source=(http://download.jetbrains.com/webide/${_pkgname}-${pkgver}.tar.gz
	webstorm
	webstorm.desktop)
md5sums=('b626762f823692fb869e58ac063fa367'
         'ebdae6cf33d6ee7754f9bb09ef7316ff'
         'f6a96ff0ca3f80384ed1a593fb7ad6cf')
sha256sums=('ead232f7f52d150517625f0074c54ad6660e84f62b4ccfd6f52d72100d365dd5'
            '152a0b551a7955837d0e249b24c69d37282633751fc0f5fc68145edcb7c74711'
            '3d706a595d0cd70fbec3620024c45a22e5b0f63f8fec8217613cdb6cf667d19a')
sha512sums=('ed9b4a0ec79108efa45447720aa06cbba923f9d697c33bec7959e843953f261dca00887ec4c0cd81838f85247af411dc593d60b15501910a0a46342f490b898a'
            'a2b72456858e3d16c2a909b16f2e29b40f7193e94f79798cc45e11c816b929185f61985cdac1aef3e106bb878216900c762cc28e5d3f7586ca304efd2fcbecdc'
            'cc1daaf40a74c415c2f95f8bdb3a8953777dcb274193c0cf653c6f4a57caed905e88b8032359ff06b16648161482f1a0ae6c8f7cb113405c1b6b31aba05dd50c')

build() {
  cd "${srcdir}"
  mkdir -p "${pkgdir}/opt/${pkgname}" || return 1
  cp -r ${srcdir}/${_pkgname}-${_pkgver}/* "${pkgdir}/opt/${pkgname}" || return 1
  if [[ $CARCH = 'i686' ]]; then
    rm -f "${pkgdir}/opt/${pkgname}/bin/libyjpagent64.so"
    rm -f "${pkgdir}/opt/${pkgname}/bin/libbreakgen64.so"
    rm -f "${pkgdir}/opt/${pkgname}/bin/fsnotifier64"
  fi
  if [[ $CARCH = 'x86_64' ]]; then
    rm -f "${pkgdir}/opt/${pkgname}/bin/libyjpagent.so"
    rm -f "${pkgdir}/opt/${pkgname}/bin/libbreakgen.so"
    rm -f "${pkgdir}/opt/${pkgname}/bin/fsnotifier"
  fi

  mkdir -p "${pkgdir}/usr/bin" || return 1
  mkdir -p "${pkgdir}/usr/share/applications" || return 1
  mkdir -p "${pkgdir}/usr/share/pixmaps" || return 1
  mkdir -p "${pkgdir}/usr/share/licenses/${pkgname}" || return 1
  install -m 644 "${startdir}/${pkgname}.desktop" "${pkgdir}/usr/share/applications" || return 1
  install -m 644 "${pkgdir}/opt/${pkgname}/bin/webide.png" "${pkgdir}/usr/share/pixmaps/${pkgname}.png" || return 1
  install -m 644 "${srcdir}/${_pkgname}-${_pkgver}/license/${_pkgname}_license.txt" "${pkgdir}/usr/share/licenses/${pkgname}/${_pkgname}_license.txt" || return 1
  install -m 755 "${startdir}/${pkgname}" "${pkgdir}/usr/bin" || return 1
}

