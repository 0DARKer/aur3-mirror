# Contributor: J8T5X7 <Jan-MartenB@web.de> 

pkgname=rr62x
pkgver=1.1
pkgrel=5
pkgdesc="Kernel module for Highpoint RocketRAID 62x SATA cards"
arch=('i686' 'x86_64')
url="http://highpoint-tech.com/USA_new/product_support_sata6.htm"
license=('custom')
depends=('kernel26=2.6.37')
makedepends=('kernel26-headers=2.6.37')
install=rr62x.install
source=("http://www.support-highpoint-tech.com/Main/RR622/Linux/opensrc/rr62x-linux-src-v$pkgver-091221-1456.tar.gz")
md5sums=('fd41c24e6e2beb86af86ff975b128c8d')

_kernver=2.6.37-ARCH

build() {
    mkdir -p $startdir/pkg/lib/modules/${_kernver}/kernel/drivers/scsi/

    cd $startdir/src/rr62x-linux-src-v$pkgver/product/rr62x/linux/

    KERNELDIR=/lib/modules/${_kernver}/build make || return 1

    # Install the kernel module
    install -m 644 -D rr62x.ko $startdir/pkg/lib/modules/${_kernver}/kernel/drivers/scsi/

    mkdir -p $startdir/pkg/usr/share/licenses/$pkgname
    cp $startdir/src/rr62x-linux-src-v$pkgver/README $startdir/pkg/usr/share/licenses/$pkgname/
}
