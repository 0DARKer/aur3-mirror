# Contributor: Jed Brown <jed@59A2.org>
pkgname=(parmetis-mpich2)
_prefix=/opt/mpich2
pkgver=3.1.1
pkgrel=1
pkgdesc="A parallel graph partitioning library, built against MPICH2"
url="http://glaros.dtc.umn.edu/gkhome/metis/parmetis/overview"
arch=('i686' 'x86_64')
license="custom"
depends=(mpich2)
makedepends=()
conflicts=()
replaces=()
backup=()
source=(http://glaros.dtc.umn.edu/gkhome/fetch/sw/parmetis/ParMetis-$pkgver.tar.gz)

build() {
  cd $srcdir/ParMetis-$pkgver
  cat > Makefile.in <<EOF
CC= ${_prefix}/bin/mpicc
OPTFLAGS= -O2 -fPIC
LD= ${_prefix}/bin/mpicc
AR= ar rv
RANLIB= ar -ts
EOF
  make || return 1
  install -D -m644 libmetis.a $pkgdir${_prefix}/lib/libmetis.a
  install -D -m644 libparmetis.a $pkgdir${_prefix}/lib/libparmetis.a
  install -D -m644 parmetis.h $pkgdir${_prefix}/include/parmetis.h
  install -D -m644 COPYRIGHT $pkgdir/usr/share/licenses/$pkgname/license.txt
}
md5sums=('57318dbaddff2c3d1ef820cff0bf87b0')
