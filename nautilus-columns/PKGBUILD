# Maintainer: 3ED <krzysztof1987 _at_ gmail _dot_ com>

pkgname=nautilus-columns
pkgver=0.2
pkgrel=1
pkgdesc="A Nautilus extension to display music/EXIF metadata info in the Nautilus List View"
url="http://ubuntuforums.org/showpost.php?p=6643803&postcount=4"
license=('GPL')
depends=('python-nautilus' 'mutagen' 'pyexiv2' 'kaa-metadata')
#makedepends=('intltool')
source=(https://launchpad.net/~nilarimogard/+archive/webupd8/+files/${pkgname}_${pkgver}.orig.tar.gz)
options=('!libtool')
arch=('i686' 'x86_64')
sha256sums=('424c5b97e1fd787e66bc0782e6e2648790426b088f6bced3a34899daf93a147d')

build() {
  cd "$srcdir"

  # Python, oh python :/
  sed 's|#!/usr/bin/python|#!/usr/bin/python2|' \
   -i "$srcdir/bsc-v2.py" || return 1

  # Compiling script.. This isn't necessary but probably increase performance
  { cat << \
PYC
try:
  from py_compile import compile
  compile('bsc-v2.py')
except:
  pass
PYC
  } | python2
}

package() {
  install -dm755 \
    "$pkgdir/usr/lib/nautilus/extensions-2.0/python/" \
      || return 1
  install -m755 \
    "$srcdir/bsc-v2.py"* \
    "$pkgdir/usr/lib/nautilus/extensions-2.0/python/" \
      || return 1
}
