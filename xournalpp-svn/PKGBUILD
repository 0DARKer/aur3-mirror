# Contributor: Robert Orzanna <orschiro@googlemail.com>

pkgname=xournalpp-svn
_realname=xournalpp
pkgver=163
pkgrel=1
pkgdesc="The latest notetaking and sketching application build on the basis of xournal."
arch=('i686' 'x86_64')
url="http://sourceforge.net/projects/xournal/"
license=('GPL')
depends=('libgnomecanvas>=2.30.1' 'ghostscript' 'shared-mime-info' 'poppler-glib>=0.14.0' 'hicolor-icon-theme' 'desktop-file-utils')
makedepends=('subversion')
provides=('xournalpp')
conflicts=('xournal')
install=xournal.install

_svntrunk="https://xournal.svn.sourceforge.net/svnroot/xournal/trunk/xournalpp"
_svnmod=xournalpp

build() {
    cd ${srcdir}

    ##########################
    msg "Getting sources..."
    if [ -d ${_svnmod}/.svn ]; then
      cd ${_svnmod} && svn up -r ${pkgver}
    else
      svn co ${_svntrunk} --config-dir ./ -r ${pkgver} ${_svnmod}
      cd ${_svnmod}
    fi

    msg "SVN checkout done or server timeout"
    msg "Starting make..."
  
    #########################
    cd "${srcdir}/${_realname}"
    autoreconf -i
    ./configure --prefix=/usr
    make
}

package() {
    cd "${srcdir}/${_realname}"
    make DESTDIR="${pkgdir}" install desktop-install
}
