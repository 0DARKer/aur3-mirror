# Contributor: Tom Wizetek <tom@wizetek.com>
pkgname=jxplorer
pkgver=3.2.1
pkgrel=3
pkgdesc="Java LDAP client"
_pkgbin="${pkgname}-${pkgver}-linux-installer.bin"
_desktop='usr/share/applications/JXplorer.desktop'
url="http://jxplorer.org/"
license=('custom')
arch=('any')
depends=('java-runtime')
source=("http://downloads.sourceforge.net/project/${pkgname}/${pkgname}/version%20${pkgver}/${_pkgbin}")
md5sums=('f558a18496a46c336012aca8294ff9a9')

package() {
	chmod 0700 ${_pkgbin}
	./${_pkgbin} --mode unattended --prefix ${srcdir}/${pkgname}

	install -d -m 0755 ${pkgdir}/opt
	cp -r ${srcdir}/${pkgname} ${pkgdir}/opt
	chmod 0755 ${pkgdir}/opt/${pkgname}/jxplorer.sh

	# Regrettably, there is no user settings separation (as far as I can tell).
	# We will use globally writeable config files then. Sorry.
	# There may be more than these two...
	touch ${pkgdir}/opt/${pkgname}/gssapi.conf
	touch ${pkgdir}/opt/${pkgname}/jxconfig.txt
	chmod 0777 ${pkgdir}/opt/${pkgname}/gssapi.conf
	chmod 0777 ${pkgdir}/opt/${pkgname}/jxconfig.txt

	install -D -m 0644 ${srcdir}/${pkgname}/JXplorer.desktop ${pkgdir}/${_desktop}
	sed -i "s,${srcdir},/opt," ${pkgdir}/${_desktop}
	sed -i "/^Version=/c\Version=${pkgver}" ${pkgdir}/${_desktop}
	sed -i "/^Comment=/c\Comment=${pkgdesc}" ${pkgdir}/${_desktop}

	rm ${pkgdir}/opt/${pkgname}/uninstall
	rm ${pkgdir}/opt/${pkgname}/*.desktop
	rm ${pkgdir}/opt/${pkgname}/*.bat
}
