# Contributor: based on zhuqin <zhuqin83@gmail.com>

pkgname=bin32-gmlive-svn
_realname=gmlive
pkgver=205
pkgrel=1
pkgdesc="A live video for linux, powered by mms, sopcast and nslive. x86_64 ONLY"
arch=('x86_64')
#use bin32-sopcast due to non-free sopcast & nslive
license=('GPL')
depends=('libglademm>=2.4.0' 'gtkmm>=2.6.0' 'bin32-sopcast' 'mplayer')
makedepends=('subversion' 'pkgconfig>=0.9.0' 'autoconf' 'automake' 'intltool' 'gnome-common')
install=nslive.install
url="http://code.google.com/p/gmlive/"
source=(http://www.newseetv.com/soft/nslive-0.1.0.tar.gz)
conflicts=('gmlive' 'gmlive-svn')
md5sums=('da9b46068a55b734bcecdda3c7d54c1f')

_svntrunk=http://$_realname.googlecode.com/svn/trunk/
_svnmod=gmlive

build() {
    cd $startdir/src
    
    msg "Updating SVN entries for $_svnmod ..."
    
    if [ -d $_svnmod/.svn ]; then
      (cd $_svnmod && svn up -r $pkgver)
    else
      svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
    fi
    
    cp -r $_svnmod $_svnmod-build
    
    cd $_svnmod-build
    
    msg "Finished update, starting build ..."

    #uncomment "--enable-plugin" if you need totem plugin support.
    ./autogen.sh --prefix=/usr #--enable-plugin
    make || return 1
    make DESTDIR=$startdir/pkg install
    cd $startdir/src/nslive-0.1.0
    install -D -m755 gnslive nslive nsweb $startdir/pkg/usr/bin/
    
    rm -rf $startdir/src/$_svnmod-build
}
