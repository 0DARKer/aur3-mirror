#Maintainer: Gustavo alvarez <sl1pkn07@gmail.com>

pkgname=kdeplasma-applets-miniplayer-git
pkgver=20130106
pkgrel=1
pkgdesc="A plasmoid for playing multimedia. (from GIT)"
arch=('i686' 'x86_64')
url="http://www.kde-look.org/content/show.php/Mini+Player?content=95501"
license=('GPL')
depends=('kdelibs')
makedepends=('cmake' 'automoc4' 'git')
provides=('kdeplasma-addons-applets-miniplayer' 'kdeplasma-applets-miniplayer')
conflicts=('kdeplasma-addons-applets-miniplayer' 'kdeplasma-applets-miniplayer')

_gitroot="git://github.com/Emdek/plasmoid-mini-player.git"
_gitname="mini-player"

build() {
    cd "${srcdir}"
    msg "Connecting to GIT server..."

    if [ -d "${_gitname}" ]; then
        cd "${_gitname}" && git pull --dept=1
    else
        git clone --depth=1 "${_gitroot}" "${_gitname}"
    fi

    msg "GIT checkout done or server timeout"
    msg "Starting build..."

    rm -fr "${srcdir}/${_gitname}-build"
    cp -R "${srcdir}/${_gitname}" "${srcdir}/${_gitname}-build"
    cd "${srcdir}/${_gitname}-build"

    cmake . -DCMAKE_INSTALL_PREFIX="$(kde4-config --prefix)"
    make
}

package() {
    cd "${srcdir}/${_gitname}-build"
    make DESTDIR="${pkgdir}" install
}
