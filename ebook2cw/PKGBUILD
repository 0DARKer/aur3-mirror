#Maintainer: Bob Finch <w9ya@qrparci.net>

pkgname=ebook2cw
pkgver=0.7.0
pkgrel=1
pkgdesc="Converts ebooks to Morse code - MP3s"
url="http://fkurz.net/ham/ebook2cw.html"
makedepends=('gcc-libs' 'html2text' 'txt2man')
depends=('lame')
source=(http://fkurz.net/ham/$pkgname/$pkgname-$pkgver.tar.gz
        http://fkurz.net/ham/$pkgname.html
        http://fkurz.net/ham/$pkgname/example/Example.txt
        http://fkurz.net/ham/$pkgname/example/Chapter{00,01,02}.mp3)
arch=('i686' 'x86_64')
license=('GPL')

md5sums=('77a2902ef19340ad8528514822d17518'
         '860d1a160d1d0bd34d40424576566b92'
         'f6ff49ec2ae839b95b48ef6592d18481'
         '52c6884888810f6b7199f004c38608a9'
         '4396acf1065cc198bdc545ae83968b19'
         'd0aa612cdfd651ce03bfead58319b7ed')

build() {
  cd $startdir/src
  
  html2text -style pretty ebook2cw.html > ebook2cw.txt
  grep -v ^- ebook2cw.txt > ebook2cw
  txt2man -p ebook2cw > ebook2cw.1
  
  gcc -lm -lmp3lame $pkgname-$pkgver/ebook2cw.c -o ebook2cw
    
  install -D -m755 ebook2cw $startdir/pkg/usr/bin/ebook2cw
  
  mkdir -p $startdir/pkg/usr/share/man/man1
  install -m644 $pkgname.1 $startdir/pkg/usr/share/man/man1
  
  mkdir -p $startdir/pkg/usr/share/$pkgname/Examples
  install -m644 Example.txt $startdir/pkg/usr/share/$pkgname/Examples
  install -m644 *.mp3 $startdir/pkg/usr/share/$pkgname/Examples
  
  cd $pkgname-$pkgver
  install -m644 *.txt $startdir/pkg/usr/share/$pkgname/Examples
  install -m644 *.conf $startdir/pkg/usr/share/$pkgname/Examples
}
