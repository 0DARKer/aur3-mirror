pkgname=mingw32-freetds-static
pkgver=0.91
pkgrel=3
pkgdesc="Library for accessing Sybase and MS SQL Server databases"
url="http://www.freetds.org"
arch=(any)
license=("LGPL")
depends=(mingw32-libiconv-static)
conflicts=(mingw32-freetds)
provides=(mingw32-freetds)
options=(!strip !buildflags !libtool)
backup=(etc/freetds/freetds.conf etc/freetds/locales.conf etc/freetds/pool.conf)
source=(ftp://ftp.ibiblio.org/pub/Linux/ALPHA/freetds/stable/freetds-$pkgver.tar.gz)
md5sums=('b14db5823980a32f0643d1a84d3ec3ad')

build() {
  cd $startdir/src/freetds-$pkgver
  ./configure --prefix=/usr/i486-mingw32 --host=i486-mingw32 --enable-sybase-compat --enable-static --disable-shared --with-tdsver=8.0 --enable-threadsafe --disable-debug --enable-msdblib
  make || return 1
}

package() {
  cd $srcdir/freetds-$pkgver
  make DESTDIR=$startdir/pkg install
  rm -R $pkgdir/usr/i486-mingw32/share
  i486-mingw32-strip $pkgdir/usr/i486-mingw32/bin/*.exe
  i486-mingw32-strip -g $pkgdir/usr/i486-mingw32/lib/*.a
}
