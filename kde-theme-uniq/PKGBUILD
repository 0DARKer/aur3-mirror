# Maintainer: Gen2ly <toddrpartridge@gmail.com>

pkgname=kde-theme-uniq
_pkgname=UniQ_by_Scnd101.gz
pkgver=0.6
pkgrel=2
pkgdesc="KDE 4 theme suite: KDM, style, windecor, icons, plasma."
arch=('i686' 'x86_64')
url="http://www.kde-look.org/content/show.php/UniQ?content=112688"
license=('CCPL')
depends=('kdebase-workspace>=4.2.91' 'qtcurve-kde4')
install="$pkgname.install"
source=()
md5sums=()


build() {

  cd $srcdir

  # Download
  if [[ ! -f "${_pkgname}" ]]; then
    msg "Downloading..."
    wget "http://www.deviantart.com/download/138312106/${_pkgname}" -o /dev/null --user-agent="Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.11) Gecko/2009061317 GranParadiso/3.0.11" || return 1
  else
    md5chk="$(md5sum ${_pkgname} | cut -d " " -f 1)"
    if [ ${md5chk} != 67e65b144deba21ea78ef2bf8980e4c6 ]; then
      msg "md5sum check failed" && return 1
    else
      msg "md5sum check passes"
    fi
  fi


  # Create destination directories
  install -d $pkgdir/usr/share/icons
  install -d $pkgdir/usr/share/wallpapers/UniQ
  install -d $pkgdir/usr/share/apps/ksplash/Themes
  install -d $pkgdir/usr/share/apps/desktoptheme
  install -d $pkgdir/usr/share/apps/aurorae/themes
  install -d $pkgdir/usr/share/apps/QtCurve/
  install -d $pkgdir/usr/share/apps/color-schemes/

  # Extract files
  bsdtar -xf ${_pkgname} -C $srcdir

  # Move extracted directory to proper build dirctory
  cd $srcdir
  [ -d $pkgname-$pkgver ] && rm -r $pkgname-$pkgver
  mv UniQ $pkgname-$pkgver

  # Install files
  cd $pkgname-$pkgver

  # icons
  cp -r ALLGREY\ UniQ\ Edition $pkgdir/usr/share/icons/UniQ-allgrey

  # wallpapers
  cd Wallpapers
  cp lines.svg $pkgdir/usr/share/wallpapers/UniQ/UniQ-lines.svg
  cp uni.svg $pkgdir/usr/share/wallpapers/UniQ/UniQ-uni.svg
  cd dotline
  rename dotline_ UniQ-dotline- *
  mv dotline.png UniQ-dotline.png
  cp UniQ-dotline-* $pkgdir/usr/share/wallpapers/UniQ/
  cd $srcdir/$pkgname-$pkgver

  # kdm themes
#  cp -r kdm/uniq_blue $pkgdir/usr/share/apps/ksplash/Themes/UniQ_Blue
#  cp -r kdm/uniq_green $pkgdir/usr/share/apps/ksplash/Themes/UniQ_Green
#  cp -r kdm/uniq_lines $pkgdir/usr/share/apps/ksplash/Themes/UniQ_Lines
#  cp -r kdm/uniq_red $pkgdir/usr/share/apps/ksplash/Themes/UniQ_Red
#  cp -r kdm/uniq_white $pkgdir/usr/share/apps/ksplash/Themes/UniQ_White

  # plasma theme
  cp -r plasma/UniQ $pkgdir/usr/share/apps/desktoptheme/

  # window decoration
  cp -r windeco/aurorae/uniq $pkgdir/usr/share/apps/aurorae/themes/

  # qtcurve theme
  install -Dm644 qtc_uniq.themerc $pkgdir/usr/share/apps/QtCurve/UniQ.qtcurve

  # color scheme
  install -Dm644 UniQ.colors $pkgdir/usr/share/apps/color-schemes/

}
