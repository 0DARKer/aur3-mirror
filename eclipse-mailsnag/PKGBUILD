# Maintainer: David Morgan <dmorgan81[at]gmail[dot]com>
pkgname=eclipse-mailsnag
pkgver=1.3.3
pkgrel=1
pkgdesc="Eclipse plugin that acts as a dummy SMTP server."
arch=('i686' 'x86_64')
url="http://code.google.com/a/eclipselabs.org/p/foos-bar/"
license=('EPL')
depends=('eclipse>=3.5')
_url="http://foos-bar.eclipselabs.org.codespot.com/svn/update/"

source=(
    "com.foosbar.mailsnag_${pkgver}_feature.jar::${_url}/features/com.foosbar.mailsnag_${pkgver}.jar"
    "com.foosbar.mailsnag_${pkgver}_plugin.jar::${_url}/plugins/com.foosbar.mailsnag_${pkgver}.jar")
noextract=(${source[@]%%::*})

build() {
  _dest=${pkgdir}/usr/share/eclipse/dropins/mailsnag/eclipse
  install -dm755 ${_dest}/plugins

  for url in ${source[@]}
  do 
    _file="${url%%::*}"
    _type="${url%/*}"
    _type="${_type##*/}"

    #install -Dm644 ${_file} ${_dest}/${_type}/${_file} || return 1
    if [ ${_type} == 'features' ]; then
        install -dm755 ${_dest}/features/${_file/.jar} 
        cd ${_dest}/features/${_file/.jar}
        jar xf ${srcdir}/${_file} || return 1
        cd ${_dest}/features
        mv ${_file/.jar} ${_file/_feature.jar}
    else
        install -Dm644 ${srcdir}/${_file} ${_dest}/plugins/${_file/_plugin.jar}.jar
    fi
  done     
}
# vim:set ts=4 sw=4 et:

md5sums=('f189c2e0c9f9efac6a054e0d51a560f4'
         'ecb04dc1b7421a593f2a489ace4e8ced')
