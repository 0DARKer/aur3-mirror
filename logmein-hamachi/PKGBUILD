# LogMeIn-Hamachi: Installer: Arch
# Contributor: Xavion <Xavion (dot) 0 (at) Gmail (dot) com>
# Contributor: Lauri Niskanen <ape@ape3000.com>
# Contributor: Andrea Scarpino <andrea@archlinux.org>
# Contributor: metzen <metzen@gmail.com>

company=logmein
product=hamachi
pkgname=${company}-${product}
pkgver=2.0.1.13
pkgrel=1
pkgdesc="A zero-configuration VPN service"
arch=("i686" "x86_64")
url="https://secure.${company}.com/US/products/${product}2/"
license=("custom")
conflicts=("${product}")
replaces=("${product}")
install="${pkgname}.install"
options=("!strip")
[ "${CARCH}" == "i686" ] &&	filearch=x86 && sha1sums=('01ef90a5df95c863d983561f39534bfc70bb7d0a')
[ "${CARCH}" == "x86_64" ] && filearch=x64 && sha1sums=('2c71fa14c1b8d68e3dc8a93a17e84b1e3ac7df97')
source=("https://secure.${company}.com/labs/${pkgname}-${pkgver}-${filearch}.tgz")

build() {
	/bin/true
}

package() {
	cd ${srcdir}/${pkgname}-${pkgver}-${filearch}

	# Directories
	install -d ${pkgdir}/opt/${pkgname}/bin || return 1
	install -d ${pkgdir}/usr/bin ${pkgdir}/etc/rc.d || return 1
	install -d ${pkgdir}/usr/share/licenses/${pkgname} || return 1

	install -m 755 ${product}d "${pkgdir}/opt/${pkgname}/bin" || return 1
	install -m 755 dnsup "${pkgdir}/opt/${pkgname}/bin" || return 1
	install -m 755 dnsdown "${pkgdir}/opt/${pkgname}/bin" || return 1
	install -m 755 uninstall.sh "${pkgdir}/opt/${pkgname}" || return 1
	install -m 444 README "${pkgdir}/opt/${pkgname}" || return 1
	install -m 444 LICENSE "${pkgdir}/opt/${pkgname}" || return 1
	install -m 444 CHANGES "${pkgdir}/opt/${pkgname}" || return 1
	ln -sf "/opt/${pkgname}/bin/${product}d" "${pkgdir}/usr/bin/${product}" || return 1
	#install -m 755 ${product}-init "${pkgdir}/etc/rc.d/${pkgname}" || return 1
	install -m 755 ${startdir}/extra/${product}-init "${pkgdir}/etc/rc.d/${pkgname}" || return 1

	# License
	ln -sf "/opt/${pkgname}/LICENSE" ${pkgdir}/usr/share/licenses/${pkgname}/LICENSE || return 1
}
