# Maintainer : Simon DÃ©saulniers <rostydela@gmail.com>

pkgname=pyclewn2
pkgver=1.11
pkgrel=1
pkgdesc="A python2 version of gdb support for vim"
license=('GPL2')
arch=(i686 x86_64)
url="http://pyclewn.wiki.sourceforge.net"
depends=('python2' 'gvim>=7.3' 'gdb')
install=${pkgname}.install
source=(http://downloads.sourceforge.net/sourceforge/pyclewn/pyclewn-$pkgver/pyclewn-$pkgver.py2.tar.gz 
        ${install}.template)
sha256sums=('29ab96e6b83056a34ef13b4116b59154054ad5c9341a33ff543f051b13d5905e'
            'SKIP')
_vimversion=$(vim --version | head -n 1 | gawk '{print $5}')

touch ${install} # stop makepkg complaints... 
                 # ${install} will be created in prepare() 

prepare() {
  cd $startdir
  # creating ${install} file from template with _vimversion var.
  echo "_vimversion=${_vimversion}" >${install}
  cat ${install}.template >>${install}

  cd $srcdir/pyclewn-$pkgver.py2
  # fixing a duplicated marker in pyclewn.txt
  sed -i 's/ \*C\*$//' runtime/doc/pyclewn.txt
}

package() {
  cd $srcdir/pyclewn-$pkgver.py2
  vimdir=/usr/share/vim/vim"${_vimversion/\./}" python2 setup.py install --force --root=$pkgdir
}
# vim:tw=80: sw=2: ts=2:
