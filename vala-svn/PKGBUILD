# Maintainer: Adam Eberlin < ae at adameberlin dot com >

pkgname=vala-svn
pkgver=2472
pkgrel=1
pkgdesc="Compiler for the GObject type system"
arch=('i686' 'x86_64')
conflicts=('vala')
depends=('glib2')
license=('LGPL')
makedepends=('vala' 'flex' 'bison' 'pkgconfig' 'gtk2' 'libxslt' 'subversion')
options=('docs' 'emptydirs' '!libtool' 'strip' 'zipman')
provides=("vala-svn=$pkgver" "vala")
url=http://live.gnome.org/vala

_svntrunk=http://svn.gnome.org/svn/vala/trunk
_svnmod=vala

build()
{
	cd ${srcdir}/

	msg "Checking out source from SVN repository..."

	if [ -d $_svnmod/.svn ]; then
		(cd $_svnmod && svn --config-dir ./ up -r $pkgver)
	else
		svn --config-dir ./ co $_svntrunk -r $pkgver $_svnmod
	fi

	msg "SVN source checkout complete (or server timeout)"
	msg "Starting build procccess..."

	cp -r $_svnmod $_svnmod-build
	cd $_svnmod-build

	./autogen.sh
	./configure --prefix=/usr --enable-vapigen --enable-gen-project || return 1

	make || return 1
	make DESTDIR=${pkgdir} install || return 1

	rm -rf $_svnmod-build
}
