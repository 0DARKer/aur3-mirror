pkgname=mingw32-openssl-static
pkgver=1.0.0g
pkgrel=1
arch=(any)
url="http://www.openssl.org"
pkgdesc="Toolkit implementing the Secure Sockets Layer (SSL v2/v3) and Transport Layer Security (TLS v1) protocols."
depends=('mingw32-zlib-static')
makedepends=('mingw32-w32api' 'mingw32-gcc' 'mingw32-binutils')
conflicts=('mingw32-openssl')
provides=('mingw32-openssl')
license=(custom)
source=(http://www.openssl.org/source/openssl-$pkgver.tar.gz)
md5sums=('07ecbe4324f140d157478637d6beccf1')
options=(!strip !buildflags)

build()
{
  cd $startdir/src/openssl-$pkgver
  ./Configure --cross-compile-prefix=i486-mingw32- -DOPENSSL_NO_CAPIENG --prefix=/usr/i486-mingw32 mingw no-shared zlib
  make || return 1

  mkdir -p $pkgdir/usr/i486-mingw32/lib
  cp libssl.a $startdir/pkg/usr/i486-mingw32/lib/
  cp libcrypto.a $startdir/pkg/usr/i486-mingw32/lib/
  cp -RL include $startdir/pkg/usr/i486-mingw32/
}

