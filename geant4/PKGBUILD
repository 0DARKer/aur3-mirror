# Contributor: Yngve Inntjore Levinsen <yngve.inntjore.levinsen@cern.ch>


pkgname=geant4
pkgver=4_9_3_p01_3
# geant4 must be linked against a specific clhep version!
_clhepver=2.0.4.6
pkgrel=4
pkgdesc=""

makedepends=('deb2targz' 'tar')
optdepends=('gnuplot: Plotting functionality' 'root: Analytical framework' 'dawn: Tool to display geometry' 'gv: Postscript viewer' 'cernlib: PAW support and/or g3tog4 support?')
_pkgver=4.9.3.p01-3
arch=('x86_64' 'i686')
license=('http://geant4.web.cern.ch/geant4/license/')
url="http://cern.ch/geant4"
if [ "${CARCH}" = "x86_64" ]; then
md5sums=('241555e324019fc4dd24b7f443ebb547'
         '0bb06c67d290c65ac9262d0f5bff0cfc'
         '080f32aa8614582b39d540f69eb04f65'
         '9c1450fd4fc89ed3e701b0adcccc315a'
         '24893bd14abbf55f33e7874154af6c38'
         '8702283c3025fbf6190d867cb99d9a1d'
         '1ba70eb5cad7e71fd620110bf5809d50'
         '866a30af4e6d6f8c315ce70d406d5d46'
         '173dce3377166b62685aaa3e9ba61a0d'
         '8b2f83bb427a43c8a81d7aab26f1fbdf')
_carch=amd64
elif [ "${CARCH}" = "i686" ]; then
md5sums=('241555e324019fc4dd24b7f443ebb547'
         '0bb06c67d290c65ac9262d0f5bff0cfc'
         '080f32aa8614582b39d540f69eb04f65'
         '9c1450fd4fc89ed3e701b0adcccc315a'
         '7ff98159f4d04c8a8fd354a2da42b2d5'
         '8db152af14f53d6de70bd91c5374e360'
         'fa3f391191f0ae554b0339e8327d6832'
         '8dbcf39c471e91113f65b29c06f97273'
         '8cab76b6fd0091cf072523501f22c1c0'
         '1e2877e99823100d1dadc78544a5358e')
 _carch=i386
fi

depends=('libx11' 'libxcb' 'glibc' 'zlib' 'libgl' 'libxaw' 'lesstif' 'libxmu' 'xerces-c-2' "clhep==${_clhepver}")

source=(
  geant4-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/g/${pkgname}/geant4_${_pkgver}_all.deb"
  geant4-common-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/g/${pkgname}/geant4-common_${_pkgver}_all.deb"
  geant4-headers-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/g/${pkgname}/geant4-headers_${_pkgver}_all.deb"
  geant4-examples-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/g/${pkgname}/geant4-examples_${_pkgver}_all.deb"
  libgeant4-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/g/${pkgname}/libgeant4-4.9-6_${_pkgver}_${_carch}.deb"
  libgeant4-dev-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/g/${pkgname}/libgeant4-dev_${_pkgver}_${_carch}.deb"
  libgeant4-plists-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/g/${pkgname}/libgeant4-plists-4.9-6_${_pkgver}_${_carch}.deb"
  libgeant4-plists-dev-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/g/${pkgname}/libgeant4-plists-dev_${_pkgver}_${_carch}.deb"
  libg4opengl-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/g/${pkgname}/libg4opengl-4.9-6_${_pkgver}_${_carch}.deb"
  libg4opengl-dev-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/g/${pkgname}/libg4opengl-dev_${_pkgver}_${_carch}.deb"
# Use this if the clhep version in aur is not the same as required for geant4:
#   clhep-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/c/clhep2/clhep2_${_clhepdebver}_${_carch}.deb"
#   clhep-dev-$pkgver.deb::"http://lcg-heppkg.web.cern.ch/lcg-heppkg/debian/pool/hep/c/clhep2/clhep2-dev_${_clhepdebver}_${_carch}.deb"
)

build() {
  install -d ${pkgdir}/usr/share/licenses/${pkgname}
  pwd
  deb2targz geant4-$pkgver.deb > /dev/null
  deb2targz geant4-common-$pkgver.deb > /dev/null
  deb2targz geant4-headers-$pkgver.deb > /dev/null
  deb2targz geant4-examples-$pkgver.deb > /dev/null
  deb2targz libgeant4-$pkgver.deb > /dev/null
  deb2targz libgeant4-dev-$pkgver.deb > /dev/null
  deb2targz libgeant4-plists-$pkgver.deb > /dev/null
  deb2targz libgeant4-plists-dev-$pkgver.deb > /dev/null
  deb2targz libg4opengl-$pkgver.deb > /dev/null
  deb2targz libg4opengl-dev-$pkgver.deb > /dev/null
  deb2targz libg4opengl-$pkgver.deb > /dev/null
  deb2targz libg4opengl-dev-$pkgver.deb > /dev/null
  tar -xzf geant4-$pkgver.tar.gz
  tar -xzf geant4-common-$pkgver.tar.gz
  tar -xzf geant4-headers-$pkgver.tar.gz
  tar -xzf geant4-examples-$pkgver.tar.gz
  tar -xzf libgeant4-$pkgver.tar.gz
  tar -xzf libgeant4-dev-$pkgver.tar.gz
  tar -xzf libgeant4-plists-$pkgver.tar.gz
  tar -xzf libgeant4-plists-dev-$pkgver.tar.gz
  tar -xzf libg4opengl-$pkgver.tar.gz
  tar -xzf libg4opengl-dev-$pkgver.tar.gz
#   #adding clhep:
#   deb2targz clhep-$pkgver.deb
#   deb2targz clhep-dev-$pkgver.deb
#   tar -xzf clhep-$pkgver.tar.gz
#   tar -xzf clhep-dev-$pkgver.tar.gz

  cp -r usr/ ${pkgdir}/
  cp -r etc/ ${pkgdir}/
  install -D -m644 usr/share/doc/${pkgname}/copyright ${pkgdir}/usr/share/licenses/${pkgname}/
  }
 
