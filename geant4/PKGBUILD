# Maintainer: Yngve Inntjore Levinsen <yngve.inntjore.levinsen@cern.ch>


pkgname=geant4
pkgver=4.9.5
_pkgver=9.5.0
pkgrel=1
pkgdesc="A simulation toolkit for particle physics interactions."

makedepends=('cmake')
depends=('clhep' 'xerces-c-2')
arch=('x86_64' 'i686')
license=('custom: http://geant4.cern.ch/license/') 
url="http://geant4.cern.ch/"

depends=("clhep" "gcc" 'xerces-c-2' 'qt')

source=(http://geant4.cern.ch/support/source/geant${pkgver}.tar.gz
        'g4env')
md5sums=('3b4ec11e82b78b25229ef3e626c16400'
         'c5ca7f8c3e2541f4a88bba0081e995ea')
build() {
    #!/bin/sh -e
    
    
    # comment out this block if you
    # for debug reasons want to continue 
    # build instead of restarting
    [ -d build ] && rm -rf build
    mkdir build 


    cd build
    
    cmake     -DGEANT4_USE_GDML=ON \
              -DGEANT4_USE_G3TOG4=ON \
              -DGEANT4_USE_QT=ON \
              -DCMAKE_INSTALL_PREFIX=/usr \
              -DGEANT4_INSTALL_EXAMPLES=ON \
              -DGEANT4_USE_RAYTRACERX=ON \
              -DGEANT4_INSTALL_DATA=ON \
              -DGEANT4_USE_OPENGL_X11=ON \
              -DGEANT4_RAYTRACER_X11=ON \
              -DGEANT4_SYSTEM_CLHEP=ON \
              -DGEANT4_XM=ON \
              -DCMAKE_INSTALL_LIBDIR=/usr/lib \
              ../geant${pkgver}

    msg "Finished configuring, now compiling and installing"

    make install DESTDIR=${pkgdir}

    msg "Finished installing, now making final adjustments"

    cd ${pkgdir}/usr

    sed s#%%G4VERSION%%#${_pkgver}#g ${srcdir}/g4env > bin/g4env
    chmod +x bin/g4env
}
