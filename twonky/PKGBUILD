# Maintainer: Michael Goehler <somebody.here@gmx.de>
# Contributor: picard <picard@fr32k.de>

pkgname=twonky
pkgver=7.2.7
pkgrel=1
pkgdesc="A DLNA-compliant UPnP AV server software from PacketVideo."
arch=('x86_64')
url="http://twonky.com/"
license=('custom')
depends=('imagemagick')
optdepends=('ffmpeg: video transcoding'
            'mencoder: video transcoding')
backup=('etc/twonky.ini')
install="${pkgname}.install"
#noextract=("twonky-x86-64-glibc-2.9-${pkgver}-${pkgrel}.zip")
noextract=("twonky-x86-64-glibc-2.9-${pkgver}.zip")
#source=("http://www.twonkyforum.com/downloads/${pkgver}-${pkgrel}/twonky-x86-64-glibc-2.9-${pkgver}-${pkgrel}.zip"
source=("http://www.twonkyforum.com/downloads/${pkgver}/twonky-x86-64-glibc-2.9-${pkgver}.zip"
        "twonky.service"
        "twonky.ini")

package() {
    # twonky base install
    #
    mkdir -p "${pkgdir}/usr/lib/twonky"
    #unzip -q -d "${pkgdir}/usr/lib/twonky" "${srcdir}/twonky-x86-64-glibc-2.9-${pkgver}-${pkgrel}.zip"
    unzip -q -d "${pkgdir}/usr/lib/twonky" "${srcdir}/twonky-x86-64-glibc-2.9-${pkgver}.zip"

    # twonky config file (including defaults for appdata dir)
    #
    mkdir -p "${pkgdir}/etc"
    cp "${srcdir}/twonky.ini" "${pkgdir}/etc/twonky.ini"

    # twonky appdata dir (as defined in twonky.ini)
    #
    mkdir -p "${pkgdir}/var/twonky/share/"{music,pictures,videos}

    # systemd unit file
    #
    mkdir -p "${pkgdir}/usr/lib/systemd/system"
    cp "${srcdir}/twonky.service" "${pkgdir}/usr/lib/systemd/system/twonky.service"
}

md5sums=('dd1840ac4c2ee2f7036201bf7a7cac29'
         '4c89bcaef67cc11f02dca29aea10de1e'
         '8b4bb58663cb81b8d1cff0cc3d6183f4')
