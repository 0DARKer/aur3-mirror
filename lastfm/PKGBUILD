# Maintainer: FzerorubigD <Fzerorubigd {AT} GMail {DOT} com>

pkgname=lastfm
pkgver=2.1.30
pkgrel=1
pkgdesc="The official Last.fm desktop application suite"
arch=('any')
url="http://www.last.fm/"
license=('GPL3')
depends=('qt>4.8' 'ruby' 'liblastfm' 'pkg-config' 'fftw' 'taglib' 'libsamplerate' 'libmad' 'libgpod' 'sqlite' 'phonon' 'phonon-vlc')
makedepends=()
source=(Last.fm-$pkgver.tar.bz2::http://www.last.fm/download/linux
	glibfix.patch
	lastfm-scrobbler)
md5sums=('5f13a2f114143a861c6f2572cb152d24'
		'2d77a2d19dd5569dc5213ac99b813e52'
		'a5d3b0b4026d4694a580b099c5f82932')
#install=$pkgname.install

build() {
  cd $srcdir/lastfm-desktop-$pkgver
  patch -Np1 -i ../glibfix.patch
  qmake -r
  make
  
}

package() {
  cd "$srcdir/lastfm-desktop-$pkgver"
  mkdir -p $pkgdir/usr/bin
  mkdir -p $pkgdir/opt/last.fm/css
  cp -R _bin $pkgdir/opt/last.fm/bin
  cp app/client/Last.fm\ Scrobbler.css $pkgdir/opt/last.fm/css
  install -m755 $srcdir/lastfm-scrobbler $pkgdir/usr/bin/lastfm-scrobbler
}
