# Contributor: T-T

pkgname='pigmap'
pkgver='1.1.2'
pkgrel=0
pkgdesc="Minecraft Google map generator"
arch=('i686' 'x86_64')
url="https://github.com/equalpants/pigmap"
license=('GPL')
depends=(bash libpng)
makedepends=()
conflicts=()
optdepends=()

source=("https://github.com/equalpants/pigmap/zipball/v1.1.2")
md5sums=(dc7588d01ae0bda3e7a23b7d5a43bf21)

build() {
	src="$(dir ${srcdir} -1 | grep equalpants-pigmap)"
	
	cd "${src}"
	mkdir "${pkgdir}/usr"
	mkdir "${pkgdir}/usr/share"
	mkdir "${pkgdir}/usr/share/pigmap"
	mkdir "${pkgdir}/usr/share/pigmap/images"
	mkdir "${pkgdir}/usr/bin"
	make
	cd "${srcdir}"
	for soubor in fire endportal; do
		mv "./${src}/${soubor}.png" "${pkgdir}/usr/share/pigmap/images"
	done
	until [ -e "${srcdir}/terrain.png" ]; do
		echo "Copy terrain.png from your ~/.minecraft/bin/minecraft.jar to $srcdir package dir."
		read
	done
	cp "${srcdir}/terrain.png" "${pkgdir}/usr/share/pigmap/images"
	for soubor in "${src}/"*; do
		mv "${soubor}" "${pkgdir}/usr/share/pigmap"
	done
	
	echo '#!/bin/bash

cd /usr/share/pigmap
./pigmap $@
' > "${pkgdir}/usr/bin/pigmap"
	chmod +x "${pkgdir}/usr/bin/pigmap"
}
