# Maintainer: TryA <tryagainprod {at} gmail.com>
# Contributor: Thomas Dziedzic < gostrc at gmail >
# Contributor: webjdm <web.jdm@gmail.com>

pkgname=firefox32
pkgver=3.6.14
pkgrel=1
pkgdesc="bin32-firefox for Arch x86_64 (en-US)"
arch=('x86_64')
license=('MPL' 'GPL' 'LGPL')
url="http://www.mozilla.org/projects/firefox"
depends=('lib32-dbus-glib' 'lib32-gtk2' 'lib32-libxt' 'lib32-alsa-lib' 'lib32-gconf' 'lib32-nss' 'lib32-xcb-util' 'lib32-libnotify')
makedepends=('diffutils' 'fakeroot' 'pkgconfig')
optdepends=('firefox32-i18n: i18n support'
            'lib32-flashplugin: flash support'
            'bin32-acroread: adobe reader plugin'
            'bin32-jre: sun java plugin'
            'lib32-librsvg: svg_loader.so library'
            'lib32-gtk-engines: libclearlooks.so library'
            'lib32-bug-buddy: libgnomebreakpad.so library')
install=firefox.install
source=("http://releases.mozilla.org/pub/mozilla.org/firefox/releases/${pkgver}/linux-i686/en-US/firefox-${pkgver}.tar.bz2"
        'firefox32.desktop' 'firefox32-safe.desktop' 'mozplugin.patch')
md5sums=('422daf7cb74eee95bb3324156c4e2f46'
         'f93c2d52600eaf905b2e9c8df318d9a6'
         '803ab3405d3c30d0a947ffe1d7d224aa'
         'a6f982f4d6271f680cbf3d1e71a85ef0')

build() {
  cd ${pkgdir}

  # directory and files
  mkdir -p {usr/bin,opt}
  cp -r ${srcdir}/firefox opt/${pkgname}
  mv opt/${pkgname}/firefox opt/${pkgname}/firefox32
  mv opt/${pkgname}/firefox-bin opt/${pkgname}/firefox32-bin
  ln -s /opt/${pkgname}/${pkgname} usr/bin/${pkgname}

  # Icons
  mkdir -p usr/share/applications
  mkdir -p usr/share/pixmaps

  cd ${srcdir}

  install -m644 firefox32.desktop ${pkgdir}/usr/share/applications/
  install -m644 firefox32-safe.desktop ${pkgdir}/usr/share/applications/
  install -m644 firefox/icons/mozicon128.png ${pkgdir}/usr/share/pixmaps/firefox32.png

  cd ${pkgdir}

  # set MOZ_PLUGIN_PATH variable
  patch -Np0 < ${srcdir}/mozplugin.patch
}
