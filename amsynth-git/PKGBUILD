# Maintainer: Nick Lanham <nick@afternight.org>
pkgname=amsynth-git
_gitname=amsynth
pkgver=20130405
pkgrel=1
pkgdesc="software synth that provides a classic subtractive synthesizer topology"
arch=('i686' 'x86_64')
url="https://code.google.com/p/amsynth/"
license=('GPL2')
depends=('gtkmm' 'jack')
makedepends=('git')
provides=('amsynth')
conflicts=('amsynth')

_gitroot="https://code.google.com/p/amsynth/"
source=()
md5sums=('SKIP')

pkgver() {
  cd "$srcdir/$_gitname"
  echo "0.$(git rev-list --count master).$(git describe --always)"
}

build() {
  cd "$srcdir"
  msg "Connecting to GIT server...."

  if [[ -d "$_gitname" ]]; then
    cd "$_gitname" && git pull origin
    msg "The local files are updated."
  else
    git clone "$_gitroot" "$_gitname"
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting build..."

  cd "$srcdir/$_gitname"

  ./autogen.sh
  ./configure --prefix=/usr
  make
}

package() {
  cd "$srcdir/$_gitname"
  make DESTDIR="$pkgdir/" install
}

# vim:set ts=2 sw=2 et:
