# Maintainer: Vincent Post <vincent.post@w1r3.net>
# Github: https://github.com/w1r3/archlinux-packages
# Repo: http://repo.w1r3.org/w1r3-supported/

pkgname=tshock
pkgver=4.2.2.1228
_pkgver=4.2200
pkgrel=1
pkgdesc="A Terraria Server administration modification that runs on the open source TerrariaAPI."
arch=(any)
url="http://tshock.co/xf/"
license=("GPL")
depends=(tmux mono)

source=("https://github.com/NyxStudios/TShock/releases/download/v${_pkgver}/TShock.${pkgver}.zip"
        'tshock.sh'
        'tshock.install'
        'tshock.service')

sha512sums=('9febbc9533a8b0594c4069a76750c2d57b9795ea09ab2de3457105cda3aeb938ad73361f93f45f613e10651ccb3aae23bacbbd81e52c5bf6c3e2215db350d12c'
            'a8dbf2342871a0cffadce17697ec5d998389b51bd0d6cb8e4361123edc1cf7399d38f4b7d361fe1942dd16177d157dbda64510047bd57eac509366b6249a0365'
            '5d22c7dd54adf426aa041df6bffb7e1f25797a9c5ff0d620076b48dbdbfdd30a02320a84544b85ccc7ff008fa5f08c6ad81b155a46bbb7b8505d805f5c621dea'
            '2d4582ddd908ebf58f6935631977794f4ab654d09f31215f2bc595c966ed18bf8db7cabc1f7ee01cbb6199711ab73a624b9de62d7a2d9256599054536ccf2482')

install=tshock.install
backup=('srv/tshock/tshock.sh')

package() {
  mkdir -p ${pkgdir}/srv/tshock/ServerPlugins/

  install -Dm744 ${srcdir}/tshock.sh ${pkgdir}/srv/tshock/
  install -Dm644 ${srcdir}/tshock.service ${pkgdir}/usr/lib/systemd/system/tshock.service

  install -Dm644 ${srcdir}/ServerPlugins/* ${pkgdir}/srv/tshock/ServerPlugins/
  install -Dm644 ${srcdir}/sqlite3.dll ${pkgdir}/srv/tshock/
  install -Dm644 ${srcdir}/TerrariaServer.exe ${pkgdir}/srv/tshock/
}
