# Contributor Alper Kanat <alperkanat@raptiye.org>
# Contributor Jaeic Lee <zeraxeal@gmail.com>
# Based on rt2860 package from Marius Dransfeld <marius.dransfeld@gmail.com>

pkgname="rt3090"
pkgver="2.4.0.1_20101110"
pkgrel=1
pkgdesc="Drivers for rt3090 chipset wireless cards"
arch=("i686" "x86_64")
url="http://www.ralinktech.com/"
license="GPL"
depends=("kernel26>=2.6.35" "kernel26<2.6.36")
makedepends=("kernel26-headers>=2.6.35" "kernel26-headers<2.6.36")
conflicts=("rt2860")
install="rt3090.install"

_kernver="2.6.35-ARCH"
_distname="DPO_RT3090_LinuxSTA_V${pkgver}_WiFiBTCombo_RFKill"
source=("noinstall.diff" "$_distname.bz2::http://www.ralinktech.com/download.php?t=U0wyRnpjMlYwY3k4eU1ERXdMekV4THpFeEwyUnZkMjVzYjJGa05UTTNPVE00TkRVek55NWllakk5UFQxRVVFOWZVbFF6TURrd1gweHBiblY0VTFSQlgxWXlMalF1TUM0eFh6SXdNVEF4TVRFd1gxZHBSbWxDVkVOdmJXSnZYMUpHUzJsc2JBPT1D")
md5sums=("7ab489cc1704ff45f727d2ad6d955d94"
         "18be1791e23a35cdfd78497e90f0cbcd")

build() {
	# Upstream puts a tarball inside a bzip2 compressed tarball, for
	# some reason.
	tar xf $_distname.tar
	
	patch -p0 < $srcdir/noinstall.diff

	cd $_distname
	make
}

package() {
	cd $_distname

	install -Dm644 RT2860STA.dat \
		$pkgdir/etc/Wireless/RT2860STA/RT2860STA.dat
	install -Dm644 os/linux/rt3090sta.ko \
		$pkgdir/lib/modules/$_kernver/kernel/drivers/net/wireless/rt3090sta.ko
}

