# Contributor: suppaman2 <suppaman2@gmail.com>
# 
# Note: no md5sum, because they change their .tar.gz without changing its filename
# but its not that important because the game has its own update system
# so there won't be any need to rise pkgver.
# 

pkgname=clonk_rage
pkgver=4.9.9.5
pkgrel=3
pkgdesc="An entertaining, action-packed game of strategy, tactics, and skill."
arch=('i686' 'x86_64')
url="http://clonk.de"
license=('SHAREWARE')
groups=('games')
md5sums=()
install=${pkgname}.install

conflicts=('clonk_rage_x86_64')
replaces=('clonk_rage_x86_64')

depends=('libxpm' 'sdl_mixer' 'libstdc++5' 'gtk2' 'grep')

source=("http://www.clonkx.de/rage/cr_full_linux.tar.bz2" \
	clonk_rage.i686.sh clonk_rage.x86_64.sh clonk_rage.desktop)

build() {
  
  # clean up unneeded files
  cd $startdir/src/cr_full_linux
  rm install.sh
  rm uninstall.sh
  
  # move everything else (its about 100mb, so moving saves a lot of resources)
  install -d $startdir/pkg/opt/clonk_rage/
  cd $startdir/pkg/opt/clonk_rage/
	mv $startdir/src/cr_full_linux/* ./
  chgrp -R games $startdir/pkg/opt/clonk_rage/
  chmod -R g+w $startdir/pkg/opt/clonk_rage/

  # link icons (we could also link mime icons, but idk where so i left it out)
  install -d $startdir/pkg/usr/share/pixmaps/
  ln -sf /opt/clonk_rage/icons/cr.png $startdir/pkg/usr/share/pixmaps/clonk_rage.png

  # chmod exec's
  chmod 755 ./clonk
  chmod 755 ./clonk64
  chmod 755 ./c4group
  chmod 755 ./c4group64
  
  # launch script
  install -Dm755 $startdir/src/clonk_rage.$CARCH.sh $startdir/pkg/usr/bin/clonk_rage
  
 # desktop launcher
 install -Dm644 $startdir/src/clonk_rage.desktop $startdir/pkg/usr/share/applications/clonk_rage.desktop

}

# vim:set ts=2 sw=2 et:
