diff --git a/Sources/ptDcRaw.h b/Sources/ptDcRaw.h
--- a/Sources/ptDcRaw.h
+++ b/Sources/ptDcRaw.h
@@ -64,12 +64,11 @@
 #ifdef __cplusplus
   // This hack copes with jpeglib.h that does or doesnt provide the
   // extern internally.
-  #define ptraw_saved_cplusplus __cplusplus
-  #undef __cplusplus
+  #define DONT_USE_EXTERN_C
   extern "C" {
   #include <jpeglib.h>
   }
-  #define __cplusplus ptraw_saved_cplusplus
+  #undef DONT_USE_EXTERN_C
 #else
   #include <jpeglib.h>
 #endif
diff --git a/Sources/ptImage.cpp b/Sources/ptImage.cpp
--- a/Sources/ptImage.cpp
+++ b/Sources/ptImage.cpp
@@ -48,12 +48,11 @@
 #ifdef __cplusplus
   // This hack copes with jpeglib.h that does or doesnt provide the
   // extern internally.
-  #define ptraw_saved_cplusplus __cplusplus
-  #undef __cplusplus
+  #define DONT_USE_EXTERN_C
   extern "C" {
   #include <jpeglib.h>
   }
-  #define __cplusplus ptraw_saved_cplusplus
+  #undef DONT_USE_EXTERN_C
 #else
   #include <jpeglib.h>
 #endif
