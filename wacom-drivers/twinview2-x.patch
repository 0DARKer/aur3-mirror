From c684649cde60772402407f398f3dbec7e8e7b909 Mon Sep 17 00:00:00 2001
From: Peter Hutterer <peter.hutterer@who-t.net>
Date: Mon, 20 Jun 2011 13:06:33 +1000
Subject: [PATCH] xsetwacom: split output setting into set_output_xrandr

Preparation work for NVIDIA TwinView support.

Signed-off-by: Peter Hutterer <peter.hutterer@who-t.net>
Tested-by: Jason Gerecke <killertofu@gmail.com>
---
 tools/xsetwacom.c |   22 ++++++++++++++--------
 1 files changed, 14 insertions(+), 8 deletions(-)

diff --git a/tools/xsetwacom.c b/tools/xsetwacom.c
index 9b5b12f..47518ee 100644
--- a/tools/xsetwacom.c
+++ b/tools/xsetwacom.c
@@ -1963,7 +1963,7 @@ static void _set_matrix_prop(Display *dpy, XDevice *dev, const float fmatrix[9])
 	XFlush(dpy);
 }
 
-static void set_output(Display *dpy, XDevice *dev, param_t *param, int argc, char **argv)
+static void set_output_xrandr(Display *dpy, XDevice *dev, param_t *param, int argc, char **argv)
 {
 	int min, maj;
 	int i, found = 0;
@@ -1972,13 +1972,6 @@ static void set_output(Display *dpy, XDevice *dev, param_t *param, int argc, cha
 	XRROutputInfo *output_info;
 	XRRCrtcInfo *crtc_info;
 
-	if (argc != param->arg_count)
-	{
-		fprintf(stderr, "'%s' requires exactly %d value(s).\n", param->name,
-			param->arg_count);
-		return;
-	}
-
 	output_name = argv[0];
 
 	if (!XRRQueryExtension(dpy, &maj, &min)) /* using min/maj as dummy */
@@ -2053,6 +2046,19 @@ static void set_output(Display *dpy, XDevice *dev, param_t *param, int argc, cha
 	XRRFreeScreenResources(res);
 }
 
+static void set_output(Display *dpy, XDevice *dev, param_t *param, int argc, char **argv)
+{
+	if (argc != param->arg_count)
+	{
+		fprintf(stderr, "'%s' requires exactly %d value(s).\n", param->name,
+			param->arg_count);
+		return;
+	}
+
+	set_output_xrandr(dpy, dev, param, argc, argv);
+}
+
+
 static void get_all(Display *dpy, XDevice *dev, param_t *param, int argc, char **argv)
 {
 	param_t *p = parameters;
-- 
1.7.0.1

