# Contributor: hocwp <hocwp[at]free[dot]fr>

pkgname=clfswm
pkgver=1102
pkgrel=1
pkgdesc="A(nother) Common Lisp FullScreen Window Manager"
url="http://common-lisp.net/project/clfswm/"
license='GPL'
arch=('i686' 'x86_64')
depends=('clisp' 'clisp-clx-cvs')
makedepends=('cvs')
backup=()
conflicts=()
provides=()
source=(http://common-lisp.net/project/clfswm/clfswm-$pkgver.tar.gz)
md5sums=(04d2da1b60d005b4bbe4b2435061441b)

build() {
	mkdir -p $startdir/pkg/usr/share/clfswm-$pkgver/src
	cp -R $startdir/src/clfswm-$pkgver/* $startdir/pkg/usr/share/clfswm-$pkgver/src
	cd $startdir/pkg/usr/share/clfswm-$pkgver/src
	msg "Starting to build clisp image"
	clisp -m 4MB -E ISO-8859-1 -q -M /usr/lib/clisp/full/lispinit.mem -i contrib/asdf.lisp -x "(asdf:oos 'asdf:load-op :clfswm)"

	mkdir -p $startdir/pkg/usr/bin/
	cat <<- EOF > $startdir/pkg/usr/bin/clfswm
#!/bin/sh

echo "Please, hit 'Alt F1' or 'Mod-1 F1' for help on clfswm."

cd /usr/share/clfswm-$pkgver/src/
clisp -m 4MB -q -q -E ISO-8859-1 -M /usr/lib/clisp/full/lispinit.mem -i contrib/asdf.lisp -x "(asdf:oos 'asdf:load-op :clfswm) (clfswm:main)"
	EOF

	chmod a+x $startdir/pkg/usr/bin/clfswm
}

