# Maintainer: Knight < echo YW5vbnltb3Vza25pZ2h0OTYrYXVyQGdtYWlsLmNvbQ== |base64 -d >


pkgname=cmd-markdown
_pkgname=Cmd-Markdown
pkgver=1.0.0
pkgrel=0
pkgdesc='An enhanced Markdown editor with MathJax, flowchart & sequence-diagram support'
arch=('x86_64')
url=('https://www.zybuluo.com/cmd')
license=('custom')
depends=('nss' 'gconf' 'libnotify' 'gtk2' 'alsa-lib' 'libxtst')
source=('http://home.ustc.edu.cn/~knight42/cmd-markdown-x86_64.tar.gz' 'cmd-markdown.desktop')
md5sums=('9e39cf084d2ad8d52811d836ac537eb2'
         'c1596b758328bb4797d867dfdb7d2633')
options=(!strip)

prepare(){
    cd "$srcdir"/linux64
    mv 'Cmd Markdown' Cmd-Markdown
    chmod 644 libffmpegsumo.so
    chmod 755 locales
}
package(){
    # for libudev.so.0
    if [ ! -e /usr/lib/libudev.so.0 ]; then
        mkdir -p ${pkgdir}/usr/lib
        ln -s /usr/lib/libudev.so ${pkgdir}/usr/lib/libudev.so.0
    fi

    mkdir -p "$pkgdir/usr/share/applications"
    install -Dm644 cmd-markdown.desktop "$pkgdir/usr/share/applications/"

    mkdir -p "$pkgdir/opt/$_pkgname"
    cp -r linux64/* "$pkgdir/opt/$_pkgname"

    mkdir -p "$pkgdir/usr/bin"
    ln -s "/opt/$_pkgname/Cmd-Markdown" "$pkgdir/usr/bin/cmd-markdown"
}
