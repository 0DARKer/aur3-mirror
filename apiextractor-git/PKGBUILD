# Contributor: Douglas Soares de Andrade <douglas@archlinux.org>

pkgname=apiextractor-git
_pkgname=apiextractor
pkgver=20110110
pkgrel=1
pkgdesc="API Extractor collects information about libraries from its header files and merges it with user written files (typesystem) describing how the library should be exposed as a binding on the target language."
url="http://qt.gitorious.org/pyside"
arch=('i686' 'x86_64')
license=('LGPL')
depends=('qt' 'boost' 'libxslt')
makedepends=('cmake' 'git' 'automoc4')
conflicts=()
provides=('apiextractor=0.9.3')

_gitroot='git://gitorious.org/pyside/apiextractor.git'
_gitname='apiextractor'

build() {
	cd "$srcdir"

	msg "Connecting to gitorious GIT server...."

	if [ -d ${srcdir}/$_gitname ] ; then
		cd $_gitname
		git pull . master
		git submodule update --init
		msg "The local files are updated."
	else
		git clone $_gitroot $_gitname
		cd $_gitname
		git submodule update --init
	fi

	msg "GIT checkout done."

	cd ..
	if [ -d build ] ; then
		rm -rf build
	fi
	mkdir build
	cd build
	cmake ${srcdir}/$_gitname \
	-DCMAKE_INSTALL_PREFIX=/usr || return 1
	make || return 1
	make DESTDIR=$startdir/pkg install
}


