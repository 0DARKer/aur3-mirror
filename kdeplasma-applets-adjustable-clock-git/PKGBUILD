# Contributor: Simone Solinas <ksolsim@gmail.com>

pkgname=kdeplasma-applets-adjustable-clock-git
pkgver=20130414
pkgrel=1
pkgdesc="Customizable kdeplasma clock"
arch=(i686 x86_64)
url="https://github.com/Emdek/plasmoid-adjustable-clock"
license=('GPL')
conflicts=('adjustable-clock-plasmoid')
depends=('kdebase-workspace')
makedepends=('cmake' 'automoc4')

_gitroot="git://github.com/Emdek/plasmoid-adjustable-clock.git"
_gitname="plasmoid-adjustable-clock"

build() {
      
    msg "Connecting to the GIT server...."
    if [[ -d "$_gitname" ]]; then
        cd "$_gitname" && git pull origin && cd "$srcdir"
        msg "The local files are updated."
    else
        git clone "$_gitroot" "$_gitname"
    fi

    msg "GIT checkout done or server timeout"
    msg "Starting build..."

    cd "$srcdir/$_gitname/"
    mkdir build
    cd build
          
  cmake -DQT_QMAKE_EXECUTABLE=qmake-qt4 -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=`kde4-config --prefix` ..
  make

}

package() {
  cd "$srcdir/$_gitname/build"
  make DESTDIR=$pkgdir install
} 