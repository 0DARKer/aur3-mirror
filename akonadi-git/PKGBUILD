# Contributor: Lawrence Lee <valheru@facticius.net>
# Contributor: Dan Vratil <vratil@progdansoft.com>
pkgname=akonadi-git
pkgver=20101116
pkgrel=1
pkgdesc="Part of KDE4 Support"
arch=('i686' 'x86_64')
url="http://www.kde.org"
license=('GPL')
depends=('soprano')
makedepends=('git' 'cmake' 'automoc4')
provides=(akonadi)
conflicts=(akonadi)
source=()
md5sums=()
groups=('kde4.0-svn' 'kde')

build() {

  msg "Connecting to GIT server...."
    
  if [ -d ${srcdir}/akonadi/.git ] ; then
      cd ${srcdir}/akonadi
      git pull origin
      msg "The local files are updated."
  else
      cd ${srcdir}
      git clone git://git.kde.org/akonadi
  fi


  # start building
  if [ ! -d ${srcdir}/build ]; then
      mkdir ${srcdir}/build
  fi
  cd ${srcdir}/build
  
  cmake ../akonadi \
	 -DCMAKE_INSTALL_PREFIX=/usr \
	 -DCMAKE_BUILD_TYPE=RELWITHDEBINFO

  make
}

package() {

  cd ${srcdir}/build
  make DESTDIR=${pkgdir} install

}
