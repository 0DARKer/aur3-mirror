# Greylisting daemon from Debian project. Requires 'start-stop-daemon'.
# Contributor: Vladimir Koshelenko <koshelenko@rndavia.ru>

pkgname=greylistd
pkgver=0.8.3.4
pkgrel=1
pkgdesc="Simple greylisting system for mail transport agents"
url="http://packages.debian.org/unstable/mail/greylistd"
depends=('python' 'start-stop-daemon')
source=(http://ftp.debian.org/debian/pool/main/g/greylistd/$pkgname\_$pkgver.tar.gz $pkgname.sh)
md5sums=('20295c2722b56c84f2ea8846ca4a47ac' '0ce2a49b24d63d30ee6df0dcb11def98')
backup=(etc/greylistd/config)
install=$pkgname.install

build() {
  mkdir -p $startdir/pkg/usr/man/man1 || return 1
  mkdir -p $startdir/pkg/usr/man/man8 || return 1
  mkdir -p $startdir/pkg/usr/bin || return 1
  mkdir -p $startdir/pkg/usr/sbin || return 1
  mkdir -p $startdir/pkg/etc/greylistd || return 1
  install -D -m644 $startdir/src/$pkgname-$pkgver/config/config $startdir/pkg/etc/greylistd || return 1
  install -D -m644 $startdir/src/$pkgname-$pkgver/config/whitelist-hosts $startdir/pkg/etc/greylistd || return 1
  install -D -m644 $startdir/src/$pkgname-$pkgver/doc/examples/exim4-acl-example.txt $startdir/pkg/etc/greylistd || return 1
  install -D -m644 $startdir/src/$pkgname-$pkgver/doc/man1/greylist.1 $startdir/pkg/usr/man/man1/ || return 1
  gzip $startdir/pkg/usr/man/man1/greylist.1 
  install -D -m644 $startdir/src/$pkgname-$pkgver/doc/man8/greylistd.8 $startdir/pkg/usr/man/man8/ || return 1
  gzip $startdir/pkg/usr/man/man8/greylistd.8 
  install -D -m755 $startdir/src/$pkgname-$pkgver/program/greylist $startdir/pkg/usr/bin/ || return 1
  install -D -m755 $startdir/src/$pkgname-$pkgver/program/greylistd $startdir/pkg/usr/sbin/ || return 1
  install -D -m755 $startdir/src/$pkgname.sh $startdir/pkg/etc/rc.d/$pkgname || return 1
  
}
