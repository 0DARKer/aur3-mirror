# Maintainer: M0Rf30 <morf3089@gmail.com>

pkgname=opengts
pkgver=2.5.4
pkgrel=1
pkgdesc="A full featured web-based GPS tracking system for your fleet of vehicles"
arch=('i686' 'x86_64')
url="http://opengts.sourceforge.net/"
license=('APACHE')
depends=('jre7-openjdk-headless' 'mysql-jdbc' 'java-gnumail' 'tomcat7' 'mariadb')
makedepends=('apache-ant')
install=opengts.install
source=("http://prdownloads.sourceforge.net/opengts/OpenGTS_${pkgver}.zip"
	'build.xml'
	'opengts.csh'
	'opengts.sh')

package() {
  cd ${srcdir}/OpenGTS_${pkgver}
  export CATALINA_HOME=/usr/share/tomcat7/
  cp ../build.xml .
  ant all
  mkdir -p $pkgdir/usr/share/tomcat7/webapps/
  cp build/*.war $pkgdir/usr/share/tomcat7/webapps/
  mkdir -p $pkgdir/opt/opengts
  cp -r bin $pkgdir/opt/opengts/
  # install profile.d script
  install -dm755 ${pkgdir}/etc/profile.d
  install -m755 "${srcdir}"/${pkgname}.{csh,sh} ${pkgdir}/etc/profile.d/
  
  # remove .bat files
  rm $pkgdir/opt/opengts/bin/*.bat

  # Pdf Guide installation
  cp OpenGTS_Config.pdf ${pkgdir}/opt/opengts/
}

md5sums=('1da57a2515a57ab043b9fe40e0441115'
         '4b7b7249c67a0fc8e84b4984dd624553'
         '841e957e78f0a617fe89e7c9bb66132d'
         '9e8981a8ad668801e8fa07405fa281f0')
