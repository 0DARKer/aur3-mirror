# Contributor: joyfulgirl@archlinux.us
# Contributor: nathan owe ndowens04 at gmail dot com
# Contributor: Tomato <kario@wsisiz.edu.pl>
# Contributor: N30N <archlinux@alunamation.com>

pkgname=cclive-git
pkgver=20110309
pkgrel=1
pkgdesc="Commandline downloader for popular video websites"
arch=("i686" "x86_64")
url="http://cclive.sourceforge.net/"
license=("GPL3")
depends=("boost-libs" "quvi")
makedepends=("git" "cmake" "boost")
provides=("cclive")
conflicts=("cclive")

_gitroot="git://repo.or.cz/cclive.git"
_gitname="cclive"

build() {
	if [ -d ${_gitname} ]; then
		cd ${_gitname}
		git clean -dfx
		git reset --hard
		git pull origin
	else
		git clone $_gitroot
		cd ${_gitname}
	fi

	# Work around for file rearrangement done in commit: 3a867
	sed -r "s|(\(\|/)(cclive)\b|\1../\2|" \
		-i src/CMakeLists.txt

	cmake -DCMAKE_BUILD_TYPE=release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DCMAKE_VERBOSE_MAKEFILE=true
	make DESTDIR="${pkgdir}" install
}

# vim: set noet ff=unix:
