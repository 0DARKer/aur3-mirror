diff -urB wine/dlls/kernel32/heap.c wine/dlls/kernel32/heap.c
--- wine/dlls/kernel32/heap.c	2011-12-16 19:15:33.000000000 +0000
+++ wine/dlls/kernel32/heap.c	2011-12-19 17:08:41.686061500 +0000
@@ -1351,6 +1351,7 @@
 
     /* values are limited to 2Gb unless the app has the IMAGE_FILE_LARGE_ADDRESS_AWARE flag */
     /* page file sizes are not limited (Adobe Illustrator 8 depends on this) */
+    /*
     if (!(nt->FileHeader.Characteristics & IMAGE_FILE_LARGE_ADDRESS_AWARE))
     {
         if (lpBuffer->dwTotalPhys > MAXLONG) lpBuffer->dwTotalPhys = MAXLONG;
@@ -1358,6 +1359,7 @@
         if (lpBuffer->dwTotalVirtual > MAXLONG) lpBuffer->dwTotalVirtual = MAXLONG;
         if (lpBuffer->dwAvailVirtual > MAXLONG) lpBuffer->dwAvailVirtual = MAXLONG;
     }
+    */
 
     /* work around for broken photoshop 4 installer */
     if ( lpBuffer->dwAvailPhys +  lpBuffer->dwAvailPageFile >= 2U*1024*1024*1024)
diff -urB wine/dlls/ntdll/loader.c wine/dlls/ntdll/loader.c
--- wine/dlls/ntdll/loader.c	2011-12-16 19:15:33.000000000 +0000
+++ wine/dlls/ntdll/loader.c	2011-12-19 17:04:12.512726601 +0000
@@ -2663,7 +2663,8 @@
     status = wine_call_on_stack( attach_process_wine/dlls, wm, NtCurrentTeb()->Tib.StackBase );
     if (status != STATUS_SUCCESS) goto error;
 
-    virtual_release_address_space( nt->FileHeader.Characteristics & IMAGE_FILE_LARGE_ADDRESS_AWARE );
+    //virtual_release_address_space( nt->FileHeader.Characteristics & IMAGE_FILE_LARGE_ADDRESS_AWARE );
+    virtual_release_address_space( IMAGE_FILE_LARGE_ADDRESS_AWARE );
     virtual_clear_thread_stack();
     wine_switch_to_stack( start_process, kernel_start, NtCurrentTeb()->Tib.StackBase );
