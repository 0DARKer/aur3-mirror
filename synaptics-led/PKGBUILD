# Maintainer: Matthew Monaco <dgbaley27@verizon.net>

_kver=2.6.38

pkgname=synaptics-led
pkgver=$_kver
pkgrel=0

arch=(i686 x86_64)
license=GPL2
url="http://www.kernel.org"
pkgdesc="Synaptics LED enabled psmouse kernel module"

source=(
	ftp://ftp.kernel.org/pub/linux/kernel/v2.6/linux-$_kver.tar.bz2
	config.i686
	config.x86_64
	synled.patch
)

md5sums=(
	7d471477bfa67546f902da62227fa976
	9190ad35cc77d57f40c16ee636c3a1dc
	3e458d099ee7d764728998911efdf600
	6d565328f36c6ca20b439f29bffc43bb
)

build() {

	cd ${srcdir}/linux-$_kver

	patch -Np1 -i ${srcdir}/synled.patch

	cp ${srcdir}/config.${CARCH} .config

	echo "CONFIG_MOUSE_PS2_SYNAPTICS_LED=y" >> .config

	make ${MAKEFLAGS} drivers/input/mouse/psmouse.ko
}

package() {

	dira=${srcdir}/linux-${_kver}/drivers/input/mouse
	dirb=${pkgdir}/lib/modules/${_kver}-ARCH/updates

	install -D -m 0644 ${dira}/psmouse.ko ${dirb}/psmouse.ko

	gzip -9 ${dirb}/psmouse.ko
}
