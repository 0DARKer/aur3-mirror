# Contributor: Praekon <praekon@googlemail.com>
# Contributor: Arthur <arthur.darcet@m4x.org>
# Contributor: Jon Wiersma <archaur@jonw.org>
# Contributor: Ray <rfischer@me.com>
# Contributor: Ryon Sherman <ryon.sherman@gmail.com>

pkgname=plexmediaserver
pkgver=0.9.6.0.11
pkgrel=1
pkgnum=ba33da9
pkgdesc='Plex Media Server for Linux'
url='http://www.plexapp.com'
arch=('i686' 'x86_64')
license=('closed')
depends=('avahi' 'rsync')
replace=('plex')
backup=("etc/conf.d/$pkgname")
install="$pkgname.install"
source=('plexmediaserver.rc.d' 'plexmediaserver.conf.d')
md5sums=('f4b9a8473551127ab3de151005600f07' 'cb0b32d853f2c8b760e62b391196a881')

if [ "$CARCH" = "i686" ]; then
       _arch='i386'
       md5sums+=('4442031c7faebded7e9ecd7e77053648')
elif [ "$CARCH" = "x86_64" ]; then
       _arch='amd64'
       md5sums+=('7aa1f4158bbea6778061796c8f65b66f')
       depends+=('lib32-libxml2' 'lib32-sqlite3' 'lib32-boost-libs' 'lib32-curl')
fi

source+=("http://www.plexapp.com/repo/pool/main/p/${pkgname}/${pkgname}_${pkgver}-${pkgnum}_${_arch}.deb")

build() {
       ar -xv ${pkgname}_${pkgver}-${pkgnum}_${_arch}.deb || return 1
       tar -zxf data.tar.gz || return 1
}

package(){
       mkdir -p $pkgdir/usr/lib/plexmediaserver
       mkdir -p $pkgdir/etc/rc.d

       cp -r usr/lib/plexmediaserver/* $pkgdir/usr/lib/plexmediaserver/
       install -D -m644 plexmediaserver.conf.d $pkgdir/etc/conf.d/plexmediaserver
       install -D -m755 plexmediaserver.rc.d $pkgdir/etc/rc.d/plexmediaserver
}

