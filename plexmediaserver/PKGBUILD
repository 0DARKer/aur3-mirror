# Contributor: Praekon <praekon@googlemail.com>
# Contributor: Arthur <arthur.darcet@m4x.org>

pkgname=plexmediaserver
pkgver=0.9.5.2
pkgrel=0
pkgdesc="Plex Media Server for Linux"
url="http://www.plexapp.com"
arch=('i686' 'x86_64')
license=('closed')
depends=('avahi' 'rsync')
replace=('plex')

install='plexmediaserver.install'

if [ "$CARCH" = "i686" ]; then
       _arch='i386'
       md5sums=('b74084ad5323d159fd493fdcfb0c6e11')
elif [ "$CARCH" = "x86_64" ]; then
       _arch='amd64'
       md5sums=('3412883e0f22d7270940fb2625dac0ba')
       depends+=('lib32-libxml2' 'lib32-sqlite3' 'lib32-boost-libs' 'lib32-curl')
fi

source=("http://www.plexapp.com/repo/pool/main/p/plexmediaserver/plexmediaserver_${pkgver}-7a18da4_${_arch}.deb" 'plexmediaserver')
md5sums+=('35e67114e32a8ddf2d99835cea86551e')


build() {
       ar -xv plexmediaserver_${pkgver}-7a18da4_${_arch}.deb || return 1
       tar -zxf data.tar.gz || return 1
}

package(){
       mkdir -p $pkgdir/usr/lib/plexmediaserver
       mkdir -p $pkgdir/etc/rc.d

       cp -r usr/lib/plexmediaserver/* $pkgdir/usr/lib/plexmediaserver/
       install -D -m644 etc/default/plexmediaserver $pkgdir/etc/plexmediaserver.conf
       install -D -m755 plexmediaserver $pkgdir/etc/rc.d/
}
