# Contributor: Arthur <arthur.darcet@m4x.org>
pkgname=plexmediaserver
pkgver=0.9.3.5
pkgrel=1
pkgdesc="Plex Media Server for Linux"
url="http://www.plexapp.com"
arch=('i686' 'x86_64')
license=('closed')
depends=('avahi')
replace=('plex')

install='plexmediaserver.install'

if [ "$CARCH" = "i686" ]; then
	_arch='i386'
	md5sums=('eaafbaa6eea6432b997604063a659cf0')
	sha1sums=('6374f6262c91908865e45eefbf19e2b68234edb0')
	sha256sums=('d54e948d4aca89d9348a69829169756e861463024cbdd5c4448307f508cdbda5')
elif [ "$CARCH" = "x86_64" ]; then
	_arch='amd64'
	md5sums=('96e9377639c0aa41bc37fe93313b3c2d')
	sha1sums=('c0cad227119923c9cdbf72efb73154998a04929b')
	sha256sums=('6faa001061cc408361702d380f1219c66a3f1842642d8bf996f99a8aa74f73e0')
	depends+=('lib32-libxml2' 'lib32-sqlite3' 'lib32-boost-libs' 'lib32-curl')
fi

source=("http://www.plexapp.com/repo/pool/main/p/plexmediaserver/plexmediaserver_0.9.3.5ubuntu1_${_arch}.deb" 'plexmediaserver')

md5sums+=('e73d9e9a5b66ef502d2b35bc82f6bb87')
sha1sums+=('cde868e4f9ebce60893ea8ed00defa24d640c546')
sha256sums+=('99539b6235f4e308a91d27877735f2e6823a771a3045c83395633b23ab06f9ec')


build() {
	ar -xv plexmediaserver_0.9.3.5ubuntu1_${_arch}.deb || return 1
	tar -zxf data.tar.gz || return 1
}

package(){
	mkdir -p $pkgdir/usr/lib/plexmediaserver
	mkdir -p $pkgdir/etc/rc.d
	
	cp -r usr/lib/plexmediaserver/* $pkgdir/usr/lib/plexmediaserver/
	install -D -m644 etc/default/plexmediaserver $pkgdir/etc/plexmediaserver.conf
	install -D -m755 plexmediaserver $pkgdir/etc/rc.d/
}
