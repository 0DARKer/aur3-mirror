# Contributor: Praekon <praekon@googlemail.com>
# Contributor: Arthur <arthur.darcet@m4x.org>
# Contributor: Jon Wiersma <archaur@jonw.org>
# Contributor: monty <linksoft [at] gmx [dot] de>

pkgname=plexmediaserver
pkgver=0.9.6.5.177
pkgrel=5c3cf40
pkgdesc="Plex Media Server for Linux"
url='http://www.plexapp.com'
arch=('i686' 'x86_64')
license=('closed')
depends=('avahi' 'rsync')
replace=('plex')
backup=('etc/conf.d/plexmediaserver')
install='plexmediaserver.install'

if [ "$CARCH" = "i686" ]; then
       _arch='i386'
       md5sums=('7aba3adb0c09cdee726d54697527a9e4'
                '60453be241bcf0baf4a68735db6cb0d5')
elif [ "$CARCH" = "x86_64" ]; then
       _arch='amd64'
       md5sums=('222ad6141eb49df4bed4f66f8d4724a5'
                '8c22de2ec41980e571472fe54595ccbf')
fi

source=("${url}/repo/pool/main/p/${pkgname}/${pkgname}_${pkgver}-${pkgrel}_${_arch}.deb" "http://dl.dropbox.com/u/152616/${_arch}/libdbus-1.so.3" "${pkgname}.conf.d" "${pkgname}.rc.d")
md5sums+=('cb0b32d853f2c8b760e62b391196a881'
          'd1e0e26fc7af46186b3f929e4b9d4005')

build() {
       ar -xv plexmediaserver_${pkgver}-${pkgrel}_${_arch}.deb || return 1
       tar -zxf data.tar.gz || return 1
}

package() {
       mkdir -p ${pkgdir}/usr/lib/plexmediaserver
       mkdir -p ${pkgdir}/etc/rc.d

       cp -r ${srcdir}/usr/lib/plexmediaserver/* ${pkgdir}/usr/lib/plexmediaserver/
       install -D -m644 ${srcdir}/libdbus-1.so.3 ${pkgdir}/usr/lib/plexmediaserver/
       install -D -m644 ${srcdir}/plexmediaserver.conf.d ${pkgdir}/etc/conf.d/plexmediaserver
       install -D -m755 ${srcdir}/plexmediaserver.rc.d ${pkgdir}/etc/rc.d/plexmediaserver
}
