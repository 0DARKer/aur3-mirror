# Maintainer: Gaetan Bisson <bisson@archlinux.org>

pkgname=usocks
pkgver=0.3
pkgrel=1
pkgdesc='Minimalistic SOCKS proxying library'
url='http://www.normalesup.org/~bisson/src/'
license=('ISC')
arch=('i686' 'x86_64' 'armv7h')
optdepends=('openssh: companion script')
source=("${url}/${pkgname}-${pkgver}.c"
        "${pkgname}")
sha1sums=('70cc31fd2fd957f38c4a814387e9f615ab1918e9'
          '31e3c9f02325976201b5a3b387b2c169f452000d')

build() {
	cd "${srcdir}"
	cc -fPIC -shared \
		${CFLAGS} ${LDFLAGS} \
		-o ${pkgname}.so ${pkgname}-${pkgver}.c
}

package() {
	cd "${srcdir}"
	install -d "${pkgdir}/usr/share/licenses/${pkgname}"
	install -Dm755 "${pkgname}" "${pkgdir}/usr/bin/${pkgname}"
	install -Dm755 "${pkgname}.so" "${pkgdir}/usr/lib/${pkgname}.so"
	head -n 15 "${pkgname}-${pkgver}.c" > "${pkgdir}/usr/share/licenses/${pkgname}/COPYING"
}
