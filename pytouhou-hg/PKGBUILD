# Maintainer: Emmanuel Gil Peyrot <linkmauve@linkmauve.fr>

_name=pytouhou
pkgname=$_name-hg
pkgver=1
pkgrel=4
pkgdesc='Libre reimplementation of the Touhou 6 engine.'
arch=('i686' 'x86_64')
url='http://linkmauve.fr/doc/touhou/'
license=('GPL3')
depends=('pyglet')
makedepends=('mercurial' 'cython2')
provides=('pytouhou')
conflicts=('pytouhou')
optdepends=('th06-demo-data: The freeware demo of EoSD.')

_hgtrunk=http://hg.sitedethib.com/touhou/
_hgmod=$_name

build() {
  cd "$srcdir"

  if [ -d "$_hgmod/.hg" ]; then
    cd "$_hgmod"
    hg pull -u
  else
    hg clone "$_hgtrunk" "$_hgmod"
    cd "$_hgmod"
  fi
}

package() {
  cd "$srcdir/$_hgmod"
  sed -i "/--path/s,'\.','/usr/share/th06-demo'," eosd
  python2 setup.py install --prefix=/usr --root="$pkgdir"
}

