--- eqn2img.c.orig	2007-10-05 17:51:48.000000000 +0200
+++ eqn2img.c	2012-08-19 15:06:54.000000000 +0200
@@ -347,7 +347,7 @@
   info_ptr = png_create_info_struct(png_ptr);
   assert(info_ptr);
   
-  if(setjmp(png_ptr->jmpbuf)) {
+  if(setjmp(png_jmpbuf(png_ptr))) {
     png_destroy_read_struct(&png_ptr, &info_ptr, NULL);
     fclose(fp);
     return NULL;
@@ -556,7 +556,7 @@
   assert(info_ptr);
 
   /* error handling, libpng longjmps here on any error */
-  if(setjmp(png_ptr->jmpbuf)) {
+  if(setjmp(png_jmpbuf(png_ptr))) {
     png_destroy_read_struct(&png_ptr, &info_ptr, NULL);
     fclose(fp);
     return -1;
