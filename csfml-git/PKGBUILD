# Maintainer: Alexandre Bury <alexandre.bury@gmail.com>

pkgname=csfml-git
pkgver=20121127
pkgrel=1
pkgdesc='C bindings for sfml. Git repository.'
arch=('i686' 'x86_64')
url='http://www.sfml-dev.org/'
license=('ZLIB')
depends=('sfml>=2.0')
makedepends=('git' 'mesa' 'cmake' 'doxygen')
conflicts=('csfml')
provides=('csfml=2.0')

_gitroot='https://github.com/LaurentGomila/CSFML.git'
_gitname='CSFML'

build() {
    cd "$srcdir"
    msg "Connecting to GIT server...."

    if [ -d $_gitname ] ; then
        cd $_gitname && git pull origin
        msg "The local files are updated."
    else
        git clone $_gitroot
        cd $_gitname
    fi

    msg "GIT checkout done or server timeout"
    msg "Starting make..."

    rm -rf "$srcdir/$_gitname-build"
    mkdir "$srcdir/$_gitname-build"
    cd "$srcdir/$_gitname-build"

    cmake -DCMAKE_INSTALL_PREFIX=/usr "../$_gitname" \
        -DBUILD_DOC=true
    make
    make doc
}

package() {
    cd "$srcdir/$_gitname-build"

    make DESTDIR="$pkgdir/" install

    install -Dm644 "../$_gitname/license.txt" "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}

# vim:set ts=2 sts=2 sw=2 et:
