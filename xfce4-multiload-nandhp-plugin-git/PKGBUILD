# Maintainer: Pierre Carru <pierre.carru@gmail.com>
pkgname=xfce4-multiload-nandhp-plugin-git
pkgver=20130203
pkgrel=2
pkgdesc="Multiload panel plugin for Xfce panel"
arch=('i686' 'x86_64')
url="http://github.com/nandhp/multiload-nandhp"
license=('GPL2')
groups=('xfce4-goodies')
depends=('xfce4-panel>=4.7.4' 'libxfcegui4' 'libgtop')
makedepends=('git' 'intltool')

md5sums=()

_gitroot=("https://github.com/nandhp/multiload-nandhp.git")
_gitname="multiload"

build() {
    cd "$srcdir"
    msg "Connecting to GIT server...."

    if [ -d $_gitname ] ; then
        cd $_gitname && git pull origin
        msg "The local files are updated."
    else
        git clone $_gitroot $_gitname
    fi

    msg "GIT checkout done or server timeout"
    msg "Starting make..."

    rm -rf "$srcdir/$_gitname-build"
    git clone "$srcdir/$_gitname" "$srcdir/$_gitname-build"
    cd "$srcdir/$_gitname-build"

    # build

    ./autogen.sh
    ./configure --prefix=/usr \
        --enable-fast-install \
        --disable-static \
        --with-xfce4
    make
}

package() {
    cd "$srcdir/$_gitname-build"
    make DESTDIR="$pkgdir" install
    rm -f $pkgdir/usr/lib/xfce4/panel/plugins/libmultiload.la
}

