# Maintainer: Thomas Laube <tomx3@tomtomtom.org>

pkgname=vokoscreen-git
pkgver=20130103
pkgrel=1
pkgdesc="vokoscreen is an easy to use screencast creator to record educational videos, live recordings of browser, installation, videoconferences, etc."
arch=('i686' 'x86_64')
url="http://www.kohaupt-online.de/"
license=('GPL2')
depends=('glibc' 'gcc-libs' 'qt' 'libstdc++5' 'libx11' 'ffmpeg' 'alsa-utils' 'lame' 'xorg-bdftopcf' 'xorg-iceauth' 'xorg-luit' 'xorg-mkfontdir' 'xorg-mkfontscale' 'xorg-sessreg' 'xorg-setxkbmap' 'xorg-smproxy' 'xorg-x11perf' 'xorg-xauth' 'xorg-xbacklight' 'xorg-xcmsdb' 'xorg-xcursorgen' 'xorg-xdpyinfo' 'xorg-xdriinfo' 'xorg-xev' 'xorg-xgamma' 'pulseaudio' 'v4l-utils' 'mkvtoolnix-gtk')
makedepends=('git' 'binutils' 'unzip' 'wget')

_gitroot="https://github.com/vkohaupt/vokoscreen.git"
_gitname="vokoscreen"

build() {

  cd ${srcdir}

  msg "Connecting to GIT server..."
  if [[ -d ${_gitname} ]]; then
    (cd ${_gitname} && git pull origin)
  else
    git clone ${_gitroot} ${_gitname}
  fi
  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  rm -rf ${_gitname}-build
  git clone ${_gitname} ${_gitname}-build

  cd ${srcdir}/${_gitname}-build
  qmake DESTDIR="${pkgdir}" PREFIX=$pkgdir VARPREFIX=$pkgdir
}

package() {

  cd ${srcdir}/${_gitname}-build
  INSTALL_ROOT=$pkgdir make install

}

