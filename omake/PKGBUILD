# Maintainer: Jaroslav Lichtblau <dragonlord@aur.archlinux.org>
# Contributor: Mildred <silkensedai@online.fr>

pkgname=omake
pkgver=0.9.8.5_3
_pkgver=0.9.8.5-3
pkgrel=3
pkgdesc="Omake build system."
arch=('i686' 'x86_64')
url="http://omake.metaprl.org/"
license=('GPL')
makedepends=('make' 'ocaml' 'patch')
source=(http://omake.metaprl.org/downloads/${pkgname}-${_pkgver}.tar.gz \
        $pkgname-build-0.9.8.5.diff \
        $pkgname-lm_printf-gcc44.diff)

md5sums=('d114b3c4201808aacd73ec1a98965c47'
         '77a937fa31739b0db89cbe526ac3ebd1'
         '21d9fb6cb2cd548b20f642b352349c6e')

build() {
  cd ${srcdir}/$pkgname-0.9.8.5

  patch -Np0 -i ${srcdir}/$pkgname-build-0.9.8.5.diff || return 1
  patch -Np0 -i ${srcdir}/$pkgname-lm_printf-gcc44.diff || return 1

  make bootstrap || return 1
  make PREFIX=/usr all || return 1
  make PREFIX=/usr INSTALL_ROOT=${pkgdir} install
}
