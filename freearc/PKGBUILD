# Maintainer: Limao Luo <luolimao+AUR@gmail.com>
# Contributor: TuxSpirit <tuxspirit@archlinux.fr>

pkgname=freearc
pkgver=0.666
_pkgname=FreeArc-$pkgver-linux-i386
pkgrel=3
pkgdesc="FreeArc archiver combines unexampled speed/compression ratio and multitude of features"
arch=(i686 x86_64)
url=http://freearc.org
license=(GPL)
depends=(desktop-file-utils lib32-curl lib32-gmp4 lib32-gtk2 lib32-ncurses)
[[ $CARCH == "i686" ]] && depends=(${depends[@]/lib32-/})
options=(!emptydirs)
install=$pkgname.install
source=($url/download/$pkgver/$_pkgname.tar.bz2
    $pkgname.desktop
    freearcusercfg.sh)
sha256sums=('84b53a3151493ae40408458b19a099e65526b6a589be343e48954d8c8446a1b9'
    'ed4b5fc8ac6ac6452921eafe0bad421d12a53ca28c12046a5c8219f89b96e058'
    '848c77ba5660a3459ab840d9951b9ae9ee8ec525232bbb4b18d198478670ddbc')
sha512sums=('bfe166d4baaf38a66b55ef88c573800ad93f145a41235673368470f2f3d2b359e1cf867e3d8d07a45365061ffe69413a72d2f277cf77376ac060fd4cf536b310'
    'f1f8a5193ccfccdfd79f4de483542f28033f90f20e42b438ac318cb71337b13ec7ec8c4484ddac290e2accc23f447f5b0355e7d8db65e6666f7b19542a2e95c5'
    'fc851ac2b7890420ba16977bd4c20441690a7da15f1dc0e9c8a384aebae02fdfdf83cfaaebd25b7ef7568333f90899d48e6d39ff1a60c500f1b99335814dbe40')

prepare(){
    [[ $CARCH == "x86_64" ]] && sed -i 's:libdir=.*:&32:' freearcusercfg.sh
}

package(){
    _libdir=lib
    [[ $CARCH == "x86_64" ]] && _libdir+=32
    desktop-file-install $pkgname.desktop --dir "$pkgdir"/usr/share/applications/
    cd $_pkgname/
    install -d "$pkgdir"/usr/share/doc/
    mv Documentation "$pkgdir"/usr/{share/doc/$pkgname/,$_libdir/}
    cp -r bin "$pkgdir"/usr/
    cp -r lib/* scripts Addons "$pkgdir"/usr/$_libdir/FreeArc/
    install -Dm755 ../freearcusercfg.sh "$pkgdir"/usr/$_libdir/FreeArc/scripts/freearcusercfg.sh

    install -d "$pkgdir"/etc/
    cp -r cfg "$pkgdir"/etc/
}  
