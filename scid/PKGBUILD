# Maintainer: Luis Sarmiento < lgsarmientop-ala-unal.edu.co >

pkgname=scid
pkgver=4.3
pkgrel=2
pkgdesc="A Free Chess Database Application"
url="http://scid.sourceforge.net"
arch=('x86_64' 'i686')
license=('GPL') 
depends=('tk' 'python')
options=('!emptydirs')

source=("$pkgname-$pkgver.tar.bz2::http://prdownloads.sourceforge.net/$pkgname/$pkgname-$pkgver.tar.bz2?download"
	"configure_tclversion.patch")
md5sums=('66592f91b690458d3aecb582142fc159'
         'e706fdb83d94e3c67ae67324e6ba214a')

build() {
	_TCL_VER=`pacman -Q tk | cut -f2 -d" " | cut -f1-2 -d"."`
	msg "Compiling ${pkgname} using Tcl version ${_TCL_VER}"
	cd ${srcdir}/${pkgname}
	patch -Np2 < ${srcdir}/configure_tclversion.patch
	./configure BINDIR=${pkgdir}/usr/bin SHAREDIR=${pkgdir}/usr/share/${pkgname} TCL_VERSION=${_TCL_VER} OPTIMIZE="-O2 -funroll-loops"
	make
}

package () {
	cd ${srcdir}/${pkgname}
	make install
}