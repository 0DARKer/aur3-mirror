# Maintainer: Kaiting Chen <kaiting.chen@kiwilight.com>

pkgname='nss-ldapd'
_pkgname='nss-pam-ldapd'
pkgver='0.8.6'
pkgrel='2'
pkgdesc='LDAP module for NSS and PAM'
arch=('i686' 'x86_64')
url="http://arthurdejong.org/$_pkgname/"
license=('LGPL2.1')
depends=('heimdal' 'pam' 'libldap' 'cyrus-sasl')
conflicts=('nss_ldap' 'pam_ldap')
replaces=('nss_ldap' 'pam_ldap')

backup=('etc/nslcd.conf')
install=nss-ldapd.install

md5sums=('0cc34b83ad2cc1d0ee66c1aa273c26d4'
         '42d7285523b23a077e1133eb3eac5ea3')
source=(
  "$url$_pkgname-$pkgver.tar.gz" nslcd.rc.d)

build() {
  cd "${srcdir}/${_pkgname}-${pkgver}"
  ./configure --prefix='/usr' \
    --sysconfdir=/etc \
    --localstatedir=/var \
    --enable-sasl \
    --with-nslcd-pidfile=/var/run/nslcd.pid \
    --with-nslcd-socket=/var/run/nslcd.sock
  make; make DESTDIR="$pkgdir" install
  install -Dm755 $srcdir/nslcd.rc.d $pkgdir/etc/rc.d/nslcd
}
