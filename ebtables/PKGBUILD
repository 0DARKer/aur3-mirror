# Contributor: Michal Soltys <soltys@ziu.info>

pkgname=ebtables
pkgver='v2.0.9.2'
_realver='v2.0.9-2'
pkgrel=1
pkgdesc="Ethernet bridge filtering utility."
arch=(i686 x86_64)
backup=(etc/conf.d/ebtables)
url="http://ebtables.sourceforge.net/"
depends=('glibc' 'perl')
license=('GPL')
#_realver is not used here, because this variable is not parsed
source=(
	http://downloads.sourceforge.net/ebtables/$pkgname-v2.0.9-2.tar.gz
	ebtables.sh
	)
md5sums=('b880429a6424186728eb57ae80ef878a'
         'a63b0204de92f5253d9801bd5a4277b7')
build() {
  cd ${startdir}/src/${pkgname}-${_realver}
  make || return 1
  mkdir -p \
	${startdir}/pkg/etc/rc.d \
	${startdir}/pkg/etc/conf.d \
	${startdir}/pkg/etc/ebtables \
	${startdir}/pkg/usr/sbin \
	${startdir}/pkg/usr/share/man
  make install \
	DESTDIR=${startdir}/pkg \
	LIBDIR=/usr/lib/ebtables \
	MANDIR=/usr/share/man \
	BINDIR=/usr/sbin \
	INITDIR=/etc/rc.d \
	SYSCONFIGDIR=/etc/ebtables || return 1
  #move to conf.d to fit into Arch structure
  mv ${startdir}/pkg/etc/ebtables/ebtables-config ${startdir}/pkg/etc/conf.d/ebtables
  chmod 0600 ${startdir}/pkg/etc/conf.d/ebtables
  #use adjusted script
  install -o root -m0755 -D ${startdir}/ebtables.sh ${startdir}/pkg/etc/rc.d/ebtables
}
