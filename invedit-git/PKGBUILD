# Maintainer: Your Name <mail@semicolonsoftware.de>
pkgname=invedit-git
pkgver=20110615
pkgrel=1
pkgdesc="Minecraft Inventory Editor"
arch=(any)
url="http://www.minecraftforum.net/topic/14190-invedit/"
license=('GPL')
groups=()
depends=( mono )
makedepends=('git')
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=invedit.install
source=(items.txt items.png special.png terrain.png invedit.desktop)
noextract=()
md5sums=('7606585775b01fe65dfb3db1560eb6e8'
         '7267344118628644f7f35216044333b4'
         '8ed32841441791504c7c9f16dc6cc81c'
         '660f8fc631f0eb6cc6d2c86a71f9379c'
         '8a74dfee530af3181a8c3b0ec50cf4b7')


_gitroot="git://github.com/copyboy/INVedit.git"
_gitname="invedit"

build() {
  cd "$srcdir"
  msg "Connecting to GIT server...."

  if [ -d $_gitname ] ; then
    cd $_gitname && git pull origin
    msg "The local files are updated."
  else
    git clone $_gitroot $_gitname
  fi

  msg "GIT checkout done or server timeout"
  msg "Starting make..."

  rm -rf "$srcdir/$_gitname-build"
  git clone "$srcdir/$_gitname" "$srcdir/$_gitname-build"
  cd "$srcdir/$_gitname-build"

  #
  # BUILD HERE
  #

  xbuild || exit 1

}

package() {
  cd "$srcdir/$_gitname-build/bin/Debug/"
  install -Dm755 "$srcdir/$_gitname-build/bin/Debug/INVedit.exe" "$pkgdir/usr/share/invedit/INVedit.exe"
  install -Dm755 "$srcdir/$_gitname-build/bin/Debug/NBT.dll" "$pkgdir/usr/share/invedit/NBT.dll"
  install -m644 "$srcdir/items.txt" "$srcdir/items.png" "$srcdir/special.png" "$srcdir/terrain.png" "$pkgdir/usr/share/invedit/"
  mkdir -p "$pkgdir/usr/bin/"

  echo -e "#!/bin/bash\nmono /usr/share/invedit/INVedit.exe" > $pkgdir/usr/bin/invedit && chmod 755 $pkgdir/usr/bin/invedit

  install -Dm644 "$srcdir/$_gitname-build/icon.png" "$pkgdir/usr/share/pixmaps/invedit.png"
  install -Dm644 "$srcdir/invedit.desktop" "$pkgdir/usr/share/applications/invedit.desktop"
} 

