# Maintainer: Anthony Cornehl <accornehl[at]gmail[dot]com>
# https://github.com/twinshadow/abs-ofed
pkgname=dapl
pkgver=2.0.36
pkgrel=2
pkgdesc="Userspace access to RDMA devices using OS Agnostic DAT APIs"
groups=('ofed')
url="http://www.openfabrics.org"
arch=('x86_64' 'i686')
license=('GPL2' 'custom:"Open Fabrics Alliance BSD"')
depends=('librdmacm')
source=("http://www.openfabrics.org/downloads/dapl/${pkgname}-${pkgver}.tar.gz"
        "dat_strerror.patch")
# cksum start
md5sums=('8313a302685089502b44934183199dd5'
         '78405bf318c0b445d62423055434a85b')
sha512sums=('40f56eef7d32db043c7562201cbd08b9d4483d08b4fb49af8da82b772c83fae097a96fd4e2b34ee403d37ad003d09b0f7e3830521ff5a865c2d6d239215b28ed'
            '7119838e76a4022535af5329347d1b979eab7960cb9bf74bf5f85a5cd67a32fa78a7b43f34bdc594ea7ef4d38233104785614dd455dc6bdbce22426470e2bb84')
# cksum end

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  ./configure --prefix=/usr \
              --mandir=/usr/share/man \
              --sysconfdir=/etc \
              --localstatedir=/var
  patch -p1 < ../../dat_strerror.patch
  make
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  make -j1 DESTDIR="${pkgdir}" install
  install -Dm644 COPYING "$pkgdir/usr/share/licenses/$pkgname/COPYING"
}