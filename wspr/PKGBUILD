# Maintainer: Mike WB2FKO <mph at sportscliche dot com>
pkgname=wspr
pkgver=2.11r2263
pkgrel=1
pkgdesc="Weak Signal Propagation Reporter"
arch=('any')
url="http://physics.princeton.edu/pulsar/K1JT/wsjt.html"
license=('GPL')
depends=('python2' 'python-imaging' 'python2-numpy' 'libsamplerate' 'portaudio' 'fftw')
makedepends=('deb2targz')
source=(http://physics.princeton.edu/pulsar/K1JT/${pkgname}_${pkgver}_i386.deb
               startwspr
               $pkgname.png
               $pkgname.desktop)
md5sums=('3827a577ba051e363fd31bc63bce48f0'
         'a45e52cf7021f56a2cfa361a5223f2fc'
         'dd21318d4aa3423f1fbefc53061cc40d'
         '1aba25c35d6f11c5f6492de4bf58cee6')

build() {
#Make a tarball from the debian source file
   deb2targz ${srcdir}/${pkgname}_${pkgver}_i386.deb
# Expand the tarball
    tar xvzf ${srcdir}/${pkgname}_${pkgver}_i386.tar.gz
# The program will not run if the files are separated so place the entire package in /opt
    rm -rf $pkgdir/opt/$pkgname
    mkdir -p $pkgdir/opt/$pkgname
    mv DEB "$pkgdir/opt/$pkgname"
    mv WSPR "$pkgdir/opt/$pkgname"

    find "$pkgdir/opt/$pkgname/" -type f  | xargs chmod 644
    find "$pkgdir/opt/$pkgname/" -type d | xargs chmod 755

# Install a menu item with icon
  cd $srcdir
  mkdir -p $pkgdir/usr/share/pixmaps
  mkdir -p $pkgdir/usr/share/applications
  install -Dm644 $pkgname.desktop $pkgdir/usr/share/applications/$pkgname.desktop
  install -Dm644  $pkgname.png $pkgdir/usr/share/pixmaps/$pkgname.png

# Install a simple launcher script
    install -Dm755 startwspr $pkgdir/opt/$pkgname/WSPR/startwspr

  echo -e "\n WSPR will be installed in the /opt directory of root \n"
}

# vim:set ts=2 sw=2 et:
