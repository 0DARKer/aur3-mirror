# Maintainer: Vinh Nguyen <kurei [at] axcoto.com>
pkgname=gogs
pkgver=0.3.1
pkgrel=1
pkgdesc="Gogs(Go Git Service) is a Self Hosted Git Service in the Go Programming Language"
arch=('i686' 'x86_64')
url="http://gogs.io/"
license=('free')
depends=(mysql)
makedepends=()
checkdepends=()
optdepends=(redis memcache)
backup=()
install=gogs.install

_homedir='/var/lib/gogs'
_datadir='/usr/share/gogs'

#source=("$pkgname"-"$pkgver"-"linux.tar.gz"
source=("http://gogs.qiniudn.com/${pkgname}_v${pkgver}_linux_amd64.zip"
"gogs.service"
"gogs.conf"
"gogs.install")

md5sums=('4a0842b0ecf1b1cf462d7e1a260718ef'
         '4bd192894425954a70c0a0ed94dbb8ab'
         'c9b9670dc9eb19130419628ae10e1e8d'
         '6bebb9d17f43a3ceb0373b783982530a')
build() {
  cd "$srcdir/$pkgname_v$pkgver_linux_amd64"
  #cd "$srcdir/"
  pwd
}

package() {
  cd "$srcdir/$pkgname_v$pkgver_linux_amd64"
  #cd "$srcdir/"

  pwd
  mkdir -p $pkgdir/var/lib/gogs/ \
            $pkgdir/usr/lib/systemd/system/ \
            $pkgdir/etc/ \
            $pkgdir/usr/share/gogs/ \
            $pkgdir/usr/share/gogs/db;
  cp -rf gogs/* "${pkgdir}/var/lib/gogs/"
  install -d -Dv gogs "${pkgdir}/var/lib/gogs/"
  install -v -Dm644 ../gogs.service $pkgdir/usr/lib/systemd/system/
  install -v -Dm644 ../gogs.conf $pkgdir/etc/
}
