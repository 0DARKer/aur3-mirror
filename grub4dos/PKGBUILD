# Maintainer:  Daniel YC Lin <dlin.tw (at) gmail.com>
# Contributor: Daniel YC Lin <dlin.tw (at) gmail.com>

# I've tried to build from source, but it failed in my x86_64 machine.
# So, this script only grab binary from exist zip format file.

pkgname=grub4dos
pkgver=0.4.5b_20110907
_pkgver=0.4.5b
_pkgdate=2011-09-07
pkgrel=1

#pkgver=${_pkgver}_${_pkgdate//-/}  # this method will failed on aur webpage

# the following line will let aur php page failed
#_pkgver=${pkgver/_*}  # right trim of _...
#_date=${pkgver/*_} # left trim of ..._
#_pkgdate=${_date:0:4}-${_date:4:2}-${_date:6:2}

pkgdesc="A GRUB boot loader support menu on windows(fat,ntfs)/linux(ext2,3,4)"
arch=(any) # (x86 x86_64) # both are same content

# namcap known warning
# grub4dos E: ELF file ('usr/sbin/bootlace.com') found in an 'any' package.
# grub4dos W: File (grub) exists in a non-standard directory.

url="http://code.google.com/p/grub4dos-chenall"
license=('GPL2')
backup=(etc/grub4dos.conf grub/menu.lst)
install=grub4dos.install
makedepends=('p7zip')
source=(
  http://grub4dos-chenall.googlecode.com/files/$pkgname-$_pkgver-$_pkgdate.7z
  http://grubutils.googlecode.com/files/unifont-2011-05-10.zip
  http://grub4dos-chenall.googlecode.com/files/arialuni_U16.zip
  README_arch.txt
  grub4dos.conf
  menu.lst
  )
#  http://grubutils.googlecode.com/files/fontfile-2010-10-03.zip

build() {
  7z x -y $pkgname-$_pkgver-$_pkgdate.7z

  mkdir -p $startdir/pkg/usr/sbin
  cp $startdir/src/$pkgname-$_pkgver/bootlace.com $startdir/pkg/usr/sbin

  mkdir -p $startdir/pkg/etc
  cp $startdir/src/grub4dos.conf $startdir/pkg/etc

  mkdir -p $startdir/pkg/grub
  for n in grldr grub.exe default ; do
    cp $startdir/src/$pkgname-$_pkgver/$n $startdir/pkg/grub
  done
  for n in unifont menu.lst arialuni_U16.bin ; do
    cp $startdir/src/$n $startdir/pkg/grub
  done
#  cp $startdir/src/unifont-5.1_U16.bin $startdir/pkg/grub/unifont
  gzip $startdir/pkg/grub/arialuni_U16.bin

  mkdir -p $startdir/pkg/usr/share/doc/$pkgname 
  for n in README_GRUB4DOS.txt ChangeLog_*.txt ; do
    cp $startdir/src/$pkgname-$_pkgver/$n $startdir/pkg/usr/share/doc/$pkgname
  done
  cp $startdir/README_arch.txt $startdir/pkg/usr/share/doc/$pkgname 
}
md5sums=('09a25bb889ca35f4741b408c7549d2c0'
         '3984c1b0dfdf22ece221e54b6690196b'
         '479f066a8f84095a2cb40ac3c473430d'
         '4fe1655e3f7f3eb45c3c58d6cc74e17c'
         '283a3e55667f7ce0d6333106b333376d'
         'be41e2a0a8080db15497eb73ac43db15')
# vim:set ts=2 sw=2 et:
