# Contributor: Paolo Herms

pkgname=why
pkgver=2.28
pkgrel=3
pkgdesc="a software verification platform"
arch=(x86_64 i686)
license=('LGPL')
url="http://why.lri.fr/"
depends=('gtk2')
optdepends=('frama-c' 'simplify-bin' 'yices-bin' 'z3-bin' 'alt-ergo')
makedepends=('ocaml' 'lablgtk2>=2.14' 'ocaml-ocamlgraph')
source=(http://why.lri.fr/download/why-$pkgver.tar.gz)

build() {
  cd "$srcdir"/why-$pkgver
  ./configure --prefix=/usr
  make || return 1
  [[ -e /usr/share/frama-c/Makefile.dynamic ]] && { 
     mkdir -p "$pkgdir"/usr/share/frama-c/ "$pkgdir"/usr/lib/frama-c/plugins/
     cp -v /usr/share/frama-c/Makefile.* "$pkgdir"/usr/share/frama-c
   } 
  [[ -e /usr/share/frama-c/Makefile.dynamic ]] || echo "no way"
  make DESTDIR="$pkgdir" FRAMAC_SHARE="$pkgdir"/usr/share/frama-c COQLIB="$pkgdir"/usr/lib/coq install || return 1
  rm -f "$pkgdir"/usr/share/frama-c/Makefile.*
   
}

md5sums=('c1fec836b51a5a10d30da82cfe3bbbb9')
