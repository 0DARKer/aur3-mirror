diff -aurN squid-3.1.7-orig/helpers/basic_auth/SMB/Makefile.in squid-3.1.7/helpers/basic_auth/SMB/Makefile.in
--- squid-3.1.7-orig/helpers/basic_auth/SMB/Makefile.in	2010-08-24 08:42:23.000000000 +0300
+++ squid-3.1.7/helpers/basic_auth/SMB/Makefile.in	2010-09-03 21:45:45.865999998 +0300
@@ -293,7 +293,7 @@
 # by using the --prefix option when configuring Samba, you need to change
 # SAMBAPREFIX accordingly.
 SMB_AUTH_HELPER = smb_auth.sh
-SAMBAPREFIX = /usr/local/samba
+SAMBAPREFIX = /usr
 SMB_AUTH_HELPER_PATH = $(libexecdir)/$(SMB_AUTH_HELPER)
 libexec_SCRIPTS = $(SMB_AUTH_HELPER)
 smb_auth_CFLAGS = -DSAMBAPREFIX=\"$(SAMBAPREFIX)\" -DHELPERSCRIPT=\"$(SMB_AUTH_HELPER_PATH)\"
diff -aurN squid-3.1.7-orig/src/Makefile.in squid-3.1.7/src/Makefile.in
--- squid-3.1.7-orig/src/Makefile.in	2010-08-24 08:42:37.000000000 +0300
+++ squid-3.1.7/src/Makefile.in	2010-09-03 22:01:43.970999999 +0300
@@ -1976,7 +1976,7 @@
 DEFAULT_STORE_LOG = $(DEFAULT_LOG_PREFIX)/store.log
 DEFAULT_PID_FILE = $(DEFAULT_PIDFILE)
 DEFAULT_NETDB_FILE = $(DEFAULT_LOG_PREFIX)/netdb.state
-DEFAULT_SWAP_DIR = $(localstatedir)/cache
+DEFAULT_SWAP_DIR = $(localstatedir)/cache/squid
 DEFAULT_PINGER = $(libexecdir)/`echo pinger | sed '$(transform);s/$$/$(EXEEXT)/'`
 DEFAULT_UNLINKD = $(libexecdir)/`echo unlinkd | sed '$(transform);s/$$/$(EXEEXT)/'`
 DEFAULT_DISKD = $(libexecdir)/`echo diskd | sed '$(transform);s/$$/$(EXEEXT)/'`
diff -aurN squid-3.1.7-orig/src/cf.data.pre squid-3.1.7/src/cf.data.pre
--- squid-3.1.7-orig/src/cf.data.pre	2010-08-24 08:41:26.000000000 +0300
+++ squid-3.1.7/src/cf.data.pre	2010-09-03 22:10:51.308558002 +0300
@@ -4080,7 +4080,7 @@
 
 NAME: cache_effective_group
 TYPE: string
-DEFAULT: none
+DEFAULT: proxy
 LOC: Config.effectiveGroup
 DOC_START
 	Squid sets the GID to the effective user's default group ID
