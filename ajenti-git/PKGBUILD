# Contributor: vbPadre <vbpadre@gmail.com>

pkgname=ajenti-git
pkgver=20100927
pkgrel=1
pkgdesc="An easy server administration frontend like webmin."
arch=('any')
url="http://github.com/Eugeny/ajenti/"
license=('GPL')
depends=('python>=2.6' 'python-lxml' 'pyopenssl' 'mysql-python' 'python-psycopg2')
makedepends=('git')
optdepends=()
provides=('ajenti')
source=('ajenti.conf' 'ajenti2.conf' 'initscript')
md5sums=('7a6de30aa25c4f9a80df248168a26234' '60ea454f11bbe1dfaa311edcee749445' 'f84dcd9355ac92f6e58c002e7968dc11')


_gitroot=git://github.com/Eugeny/ajenti.git
_gitname=ajenti

build() {
  cd ${srcdir}
  msg "Connecting to GIT server...."

  if [ -d "${srcdir}/${_gitname}" ] ; then
    cd ${_gitname} && git pull --rebase
  else
    git clone ${_gitroot}
  fi

  msg "GIT checkout done or server timeout"
  msg "Creating pkg..."

cp -f ${srcdir}/ajenti2.conf ${srcdir}/ajenti/packaging/files/ajenti.conf
cp -f ${srcdir}/ajenti.conf ${srcdir}/ajenti/ajenti.conf
cp -f ${srcdir}/initscript ${srcdir}/ajenti/packaging/files/initscript
mkdir -p ${pkgdir}/usr/share/ajenti
mkdir -p ${pkgdir}/usr/bin
mkdir -p ${pkgdir}/etc/rc.d
cp -r ${srcdir}/ajenti/ ${pkgdir}/usr/share/
cp  ${srcdir}/ajenti/packaging/files/starter ${pkgdir}/usr/bin/ajenti
cp  ${srcdir}/ajenti/packaging/files/initscript ${pkgdir}/etc/rc.d/ajenti
chmod 0755 ${pkgdir}/usr/bin/ajenti
chmod 0755 ${pkgdir}/etc/rc.d/ajenti

}
