# Maintainer: archtux <antonio dot arias99999 at gmail dot com>

pkgname=noblenote-git
pkgver=20130323
pkgrel=1
pkgdesc="nobleNote aims to be a lightweight, open source alternative to Evernote and OneNote."
url="http://qt-apps.org/content/show.php/nobleNote?content=157713"
arch=('i686' 'x86_64')
license=('BSD')
depends=('qt4')
makedepends=('git')

_gitroot="https://github.com/hakaishi/nobleNote.git"
_gitname="nobleNote"


build() {
   cd $srcdir
   msg "Connecting to GIT server...."

   if [[ -d $_gitname ]]; then
     cd $_gitname && git pull origin
     msg "The local files are updated."
   else
     git clone $_gitroot
   fi

   msg "GIT checkout done or server timeout"
   msg "Starting build..."

   rm -rf "$srcdir/$_gitname-build"
   git clone "$srcdir/$_gitname" "$srcdir/$_gitname-build"
   cd "$srcdir/$_gitname-build"

   # Build
   qmake-qt4
   make
}

package() {
   cd "$srcdir/$_gitname-build"

   make INSTALL_ROOT="${pkgdir}" install

   # Desktop icon
   install -Dm644 noblenote.desktop $pkgdir/usr/share/applications/noblenote.desktop
   sed -i 's|Icon=noblenote|Icon=/usr/share/pixmaps/noblenote-icons/noblenote|' $pkgdir/usr/share/applications/noblenote.desktop
}