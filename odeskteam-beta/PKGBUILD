# Package build for the linux oDesk Team client
# Maintainer: der_FeniX <derfenix dot gmail.com>
# Contributor: Stephen Weinberg <[firstname]@q5comm.com>

CARCH=`uname -m`
#CARCH='i686'

pkgname=odeskteam-beta
pkgver=3.12.9
pkgrel=2
pkgdesc="The oDesk Team client for odesk.com"
arch=('i586' 'i686' 'x86_64')
provides=('godesk')
replaces=('godesk')
conflicts=('godesk')
url="http://www.odesk.com/downloads"
license=('custom:ODESK TEAM LICENSE AGREEMENT')
depends=('libxss' 'phonon-qt4')

if test "$CARCH" = i686; then
	source=("https://www.odesk.com/downloads/linux/beta/odeskteam_${pkgver}_i386.deb")
	md5sums=('a8b34fb68a546429fb98acecf6724079')
fi

if test "$CARCH" = x86_64; then
	source=("https://www.odesk.com/downloads/linux/beta/odeskteam_${pkgver}_amd64.deb")
	md5sums=('6260c5625fe6c74af3a1c80ec7293b1b')
fi

prepare() {
	cd "$srcdir"
	tar -zxf "$srcdir/data.tar.gz"
}

package() {
	cd $srcdir
	mkdir $pkgdir/usr
	cp -R $srcdir/usr/* $pkgdir/usr/
	# Move licence to licences dir
	mkdir -p $pkgdir/usr/share/licenses/$pkgname
	zcat "$srcdir/usr/share/doc/odeskteam/COPYING.gz" > "$pkgdir/usr/share/licenses/$pkgname/COPYING"

	# Install .desktop file
	install -D -m 644 "../odeskteam.desktop" "$pkgdir/usr/share/applications/odeskteam.desktop"
}
