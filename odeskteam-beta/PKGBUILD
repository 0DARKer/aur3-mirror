# Package build for the linux oDesk Team client
# Maintainer: der_FeniX <derfenix dot gmail.com>
# Contributor: Stephen Weinberg <[firstname]@q5comm.com>

CARCH=`uname -m`

pkgname=odeskteam-beta
pkgver=3.12.9
pkgrel=1
pkgdesc="The oDesk Team client for odesk.com (beta version)"
arch=('i586' 'i686' 'x86_64')
provides=('godesk')
replaces=('godesk')
conflicts=('godesk')
url="http://www.odesk.com/downloads"
license=('custom:ODESK TEAM LICENSE AGREEMENT')
makedepends=('rpmextract')
depends=('qt4')

if [[ $CARCH = 'x86_64' ]]
then
	source=("https://www.odesk.com/downloads/linux/beta/odeskteam-3.12.9.x86_64.rpm"
	"odeskteam.desktop")
	md5sums=('e960d8d243c2e9c2e0441fb74d037697'
        	 'd5d155a48fb90db78096e1f74a618e78')
else
	source=("https://www.odesk.com/downloads/linux/beta/odeskteam-3.12.9.i386.rpm"
	"odeskteam.desktop")
	md5sums=('9eed252c69c75f584be27a36a9a88f37'
	         'd5d155a48fb90db78096e1f74a618e78')
fi

build() {
	if [[ $CARCH == 'x86_64' ]]
then
	rpmextract.sh odeskteam-3.12.9.x86_64.rpm
else
	rpmextract.sh odeskteam-3.12.9.i386.rpm
fi
}

package() {
	cd $srcdir
	mkdir $pkgdir/usr
	cp -R $srcdir/usr/* $pkgdir/usr/
	# Move licence to licences dir
	mkdir -p $pkgdir/usr/share/licenses/$pkgname
	mv "$srcdir/usr/share/odeskteam/COPYING" "$pkgdir/usr/share/licenses/$pkgname/COPYING"

	# Install .desktop file
	install -D -m 644 "$srcdir/odeskteam.desktop" "$pkgdir/usr/share/applications/odeskteam.desktop"
}
