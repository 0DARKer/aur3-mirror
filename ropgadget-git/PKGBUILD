pkgname=ropgadget-git
pkgver=4.0.2.r19.g407b1fd
pkgrel=1

pkgdesc='Search ELF binaries for gadgets to facilitate ROP exploitation'
url='http://www.shell-storm.org/project/ROPgadget/'
arch=('i686' 'x86_64')
license=('GPL2')

depends=('glibc')
makedepends=('python2' 'python')

source=('git://github.com/JonathanSalwan/ROPgadget/')

md5sums=('SKIP')

pkgver() {
    cd ROPgadget
    git describe --tags | sed 's/^v//; s/-/.r/; s/-/./'
}

prepare() {
    cd ROPgadget
    sed -i 's:/usr/bin/python:&2:' script/genInstrX86.py
}

build() {
    cd ROPgadget
    make
}

package() {
    cd ROPgadget
    install -Dm755 ROPgadget "$pkgdir"/usr/bin/ropgadget
}
