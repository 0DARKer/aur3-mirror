# Maintainer: twa022 <twa022 at gmail dot com>
# Contributor: Giuseppe Borzi <gborzi _AT_ ieee _DOT_ org>
# Contributor: ryooichi <ryooichi+arch AT gmail DOT com>
# Real thanks goes to jelly, mike_93 and the original creators of mintmenu, usp, slab...
# See also:
#   http://bbs.archlinux.org/viewtopic.php?id=66987
#   http://bbs.archlinux.org/viewtopic.php?id=68633
#   http://github.com/jelly/archmenu

pkgname=mintmenu
pkgver=5.3.7
pkgrel=1
pkgdesc="Linux Mint Menu for MATE"
arch=('i686' 'x86_64')
url="http://packages.linuxmint.com/pool/main/m/mintmenu"
license=('GPL')
depends=('pygtk' 'python-mate' 'python-mate-desktop' 'python-corba' 'archlinux-artwork' 'gksu' 'mate-terminal' 'python2-xdg' 'xdg-utils')
optdepends=('mate-menu-editor: for editing the gnome menu'
            'mint-translations: translations files')
source=("${url}/${pkgname}_${pkgver}.tar.gz" 'arch-patch.diff' 'removescript')

build() {
  cd "$srcdir"
  patch -Np0 -i "$srcdir/arch-patch.diff"
  cd "$srcdir/${pkgname}"
  rm -f usr/lib/linuxmint/mintMenu/*.pyc usr/lib/linuxmint/mintMenu/plugins/*pyc
  sed -i -e "s/__version__/$pkgver/" usr/lib/linuxmint/mintMenu/mintMenu.py
  cp -R usr "$pkgdir/"
  chmod 644 "$pkgdir/usr/lib/matecomponent/servers/mintMenu.server"
  install -m755 "$srcdir/removescript" "$pkgdir/usr/lib/linuxmint/mintMenu/"
  sed -i 's:#!/usr/bin/python:&2:' ${pkgdir}/usr/bin/mintmenu ${pkgdir}/usr/lib/linuxmint/mintMenu/{./,plugins/}*py
  sed -i 's:#!/usr/bin/env python:&2:' ${pkgdir}/usr/bin/mintmenu ${pkgdir}/usr/lib/linuxmint/mintMenu/{./,plugins/}*py
  cd "$pkgdir"/usr/lib/linuxmint/mintMenu
  ./compile.py
}

md5sums=('99672d641eb127d2dc3d4eb12ed65b6a'
         'f1d6c4434d7de8aec0d3471e780f1ae7'
         'bcdbc95fc35331f1f5e13a86b9d770f0')
