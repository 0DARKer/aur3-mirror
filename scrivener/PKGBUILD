# Maintainer: Dan Serban

pkgname=scrivener
pkgver=latest
pkgrel=1
pkgdesc="A powerful content-generation tool for writers"
arch=(i686 x86_64)
url=http://literatureandlatte.com/scrivener.php
license=(Commercial)
depends=(aspell)
makedepends=(lynx)
[ "${CARCH}" == "x86_64" ] && depends=(aspell lib32-glib2)
source=("http://eazyhax.com/downloads/scrivener.png")
md5sums=('6af6d7d5071fc9c481e88847c757a2e8')

build()
{
  _source_url=$(lynx -dump http://www.literatureandlatte.com/scrivenerforwindows/ | grep -o http.*tgz)
  msg2 "Retrieving ${_source_url}"
  wget -O LinuxScrivener.tgz "${_source_url}"
  bsdtar -xf LinuxScrivener.tgz
  mkdir -p "${pkgdir}"/usr/local
  mv LiteratureAndLatte "${pkgdir}"/usr/local/
  install -Dm644 scrivener.png "${pkgdir}"/usr/share/pixmaps/scrivener.png
  mkdir -p "${pkgdir}"/usr/share/applications
  DESKTOPFILE="${pkgdir}"/usr/share/applications/${pkgname}.desktop
  echo "[Desktop Entry]" > "${DESKTOPFILE}"
  echo "Name=Scrivener" >> "${DESKTOPFILE}"
  echo "GenericName=Writing Tool" >> "${DESKTOPFILE}"
  echo "Comment=A powerful content-generation tool for writers" >> "${DESKTOPFILE}"
  echo "Exec=/usr/local/LiteratureAndLatte/bin/Scrivener" >> "${DESKTOPFILE}"
  echo "Icon=/usr/share/pixmaps/scrivener.png" >> "${DESKTOPFILE}"
  echo "Terminal=false" >> "${DESKTOPFILE}"
  echo "Type=Application" >> "${DESKTOPFILE}"
  echo "Categories=Office;" >> "${DESKTOPFILE}"
  echo "StartupNotify=false" >> "${DESKTOPFILE}"
}

